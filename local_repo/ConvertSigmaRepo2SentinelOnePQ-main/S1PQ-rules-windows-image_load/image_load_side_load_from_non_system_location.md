```sql
// Translated content (automatically translated on 22-12-2025 01:26:06):
event.type="Module Load" and (endpoint.os="windows" and ((module.path contains "\\aclui.dll" or module.path contains "\\activeds.dll" or module.path contains "\\adsldpc.dll" or module.path contains "\\aepic.dll" or module.path contains "\\apphelp.dll" or module.path contains "\\applicationframe.dll" or module.path contains "\\appvpolicy.dll" or module.path contains "\\appxalluserstore.dll" or module.path contains "\\appxdeploymentclient.dll" or module.path contains "\\archiveint.dll" or module.path contains "\\atl.dll" or module.path contains "\\audioses.dll" or module.path contains "\\auditpolcore.dll" or module.path contains "\\authfwcfg.dll" or module.path contains "\\authz.dll" or module.path contains "\\avrt.dll" or module.path contains "\\batmeter.dll" or module.path contains "\\bcd.dll" or module.path contains "\\bcp47langs.dll" or module.path contains "\\bcp47mrm.dll" or module.path contains "\\bcrypt.dll" or module.path contains "\\bderepair.dll" or module.path contains "\\bootmenuux.dll" or module.path contains "\\bootux.dll" or module.path contains "\\cabinet.dll" or module.path contains "\\cabview.dll" or module.path contains "\\certcli.dll" or module.path contains "\\certenroll.dll" or module.path contains "\\cfgmgr32.dll" or module.path contains "\\cldapi.dll" or module.path contains "\\clipc.dll" or module.path contains "\\clusapi.dll" or module.path contains "\\cmpbk32.dll" or module.path contains "\\cmutil.dll" or module.path contains "\\coloradapterclient.dll" or module.path contains "\\colorui.dll" or module.path contains "\\comdlg32.dll" or module.path contains "\\configmanager2.dll" or module.path contains "\\connect.dll" or module.path contains "\\coredplus.dll" or module.path contains "\\coremessaging.dll" or module.path contains "\\coreuicomponents.dll" or module.path contains "\\credui.dll" or module.path contains "\\cryptbase.dll" or module.path contains "\\cryptdll.dll" or module.path contains "\\cryptsp.dll" or module.path contains "\\cryptui.dll" or module.path contains "\\cryptxml.dll" or module.path contains "\\cscapi.dll" or module.path contains "\\cscobj.dll" or module.path contains "\\cscui.dll" or module.path contains "\\d2d1.dll" or module.path contains "\\d3d10_1.dll" or module.path contains "\\d3d10_1core.dll" or module.path contains "\\d3d10.dll" or module.path contains "\\d3d10core.dll" or module.path contains "\\d3d10warp.dll" or module.path contains "\\d3d11.dll" or module.path contains "\\d3d12.dll" or module.path contains "\\d3d9.dll" or module.path contains "\\d3dx9_43.dll" or module.path contains "\\dataexchange.dll" or module.path contains "\\davclnt.dll" or module.path contains "\\dcntel.dll" or module.path contains "\\dcomp.dll" or module.path contains "\\defragproxy.dll" or module.path contains "\\desktopshellext.dll" or module.path contains "\\deviceassociation.dll" or module.path contains "\\devicecredential.dll" or module.path contains "\\devicepairing.dll" or module.path contains "\\devobj.dll" or module.path contains "\\devrtl.dll" or module.path contains "\\dhcpcmonitor.dll" or module.path contains "\\dhcpcsvc.dll" or module.path contains "\\dhcpcsvc6.dll" or module.path contains "\\directmanipulation.dll" or module.path contains "\\dismapi.dll" or module.path contains "\\dismcore.dll" or module.path contains "\\dmcfgutils.dll" or module.path contains "\\dmcmnutils.dll" or module.path contains "\\dmcommandlineutils.dll" or module.path contains "\\dmenrollengine.dll" or module.path contains "\\dmenterprisediagnostics.dll" or module.path contains "\\dmiso8601utils.dll" or module.path contains "\\dmoleaututils.dll" or module.path contains "\\dmprocessxmlfiltered.dll" or module.path contains "\\dmpushproxy.dll" or module.path contains "\\dmxmlhelputils.dll" or module.path contains "\\dnsapi.dll" or module.path contains "\\dot3api.dll" or module.path contains "\\dot3cfg.dll" or module.path contains "\\dpx.dll" or module.path contains "\\drprov.dll" or module.path contains "\\drvstore.dll" or module.path contains "\\dsclient.dll" or module.path contains "\\dsparse.dll" or module.path contains "\\dsprop.dll" or module.path contains "\\dsreg.dll" or module.path contains "\\dsrole.dll" or module.path contains "\\dui70.dll" or module.path contains "\\duser.dll" or module.path contains "\\dusmapi.dll" or module.path contains "\\dwmapi.dll" or module.path contains "\\dwmcore.dll" or module.path contains "\\dwrite.dll" or module.path contains "\\dxcore.dll" or module.path contains "\\dxgi.dll" or module.path contains "\\dxva2.dll" or module.path contains "\\dynamoapi.dll" or module.path contains "\\eappcfg.dll" or module.path contains "\\eappprxy.dll" or module.path contains "\\edgeiso.dll" or module.path contains "\\edputil.dll" or module.path contains "\\efsadu.dll" or module.path contains "\\efsutil.dll" or module.path contains "\\esent.dll" or module.path contains "\\execmodelproxy.dll" or module.path contains "\\explorerframe.dll" or module.path contains "\\fastprox.dll" or module.path contains "\\faultrep.dll" or module.path contains "\\fddevquery.dll" or module.path contains "\\feclient.dll" or module.path contains "\\fhcfg.dll" or module.path contains "\\fhsvcctl.dll" or module.path contains "\\firewallapi.dll" or module.path contains "\\flightsettings.dll" or module.path contains "\\fltlib.dll" or module.path contains "\\framedynos.dll" or module.path contains "\\fveapi.dll" or module.path contains "\\fveskybackup.dll" or module.path contains "\\fvewiz.dll" or module.path contains "\\fwbase.dll" or module.path contains "\\fwcfg.dll" or module.path contains "\\fwpolicyiomgr.dll" or module.path contains "\\fwpuclnt.dll" or module.path contains "\\fxsapi.dll" or module.path contains "\\fxsst.dll" or module.path contains "\\fxstiff.dll" or module.path contains "\\getuname.dll" or module.path contains "\\gpapi.dll" or module.path contains "\\hid.dll" or module.path contains "\\hnetmon.dll" or module.path contains "\\httpapi.dll" or module.path contains "\\icmp.dll" or module.path contains "\\idstore.dll" or module.path contains "\\ieadvpack.dll" or module.path contains "\\iedkcs32.dll" or module.path contains "\\iernonce.dll" or module.path contains "\\iertutil.dll" or module.path contains "\\ifmon.dll" or module.path contains "\\ifsutil.dll" or module.path contains "\\inproclogger.dll" or module.path contains "\\iphlpapi.dll" or module.path contains "\\iri.dll" or module.path contains "\\iscsidsc.dll" or module.path contains "\\iscsium.dll" or module.path contains "\\isv.exe_rsaenh.dll" or module.path contains "\\iumbase.dll" or module.path contains "\\iumsdk.dll" or module.path contains "\\joinutil.dll" or module.path contains "\\kdstub.dll" or module.path contains "\\ksuser.dll" or module.path contains "\\ktmw32.dll" or module.path contains "\\licensemanagerapi.dll" or module.path contains "\\licensingdiagspp.dll" or module.path contains "\\linkinfo.dll" or module.path contains "\\loadperf.dll" or module.path contains "\\lockhostingframework.dll" or module.path contains "\\logoncli.dll" or module.path contains "\\logoncontroller.dll" or module.path contains "\\lpksetupproxyserv.dll" or module.path contains "\\lrwizdll.dll" or module.path contains "\\magnification.dll" or module.path contains "\\maintenanceui.dll" or module.path contains "\\mapistub.dll" or module.path contains "\\mbaexmlparser.dll" or module.path contains "\\mdmdiagnostics.dll" or module.path contains "\\mfc42u.dll" or module.path contains "\\mfcore.dll" or module.path contains "\\mfplat.dll" or module.path contains "\\mi.dll" or module.path contains "\\midimap.dll" or module.path contains "\\mintdh.dll" or module.path contains "\\miutils.dll" or module.path contains "\\mlang.dll" or module.path contains "\\mmdevapi.dll" or module.path contains "\\mobilenetworking.dll" or module.path contains "\\mpr.dll" or module.path contains "\\mprapi.dll" or module.path contains "\\mrmcorer.dll" or module.path contains "\\msacm32.dll" or module.path contains "\\mscms.dll" or module.path contains "\\mscoree.dll" or module.path contains "\\msctf.dll" or module.path contains "\\msctfmonitor.dll" or module.path contains "\\msdrm.dll" or module.path contains "\\msdtctm.dll" or module.path contains "\\msftedit.dll" or module.path contains "\\msi.dll" or module.path contains "\\msiso.dll" or module.path contains "\\msutb.dll" or module.path contains "\\msvcp110_win.dll" or module.path contains "\\mswb7.dll" or module.path contains "\\mswsock.dll" or module.path contains "\\msxml3.dll" or module.path contains "\\mtxclu.dll" or module.path contains "\\napinsp.dll" or module.path contains "\\ncrypt.dll" or module.path contains "\\ndfapi.dll" or module.path contains "\\netapi32.dll" or module.path contains "\\netid.dll" or module.path contains "\\netiohlp.dll" or module.path contains "\\netjoin.dll" or module.path contains "\\netplwiz.dll" or module.path contains "\\netprofm.dll" or module.path contains "\\netprovfw.dll" or module.path contains "\\netsetupapi.dll" or module.path contains "\\netshell.dll" or module.path contains "\\nettrace.dll" or module.path contains "\\netutils.dll" or module.path contains "\\networkexplorer.dll" or module.path contains "\\newdev.dll" or module.path contains "\\ninput.dll" or module.path contains "\\nlaapi.dll" or module.path contains "\\nlansp_c.dll" or module.path contains "\\npmproxy.dll" or module.path contains "\\nshhttp.dll" or module.path contains "\\nshipsec.dll" or module.path contains "\\nshwfp.dll" or module.path contains "\\ntdsapi.dll" or module.path contains "\\ntlanman.dll" or module.path contains "\\ntlmshared.dll" or module.path contains "\\ntmarta.dll" or module.path contains "\\ntshrui.dll" or module.path contains "\\oleacc.dll" or module.path contains "\\omadmapi.dll" or module.path contains "\\onex.dll" or module.path contains "\\opcservices.dll" or module.path contains "\\osbaseln.dll" or module.path contains "\\osksupport.dll" or module.path contains "\\osuninst.dll" or module.path contains "\\p2p.dll" or module.path contains "\\p2pnetsh.dll" or module.path contains "\\p9np.dll" or module.path contains "\\pcaui.dll" or module.path contains "\\pdh.dll" or module.path contains "\\peerdistsh.dll" or module.path contains "\\pkeyhelper.dll" or module.path contains "\\pla.dll" or module.path contains "\\playsndsrv.dll" or module.path contains "\\pnrpnsp.dll" or module.path contains "\\policymanager.dll" or module.path contains "\\polstore.dll" or module.path contains "\\powrprof.dll" or module.path contains "\\printui.dll" or module.path contains "\\prntvpt.dll" or module.path contains "\\profapi.dll" or module.path contains "\\propsys.dll" or module.path contains "\\proximitycommon.dll" or module.path contains "\\proximityservicepal.dll" or module.path contains "\\prvdmofcomp.dll" or module.path contains "\\puiapi.dll" or module.path contains "\\radcui.dll" or module.path contains "\\rasapi32.dll" or module.path contains "\\rasdlg.dll" or module.path contains "\\rasgcw.dll" or module.path contains "\\rasman.dll" or module.path contains "\\rasmontr.dll" or module.path contains "\\reagent.dll" or module.path contains "\\regapi.dll" or module.path contains "\\reseteng.dll" or module.path contains "\\resetengine.dll" or module.path contains "\\resutils.dll" or module.path contains "\\rmclient.dll" or module.path contains "\\rpcnsh.dll" or module.path contains "\\rsaenh.dll" or module.path contains "\\rtutils.dll" or module.path contains "\\rtworkq.dll" or module.path contains "\\samcli.dll" or module.path contains "\\samlib.dll" or module.path contains "\\sapi_onecore.dll" or module.path contains "\\sas.dll" or module.path contains "\\scansetting.dll" or module.path contains "\\scecli.dll" or module.path contains "\\schedcli.dll" or module.path contains "\\secur32.dll" or module.path contains "\\security.dll" or module.path contains "\\sensapi.dll" or module.path contains "\\shell32.dll" or module.path contains "\\shfolder.dll" or module.path contains "\\slc.dll" or module.path contains "\\snmpapi.dll" or module.path contains "\\spectrumsyncclient.dll" or module.path contains "\\spp.dll" or module.path contains "\\sppc.dll" or module.path contains "\\sppcext.dll" or module.path contains "\\srclient.dll" or module.path contains "\\srcore.dll" or module.path contains "\\srmtrace.dll" or module.path contains "\\srpapi.dll" or module.path contains "\\srvcli.dll" or module.path contains "\\ssp_isv.exe_rsaenh.dll" or module.path contains "\\ssp.exe_rsaenh.dll" or module.path contains "\\sspicli.dll" or module.path contains "\\ssshim.dll" or module.path contains "\\staterepository.core.dll" or module.path contains "\\structuredquery.dll" or module.path contains "\\sxshared.dll" or module.path contains "\\systemsettingsthresholdadminflowui.dll" or module.path contains "\\tapi32.dll" or module.path contains "\\tbs.dll" or module.path contains "\\tdh.dll" or module.path contains "\\textshaping.dll" or module.path contains "\\timesync.dll" or module.path contains "\\tpmcoreprovisioning.dll" or module.path contains "\\tquery.dll" or module.path contains "\\tsworkspace.dll" or module.path contains "\\ttdrecord.dll" or module.path contains "\\twext.dll" or module.path contains "\\twinapi.dll" or module.path contains "\\twinui.appcore.dll" or module.path contains "\\uianimation.dll" or module.path contains "\\uiautomationcore.dll" or module.path contains "\\uireng.dll" or module.path contains "\\uiribbon.dll" or module.path contains "\\umpdc.dll" or module.path contains "\\unattend.dll" or module.path contains "\\updatepolicy.dll" or module.path contains "\\upshared.dll" or module.path contains "\\urlmon.dll" or module.path contains "\\userenv.dll" or module.path contains "\\utildll.dll" or module.path contains "\\uxinit.dll" or module.path contains "\\uxtheme.dll" or module.path contains "\\vaultcli.dll" or module.path contains "\\vdsutil.dll" or module.path contains "\\version.dll" or module.path contains "\\virtdisk.dll" or module.path contains "\\vssapi.dll" or module.path contains "\\vsstrace.dll" or module.path contains "\\wbemprox.dll" or module.path contains "\\wbemsvc.dll" or module.path contains "\\wcmapi.dll" or module.path contains "\\wcnnetsh.dll" or module.path contains "\\wdi.dll" or module.path contains "\\wdscore.dll" or module.path contains "\\webservices.dll" or module.path contains "\\wecapi.dll" or module.path contains "\\wer.dll" or module.path contains "\\wevtapi.dll" or module.path contains "\\whhelper.dll" or module.path contains "\\wimgapi.dll" or module.path contains "\\winbio.dll" or module.path contains "\\winbrand.dll" or module.path contains "\\windows.storage.dll" or module.path contains "\\windows.storage.search.dll" or module.path contains "\\windows.ui.immersive.dll" or module.path contains "\\windowscodecs.dll" or module.path contains "\\windowscodecsext.dll" or module.path contains "\\windowsudk.shellcommon.dll" or module.path contains "\\winhttp.dll" or module.path contains "\\wininet.dll" or module.path contains "\\winipsec.dll" or module.path contains "\\winmde.dll" or module.path contains "\\winmm.dll" or module.path contains "\\winnsi.dll" or module.path contains "\\winrnr.dll" or module.path contains "\\winscard.dll" or module.path contains "\\winsqlite3.dll" or module.path contains "\\winsta.dll" or module.path contains "\\winsync.dll" or module.path contains "\\wkscli.dll" or module.path contains "\\wlanapi.dll" or module.path contains "\\wlancfg.dll" or module.path contains "\\wldp.dll" or module.path contains "\\wlidprov.dll" or module.path contains "\\wmiclnt.dll" or module.path contains "\\wmidcom.dll" or module.path contains "\\wmiutils.dll" or module.path contains "\\wmpdui.dll" or module.path contains "\\wmsgapi.dll" or module.path contains "\\wofutil.dll" or module.path contains "\\wpdshext.dll" or module.path contains "\\wscapi.dll" or module.path contains "\\wsdapi.dll" or module.path contains "\\wshbth.dll" or module.path contains "\\wshelper.dll" or module.path contains "\\wsmsvc.dll" or module.path contains "\\wtsapi32.dll" or module.path contains "\\wwancfg.dll" or module.path contains "\\wwapi.dll" or module.path contains "\\xmllite.dll" or module.path contains "\\xolehlp.dll" or module.path contains "\\xpsservices.dll" or module.path contains "\\xwizards.dll" or module.path contains "\\xwtpw32.dll" or module.path contains "\\amsi.dll" or module.path contains "\\appraiser.dll" or module.path contains "\\COMRES.DLL" or module.path contains "\\cryptnet.dll" or module.path contains "\\DispBroker.dll" or module.path contains "\\dsound.dll" or module.path contains "\\dxilconv.dll" or module.path contains "\\FxsCompose.dll" or module.path contains "\\FXSRESM.DLL" or module.path contains "\\msdtcVSp1res.dll" or module.path contains "\\PrintIsolationProxy.dll" or module.path contains "\\rdpendp.dll" or module.path contains "\\rpchttp.dll" or module.path contains "\\storageusage.dll" or module.path contains "\\utcutil.dll" or module.path contains "\\WfsR.dll" or module.path contains "\\igd10iumd64.dll" or module.path contains "\\igd12umd64.dll" or module.path contains "\\igdumdim64.dll" or module.path contains "\\igdusc64.dll" or module.path contains "\\TSMSISrv.dll" or module.path contains "\\TSVIPSrv.dll" or module.path contains "\\wbemcomn.dll" or module.path contains "\\WLBSCTRL.dll" or module.path contains "\\wow64log.dll" or module.path contains "\\WptsExtensions.dll") and (not ((module.path contains "C:\\$WINDOWS.~BT\\" or module.path contains "C:\\$WinREAgent\\" or module.path contains "C:\\Windows\\SoftwareDistribution\\" or module.path contains "C:\\Windows\\System32\\" or module.path contains "C:\\Windows\\SystemTemp\\" or module.path contains "C:\\Windows\\SysWOW64\\" or module.path contains "C:\\Windows\\WinSxS\\" or module.path contains "C:\\Windows\\SyChpe32\\") or (module.path contains "C:\\Windows\\Temp\\" and (src.process.image.path contains "C:\\Windows\\WinSxS\\arm64" or src.process.image.path contains "C:\\Windows\\UUS\\arm64\\") and (src.process.image.path contains "\\TiWorker.exe" or src.process.image.path contains "\\wuaucltcore.exe")) or (module.path contains "C:\\Windows\\Microsoft.NET\\" and module.path contains "\\cscui.dll") or (module.path contains "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\" and module.path contains "\\version.dll") or (module.path contains "C:\\Program Files\\WindowsApps\\Microsoft.DirectXRuntime_" and module.path contains "\\d3dx9_43.dll"))) and (not ((module.path contains "C:\\Program Files\\Microsoft\\Exchange Server\\" and module.path contains "\\mswb7.dll") or (module.path contains "C:\\Program Files\\Arsenal-Image-Mounter-" and (module.path contains "\\mi.dll" or module.path contains "\\miutils.dl")) or (src.process.image.path="C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\OfficeClickToRun.exe" and module.path="C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\AppVPolicy.dll") or module.path contains "C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\" or ((src.process.image.path contains "C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs" or src.process.image.path contains "C:\\Windows\\System32\\backgroundTaskHost.exe") and module.path contains "C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs") or (src.process.image.path contains "C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs" and src.process.image.path contains "\\wldp.dll") or ((src.process.image.path contains "C:\\Program Files\\CheckPoint\\" or src.process.image.path contains "C:\\Program Files (x86)\\CheckPoint\\") and src.process.image.path contains "\\SmartConsole.exe" and (module.path contains "C:\\Program Files\\CheckPoint\\" or module.path contains "C:\\Program Files (x86)\\CheckPoint\\") and module.path contains "\\PolicyManager.dll")))))
```


# Original Sigma Rule:
```yaml
title: Potential System DLL Sideloading From Non System Locations
id: 4fc0deee-0057-4998-ab31-d24e46e0aba4
status: test
description: Detects DLL sideloading of DLLs usually located in system locations (System32, SysWOW64, etc.).
references:
    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there). Wietze Beukema (project and research)
    - https://blog.cyble.com/2022/07/21/qakbot-resurfaces-with-new-playbook/ # WindowsCodecs.dll
    - https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/ # iphlpapi.dll
    - https://github.com/XForceIR/SideLoadHunter/blob/cc7ef2e5d8908279b0c4cee4e8b6f85f7b8eed52/SideLoads/README.md # XForceIR (SideLoadHunter Project), Chris Spehn (research WFH Dridex)
    - https://www.hexacorn.com/blog/2023/12/26/1-little-known-secret-of-runonce-exe-32-bit/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-08-14
modified: 2025-12-03
tags:
    - attack.defense-evasion
    - attack.persistence
    - attack.privilege-escalation
    - attack.t1574.001
logsource:
    category: image_load
    product: windows
detection:
    selection:
        ImageLoaded|endswith:
            - '\aclui.dll'
            - '\activeds.dll'
            - '\adsldpc.dll'
            - '\aepic.dll'
            - '\apphelp.dll'
            - '\applicationframe.dll'
            - '\appvpolicy.dll'
            - '\appxalluserstore.dll'
            - '\appxdeploymentclient.dll'
            - '\archiveint.dll'
            - '\atl.dll'
            - '\audioses.dll'
            - '\auditpolcore.dll'
            - '\authfwcfg.dll'
            - '\authz.dll'
            - '\avrt.dll'
            - '\batmeter.dll'
            - '\bcd.dll'
            - '\bcp47langs.dll'
            - '\bcp47mrm.dll'
            - '\bcrypt.dll'
            - '\bderepair.dll'
            - '\bootmenuux.dll'
            - '\bootux.dll'
            - '\cabinet.dll'
            - '\cabview.dll'
            - '\certcli.dll'
            - '\certenroll.dll'
            - '\cfgmgr32.dll'
            - '\cldapi.dll'
            - '\clipc.dll'
            - '\clusapi.dll'
            - '\cmpbk32.dll'
            - '\cmutil.dll'
            - '\coloradapterclient.dll'
            - '\colorui.dll'
            - '\comdlg32.dll'
            - '\configmanager2.dll'
            - '\connect.dll'
            - '\coredplus.dll'
            - '\coremessaging.dll'
            - '\coreuicomponents.dll'
            - '\credui.dll'
            - '\cryptbase.dll'
            - '\cryptdll.dll'
            - '\cryptsp.dll'
            - '\cryptui.dll'
            - '\cryptxml.dll'
            - '\cscapi.dll'
            - '\cscobj.dll'
            - '\cscui.dll'
            - '\d2d1.dll'
            - '\d3d10_1.dll'
            - '\d3d10_1core.dll'
            - '\d3d10.dll'
            - '\d3d10core.dll'
            - '\d3d10warp.dll'
            - '\d3d11.dll'
            - '\d3d12.dll'
            - '\d3d9.dll'
            - '\d3dx9_43.dll'
            - '\dataexchange.dll'
            - '\davclnt.dll'
            - '\dcntel.dll'
            - '\dcomp.dll'
            - '\defragproxy.dll'
            - '\desktopshellext.dll'
            - '\deviceassociation.dll'
            - '\devicecredential.dll'
            - '\devicepairing.dll'
            - '\devobj.dll'
            - '\devrtl.dll'
            - '\dhcpcmonitor.dll'
            - '\dhcpcsvc.dll'
            - '\dhcpcsvc6.dll'
            - '\directmanipulation.dll'
            - '\dismapi.dll'
            - '\dismcore.dll'
            - '\dmcfgutils.dll'
            - '\dmcmnutils.dll'
            - '\dmcommandlineutils.dll'
            - '\dmenrollengine.dll'
            - '\dmenterprisediagnostics.dll'
            - '\dmiso8601utils.dll'
            - '\dmoleaututils.dll'
            - '\dmprocessxmlfiltered.dll'
            - '\dmpushproxy.dll'
            - '\dmxmlhelputils.dll'
            - '\dnsapi.dll'
            - '\dot3api.dll'
            - '\dot3cfg.dll'
            - '\dpx.dll'
            - '\drprov.dll'
            - '\drvstore.dll'
            - '\dsclient.dll'
            - '\dsparse.dll'
            - '\dsprop.dll'
            - '\dsreg.dll'
            - '\dsrole.dll'
            - '\dui70.dll'
            - '\duser.dll'
            - '\dusmapi.dll'
            - '\dwmapi.dll'
            - '\dwmcore.dll'
            - '\dwrite.dll'
            - '\dxcore.dll'
            - '\dxgi.dll'
            - '\dxva2.dll'
            - '\dynamoapi.dll'
            - '\eappcfg.dll'
            - '\eappprxy.dll'
            - '\edgeiso.dll'
            - '\edputil.dll'
            - '\efsadu.dll'
            - '\efsutil.dll'
            - '\esent.dll'
            - '\execmodelproxy.dll'
            - '\explorerframe.dll'
            - '\fastprox.dll'
            - '\faultrep.dll'
            - '\fddevquery.dll'
            - '\feclient.dll'
            - '\fhcfg.dll'
            - '\fhsvcctl.dll'
            - '\firewallapi.dll'
            - '\flightsettings.dll'
            - '\fltlib.dll'
            - '\framedynos.dll'
            - '\fveapi.dll'
            - '\fveskybackup.dll'
            - '\fvewiz.dll'
            - '\fwbase.dll'
            - '\fwcfg.dll'
            - '\fwpolicyiomgr.dll'
            - '\fwpuclnt.dll'
            - '\fxsapi.dll'
            - '\fxsst.dll'
            - '\fxstiff.dll'
            - '\getuname.dll'
            - '\gpapi.dll'
            - '\hid.dll'
            - '\hnetmon.dll'
            - '\httpapi.dll'
            - '\icmp.dll'
            - '\idstore.dll'
            - '\ieadvpack.dll'
            - '\iedkcs32.dll'
            - '\iernonce.dll'
            - '\iertutil.dll'
            - '\ifmon.dll'
            - '\ifsutil.dll'
            - '\inproclogger.dll'
            - '\iphlpapi.dll'
            - '\iri.dll'
            - '\iscsidsc.dll'
            - '\iscsium.dll'
            - '\isv.exe_rsaenh.dll'
            - '\iumbase.dll'
            - '\iumsdk.dll'
            - '\joinutil.dll'
            - '\kdstub.dll'
            - '\ksuser.dll'
            - '\ktmw32.dll'
            - '\licensemanagerapi.dll'
            - '\licensingdiagspp.dll'
            - '\linkinfo.dll'
            - '\loadperf.dll'
            - '\lockhostingframework.dll'
            - '\logoncli.dll'
            - '\logoncontroller.dll'
            - '\lpksetupproxyserv.dll'
            - '\lrwizdll.dll'
            - '\magnification.dll'
            - '\maintenanceui.dll'
            - '\mapistub.dll'
            - '\mbaexmlparser.dll'
            - '\mdmdiagnostics.dll'
            - '\mfc42u.dll'
            - '\mfcore.dll'
            - '\mfplat.dll'
            - '\mi.dll'
            - '\midimap.dll'
            - '\mintdh.dll'
            - '\miutils.dll'
            - '\mlang.dll'
            - '\mmdevapi.dll'
            - '\mobilenetworking.dll'
            - '\mpr.dll'
            - '\mprapi.dll'
            - '\mrmcorer.dll'
            - '\msacm32.dll'
            - '\mscms.dll'
            - '\mscoree.dll'
            - '\msctf.dll'
            - '\msctfmonitor.dll'
            - '\msdrm.dll'
            - '\msdtctm.dll'
            - '\msftedit.dll'
            - '\msi.dll'
            - '\msiso.dll'
            - '\msutb.dll'
            - '\msvcp110_win.dll'
            - '\mswb7.dll'
            - '\mswsock.dll'
            - '\msxml3.dll'
            - '\mtxclu.dll'
            - '\napinsp.dll'
            - '\ncrypt.dll'
            - '\ndfapi.dll'
            - '\netapi32.dll'
            - '\netid.dll'
            - '\netiohlp.dll'
            - '\netjoin.dll'
            - '\netplwiz.dll'
            - '\netprofm.dll'
            - '\netprovfw.dll'
            - '\netsetupapi.dll'
            - '\netshell.dll'
            - '\nettrace.dll'
            - '\netutils.dll'
            - '\networkexplorer.dll'
            - '\newdev.dll'
            - '\ninput.dll'
            - '\nlaapi.dll'
            - '\nlansp_c.dll'
            - '\npmproxy.dll'
            - '\nshhttp.dll'
            - '\nshipsec.dll'
            - '\nshwfp.dll'
            - '\ntdsapi.dll'
            - '\ntlanman.dll'
            - '\ntlmshared.dll'
            - '\ntmarta.dll'
            - '\ntshrui.dll'
            - '\oleacc.dll'
            - '\omadmapi.dll'
            - '\onex.dll'
            - '\opcservices.dll'
            - '\osbaseln.dll'
            - '\osksupport.dll'
            - '\osuninst.dll'
            - '\p2p.dll'
            - '\p2pnetsh.dll'
            - '\p9np.dll'
            - '\pcaui.dll'
            - '\pdh.dll'
            - '\peerdistsh.dll'
            - '\pkeyhelper.dll'
            - '\pla.dll'
            - '\playsndsrv.dll'
            - '\pnrpnsp.dll'
            - '\policymanager.dll'
            - '\polstore.dll'
            - '\powrprof.dll'
            - '\printui.dll'
            - '\prntvpt.dll'
            - '\profapi.dll'
            - '\propsys.dll'
            - '\proximitycommon.dll'
            - '\proximityservicepal.dll'
            - '\prvdmofcomp.dll'
            - '\puiapi.dll'
            - '\radcui.dll'
            - '\rasapi32.dll'
            - '\rasdlg.dll'
            - '\rasgcw.dll'
            - '\rasman.dll'
            - '\rasmontr.dll'
            - '\reagent.dll'
            - '\regapi.dll'
            - '\reseteng.dll'
            - '\resetengine.dll'
            - '\resutils.dll'
            - '\rmclient.dll'
            - '\rpcnsh.dll'
            - '\rsaenh.dll'
            - '\rtutils.dll'
            - '\rtworkq.dll'
            - '\samcli.dll'
            - '\samlib.dll'
            - '\sapi_onecore.dll'
            - '\sas.dll'
            - '\scansetting.dll'
            - '\scecli.dll'
            - '\schedcli.dll'
            - '\secur32.dll'
            - '\security.dll'
            - '\sensapi.dll'
            - '\shell32.dll'
            - '\shfolder.dll'
            - '\slc.dll'
            - '\snmpapi.dll'
            - '\spectrumsyncclient.dll'
            - '\spp.dll'
            - '\sppc.dll'
            - '\sppcext.dll'
            - '\srclient.dll'
            - '\srcore.dll'
            - '\srmtrace.dll'
            - '\srpapi.dll'
            - '\srvcli.dll'
            - '\ssp_isv.exe_rsaenh.dll'
            - '\ssp.exe_rsaenh.dll'
            - '\sspicli.dll'
            - '\ssshim.dll'
            - '\staterepository.core.dll'
            - '\structuredquery.dll'
            - '\sxshared.dll'
            - '\systemsettingsthresholdadminflowui.dll'
            - '\tapi32.dll'
            - '\tbs.dll'
            - '\tdh.dll'
            - '\textshaping.dll'
            - '\timesync.dll'
            - '\tpmcoreprovisioning.dll'
            - '\tquery.dll'
            - '\tsworkspace.dll'
            - '\ttdrecord.dll'
            - '\twext.dll'
            - '\twinapi.dll'
            - '\twinui.appcore.dll'
            - '\uianimation.dll'
            - '\uiautomationcore.dll'
            - '\uireng.dll'
            - '\uiribbon.dll'
            - '\umpdc.dll'
            - '\unattend.dll'
            - '\updatepolicy.dll'
            - '\upshared.dll'
            - '\urlmon.dll'
            - '\userenv.dll'
            - '\utildll.dll'
            - '\uxinit.dll'
            - '\uxtheme.dll'
            - '\vaultcli.dll'
            - '\vdsutil.dll'
            - '\version.dll'
            - '\virtdisk.dll'
            - '\vssapi.dll'
            - '\vsstrace.dll'
            - '\wbemprox.dll'
            - '\wbemsvc.dll'
            - '\wcmapi.dll'
            - '\wcnnetsh.dll'
            - '\wdi.dll'
            - '\wdscore.dll'
            - '\webservices.dll'
            - '\wecapi.dll'
            - '\wer.dll'
            - '\wevtapi.dll'
            - '\whhelper.dll'
            - '\wimgapi.dll'
            - '\winbio.dll'
            - '\winbrand.dll'
            - '\windows.storage.dll'
            - '\windows.storage.search.dll'
            - '\windows.ui.immersive.dll'
            - '\windowscodecs.dll'
            - '\windowscodecsext.dll'
            - '\windowsudk.shellcommon.dll'
            - '\winhttp.dll'
            - '\wininet.dll'
            - '\winipsec.dll'
            - '\winmde.dll'
            - '\winmm.dll'
            - '\winnsi.dll'
            - '\winrnr.dll'
            - '\winscard.dll'
            - '\winsqlite3.dll'
            - '\winsta.dll'
            - '\winsync.dll'
            - '\wkscli.dll'
            - '\wlanapi.dll'
            - '\wlancfg.dll'
            - '\wldp.dll'
            - '\wlidprov.dll'
            - '\wmiclnt.dll'
            - '\wmidcom.dll'
            - '\wmiutils.dll'
            - '\wmpdui.dll'
            - '\wmsgapi.dll'
            - '\wofutil.dll'
            - '\wpdshext.dll'
            - '\wscapi.dll'
            - '\wsdapi.dll'
            - '\wshbth.dll'
            - '\wshelper.dll'
            - '\wsmsvc.dll'
            - '\wtsapi32.dll'
            - '\wwancfg.dll'
            - '\wwapi.dll'
            - '\xmllite.dll'
            - '\xolehlp.dll'
            - '\xpsservices.dll'
            - '\xwizards.dll'
            - '\xwtpw32.dll'
            # From https://github.com/XForceIR/SideLoadHunter/blob/main/SideLoads/README.md
            - '\amsi.dll'
            - '\appraiser.dll'
            - '\COMRES.DLL'
            - '\cryptnet.dll'
            - '\DispBroker.dll'
            - '\dsound.dll'
            - '\dxilconv.dll'
            - '\FxsCompose.dll'
            - '\FXSRESM.DLL'
            - '\msdtcVSp1res.dll'
            - '\PrintIsolationProxy.dll'
            - '\rdpendp.dll'
            - '\rpchttp.dll'
            - '\storageusage.dll'
            - '\utcutil.dll'
            - '\WfsR.dll'
            # The DLLs below exists in "C:\Windows\System32\DriverStore\FileRepository\" folder. But there is also a copy located in "C:\ProgramData\Package Cache\XXXXXXX\Graphics\". If you see them being loaded from there. Please comment them out, don't add a filter for ProgramData :)
            - '\igd10iumd64.dll'
            - '\igd12umd64.dll'
            - '\igdumdim64.dll'
            - '\igdusc64.dll'
            # Other
            - '\TSMSISrv.dll'
            - '\TSVIPSrv.dll'
            - '\wbemcomn.dll'
            - '\WLBSCTRL.dll'
            - '\wow64log.dll'
            - '\WptsExtensions.dll'
    filter_main_generic:
        # Note: this filter is generic on purpose to avoid insane amount of FP from legitimate third party applications. A better approach would be to baseline everything and add specific filters to avoid blind spots
        ImageLoaded|contains:
            - 'C:\$WINDOWS.~BT\'
            - 'C:\$WinREAgent\'
            - 'C:\Windows\SoftwareDistribution\'
            - 'C:\Windows\System32\'
            - 'C:\Windows\SystemTemp\'
            - 'C:\Windows\SysWOW64\'
            - 'C:\Windows\WinSxS\'
            - 'C:\Windows\SyChpe32\' # “hybrid” binaries containing x86-to-ARM stubs to improve the x86 emulation performance
    filter_main_windows_temp:
        ImageLoaded|startswith: 'C:\Windows\Temp\'
        Image|startswith:
            - 'C:\Windows\WinSxS\arm64'
            - 'C:\Windows\UUS\arm64\'
        Image|endswith:
            - '\TiWorker.exe'
            - '\wuaucltcore.exe'
    filter_main_dot_net:
        ImageLoaded|startswith: 'C:\Windows\Microsoft.NET\'
        ImageLoaded|endswith: '\cscui.dll'
    filter_main_defender:
        ImageLoaded|startswith: 'C:\ProgramData\Microsoft\Windows Defender\Platform\'
        ImageLoaded|endswith: '\version.dll'
    filter_main_directx:
        ImageLoaded|startswith: 'C:\Program Files\WindowsApps\Microsoft.DirectXRuntime_'
        ImageLoaded|endswith: '\d3dx9_43.dll'
    filter_optional_exchange:
        ImageLoaded|startswith: 'C:\Program Files\Microsoft\Exchange Server\'
        ImageLoaded|endswith: '\mswb7.dll'
    filter_optional_arsenal_image_mounter:
        ImageLoaded|startswith: 'C:\Program Files\Arsenal-Image-Mounter-'
        ImageLoaded|endswith:
            - '\mi.dll'
            - '\miutils.dl'
    filter_optional_office_appvpolicy:
        Image: 'C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeClickToRun.exe'
        ImageLoaded: 'C:\Program Files\Common Files\microsoft shared\ClickToRun\AppVPolicy.dll'
    filter_optional_azure:
        ImageLoaded|startswith: 'C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\'
    filter_optional_dell:
        Image|contains:
            - 'C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs'
            - 'C:\Windows\System32\backgroundTaskHost.exe'
        ImageLoaded|startswith: 'C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs'
    filter_optional_dell_wldp:
        Image|startswith: 'C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs'
        Image|endswith: '\wldp.dll'
    filter_optional_checkpoint:
        Image|startswith:
            - 'C:\Program Files\CheckPoint\'
            - 'C:\Program Files (x86)\CheckPoint\'
        Image|endswith: '\SmartConsole.exe'
        ImageLoaded|startswith:
            - 'C:\Program Files\CheckPoint\'
            - 'C:\Program Files (x86)\CheckPoint\'
        ImageLoaded|endswith: '\PolicyManager.dll'
    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
falsepositives:
    - Legitimate applications loading their own versions of the DLLs mentioned in this rule
level: high
```
